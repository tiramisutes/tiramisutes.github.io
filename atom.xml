<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hope</title>
  <subtitle>A new day is coming,whether we like it or not. The question is will you control it,or will it control you?</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://tiramisutes.github.io/"/>
  <updated>2021-10-21T14:02:23.577Z</updated>
  <id>http://tiramisutes.github.io/</id>
  
  <author>
    <name>tiramisutes</name>
    <email>1099808298@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>植物单细胞转录组数据库PsctH</title>
    <link href="http://tiramisutes.github.io/2021/10/21/PsctH.html"/>
    <id>http://tiramisutes.github.io/2021/10/21/PsctH.html</id>
    <published>2021-10-21T13:55:09.000Z</published>
    <updated>2021-10-21T14:02:23.577Z</updated>
    
    <content type="html"><![CDATA[<p>作为所有生物体的基本组成部分，细胞在维持生命活动中起着至关重要的作用，而作为细胞异质性研究的重要工具，近年来单细胞转录组测序技术蓬勃发展，促使生物学研究进入单细胞水平的时代。然而，在植物学领域，单细胞的研究仍处于起步阶段，可用资源非常有限，且单细胞悬浮液（即原生质悬浮液）的制备和细胞簇的注释仍然是阻碍其研究的两大主要障碍。<br>近日，知名期刊Plant Biotechnology Journal在线发表了华中农业大学棉花遗传改良团队金双侠教授团队的篇题为《<span class="exturl" data-url="aHR0cHM6Ly9vbmxpbmVsaWJyYXJ5LndpbGV5LmNvbS9kb2kvMTAuMTExMS9wYmkuMTM3MjU=" title="https://onlinelibrary.wiley.com/doi/10.1111/pbi.13725">Plant Single Cell Transcriptome Hub (PsctH): an integrated online tool to explore the plant single-cell transcriptome landscape<i class="fa fa-external-link"></i></span>》论文，开发了植物单细胞转录组综合数据库<span class="exturl" data-url="aHR0cDovL2ppbmxhYi5oemF1LmVkdS5jbi9Qc2N0SC8=" title="http://jinlab.hzau.edu.cn/PsctH/">PsctH<i class="fa fa-external-link"></i></span>，提供综合全面的单细胞Marker基因资源和单细胞研究的workflow。<br><a id="more"></a><br><img src="/images/PsctH2.png" alt=""><br>PsctH主要包括植物单细胞悬浮液的制备手册，植物单细胞转录组分析流程的个性化定制，植物单细胞Marker基因资源和植物单细胞测序原始数据集四大板块，综合了单细胞研究的整个过程。<br><img src="/images/PsctH.png" alt=""><br>不同于动物细胞，细胞壁的存在使得植物单细胞悬浮液的制备更加困难。根据实验室前期原生质体解离实验经验，作者比较和评估了用于制备原生质体的不同方案，并提供了一套可行和高效的植物单细胞悬浮液制备手册，其中包括组织样品的制备和分离、酶解消化、纯化以及单个细胞完整性检测。同时，还提供了灵活的植物单细胞转录组（scRNA-seq）分析流程，包括质量控制、标准化、聚类和标记基因鉴定过程。同时考虑到单细胞研究的复杂性和大数据量，暂时并未提供相应的在线分析，而是通过配置关键参数以获得特定的R语言分析脚本。此外，还提供了配置数据分析的R环境文件（SingleCellCondaEnvironment.yml），研究人员可以通过conda再现单细胞转录组的分析环境，来运行之前获得的R脚本。<br>另一方面，由于缺乏有效的Marker基因资源，植物单细胞研究通常需要花费大量的时间来进行RNA原位杂交或报告基因的遗传转化来为细胞簇的组织类型鉴定提供可靠的实验证据。因此，作者通过收集目前植物单细胞研究，获取到来自5种植物（拟南芥、玉米、水稻、花生和番茄）的9个组织或亚组织的51种细胞类型的共计98个Marker基因（均经过RNA原位杂交或报告基因验证），并在PsctH的MarkerGeneDB栏目进行保存和展示。<br>此外，PsctH还提供目前植物单细胞测序原始数据集，植物单细胞文献的挖掘等功能。伴随单细胞研究的快速发展，数据库也采用定期跟新（包括新的功能和现有数据库内容，特别是Marker基因资源）的原则，也欢迎该领域研究人员提供相关资源和建议。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;作为所有生物体的基本组成部分，细胞在维持生命活动中起着至关重要的作用，而作为细胞异质性研究的重要工具，近年来单细胞转录组测序技术蓬勃发展，促使生物学研究进入单细胞水平的时代。然而，在植物学领域，单细胞的研究仍处于起步阶段，可用资源非常有限，且单细胞悬浮液（即原生质悬浮液）的制备和细胞簇的注释仍然是阻碍其研究的两大主要障碍。&lt;br&gt;近日，知名期刊Plant Biotechnology Journal在线发表了华中农业大学棉花遗传改良团队金双侠教授团队的篇题为《&lt;a href=&quot;https://onlinelibrary.wiley.com/doi/10.1111/pbi.13725&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Plant Single Cell Transcriptome Hub (PsctH): an integrated online tool to explore the plant single-cell transcriptome landscape&lt;/a&gt;》论文，开发了植物单细胞转录组综合数据库&lt;a href=&quot;http://jinlab.hzau.edu.cn/PsctH/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;PsctH&lt;/a&gt;，提供综合全面的单细胞Marker基因资源和单细胞研究的workflow。&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="PsctH" scheme="http://tiramisutes.github.io/tags/PsctH/"/>
    
  </entry>
  
  <entry>
    <title>Nature Methods | 多伦多大学通过优化KRAB来提高CRISPRi对靶基因的沉默效果</title>
    <link href="http://tiramisutes.github.io/2020/10/07/CRISPRi.html"/>
    <id>http://tiramisutes.github.io/2020/10/07/CRISPRi.html</id>
    <published>2020-10-07T06:16:32.000Z</published>
    <updated>2020-10-07T06:32:05.430Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CRISPRi_简介">CRISPRi 简介</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CRISPR-Cas9系统的简约和高效使其迅速成为生命科学实验室的新宠。近来，CRISPR-Cas9工具箱已经大大扩展，新增了CRISPRi和CRISPRa这两种工具。其中催化失活的Cas9（dCas9）在靶向启动子区域时会由于转录机制的空间位阻效应而导致基因表达的抑制。若将dCas9与阻遏结构域【如Krüppel-associated box (KRAB)】融合，则能实现高效的转录沉默。这个过程被称为CRISPRi（CRISPR干扰）。由于DNA没有任何变化，故CRISPRi实现了可逆的<strong>knockdown</strong>，而不是<strong>knockout</strong>。同理，与转录激活因子（如VP64和p65）融合的dCas9可靶向启动子和增强子区域来激活基因表达，导致基因表达上调，这被称为CRISPRa（CRISPR激活）（图1）。<br><img src="/images/CRISPRi1.jpg" alt="">图1. dCas9介导的基因调控系统。(Cell. 2013 Jul 18; 154(2): 442–451)<br><a id="more"></a></p>
<h2 id="CRISPRi与RNAi区别">CRISPRi与RNAi区别</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;看到CRISPRi功能描述是否心中存满疑问：<strong>与跌落神坛的RNAi有啥区别？与CRISPR有啥区别？</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先与RNAi相比：</p>
<pre><code>-<span class="ruby"> ①靶标不同：<span class="constant">RNAi</span>的靶标是<span class="constant">RNA</span>，而<span class="constant">CRISPRi</span>的靶标是<span class="constant">DNA</span>的转录起始位点(transcription start site, <span class="constant">TSS</span>)。
</span>-<span class="ruby"> ②作用细胞区域不同：一般情况下，<span class="constant">RNAi</span>在胞质内发生剪切，而<span class="constant">CRISPRi</span>在细胞核内。
</span>-<span class="ruby"> ③脱靶率不同：<span class="constant">RNAi</span>似乎更高一些，而<span class="constant">CRISPRi</span>复合物必须在转录起始位点附近才能发挥作用，因此降低了脱靶效应。</span>
</code></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;此外，在dCas9-KRAB融合蛋白前加一个条件性启动子可进行条件性CRISPRi。将若干sgRNA、启动子和dCas9-KRAB串联表达可同时进行多重基因的CRISPRi，实现多基因的同时沉默等优势（Zheng, Y., Shen, W., Zhang, J. et al. CRISPR interference-based specific and efficient gene inactivation in the brain. Nat Neurosci 21, 447–454 (2018). <span class="exturl" data-url="aHR0cHM6Ly9kb2kub3JnLzEwLjEwMzgvczQxNTkzLTAxOC0wMDc3LTU=" title="https://doi.org/10.1038/s41593-018-0077-5">https://doi.org/10.1038/s41593-018-0077-5<i class="fa fa-external-link"></i></span> ）。</p>
<h2 id="CRISPRi与CRISPR区别">CRISPRi与CRISPR区别</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;尽管CRISPR相关工具的基因敲除在基因功能研究和性状改良方面有重要的应用，但同时也存在其局限性。如某个基因功能的完全丧失会产生极端表型，而育种过程中通常想要的是中间表型。此外，CRISPRi可靶向lncRNA、microRNA、反向转录产物、细胞核内的转录本等，是研究非蛋白编码基因的有力工具（图2）。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;尽管CRISPRi如此优秀，但目前也存在一些“小问题”，如靶基因的不完全沉默；PAM序列在一定程度上限制了结合靶序列的数量；染色体状态和修饰可能会影响dCas9-gRNA与DNA的结合；当靶基因的靶序列与其它基因重叠，或受双向启动子调节时，CRISPRi的调控可能会影响到周边的基因表达。<br><img src="/images/CRISPRi2.png" alt="">图2. 功能缺失或功能获得系统示意图。(ACS Chem Biol. 2018 Feb 16;13(2):406-416)</p>
<h2 id="CRISPRi优化">CRISPRi优化</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;近日，知名植物学期刊Nature Methods在线发表了多伦多大学和加拿大高等研究院（CIFAR）题为<span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE1OTItMDIwLTA5NjYteCNTZWMy" title="https://www.nature.com/articles/s41592-020-0966-x#Sec2">An efficient KRAB domain for CRISPRi applications in human cells<i class="fa fa-external-link"></i></span>的研究论文。通过优化KRAB domain来提高对靶基因的沉默效果，并筛选出目前基因沉默效果最具高效的ZIM3 KRAB–dCas9载体。<br><img src="/images/CRISPRi3.png" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作者将57个人的KRAB结构域融合到dCas9的N端，并用慢病毒感染法检测它们被招募到两个不同的含报告基因结构中时的活性。其中一种方法是将dCas9-KRAB融合靶向到SV40启动子上的两个位点，该启动子驱动人类胚胎肾器官293T细胞（HEK293T）中绿色荧光蛋白（EGFP）的表达。在另一组实验中，dCas9-KRAB融合蛋白靶向K562细胞的PGK1-EGFP报告基因下游的7×TetO阵列上（图3）。且两种报告细胞系均来自单细胞克隆，以确保报告基因和gRNA表达水平的一致性。<br><img src="/images/CRISPRi4.png" alt="">图3. KRAB结构域筛选系统。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在上述两种情况下，与nanolouc–dCas9对照组相比，不同的dCas9-KRAB融合体在被招募21天后对靶标基因表现出不同水平的沉默效果，从几乎完全沉默到无沉默，且在两个筛选系统间的结果基本一致（R2 = 0.59），这表明不同的KRAB结构域对靶标基因造成不同程度的沉默效果而与细胞类型无关。且ZIM3 KRAB结构域在两个筛选系统中表现出较强的基因沉默效果（图4）。<br><img src="/images/CRISPRi5.png" alt="">图4. 不同dCas9-KRAB融合体对靶标基因的沉默效果。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;随后作者将ZIM3 KRAB–dCas9与现有的KOX1 KRAB–dCas9, KOX1 KRAB–MeCP2–dCas9和阴性对照Nanoluc–dCas9用慢病毒感染的方式靶标到HEK293T细胞的5个内源性启动子，并通过逆转录定量PCR (RT-qPCR)检测9d后的沉默效果。结果在4个启动子中，ZIM3 KRAB沉默效果显著优于KOX1 KRAB或KOX1 KRAB–MeCP2。此外，ZIM3-KRAB比其他两种结构更能抑制CD81的表达（图5）。<br><img src="/images/CRISPRi6.png" alt="">图5. 靶向ERK1，SEL1L和CD81启动子和相应基因的RT–qPCR表达水平。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;综上所述，作者确定了一种高效的KRAB结构域，其具更有效的靶基因沉默和对gRNA选择较低的敏感性。除沉默效率外，相较于KOX1-KRAB-MeCP2结构，ZIM3-KRAB融合载体更小，可串联更多的gRNA，可用于多基因的大规模筛选。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;CRISPRi_简介&quot;&gt;CRISPRi 简介&lt;/h2&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;CRISPR-Cas9系统的简约和高效使其迅速成为生命科学实验室的新宠。近来，CRISPR-Cas9工具箱已经大大扩展，新增了CRISPRi和CRISPRa这两种工具。其中催化失活的Cas9（dCas9）在靶向启动子区域时会由于转录机制的空间位阻效应而导致基因表达的抑制。若将dCas9与阻遏结构域【如Krüppel-associated box (KRAB)】融合，则能实现高效的转录沉默。这个过程被称为CRISPRi（CRISPR干扰）。由于DNA没有任何变化，故CRISPRi实现了可逆的&lt;strong&gt;knockdown&lt;/strong&gt;，而不是&lt;strong&gt;knockout&lt;/strong&gt;。同理，与转录激活因子（如VP64和p65）融合的dCas9可靶向启动子和增强子区域来激活基因表达，导致基因表达上调，这被称为CRISPRa（CRISPR激活）（图1）。&lt;br&gt;&lt;img src=&quot;/images/CRISPRi1.jpg&quot; alt=&quot;&quot;&gt;图1. dCas9介导的基因调控系统。(Cell. 2013 Jul 18; 154(2): 442–451)&lt;br&gt;
    
    </summary>
    
      <category term="文献" scheme="http://tiramisutes.github.io/categories/%E6%96%87%E7%8C%AE/"/>
    
    
      <category term="CRISPR/Cas9" scheme="http://tiramisutes.github.io/tags/CRISPR-Cas9/"/>
    
  </entry>
  
  <entry>
    <title>爬取 Plant Cell 期刊</title>
    <link href="http://tiramisutes.github.io/2020/08/29/Spider-Plant-Cell.html"/>
    <id>http://tiramisutes.github.io/2020/08/29/Spider-Plant-Cell.html</id>
    <published>2020-08-29T05:42:20.000Z</published>
    <updated>2020-08-29T06:33:52.903Z</updated>
    
    <content type="html"><![CDATA[<p>爬取 <span class="exturl" data-url="aHR0cDovL3d3dy5wbGFudGNlbGwub3JnLw==" title="http://www.plantcell.org/">Plant Cell<i class="fa fa-external-link"></i></span> 期刊创刊到现在发表的 Articles 文章标题和链接，并调用百度翻译API将标题翻译成中文。<br><img src="/images/plantcelltop.png" alt=""><br><a id="more"></a></p>
<h2 id="使用">使用</h2><p>首先注册百度翻译帐号，获取API相关信息，然后修改``脚本的第44和45行👇<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">appid</span> = <span class="string">''</span></span><br><span class="line"><span class="attr">secretKey</span> = <span class="string">''</span></span><br></pre></td></tr></table></figure></p>
<p>修改第227行可选取爬取的起始和终止年限👇<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">film</span> = parse_detail_page(<span class="number">1989</span>, <span class="number">2021</span>, tool)</span><br></pre></td></tr></table></figure></p>
<p>之后运行<code>python Spider_Plant_Cell.py</code> 即可开始爬取。</p>
<h2 id="结果输出">结果输出</h2><h3 id="CSV_文件">CSV 文件</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2004</span>	A CDC45 Homolog <span class="keyword">in</span> Arabidopsis Is Essential <span class="keyword">for</span> Meiosis, as Shown by RNA Interference–Induced Gene Silencing	如RNA干扰诱导的基因沉默所示，拟南芥CDC45同系物对减数分裂至关重要	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">16</span><span class="regexp">/1/</span><span class="number">99</span></span><br><span class="line"><span class="number">2007</span>	A CLASSY RNA Silencing Signaling Mutant <span class="keyword">in</span> Arabidopsis	拟南芥一个RNA沉默信号突变株	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">19</span><span class="regexp">/5/</span><span class="number">1439</span></span><br><span class="line"><span class="number">2007</span>	A CRM Domain Protein Functions Dually <span class="keyword">in</span> Group I and Group II Intron Splicing <span class="keyword">in</span> Land Plant Chloroplasts	陆地植物叶绿体中CRM结构域蛋白在Ⅰ组和Ⅱ组内含子剪接中的双重功能	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">19</span><span class="regexp">/12/</span><span class="number">3864</span></span><br><span class="line"><span class="number">2015</span>	A Cascade of Sequentially Expressed Sucrose Transporters <span class="keyword">in</span> the Seed Coat and Endosperm Provides Nutrition <span class="keyword">for</span> the Arabidopsis Embryo	种皮和胚乳中蔗糖转运蛋白的级联表达为拟南芥胚胎提供了营养	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">27</span><span class="regexp">/3/</span><span class="number">607</span></span><br><span class="line"><span class="number">2011</span>	A Case <span class="keyword">for</span> Spatial Regulation <span class="keyword">in</span> Tetrapyrrole Biosynthesis	四吡咯生物合成的空间调控	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">23</span><span class="regexp">/12/</span><span class="number">4167</span></span><br><span class="line"><span class="number">2001</span>	A Cell Plate–Specific Callose Synthase and Its Interaction with Phragmoplastin	细胞板特异性胼胝质合成酶及其与胞浆蛋白的相互作用	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">13</span><span class="regexp">/4/</span><span class="number">755</span></span><br><span class="line"><span class="number">2009</span>	A Cell Wall–Degrading Esterase of Xanthomonas oryzae Requires a Unique Substrate Recognition Module <span class="keyword">for</span> Pathogenesis on Rice	水稻黄单胞菌的细胞壁降解酯酶需要一个独特的底物识别模块来研究水稻的发病机制	http:<span class="regexp">//</span>www.plantcell.org<span class="regexp">/content/</span><span class="number">21</span><span class="regexp">/6/</span><span class="number">1860</span></span><br></pre></td></tr></table></figure>
<h3 id="标题词云">标题词云</h3><p><img src="/images/baidu_Plant_Cell_Articles.png" alt=""></p>
<h2 id="源码">源码</h2><p>相关源码位于 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpcmFtaXN1dGVzL1NwaWRlcl9QbGFudF9DZWxs" title="https://github.com/tiramisutes/Spider_Plant_Cell">Spider_Plant_Cell<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;爬取 &lt;a href=&quot;http://www.plantcell.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Plant Cell&lt;/a&gt; 期刊创刊到现在发表的 Articles 文章标题和链接，并调用百度翻译API将标题翻译成中文。&lt;br&gt;&lt;img src=&quot;/images/plantcelltop.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Spider" scheme="http://tiramisutes.github.io/categories/Spider/"/>
    
    
      <category term="Plant_Cell" scheme="http://tiramisutes.github.io/tags/Plant-Cell/"/>
    
  </entry>
  
  <entry>
    <title>Nature Communications---“香料之王”染色体级参考基因组揭秘</title>
    <link href="http://tiramisutes.github.io/2019/10/13/hujiao.html"/>
    <id>http://tiramisutes.github.io/2019/10/13/hujiao.html</id>
    <published>2019-10-13T01:36:59.000Z</published>
    <updated>2019-10-23T08:20:03.355Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hujiao1.png" alt=""><br>胡椒（Piper nigrum，2n = 52）是木兰亚纲（Magnoliids）胡椒目（Piperales）胡椒科（Piperaceae）胡椒属（Piper）的常绿热带藤本植物，是世界范围内使用历史最悠久的香料，素有“香料之王”的美誉。在中世纪的欧洲，胡椒是社会地位和财富的象征，甚至价格要高于金银可作为货币流通，价比黄金。历史上，西哥特人入侵罗马、十字军东征、新航路的开辟等重要事件与胡椒资源和贸易权的争夺有着密切联系，胡椒被认为是古代促进东西方文化交流的重要商品。在古代，胡椒贸易路线的拓展促成了新航路开辟、地理大发现等重要历史事件。如今，海南岛是我国胡椒种植的主要地区，占全国产量的95%以上，已发展成为关系到上百万热区百姓收入的重要热作产业。中国热带农业科学院香料饮料研究所位於海南省东南部万宁市兴隆华侨旅遊经济区，主要承担胡椒、咖啡、可可等热带香料饮料作物的科学研究和产业化配套技术研发任务。<br><a id="more"></a><br><img src="/images/hujiao2.png" alt=""><br>华中农业大学作物遗传改良国家重点实验自2014年购置高性能集群平台以来，形成完善的生物信息学分析能力，先后完成异源四倍体陆地棉和海岛棉（<span class="exturl" data-url="aHR0cDovL3d3dy5iaW9tYXJrZXIuY29tLmNuL2FyY2hpdmVzLzE0ODY3" title="http://www.biomarker.com.cn/archives/14867">百迈客助力四倍体海岛棉及陆地棉基因组发表于Nature Genetics<i class="fa fa-external-link"></i></span>）以及玉米（<span class="exturl" data-url="aHR0cDovL2R5LjE2My5jb20vdjIvYXJ0aWNsZS9kZXRhaWwvRUdJUktJT1IwNTEyVFAzNC5odG1s" title="http://dy.163.com/v2/article/detail/EGIRKIOR0512TP34.html">Nature Genet. | 华中农大严建兵团队公布热带玉米高质量基因组，并克隆了一个玉米产量基因<i class="fa fa-external-link"></i></span>）等重要农作物基因组图谱的构建，基于此中国热带农业科学院香料饮料研究所联合华中农业大学开展了热带重要作物胡椒高质量基因组图谱的构建项目，同时也服务于国家“一带一路”的倡议。</p>
<p>2019年10月16日，国际学术期刊Nature Communications在线发表了中国热带农业科学院香料饮料研究所联合华中农业大学、马来西亚科学院等7家单位完成的题为“<span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE0NjctMDE5LTEyNjA3LTY=" title="https://www.nature.com/articles/s41467-019-12607-6">The chromosome-scale reference genome of black pepper provides insight into piperine biosynthesis<i class="fa fa-external-link"></i></span>”的研究论文。该研究绘制了我国胡椒栽培种“热引1号”染色体级别精细基因组图谱（木兰亚纲胡椒目首次报道基因组组装的物种），综合解读胡椒的基因组特征，物种进化位置，并进一步对胡椒碱合成代谢网络和关键基因及其基因家族进行深入研究，为被子植物演化及胡椒碱生物合成提供了新的见解。<br><img src="/images/hujiao3.png" alt=""></p>
<h2 id="1-_构建染色体水平的高质量胡椒基因组">1. 构建染色体水平的高质量胡椒基因组</h2><p>作为整个基部被子植物类群胡椒目中第一个完成全基因组测序的物种，kmer分析表明胡椒基因组的大小约为761.74 Mb，杂合度为1.33%，重复序列比例为59.54%，属高杂合且高重复序列的复杂基因组。因此，作者结合PacBio三代测序、10X Genomics、基于直接标记和染色（DLS）的BioNano单分子光学图谱和Hi-C染色体交互捕获四种测序技术对胡椒基因组进行de novo组装和染色体锚定，并用二代Illumina数据对组装结果进行潜在InDel和小片段错误组装的纠正。经过PacBio和10X Genomics数据初步组装的胡椒基因组（“Piper_nigrum_v1”）包含有1,277条scaffolds，其N50值为2.3 Mb，组装基因组大小为791.0 Mb。进一步的BioNano和Hi-C辅助组装后，得到组装基因组大小为761.2 Mb，其中包含45条scaffolds序列，且N50达到29.8 Mb的最终染色体级胡椒基因组组装结果“Piper_nigrum_v3”。CEGMA和BUSCO综合对胡椒基因组组装结果进行评估，显示了较高的完整性和准确性。<br><img src="/images/hujiao4.png" alt=""></p>
<h2 id="2-_完成胡椒基因结构和功能注释">2. 完成胡椒基因结构和功能注释</h2><p>首先通过从头预测和同源序列比对相结合的方法对胡椒基因组的重复序列进行注释和屏蔽，结果显示重复序列占总基因组的54.85%，其中54.01%属于散在重复序列，进一步细分有40.55%属于长末端重复序列反转录转座子（LTR-retrotransposons，LTR-RTs），LTR-RTs中主要类型LTR/Gypsy占27.63%和LTR/Copia占9.95%；随后选用BRAKER2基因结构注释流程，结合从头预测、胡椒属UniProt蛋白数据库数据和RNA-seq和Iso-seq测序转录组数据，对胡椒基因组基因结构进行预测。结果共注释到63,466个蛋白编码基因；另外，还注释到1,514个转运RNA（tRNA），1,206个核糖体RNA（rRNA），1,533个小核RNA（snRNA），256个非编码RNA（miRNAs），6,509个长链非编码RNA（lncRNAs），59个转录因子（TFs）家族， 157个转录调节因子（TRs）和646个染色质调节因子（CRs）。在基因功能注释中，有48,277和46,256个基因分别比对到NR和UniProt数据库，进一步InterProScan分析共鉴定到3,652个蛋白家族和2,071个GO分类。KEGG注释显示共有11,362个蛋白编码基因注释到KO功能，57,700个基因注释到330个代谢通路中。次生代谢物注释共鉴定到10与生物碱代谢通路相关的基因簇。<br><img src="/images/hujiao5.jpg" alt=""></p>
<blockquote>
<p>（a）胡椒染色体。（b-d）GC含量，重复序列密度和基因密度在500 Kb窗口内的分布。（e-l）不同组织基因表达情况（从外到内依次为2 MAP，4 MAP，6 MAP，8 MAP，根，茎，叶和花）。（m）次生代谢物（绿色正方形）和胡椒碱代谢路径（红色正方形）基因分布。（n）染色体共线性区块，带宽与共线性区块大小成正比。</p>
</blockquote>
<h2 id="3-_鉴定到发生于胡椒中的全基因组复制事件">3. 鉴定到发生于胡椒中的全基因组复制事件</h2><p>对胡椒基因组进行共线性分析，结果显示胡椒基因组内存在1,295个共线性区块，占约基因组注释到总基因数量的45.10%，其中66.0%的旁系同源基因位于不同染色体间，34.0%的位于染色体内。其次，共线性dot图分析显示胡椒染色体内和染色体间存在大量的复制区域。此外，胡椒基因组的相互最佳匹配基因对和共线性区块基因对的同义替换率（Ks）分布显示在大约0.1处存在明显的单峰。明确了发生于胡椒的全基因组复制事件，并计算得出胡椒的WGD事件发生时间大致为17.2-17.9百万年前（MYA）。</p>
<h2 id="4-_确定了胡椒及其所在木兰亚纲的系统发育位置">4. 确定了胡椒及其所在木兰亚纲的系统发育位置</h2><p>基于21个典型物种的比较基因组和系统发育分析，确定了胡椒及其所在木兰亚纲的系统发育位置。在胡椒、9个双子叶植物、3个单子叶植物、3个木兰亚纲植物、无油樟、2个裸子植物和两个低等植物外群共21个物种中鉴定出82个单拷贝直系同源基因。随后，利用这82个单拷贝直系同源基因进行物种进化树的构建和分歧时间的评估，结果显示木兰亚纲与整个单子叶-双子叶互为姐妹关系，进一步胡椒目与木兰目-樟目互为姐妹关系，且大约在175-187 MYA（95% HPD）发生分歧。<br><img src="/images/hujiao6.png" alt=""></p>
<h2 id="5-_初步揭示了胡椒中胡椒碱生物合成分子特征">5. 初步揭示了胡椒中胡椒碱生物合成分子特征</h2><p>通过分析胡椒中的基因家族扩增和不同组织的RNA-seq转录组数据，揭示了胡椒碱合成的重要代谢过程：苯丙烷代谢途径和赖氨酸代谢途径，以及酰基转移代谢过程。基因家族扩张分析发现，91个基因家族在胡椒中发生扩张，其中有35个基因家族发生显著扩张（family-wide P-value ≤ 0.01）。<br><img src="/images/hujiao7.png" alt=""><br>胡椒物种特异的基因家族扩张相关基因显著富集在次生代谢相关功能和抗病防御相关基因中。不同组织的RNA-seq转录组数据分析发现参与到苯丙烷代谢途径和赖氨酸代谢途径的部分基因在果浆中特异高表达，且BAHD-AT和SCPL-AT基因家族的扩张伴随着在果浆组织中的高表达，将苯丙烷代谢和赖氨酸代谢联系起来。进一步对属于苯丙烷代谢途径和赖氨酸代谢途径以及BAHD-AT和SCPL-AT基因的扩张基因家族进行序列水平分析，检测到不同程度的纯化选择和正向选择。<br>为全面了解胡椒中胡椒碱合成代谢过程，作者集中在分析与胡椒碱生物合成相关生物过程和参与到胡椒碱代谢的基因家族的扩张情况。通过综合的比较基因组和基因家族分析，发现了参与到赖氨酸代谢的LDC基因，参与到苯丙烷代谢的GTF，CYP和HCT基因，以及BAHD-AT和SCPL-AT基因家族有显著变化。在植物的次生代谢过程中，苯丙烷和氨基酸代谢通路和酰基转移酶无处不在。如咖啡、苹果、葡萄、可可、茶树、菠萝和甜橙等物种均富含苯丙烷衍生物，且这些物种中相应次生代谢物的合成也通过聚合上述两个代谢过程（苯丙烷代谢和赖氨酸代谢）。特别是辣椒（chili pepper）中，辣椒素（capsaicinoids）的合成来源于苯丙烷和支链脂肪酸代谢通路。此外，烟草中烟碱合成的前体来源于萜类化合物代谢和氨基酸代谢过程。在荷花、罂粟、博落回和番木瓜等物种中，赖氨酸驱动的喹啉生物碱的合成同样通过聚合苯丙烷代谢和赖氨酸代谢两个过程。然而，胡椒碱合成起始于赖氨酸的脱羧反应和胺基氧化过程，这与通过聚合两个酪氨酸来进行苄基异喹啉生物碱（benzylisoquinoline alkaloid）的生物合成有明显的区别。随后来源于苯丙烷代谢和赖氨酸代谢的前体物质通过酰基转移酶催化进行胡椒碱的合成。其中苯丙烷代谢和赖氨酸代谢的聚合，特别是赖氨酸的脱羧反应，胺基氧化反应和酰基转移过程代表了胡椒碱合成的主要特征，并进一步通过基因水平、转录水平和序列进化过程揭示了胡椒中胡椒碱生物合成的特异性，初步阐述了胡椒碱生物合成分子机理。<br><img src="/images/hujiao8.png" alt=""></p>
<h2 id="6-_Author_contributions">6. Author contributions</h2><blockquote>
<p>C.H. and S.J. designed and supervised the research. Z.X. performed the genome assemblies and annotation. Z.X. and L.H. performed the transcriptome and phylogenetic analysis. L.H., H.W., X.Q., L.Y. and L.T. collected materials for sequencing and generated transcriptome data. Z.X., L.H., R.F. and B.W. analysed the RNA-seq data. M.W., D.Y., S.S., W.L., C.S., H.D., J.W., K.L. and X.Z. provided constructive comments and suggestions on data analysis. Z.X. and L.H. wrote the paper with input from all other authors. All authors approved the paper.</p>
</blockquote>
<h2 id="7-_基金支持">7. 基金支持</h2><blockquote>
<p>该研究得到了农业农村部物种资源保护、海南省自然科学基金、中央级公益性科研院所基本科研业务费等项目的支持，是中国热带农业科学院重视基础研究、大力实施以基础和前沿研究、推进“十百千”科技工程、促进原始创新成果产出的体现。中国热带农业科学院香料饮料研究所郝朝运研究员、华中农业大学金双侠教授为论文的共同通讯作者。中国热带农业科学院香料饮料研究所胡丽松副研究员、华中农业大学许忠平博士为论文的共同第一作者。</p>
</blockquote>
<h2 id="8-_How_to_cite_this_article">8. How to cite this article</h2><hr>
<p>The chromosome-scale reference genome of black pepper provides insight into piperine biosynthesis<br>类型     期刊文章<br>作者     Lisong Hu<br>作者     Zhongping Xu<br>作者     Maojun Wang<br>作者     Rui Fan<br>作者     Daojun Yuan<br>作者     Baoduo Wu<br>作者     Huasong Wu<br>作者     Xiaowei Qin<br>作者     Lin Yan<br>作者     Lehe Tan<br>作者     Soonliang Sim<br>作者     Wen Li<br>作者     Christopher A. Saski<br>作者     Henry Daniell<br>作者     Jonathan F. Wendel<br>作者     Keith Lindsey<br>作者     Xianlong Zhang<br>作者     Chaoyun Hao<br>作者     Shuangxia Jin<br>URL     <span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE0NjctMDE5LTEyNjA3LTY=" title="https://www.nature.com/articles/s41467-019-12607-6">https://www.nature.com/articles/s41467-019-12607-6<i class="fa fa-external-link"></i></span><br>版权     2019 The Author(s)<br>卷     10<br>期     1<br>页码     1-11<br>期刊     Nature Communications<br>ISSN     2041-1723<br>日期     2019-10-16<br>刊名缩写     Nat Commun<br>DOI     10.1038/s41467-019-12607-6<br>访问时间     10/23/2019, 11:55:31 AM<br>馆藏目录     www.nature.com<br>语言     en<br>摘要     Black pepper (Piper nigrum) belongs to the long-isolated lineage of basal angiosperm and its fruit has been used for food spice and phytomedicines for thousands of years. Here, the authors assemble the reference genome of this species and analyze gene families associated with piperine biosynthesis.<br>添加日期     10/23/2019, 11:55:31 AM<br>修改日期     10/23/2019, 11:55:31 AM</p>
<hr>
<h2 id="9-_社交链接">9. 社交链接</h2><ul>
<li>微信推送<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/X19iaXo9TXpnM01ERXdOREV5TWc9PSZhbXA7bWlkPTIyNDc0ODYwNTUmYW1wO2lkeD0xJmFtcDtzbj0yMjI2M2Q0YTZhZjFhMTA5ODA1Zjg2OGE3YjVkZGE2OSZhbXA7Y2hrc209Y2U5M2E3MzJmOWU0MmUyNDI1MjM1ODA5NzRmZmE2MTI0MWUyYWNiMzk0NjljYjk1ZGIyMGM5MWY4ZjEyYWQ3OTA3NWQ3ODc1MjZkYSZhbXA7bXBzaGFyZT0xJmFtcDtzY2VuZT0yMyZhbXA7c3JjaWQ9JmFtcDtzaGFyZXJfc2hhcmV0aW1lPTE1NzEzODcxMDM5NTEmYW1wO3NoYXJlcl9zaGFyZWlkPTNjOTlmNTAzNDNiNTE3ZjM0NjVkMjgwYmFiZmZiYzM4I3Jk" title="https://mp.weixin.qq.com/s?__biz=Mzg3MDEwNDEyMg==&amp;mid=2247486055&amp;idx=1&amp;sn=22263d4a6af1a109805f868a7b5dda69&amp;chksm=ce93a732f9e42e242523580974ffa61241e2acb39469cb95db20c91f8f12ad79075d787526da&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1571387103951&amp;sharer_shareid=3c99f50343b517f3465d280babffbc38#rd">Nature Communications|华中农大与热科院香料饮料研究所合作解析“香料之王”-胡椒染色体级参考基因组<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvSGZXRVRmNmxrWlBIbmhwMi13OFdTZw==" title="https://mp.weixin.qq.com/s/HfWETf6lkZPHnhp2-w8WSg">胡椒基因组的意义，远不止胡椒碱的合成<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5lYmlvdHJhZGUuY29tL25ld3NmLzIwMTktMTAvMjAxOTEwMjExNTA2MjA2OTQuaHRt" title="http://www.ebiotrade.com/newsf/2019-10/20191021150620694.htm">找到了！胡椒那么辣的原因<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25iZXRhLmNvbS9hcnRpY2xlcy9zY2llbmNlLzkwMTA0NS5odG0=" title="https://www.cnbeta.com/articles/science/901045.htm">中国科学家找到胡椒辛辣的原因：哪些基因起作用？<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL2hpLnBlb3BsZS5jb20uY24vbjIvMjAxOS8xMDE4L2MyMzExOTAtMzM0NDczMzkuaHRtbA==" title="http://hi.people.com.cn/n2/2019/1018/c231190-33447339.html">海南日报：热科院等单位成功绘制胡椒染色体级别精细基因组图谱<i class="fa fa-external-link"></i></span></li>
</ul>
<h2 id="10-_彩蛋">10. 彩蛋</h2><p><a href="http://tiramisutes.github.io/SCIFigure/">http://tiramisutes.github.io/SCIFigure/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/hujiao1.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;胡椒（Piper nigrum，2n = 52）是木兰亚纲（Magnoliids）胡椒目（Piperales）胡椒科（Piperaceae）胡椒属（Piper）的常绿热带藤本植物，是世界范围内使用历史最悠久的香料，素有“香料之王”的美誉。在中世纪的欧洲，胡椒是社会地位和财富的象征，甚至价格要高于金银可作为货币流通，价比黄金。历史上，西哥特人入侵罗马、十字军东征、新航路的开辟等重要事件与胡椒资源和贸易权的争夺有着密切联系，胡椒被认为是古代促进东西方文化交流的重要商品。在古代，胡椒贸易路线的拓展促成了新航路开辟、地理大发现等重要历史事件。如今，海南岛是我国胡椒种植的主要地区，占全国产量的95%以上，已发展成为关系到上百万热区百姓收入的重要热作产业。中国热带农业科学院香料饮料研究所位於海南省东南部万宁市兴隆华侨旅遊经济区，主要承担胡椒、咖啡、可可等热带香料饮料作物的科学研究和产业化配套技术研发任务。&lt;br&gt;
    
    </summary>
    
      <category term="Paper" scheme="http://tiramisutes.github.io/categories/Paper/"/>
    
    
      <category term="SCI" scheme="http://tiramisutes.github.io/tags/SCI/"/>
    
  </entry>
  
  <entry>
    <title>NC | 苹果蠹蛾基因组测序揭示其化学感觉和杀虫剂抗性机制</title>
    <link href="http://tiramisutes.github.io/2019/09/18/apple-cp-genome.html"/>
    <id>http://tiramisutes.github.io/2019/09/18/apple-cp-genome.html</id>
    <published>2019-09-18T15:14:25.000Z</published>
    <updated>2019-09-18T15:29:28.408Z</updated>
    
    <content type="html"><![CDATA[<p>苹果蠹蛾(Cydia pomonella)，俗称食心虫，属鳞翅目卷蛾科。在我国仅分布于新疆、甘肃等北部地区，在国内其他地区是检疫对象。苹果蠹蛾可为害苹果、梨、杏、桃、樱桃及梅等果树。苹果蠢蛾幼虫蛀食果实，不仅降低果品质量，而且引起大量落果。成虫产卵于果实或者叶片上，卵散产，前期果实较硬时，初孵幼虫多从萼洼或梗洼蛀入，后期果实肉质松软时，从果面蛀入，幼虫蛀果后有偏食种子的习性，并向外排出虫粪。几头幼虫能同时蛀食1个果实，1头幼虫也可转移2个以上果实为害。老熟幼虫脱果后由枝干爬向树皮下作茧化蛹。苹果蠹蛾会蛀入果心，啃食种子。对苹果等经济果树造成较大的经济损失。<br><img src="/images/cp1.png" alt=""><br><a id="more"></a><br>近日，来自中国农业科学院、中科院、浙江大学和美国堪萨斯大学等国内和国际共20多家科研机构联合在Nature Communications杂志在线发表了“A chromosome-level genome assembly of Cydia pomonella provides insights into chemical ecology and insecticide resistance” 的研究论文，联合Illumina、PacBio、BioNano和Hi-C测序技术对苹果主要害虫苹果蠹蛾进行了基因组测序。<br><img src="/images/cp2.png" alt=""></p>
<h2 id="基因组组装结果描述">基因组组装结果描述</h2><p>研究人员对来自甘肃省酒泉地区野外捕获的苹果蠹蛾进行人工饲养，后选取42头雌性进行基因组DNA的提取和测序。k-mer和流式细胞分析其基因组大小约为630 Mb。对此，构建了4个小片段（180, 300, 500和800 bp）和3个大片段（3，8和10 Kb）的Illumina文库（大约390X的基因组覆盖度），86X的PacBio测序，初步组装出682.49 Mb基因组大小，包含2221条contigs，且contig N50 为862 Kb。BioNano辅助组装后共获得1717条scaffolds，组装基因组大小为772.89 Mb，scaffold N50 为8.9 Mb。结合Hi-C辅助组装，1108条scaffolds能锚定到29条染色体（27条常染色体，Z和W两天性染色体）上，97%的基因组序列能定位到染色体。同时作者也注意到因为苹果蠹蛾高杂合的基因组特征，Hi-C组装时引入了大量的gap。为验证组装的准确性，作者获得了两个不同版本的组装结果1）联合PacBio和Hi-C组装结果；2）联合PacBio、BioNano和Hi-C组装的超级scaffolds。随后将这两个组装结果进行全基因组比对，结果二者有超高的共线性，随后作者选用联合PacBio、BioNano和Hi-C组装的超级scaffolds用于后续分析。<br>BUSCO比对到节肢动物门(Arthropoda)数据库，结果显示有98.5%的直系同源基因能在苹果蠹蛾组装基因组中鉴定到。为进一步验证组装质量，测定71 Gb的苹果蠹蛾基因组Nanopore数据，结果有99%的reads能够比对到组装结果。PacBio RNA测序获得的15,000 条consensus转录本有93%的能比对到组装结果。同时鉴于鳞翅目昆虫基因组具有典型的超高水平的共线性特征，将苹果蠹蛾和斜纹夜蛾的基因组进行比较，结果显示二者染色体的连接和基因排序是高度保守的。综上所有分析说明了苹果蠹蛾基因组组装的准确性和完整性。</p>
<h2 id="基因组注释">基因组注释</h2><p>共鉴定到占基因组大小42.87%的重复序列。用OMIGA结合28个RNA-seq测序数据共初步鉴定到16,997个蛋白编码基因。并对昆虫中广泛研究的对其适应性起重要作用的85个嗅觉受体基因，65个味觉受体基因，39个亲离子受体基因，50个气味结合蛋白基因，28个化学感应蛋白质基因，136个P450基因，47个ABC转运蛋白基因，73个羧酸酯酶基因，30个谷胱甘肽s-转移酶，9个烟碱乙酰胆碱受体，2个乙酰胆碱酯酶和1个电压门控钠离子通道基因进行手动注释。经过去冗余后最终共获得17,184个蛋白编码基因。<br>非编码RNA的鉴定中，共获得82个snRNA，137,752个piRNA，2435个tRNA，334个rRNA和217个miRNA。<br><img src="/images/cp3.png" alt=""></p>
<h2 id="比较基因组分析">比较基因组分析</h2><p>苹果蠹蛾与覆盖7个昆虫目（鳞翅目，双翅目，鞘翅目，膜翅目，半翅目，等翅目和直翅目）的19个其他昆虫的比较基因组分析，共鉴定到2124个单拷贝直系同源基因，选取500个直系同源基因构建物种进化树，结果显示苹果蠹蛾与obtectomeran鳞翅目大约在141 百万年前发生分歧。<br><img src="/images/cp4.png" alt=""></p>
<h2 id="共线性，核型进化和性染色体">共线性，核型进化和性染色体</h2><p>苹果蠹蛾与鳞翅目的斜纹夜蛾具有高水平的共线性。而斜纹夜蛾呈现出31条染色体的祖先核型，前期的细胞遗传学分析显示苹果蠹蛾包含27条常染色体，雌性为W染色体，新的Z性染色体来源于与家蚕15号染色体同源的Z常染色体的融合，与斜纹夜蛾基因组的比较证实了这一染色体融合事件，从而形成了苹果蠹蛾基因组中最大的染色体。此外，也观察到发生在苹果蠹蛾的2（来源于斜纹夜蛾的5和22号染色体）和3（来源于斜纹夜蛾的7和8号染色体）号染色体的融合事件。<br><img src="/images/cp5.png" alt=""><br>对三个雌性和三个雄性重测序数据的分析，证实了Z染色体（chr1）和部分W染色体（chr29）存在于组装基因组中。细胞遗传学分析显示Z和W性染色体间几乎没有共享序列，表明新型的W染色体的片段发生了丢失或几乎完全的退化。<br>进一步chr29染色体与基因组其他序列的比较发现chr29有较高的GC含量。作为典型的非重组染色体半合子，鳞翅目W染色体高度退化，呈现出较少的基因数量和重复序列的富集，除TEs外，在chr29染色体上没有坚定到任何蛋白编码基因。而重复序列分析结果显示相较于其他染色体，chr29并没有表现出明显高的含量。但W染色体相较于其他染色体有较高比例的的长末端重复转座子和DNA转座子。</p>
<h2 id="嗅觉受体基因OR3的复制增强其寻找食物和配偶的能力">嗅觉受体基因OR3的复制增强其寻找食物和配偶的能力</h2><p>在昆虫中，化学感应系统调节许多行为，如寻找食物，避难所，配偶和产卵地。因此在物种入侵能力测定中扮演着重要作用，特别是对于如苹果蠹蛾类的寡食性昆虫。苹果蠹蛾体内化学感受器的研究已经证实，两性都能被植物挥发性梨酯强烈吸引，而梨酯能大幅度的增加雄性对可得蒙（雌性产生的主要性信息素物质）的响应。然而梨酯与可得蒙在雄性之间的协同相应机制仍不清楚。<br>本次组装高质量的基因组为了解苹果蠹蛾体内的化学感应相关基因提供基础。作者共苹果蠹蛾基因组中鉴定到85个嗅觉受体基因，这些基因的进化分析发现信息素受体簇在苹果蠹蛾中发生扩张。此外，基因簇的染色体位置分析发现CpomOR3a和CpomOR3b有相同的基因长度和相同的外显子-内含子结构，在17号染色体上呈现出串联重复，二者间隔9812 nt。为证实OR3基因的复制是固定的而不是分离的(有些有一个拷贝，有些有两个)，我们在所有重测序的苹果蠹蛾数据中确认了OR3基因复制的存在。<br><img src="/images/cp6.png" alt=""><br>确定了OR3基因复制的事实，但其是否有助于增强苹果蠹蛾对梨酯的感应能力？首先作者通过PCR确定了CpomOR3a和CpomOR3b的扩张。其次，24个不同组织的RNA-seq的FPKM值计算表明CpomOR3b只在成虫触角中表达（雄性FPKM = 1050.17和雌性FPKM = 4014.13），而CpomOR3a除在成虫雌性（FPKM = 88916.8）和雄性（FPKM = 41170.2）的触角中均表达外，还在成虫头部（FPKM = 14771.4–68715.2）和幼虫头部（FPKM = 7627.82）表达。相较于其他CpomORs基因，OR3复制基因（CpomOR3a和CpomOR3b）在成虫触角中有最高的表达量。苹果蠹蛾成虫触角的荧光原位杂交显示，尽管CpomOR3a和CpomOR3b都有一些专属表达的非共聚焦神经元，但二者主要表达于同一感受器内邻近但不同的神经元细胞中。此外，CpomOR3a和CpomOR3b与ORs基因的特异性共受体CpomORco在苹果蠹蛾成虫触角中一致性表达。这些结果表明，这两个拷贝有不同的表达模式，推断他们可能经历了新功能化，并且获得了不同的基因功能。<br>CpomOR3a已经有报道是假定的梨酯受体，与其有89%的序列相似性的CpomOR3b是否也能够检测到这种化合物，并有助于苹果蠹蛾对这种化学因子的高度灵敏性？作者将CpomOR3a或CpomOR3b分别与CpomORco在爪蟾卵母细胞中共表达，用双电极电压钳记录每个蛋白质对梨酯和其他化学物质的相应。结果发现这两个基因拷贝具有相似的反应谱。CpomOR3a和CpomOR3b对梨酯有较强的调控作用，但二者对性信息素可得蒙也均有一定的响应。随后通过对晚期的蛹注射siRNAs来将CpomOR3a和CpomOR3b进行各自单独或同时的敲除，qPCR结果显示其中一个的敲除并不会影响另一个旁系同源基因的表达。注射72小时后利用触角电位检测整个触角的电活性，结果表明不同处理下雄虫对梨酯和可得蒙的响应均受损。相反，仅有当CpomOR3a和CpomOR3b全部敲除时，雌虫对梨酯的响应才会受损。此外，单独沉默CpomOR3b显著降低了雄虫苹果蠹蛾对可得蒙的追踪能力。<br><img src="/images/cp7.png" alt=""></p>
<h2 id="GWAS鉴定到杀虫剂抗性相关SNPs">GWAS鉴定到杀虫剂抗性相关SNPs</h2><p>目前，主要通过化学杀虫剂对苹果蠹蛾进行管控，但已出现明显抗性。了解其抗药性机制对于进一步的害虫防御起到重要的作用。苹果蠹蛾主要的抗药性机制依赖于解毒酶活性的提高和降低靶蛋白对杀虫剂的敏感性。作者在苹果蠹蛾中共鉴定到667个潜在杀虫剂抗性相关基因，包括434个解毒基因，45个杀虫剂目标基因，124个角质层基因，47个ABC转运蛋白和12个水通道蛋白。之前的研究表明P450基因赋予苹果蠹蛾对杀虫剂的光谱抗性。因此，作者对苹果蠹蛾基因组中的P450基因进行深入研究。<br>146个P450基因在基因组的染色体分布显示有16个基因簇包含3个或更多的P450基因。其中位于chr20染色体的基因簇包含11个基因，包括3个CYP6AE基因。<br><img src="/images/cp8.png" alt=""><br>为确定P450基因数目的增加赋予苹果蠹蛾对杀虫剂的抗虫，作者对来自三个种群的（S, Raz和Rv）苹果蠹蛾各随机挑选6个个体进行40X的重测序，S种群对杀虫剂敏感，自1995年起没有暴露在任何杀虫剂中；Raz种群对杀虫剂有抗性，自1997年起幼虫暴露在甲基谷硫磷中，相较于S种群表现出对甲基谷硫磷7倍的抗性，对西维因130倍的抗性；RV种群自1995年起幼虫暴露于溴氰菊酯，相较于S种群，表现出对溴氰菊酯140倍的抗性。<br>GWAS分析在S 和 Raz种群中共鉴定到109个具显著不同的等位基因频率的SNPs位于上述667个耐药相关基因的外显子区。S 和 Rv种群的比较共鉴定到242个具显著差异的SNPs位于耐药相关基因的外显子区，其中18个SNPs是Raz 和Rv种群共有的。对于其中的11个SNPs对，选取每个种群的数十个个体通过Sanger测序进行进一步的分析，确认了其中7个SNPs在S与Raz或Rv种群间存在固定的差异。验证的SNPs在毒蕈碱受体（mAChR），章鱼胺β受体和P450基因CYP6B2中的突变因相关基因从未报道参与到鳞翅目昆虫的杀虫剂抗性中而引起作者的注意。<br>随后作者对苹果蠹蛾的P450基因通过RACE进行5’UTR的注释，结果136个P450基因有69个完成5’UTR的注释 ，并将这69个P450基因比对到基因组scaffolds进行转录起始位点和启动子的注释。136个P450基因中，GWAS分析分别鉴定到128和203个SNPs在S种群和Raz或Rv种群间存在差异。在69个基因的启动子区中，分别鉴定到9和10个SNPs在S种群和Raz或Rv种群间存在差异。特别的，有3个SNPs均存在于Raz和Rv种群的CYP6B2基因启动子区：A52T: A (−52)T，T(−57)T，和T(−110)G (gene ID: CPOM05212)。qPCR对三个种群中的CYP6B2基因的表达进行测定，结果表明该基因相较于S种群，在两个抗性种群中（241.4-fold in Raz and 77.3-fold in Rv）组成性高表达，表明这3个SNPs在CYP6B2基因的表达调控中起到重要作用。<br>进一步为确认CYP6B2基因的表达与杀虫剂抗性相关，作者对来自酒泉的四龄测序苹果蠹蛾通过siRNA注射敲除CYP6B2基因，结果48小时后CYP6B2基因的表达下降55%，并用LC50浓度的甲基谷硫磷，溴氰菊酯和吡虫啉饲喂RNAi个体。结果饲喂甲基谷硫磷和溴氰菊酯的幼虫成活率分别为31.1%和45.6%，显著低于GFP注射的对照组或不做任何处理的分组，表明敲除CYP6B2基因显著增加对甲基谷硫磷和溴氰菊酯的敏感性，而幼虫对吡虫啉的敏感性并未受影响。综合表明CYP6B2基因赋予苹果蠹蛾对两个广泛使用的杀虫剂的抗性中起到关键作用。<br><img src="/images/cp9.png" alt=""></p>
<p>原文链接：<span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE0NjctMDE5LTEyMTc1LTkjU2VjOQ==" title="https://www.nature.com/articles/s41467-019-12175-9#Sec9">https://www.nature.com/articles/s41467-019-12175-9#Sec9<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;苹果蠹蛾(Cydia pomonella)，俗称食心虫，属鳞翅目卷蛾科。在我国仅分布于新疆、甘肃等北部地区，在国内其他地区是检疫对象。苹果蠹蛾可为害苹果、梨、杏、桃、樱桃及梅等果树。苹果蠢蛾幼虫蛀食果实，不仅降低果品质量，而且引起大量落果。成虫产卵于果实或者叶片上，卵散产，前期果实较硬时，初孵幼虫多从萼洼或梗洼蛀入，后期果实肉质松软时，从果面蛀入，幼虫蛀果后有偏食种子的习性，并向外排出虫粪。几头幼虫能同时蛀食1个果实，1头幼虫也可转移2个以上果实为害。老熟幼虫脱果后由枝干爬向树皮下作茧化蛹。苹果蠹蛾会蛀入果心，啃食种子。对苹果等经济果树造成较大的经济损失。&lt;br&gt;&lt;img src=&quot;/images/cp1.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="文献" scheme="http://tiramisutes.github.io/categories/%E6%96%87%E7%8C%AE/"/>
    
    
      <category term="基因组" scheme="http://tiramisutes.github.io/tags/%E5%9F%BA%E5%9B%A0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>Linux下NoRoot安装nodejs和npm</title>
    <link href="http://tiramisutes.github.io/2019/08/29/nodejs.html"/>
    <id>http://tiramisutes.github.io/2019/08/29/nodejs.html</id>
    <published>2019-08-29T11:54:34.000Z</published>
    <updated>2019-08-29T14:14:46.597Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/Add-npm-packages-into-NodeJs-projects.jpg" alt=""></p>
<blockquote>
<p><span class="exturl" data-url="aHR0cDovL25vZGVqcy5jbi8=" title="http://nodejs.cn/">Node.js<i class="fa fa-external-link"></i></span> Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。<br><span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY24v" title="https://www.npmjs.cn/">NPM<i class="fa fa-external-link"></i></span>是随同NodeJS一起安装的包管理工具，能解决NodeJS代码部署上的很多问题<br><a id="more"></a></p>
</blockquote>
<h2 id="下载源码包">下载源码包</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.nodejs.org/dist/latest/<span class="keyword">node</span><span class="title">-v10</span>.<span class="number">16.3</span>.tar.gz</span><br><span class="line">tar -zxvf <span class="keyword">node</span><span class="title">-v10</span>.<span class="number">16.3</span>.tar.gz</span><br><span class="line">cd <span class="keyword">node</span><span class="title">-v10</span>.<span class="number">16.3</span></span><br></pre></td></tr></table></figure>
<h2 id="配置、编译、安装">配置、编译、安装</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">load</span> <span class="title">GCC</span>/6.2.0-2.27</span></span><br><span class="line">./configure --prefix=$PWD</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<h2 id="配置nodejs环境">配置nodejs环境</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">NODE_HOME</span>=/public/home/software/node-v10.16.3</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$NODE_HOME</span>/bin:$PATH</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">NODE_PATH</span>=<span class="variable">$NODE_HOME</span>/lib/node_modules:$PATH</span><br></pre></td></tr></table></figure>
<h2 id="测试是否安装成功">测试是否安装成功</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">node</span> <span class="title">-v</span></span><br><span class="line">v10.<span class="number">16.3</span></span><br><span class="line">$ npm -v</span><br><span class="line"><span class="number">6.9</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/Add-npm-packages-into-NodeJs-projects.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://nodejs.cn/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Node.js&lt;/a&gt; Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。&lt;br&gt;&lt;a href=&quot;https://www.npmjs.cn/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;NPM&lt;/a&gt;是随同NodeJS一起安装的包管理工具，能解决NodeJS代码部署上的很多问题&lt;br&gt;
    
    </summary>
    
      <category term="nodejs" scheme="http://tiramisutes.github.io/categories/nodejs/"/>
    
    
      <category term="nodejs+npm" scheme="http://tiramisutes.github.io/tags/nodejs-npm/"/>
    
  </entry>
  
  <entry>
    <title>Docker和Singularity双剑合璧构建生物信息分析流</title>
    <link href="http://tiramisutes.github.io/2019/08/29/docker.html"/>
    <id>http://tiramisutes.github.io/2019/08/29/docker.html</id>
    <published>2019-08-29T08:03:25.000Z</published>
    <updated>2020-06-28T04:47:32.196Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用场景">使用场景</h2><p><img src="/images/docker.png" alt=""><br>容器作为轻量级的虚拟机，可在主机之外提供多种系统环境选择；另外，在容器中一次打包好软件及相关依赖环境之后，即可将复杂的软件环境在各种平台上无缝运行，无需重复多次配置，大大减轻相关工作人员的工作量；</p>
<p>目前主流的容器为docker，其最初被用于软件产品需要快速迭代的互联网行业，极大地简化了系统部署、提高了硬件资源的利用率，近来也在各种特定领域的应用系统中被使用。</p>
<p>Docker 是一个开源的应用容器引擎，基于 <span class="exturl" data-url="aHR0cHM6Ly9nb2xhbmcub3JnLw==" title="https://golang.org/">Go<i class="fa fa-external-link"></i></span> 语言，并遵从Apache2.0协议开源。</p>
<p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p>
<p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。<br><a id="more"></a><br>Docker 的优点：</p>
<ol>
<li>比较轻量级：相对于虚拟机这样的技术来说，docker 比较轻量级，占用的额外资源少</li>
<li>容易维护： 采用Docker file 定义环境，方便更新和共享</li>
<li>操作简单： Docker 的操作非常的简单，学习成本低</li>
</ol>
<p><img src="/images/docsin.jpg" alt=""><br>在生物信息领域，为了一次配置，多次使用的目的，一些复杂的软件开始使用docker进行打包分发，另外由于云的兴起，docker也用于搭建私有生物信息云分析平台。尽管如此，由于<strong>权限、资源管理等因素限制</strong>，docker并未在传统HPC集群（物理裸机+操作系统+作业调度系统+高速互联网络）中流行开。</p>
<p>于是，有人开发了专门针对传统HPC集群的容器工具<span class="exturl" data-url="aHR0cHM6Ly9zeWxhYnMuaW8vc2luZ3VsYXJpdHkv" title="https://sylabs.io/singularity/">singularity<i class="fa fa-external-link"></i></span>，其使得普通用户可以方便地在集群使用打包好的容器镜像，配合作业调度系统，其使用也非常方便，跟使用其它应用软件的方式相同。singularity还有一大优势是，可直接使用docker镜像，大大提高了singularity的可用性。</p>
<h2 id="安装">安装</h2><p>Docker和Singularity的服务器安装需要Root权限，所以可选择在本地个人电脑安装Docker用来制作镜像，然后上传服务器用Singularity运行；</p>
<h2 id="镜像集合">镜像集合</h2><p><span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS8=" title="https://hub.docker.com/">Docker Hub<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="c2h1YjovL3VzZXIvaW1hZ2U6dGFn" title="shub://user/image:tag">Singularity Hub<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9iaW9jb250YWluZXJzLnByby8jLw==" title="https://biocontainers.pro/#/">BioContainers<i class="fa fa-external-link"></i></span>，一个类似Bioconductor、Bioconda的生物信息分析工具集合。</p>
<h2 id="Docker_国内镜像站">Docker 国内镜像站</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGFvY2xvdWQuaW8vbWlycm9yI2FjY2VsZXJhdG9yLWRvYw==" title="https://www.daocloud.io/mirror#accelerator-doc">DaoCloud<i class="fa fa-external-link"></i></span>: 为了解决国内用户使用 Docker Hub 时遇到的稳定性及速度问题 DaoCloud 推出永久免费的新一代镜像站服务。</p>
<h2 id="Docker_应用实例">Docker 应用实例</h2><p>镜像搜索<br>使用 <code>docker search</code> 命令来搜索标星至少为 25 的 CentOS 相关镜像。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search -f <span class="attribute">stars</span>=25 centos</span><br></pre></td></tr></table></figure></p>
<p>下载一个镜像到本地<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载远程镜像</span></span><br><span class="line">docker pull biocontainers/bowtie2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 载入本地镜像</span></span><br><span class="line">docker load docker_rnaseq_ref.tar</span><br></pre></td></tr></table></figure></p>
<p>察看所下载镜像<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker images</span></span><br></pre></td></tr></table></figure></p>
<p>察看docker运行和相关软件镜像对应参数<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> --<span class="built_in">help</span></span></span><br><span class="line"><span class="bash">docker run biocontainers/bowtie2</span></span><br></pre></td></tr></table></figure></p>
<p>其中重要参数有：</p>
<ul>
<li><code>--rm</code>：使得该容器退出后自动删除；</li>
<li><code>-v</code>：进行本地文件夹的挂载，用来指定输入数据位置和输出结果位置；</li>
</ul>
<p>删除本地镜像<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker image rm <span class="string">[选项]</span> &lt;镜像<span class="number">1</span>&gt; <span class="string">[&lt;镜像2&gt; ...]</span></span><br><span class="line">docker image rm biocontainers/bowtie2</span><br></pre></td></tr></table></figure></p>
<p>[选项]的 <code>-f</code> 参数来执行强制删除；</p>
<h2 id="Docker_创建自己的镜像">Docker 创建自己的镜像</h2><p>构建镜像的方式有好几种，我们主要利用Dockerfile，简要介绍一下相关指令（大小写不敏感，但惯例为均大写），具体的还应参考<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vZGV2ZWxvcC9kZXZlbG9wLWltYWdlcy9kb2NrZXJmaWxlX2Jlc3QtcHJhY3RpY2VzLw==" title="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">官方文档<i class="fa fa-external-link"></i></span>：</p>
<p>FROM：指定基础镜像，必须是第一条指令。</p>
<p>MAINTAINER：指定镜像作者信息。</p>
<p>LABEL：指定镜像信息。</p>
<p>ENV：设置环境变量。</p>
<p>ADD &amp; COPY：将本地文件复制进镜像，注意COPY只能是本地文件，ADD可以是url，并且自动解压缩。</p>
<p>RUN：运行指定的命令，每一个RUN指令都将在一个新的container里面运行，并提交为一个image作为下一个RUN的base，即层与层之间不会共用内存，所以如果要将多条命令联合起来执行则需加上<code>&amp;&amp;</code>。另外，在一个Dockerfile中可以包含多个RUN，按顺序执行。</p>
<p>CMD：在容器启动时要运行的命令。</p>
<p>首先根据自己常用操作系统pull官方系统文件，如<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search -f <span class="attribute">stars</span>=25 centos</span><br><span class="line">docker pull centos</span><br></pre></td></tr></table></figure></p>
<p>然后建立一个文件夹用于存放制作镜像过程中所用到的文件，下载软件的源码包并新建Dockerfile文件；</p>
<p>接下来制作镜像：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t macs2:ubuntu<span class="selector-class">.v1</span> .</span><br></pre></td></tr></table></figure></p>
<p>其中<code>:</code>前面为镜像名称，后面为TAG，<code>.</code>表示当前目录，也可以使用全路径，目的就是找到Dockerfile文件。</p>
<p>由于需要网络环境，整体过程可能较慢。构建成功后，可<code>docker images</code>查看。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9odWIuZG9ja2VyLmNvbS8=" title="https://hub.docker.com/">Docker Hub<i class="fa fa-external-link"></i></span>有大量现成镜像，随便搜索一个打开其Dockerfile察看，参考制作自己的镜像文件；</p>
<p>然后登陆<code>docker login</code>，成功后推送<code>docker push wenlongshen/macs2:ubuntu.v1</code>，至此，就可以在自己的docker hub里查看并管理了，同样地，也可以<code>docker pull wenlongshen/macs2:ubuntu.v1</code>到本地使用。</p>
<h2 id="Singularity_使用">Singularity 使用</h2><p>singularity有许多命令，常用的命令有，pull、run、exec、shell、build；</p>
<p>下载镜像<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">singularity pull qiime2_core_2018.<span class="number">11</span><span class="selector-class">.sif</span> docker:<span class="comment">//qiime2/core:2018.11</span></span><br></pre></td></tr></table></figure></p>
<p>载入数据<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">singularity exec -B /share/exercise/qiime2/emp-single-<span class="keyword">end</span>-sequences qiime2_core_2018<span class="variable">.11</span><span class="variable">.sif</span> qiime tools <span class="keyword">import</span> --<span class="keyword">type</span> EMPSingleEndSequences --<span class="keyword">input</span>-path /share/exercise/qiime2/emp-single-<span class="keyword">end</span>-sequences --<span class="keyword">output</span>-path emp-single-<span class="keyword">end</span>-sequences<span class="variable">.qza</span></span><br></pre></td></tr></table></figure></p>
<p>因为在容器中是没有/share/exercise/qiime2/emp-single-end-sequences 这个绝对路径的，所以需要使用-B选项将宿主机的/share/exercise/qiime2/emp-single-end-sequences路径映射到容器中；</p>
<h2 id="参考资料">参考资料</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly95ZWFzeS5naXRib29rcy5pby9kb2NrZXJfcHJhY3RpY2UvY29udGVudC9jYXNlcy9vcy9jZW50b3MuaHRtbA==" title="https://yeasy.gitbooks.io/docker_practice/content/cases/os/centos.html">Docker —— 从入门到实践<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93ZW5sb25nc2hlbi5naXRodWIuaW8vMjAxOC8wOS8wOC9QaXBlbGluaW5nLVNvbHV0aW9uLTEv" title="https://wenlongshen.github.io/2018/09/08/Pipelining-Solution-1/">生物信息分析流程<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC81YjVlMmYxYmQwNTc=" title="https://www.jianshu.com/p/5b5e2f1bd057">singularity<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9jbG91ZC50ZW5jZW50LmNvbS9kZXZlbG9wZXIvYXJ0aWNsZS8xNDc4NjE4" title="https://cloud.tencent.com/developer/article/1478618">Singularity入门之安装<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;使用场景&quot;&gt;使用场景&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/docker.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;容器作为轻量级的虚拟机，可在主机之外提供多种系统环境选择；另外，在容器中一次打包好软件及相关依赖环境之后，即可将复杂的软件环境在各种平台上无缝运行，无需重复多次配置，大大减轻相关工作人员的工作量；&lt;/p&gt;
&lt;p&gt;目前主流的容器为docker，其最初被用于软件产品需要快速迭代的互联网行业，极大地简化了系统部署、提高了硬件资源的利用率，近来也在各种特定领域的应用系统中被使用。&lt;/p&gt;
&lt;p&gt;Docker 是一个开源的应用容器引擎，基于 &lt;a href=&quot;https://golang.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Go&lt;/a&gt; 语言，并遵从Apache2.0协议开源。&lt;/p&gt;
&lt;p&gt;Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。&lt;/p&gt;
&lt;p&gt;容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。&lt;br&gt;
    
    </summary>
    
      <category term="docker" scheme="http://tiramisutes.github.io/categories/docker/"/>
    
    
      <category term="docker" scheme="http://tiramisutes.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>go语言简单介绍与module安装</title>
    <link href="http://tiramisutes.github.io/2019/08/29/go.html"/>
    <id>http://tiramisutes.github.io/2019/08/29/go.html</id>
    <published>2019-08-29T03:17:40.000Z</published>
    <updated>2019-08-30T05:41:05.064Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/Golang-logo.png" alt=""></p>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9nb2xhbmcub3JnLw==" title="https://golang.org/">Go<i class="fa fa-external-link"></i></span> 是Google开发的一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。</p>
</blockquote>
<a id="more"></a>
<h2 id="go_安装">go 安装</h2><p>到 <span class="exturl" data-url="aHR0cHM6Ly9nb2xhbmcub3JnL2RsLw==" title="https://golang.org/dl/">https://golang.org/dl/<i class="fa fa-external-link"></i></span> 下载最新版本的编译好的GoLang（国内好像打不开哦），并进行完整性验证，然后解压即可运行。<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget -c https:<span class="comment">//storage.googleapis.com/golang/go1.12.9.linux-amd64.tar.gz</span></span><br><span class="line">shasum -<span class="selector-tag">a</span> <span class="number">256</span> go1.<span class="number">12.9</span><span class="selector-class">.linux-amd64</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br><span class="line">tar -xvzf go1.<span class="number">12.9</span><span class="selector-class">.linux-amd64</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure></p>
<p>添加环境变量<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:/path/go/bin</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">GOPATH</span>=<span class="string">"/path/go/src"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">GOBIN</span>=<span class="string">"/path/go/bin"</span></span><br></pre></td></tr></table></figure></p>
<p>检测安装情况<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> <span class="keyword">version</span></span><br></pre></td></tr></table></figure></p>
<p>用<code>go env</code>来察看相关路径设置是否正确。</p>
<h2 id="go_module使用">go module使用</h2><blockquote>
<p><code>go module</code> 是go官方在go1.11版本引进的，用来管理包的依赖关系，可以通过版本号来进行迭代，通过<code>go.mod</code>来管理项目依赖的模块。</p>
</blockquote>
<p>其<code>go.mod</code>格式如下：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">module github.com/martian-lang/martian</span><br><span class="line"> </span><br><span class="line">go <span class="number">1.12</span></span><br><span class="line"> </span><br><span class="line">require (</span><br><span class="line">	github.com/cloudfoundry/gosigar v1<span class="number">.1</span><span class="number">.0</span></span><br><span class="line">	github.com/dustin/go-humanize v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20180713052910</span><span class="number">-9</span>f541cc9db5d</span><br><span class="line">	github.com/google/shlex v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20150127133951</span><span class="number">-6</span>f45313302b9</span><br><span class="line">	github.com/martian-lang/docopt.go v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20180828184714</span><span class="number">-57</span>cc8f5f669d</span><br><span class="line">	github.com/satori/go.uuid v1<span class="number">.1</span><span class="number">.1</span><span class="number">-0.20160713180306</span><span class="number">-0</span>aa62d5ddceb</span><br><span class="line">	github.com/golang/sys v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20190209173611</span><span class="number">-3</span>b5209105503</span><br><span class="line">	github.com/golang/tools v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20190219175448</span><span class="number">-49</span>d818b07734</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>module</code> 用来定义项目的模块名字。</li>
<li><code>go 1.12</code> 用来表示，项目使用的go版本。</li>
<li><code>require</code> 用来表示项目引用的模块和模块对应的版本号。</li>
</ul>
<p>一个模块是由一组相关的软件包组成的一个单元，如下:<br><img src="/images/gomodule.png" alt=""></p>
<p>go项目通常放到src目录中。</p>
<p>如同CRAN 和 CPAN，go module也有对应仓库，主要是<code>golang.org</code>（官方仓库），<code>https://goproxy.io/</code>（最大代理仓库）和<code>github</code>。</p>
<h3 id="golang-org">golang.org</h3><p>类似于python安装module仅需<code>pip install XXX</code>，perl仅需<code>cpanm XXX</code>和R仅需<code>library(&quot;XXX&quot;)</code>一样，go module的安装也可以通过命令直接安装。<br>如尝试安装 <code>sys</code> module：<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">go</span> <span class="built_in">get</span> -u golang.org/x/sys</span><br></pre></td></tr></table></figure></p>
<p>但结果却是报错，不应该啊，网上各种教程甚至官网都是写的这样下载啊：<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">go</span>: golang.org/x/sys<span class="variable">@v0</span>.<span class="number">0.0</span><span class="attribute">-20190209173611-3b5209105503</span>: unrecognized import path <span class="string">"golang.org/x/sys"</span> (https <span class="attribute">fetch</span>: Get <span class="attribute">https</span>:<span class="comment">//golang.org/x/sys?go-get=1: dial tcp 216.239.37.1:443: i/o timeout)</span></span><br><span class="line"><span class="attribute">go</span>: error loading module requirements</span><br></pre></td></tr></table></figure></p>
<p>(┬＿┬)因为万恶的墙，go是Google开发的……..，难道不能用了吗？<code>goproxy.io</code>和<code>github</code>就是救世主。</p>
<h3 id="goproxy-io">goproxy.io</h3><p><span class="exturl" data-url="aHR0cHM6Ly9nb3Byb3h5LmlvLw==" title="https://goproxy.io/">官网<i class="fa fa-external-link"></i></span>一张图看下 goproxy.io 的作用：解救我们于水生火热中……..<br><img src="/images/goproxio.png" alt=""></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开启 go modules 特征</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">GO111MODULE</span>=on</span><br><span class="line"><span class="comment"># 设置GOPROXY环境变量</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">GOPROXY</span>=https://goproxy.io</span><br></pre></td></tr></table></figure>
<p>然后重新下载所需module即可<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">go</span> <span class="built_in">get</span> -u golang.org/x/sys</span><br></pre></td></tr></table></figure></p>
<h3 id="github">github</h3><p>两种方式：<br>将github相关仓库 <code>git clone</code> 到 <code>gopath/src/golang.org/x/</code> 目录下，然后cd 到相应目录执行<code>go install golang.org/x/sys</code>；<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p <span class="variable">$GOPATH</span><span class="regexp">/src/g</span>olang.org<span class="regexp">/x/</span></span><br><span class="line">cd <span class="variable">$GOPATH</span><span class="regexp">/src/g</span>olang.org<span class="regexp">/x/</span></span><br><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/golang/</span>sys.git sys</span><br><span class="line">go install golang.org<span class="regexp">/x/</span>sys</span><br></pre></td></tr></table></figure></p>
<p>执行go install之后没有提示，就说明安装好了。</p>
<p>或者直接<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> -v gitlab.<span class="keyword">com</span>/groupName/projectName</span><br></pre></td></tr></table></figure></p>
<hr>
<p>总结有效办法是将所需module的<code>go.mod</code>文件中的任何<code>golang.org</code>指定替换为相应的<code>github</code>位置。</p>
<hr>
<p>我的 Go 环境如下：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">GOARCH</span>=<span class="string">"amd64"</span></span><br><span class="line"><span class="attr">GOBIN</span>=<span class="string">"/public/home/zpxu/software/go/bin"</span></span><br><span class="line"><span class="attr">GOCACHE</span>=<span class="string">"/public/home/zpxu/.cache/go-build"</span></span><br><span class="line"><span class="attr">GOEXE</span>=<span class="string">""</span></span><br><span class="line"><span class="attr">GOFLAGS</span>=<span class="string">""</span></span><br><span class="line"><span class="attr">GOHOSTARCH</span>=<span class="string">"amd64"</span></span><br><span class="line"><span class="attr">GOHOSTOS</span>=<span class="string">"linux"</span></span><br><span class="line"><span class="attr">GOOS</span>=<span class="string">"linux"</span></span><br><span class="line"><span class="attr">GOPATH</span>=<span class="string">"/public/home/zpxu/software/go/src"</span></span><br><span class="line"><span class="attr">GOPROXY</span>=<span class="string">"https://goproxy.io"</span></span><br><span class="line"><span class="attr">GORACE</span>=<span class="string">""</span></span><br><span class="line"><span class="attr">GOROOT</span>=<span class="string">"/public/home/zpxu/software/go"</span></span><br><span class="line"><span class="attr">GOTMPDIR</span>=<span class="string">""</span></span><br><span class="line"><span class="attr">GOTOOLDIR</span>=<span class="string">"/public/home/zpxu/software/go/pkg/tool/linux_amd64"</span></span><br><span class="line"><span class="attr">GCCGO</span>=<span class="string">"gccgo"</span></span><br><span class="line"><span class="attr">CC</span>=<span class="string">"gcc"</span></span><br><span class="line"><span class="attr">CXX</span>=<span class="string">"g++"</span></span><br><span class="line"><span class="attr">CGO_ENABLED</span>=<span class="string">"1"</span></span><br><span class="line"><span class="attr">GOMOD</span>=<span class="string">"/public/home/zpxu/software/cellranger/martian/go.mod"</span></span><br><span class="line"><span class="attr">CGO_CFLAGS</span>=<span class="string">"-g -O2"</span></span><br><span class="line"><span class="attr">CGO_CPPFLAGS</span>=<span class="string">""</span></span><br><span class="line"><span class="attr">CGO_CXXFLAGS</span>=<span class="string">"-g -O2"</span></span><br><span class="line"><span class="attr">CGO_FFLAGS</span>=<span class="string">"-g -O2"</span></span><br><span class="line"><span class="attr">CGO_LDFLAGS</span>=<span class="string">"-g -O2"</span></span><br><span class="line"><span class="attr">PKG_CONFIG</span>=<span class="string">"pkg-config"</span></span><br><span class="line"><span class="attr">GOGCCFLAGS</span>=<span class="string">"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build473583117=/tmp/go-build -gno-record-gcc-switches"</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="参考资料">参考资料</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cudGVjbWludC5jb20vaW5zdGFsbC1nby1pbi1saW51eC8=" title="https://www.tecmint.com/install-go-in-linux/">How to Install GoLang (Go Programming Language) in Linux<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5maW5kbWUud2FuZy9ibG9nL2RldGFpbC9pZC82NzQuaHRtbA==" title="http://www.findme.wang/blog/detail/id/674.html">Go中的modules初步使用<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/Golang-logo.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://golang.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Go&lt;/a&gt; 是Google开发的一个开源的编程语言，它能让构造简单、可靠且高效的软件变得容易。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="go" scheme="http://tiramisutes.github.io/categories/go/"/>
    
    
      <category term="go_module" scheme="http://tiramisutes.github.io/tags/go-module/"/>
    
  </entry>
  
  <entry>
    <title>高能预警：拟南芥&amp;基因家族分析也能发Cell</title>
    <link href="http://tiramisutes.github.io/2019/08/24/AT-GeneFamily.html"/>
    <id>http://tiramisutes.github.io/2019/08/24/AT-GeneFamily.html</id>
    <published>2019-08-24T15:10:02.000Z</published>
    <updated>2019-09-04T00:37:07.325Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/AT1.png" alt=""><br>测序技术的发展普及极快的促进了基因组学的研究进展，如果说DNA sequencing at 40: past, present and future呈现给我们的是气势磅礴的DNA测序技术，那“拟南芥1001基因组计划”（<span class="exturl" data-url="aHR0cDovLzEwMDFnZW5vbWVzLm9yZw==" title="http://1001genomes.org">http://1001genomes.org<i class="fa fa-external-link"></i></span> ）就是这雄伟蓝图中的冰山一角，自2008年启动伊始，这一角却撬动了生命科学研究的步伐，加速了人类对基因功能，物种多样性的认知。2016年1135 个拟南芥基因组全基因组序列分析论文的发表，宣告了 1001 基因组计划项目第一阶段的结束，然而基于基因组的拟南芥相关研究却从未止步。<br><a id="more"></a><br>bioRxiv最近上传了题为“Chromosome-level assemblies of multiple Arabidopsis thaliana accessions reveal hotspots of genomic rearrangements”的文章通过对7个拟南芥品种进行PacBio测序和染色体水平基因组组装，揭示了其在长期进化过程中相应逆境胁迫而引起的大约350个热点区域的染色体重排。<br><img src="/images/AT2.png" alt=""></p>
<h1 id="背景介绍">背景介绍</h1><p>说起逆境胁迫，植物从寒武纪生命大爆发选择陆地作为落脚点开始，风雨不动安如山便是对它们最真实的写照，为生存植物在长期的进化过程中形成其独特的免疫系统来发现潜在的病原体，植物免疫依赖于一系列免疫受体，而植物与微生物的共进化促进了免疫受体的多样性。通常有两种类型的受体可以激活植物的免疫信号：能够识别病原相关分子模式（microbe-associated molecular patterns, MAMPs）的细胞表面蛋白和能够感知病原菌效应子的细胞内蛋白。病原菌可以通过释放一系列的效应子来破坏或扰乱植物的PTI防御反应以便更好地侵染植物，植物在PTI的基础上配置了多种类型的核苷酸结合富亮氨酸重复的免疫受体 (nucleotide-binding leucine-rich repeat, NLR)，作为效应子触发免疫的第2道防御体系 (即ETI)。植物通过NLR免疫受体识别病原体，引起植物的超敏反应（hypersensitive response, HR），进而阻止病原菌的侵染。NLR 是具有保守结构的多结构域蛋白，包括C 末端富含亮氨酸重复序列（LRR）结构域，中央核苷酸结合结构域（NBD）和直接或间接识别病原体衍生效应子的可变N-末端结构域，其主要是TIR（Toll/interleukin-1 receptor）和CC（coiled-coil）结构域。就在昨天Science背靠背报道了TIR结构域能够分裂代谢辅因子NAD+（nicotinamide adenine dinucleotide），并作为抗病反应的细胞死亡信号。（详见：Science背靠背 | NLR受体介导植物抗病反应新机制）。这些关键性结构域为NLRs相关基因的鉴定和家族分析提供了依据。<br>基于NLR基因在植物免疫和育种应用中的重要性，目前有大量的物种进行相关基因的鉴定和进化分析。然而NLR基因家族极端的多态性，甚至是近缘个体间广泛存在的获得与缺失变异（presence-absence variants，PAVs），使得人们对NLR的多样性至今无清晰了解。<br>近日，来自德国马普发育生物学研究所的Felix Bemm团队在Cell杂志在线发表了“A Species-Wide Inventory of NLR Genes and Alleles in Arabidopsis thaliana” 的研究论文，通过对64个不同地理分布的拟南芥accession进行RenSeq测序（Resistance gene enrichment Sequencing，能够从已测序的植物基因组中重新定位NLR基因家族，并快速绘制分离群体中的抗性位点）和泛NLR组（pan-NLRome）分析，进而确定核心NLR complement，整合结构域多样性，描述新的结构域特征，评估非核心NLRs的获得与缺失多态性和锚定拟南芥Col-0参考基因组上的非典型NLRs基因位置。<br><img src="/images/AT3.png" alt=""></p>
<h1 id="结果">结果</h1><h2 id="NLR_Discovery">NLR Discovery</h2><p>通过RenSeq和单分子实时测序（SMRT），在64个拟南芥中共构建了65个NLR complement，其中包含13,167个注释的NLR基因，平均在每个个体中有167到251个基因。其中47%到71%的NLR基因在不同个体基因组中成簇存在，且部分NLR基因呈现出head-to-head的方向性（定义为paired NLRs），每个accession中有10到34个这个的配对NLRs。所有NLRs基因根据其所包含结构域的不同分为四类：TIR-NLR (TNL), CC-NLR (CNL), CCR-NLR (RNL), 和NB-and-LRR-only proteins (NL)，其中每个accession中数量最多的是TNLs，其次是NLs, CNLs和RNLs。<br><img src="/images/AT4.png" alt=""></p>
<h2 id="Diversity_of_NLR_Domain_Architectures">Diversity of NLR Domain Architectures</h2><p>这13,167个NLR基因中，663个编码至少一个非典型NLR结构域，代表36个明显不同的Pfam结构域。NLR组跨物种多样性的显著标志是不同结构域特征相对比例的变化。本次拟南芥泛NLR组研究共鉴定到97个明显的特征，其中仅有22个在Col-0参考基因组中存在，仅有48个在Col-0或其他十字花科植物中报道过。<br><img src="/images/AT5.png" alt=""></p>
<h2 id="The_Pan-NLRome">The Pan-NLRome</h2><p>为了解NLR数量和多样性变异，对所测序的64个拟南芥accessions所含NLRs基因基于序列相似性进行orthogroups（OGs）聚类。结果仅有小于10%（1,663个基因）的基因以单体形式存在，剩下的11,497个基因共聚成464个OGs。这464个OGs中95%可在任意的38个accessions中找到。OGs进一步通过大小，结构域特征和结构特征进行分类。核心NLR组仅包含106个OGs（23%），对应6,080（53%）个基因能在至少52个accessions中找到。shell NLR组有稍微高的143个OGs (31%)，对应3,932 (34%)个基因能在至少13个，但少于52个accessions中找到。cloud NLR组为215个OGs (46%)，对应1,485 (13%)个基因能在最多12个accessions中找到。<br><img src="/images/AT6.png" alt=""></p>
<h2 id="Genomic_Placement_of_Non-reference_OGs">Genomic Placement of Non-reference OGs</h2><p>296个OGs在Col-0参考基因组中缺失，其中6个属于核心，205个属于cloud和85个属于shell NLR组。本研究通过共线性将OGs锚定到Col-0参考基因组。结果共得到42个共线性子网络。<br><img src="/images/AT7.png" alt=""><br>其中OG102和OG211聚类在新的NLRs区域中，此外，新锚定的OGs还包括一个CNL和三个TNL类的 NLR基因对。<br><img src="/images/AT8.png" alt=""></p>
<h2 id="Pan-NLRome_Diversity">Pan-NLRome Diversity</h2><p>基于正交分类法（orthogonal approach, <span class="exturl" data-url="aHR0cDovL3d3dy5waGFybXRlY2guY29tL29ydGhvZ29uYWwtYXBwcm9hY2gtYmlvc2ltaWxhcml0eQ==" title="http://www.pharmtech.com/orthogonal-approach-biosimilarity">http://www.pharmtech.com/orthogonal-approach-biosimilarity<i class="fa fa-external-link"></i></span> ） 根据结构域特征对NLR基因进行分类，并评估了序列多样性作为形成泛NLR组的进化压的指示。随机挑选的32个accessions中，平均核苷酸序列多样性达到95%的饱和度。相反，仅有49个accessions存在单倍型多样性的饱和度，这反映出新的单倍型的出现不仅来源于突变，而且与基因内的重排和基因转换相关，这在3/4的OGs（74%）中得到验证。这与基因内的重排能引起功能分化的报道相吻合。相较于没有聚类的OGs而言，成簇的OGs有显著高的核苷酸多样性，这与基因复制后存在较小的选择压相符合。尽管当涉及到获得与缺失多态性时不同的NLR分类有不同的整体轮廓，但是平均核苷酸多样性在OGs内是相似的对于CNLs, TNLs和NLs类NLR组来说。而RNLs类有较低的平均核苷酸多样性，这与他们功能的保守性相关联。<br><img src="/images/AT9.png" alt=""><br>对进化的每一个分支进行选择分析共鉴定到131个OGs在至少一个分支中存在偶然正选择（episodic positive selection），大部分OGs属于核心（50）或shell （73）NLR组。位点特异的选择分析揭示了543个核心和shell OGs可能经历过experienced constant (46%), pervasive (30%)或 episodic (24%)正选择。没有变化的密码子代表了恒定的纯化选择能够在所有类型（core和shell），分类（TNLs, CNLs，RNL和NL）和配对状态 (paired和unpaired)中找到，而其子类表现出不均匀的正选择模式。<br><img src="/images/AT10.png" alt=""></p>
<h2 id="Linking_Diversity_to_Known_Function">Linking Diversity to Known Function</h2><p>为了将NLR组多样性与已知的基因功能相联系，进一步将OGs分类为对适应性活体营养型有抗性，对非适应性活体营养型有抗性和对半活体营养型有抗性三类。结果显示OGs中对适应性活体营养型（adapted biotrophs）有抗性类型显著多于其他类别，说明了宿主适应性活体营养型病原菌更加能够驱动NLRs基因的多样性。对适应性活体营养型有抗性的OGs有较高的Tajima’s D值，表明其不仅经历过正向选择也经历过平衡选择。<br><img src="/images/AT11.png" alt=""></p>
<h1 id="数据分析">数据分析</h1><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9hc3RhdHNhLmNvbS9PbmVXYXlfQW5vdmFfd2l0aF9UdWtleUhTRC8=" title="https://astatsa.com/OneWay_Anova_with_TukeyHSD/">One-way ANOVA with post-hoc Tukey HSD Test Calculator<i class="fa fa-external-link"></i></span></li>
<li><a href=""></a></li>
</ol>
<hr>
<p>正文结束，我是分割线</p>
<hr>
<p>纵观全文，这个基因家族分析涉及SMRT RenSeq测序，类似于基因组的De novo组装，基因结构和功能注释以及分类，其中为保证NLR基因注释准确性通过多种手段进行人工纠正，随后的比较基因组分析，泛NLR组分析，聚类分析和序列水平的选择分析，最关键的是每一个漂亮的figure都告诉你是怎么画的，包括R脚本。正所谓面面俱到，完全不像满大街的单个物种找下目标基因，看下染色体分布，什么基因结构，motif有用没用先放上，或者再计算个简单的kaks，最后东拼西凑点转录组数据，塞几个qRT结果……类基因家族分析文章。非常值得学习。<br>最后奉上师兄的点评。<br><img src="/images/AT12.png" alt=""></p>
<p>原文链接： <span class="exturl" data-url="aHR0cHM6Ly93d3cuc2NpZW5jZWRpcmVjdC5jb20vc2NpZW5jZS9hcnRpY2xlL3BpaS9TMDA5Mjg2NzQxOTMwODM3Mg==" title="https://www.sciencedirect.com/science/article/pii/S0092867419308372">A Species-Wide Inventory of NLR Genes and Alleles in Arabidopsis thaliana<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/AT1.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;测序技术的发展普及极快的促进了基因组学的研究进展，如果说DNA sequencing at 40: past, present and future呈现给我们的是气势磅礴的DNA测序技术，那“拟南芥1001基因组计划”（&lt;a href=&quot;http://1001genomes.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://1001genomes.org&lt;/a&gt; ）就是这雄伟蓝图中的冰山一角，自2008年启动伊始，这一角却撬动了生命科学研究的步伐，加速了人类对基因功能，物种多样性的认知。2016年1135 个拟南芥基因组全基因组序列分析论文的发表，宣告了 1001 基因组计划项目第一阶段的结束，然而基于基因组的拟南芥相关研究却从未止步。&lt;br&gt;
    
    </summary>
    
      <category term="文献" scheme="http://tiramisutes.github.io/categories/%E6%96%87%E7%8C%AE/"/>
    
    
      <category term="基因组" scheme="http://tiramisutes.github.io/tags/%E5%9F%BA%E5%9B%A0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>R 标准地图记（区分四川和重庆且有台湾和南海诸岛）</title>
    <link href="http://tiramisutes.github.io/2019/06/19/Rmap.html"/>
    <id>http://tiramisutes.github.io/2019/06/19/Rmap.html</id>
    <published>2019-06-19T06:33:27.000Z</published>
    <updated>2019-06-28T07:32:22.619Z</updated>
    
    <content type="html"><![CDATA[<p>在重测序文章中经常见到用地图来描述测序样品分布，而地图涉及到主权，属敏感问题，但在R中可轻(fu)松(za)复现。<br><img src="/images/map0.png" alt=""><br><a id="more"></a></p>
<h1 id="1-_不同方法比较">1. 不同方法比较</h1><h2 id="ggplot2">ggplot2</h2><p>可灵活调整图形的任意组成成分，同时可在图形上添加2个或多个维度的数据；</p>
<h2 id="maps">maps</h2><p>简单易操作，但原先中国的基础地图中，没有将四川和重庆区分开，现在虽然已经区分，但每个省份轮廓看起来还是与地图略有区别（<span class="exturl" data-url="aHR0cDovL3d3dy5uZ2NjLmNuLw==" title="http://www.ngcc.cn/">国家基础地理信息中心<i class="fa fa-external-link"></i></span>）；<br><img src="/images/map2.png" alt=""></p>
<h2 id="googleVis">googleVis</h2><p>绘制基础地图方法，仍然只能绘制一维的数据。同时绘制的地图依赖google地图；</p>
<h2 id="REmap">REmap</h2><p>国人开发的基于百度地图Echart。优点，绘制地图方便快捷，省市级地区的二级地图非常精准，并可绘制炫酷的迁徙图和热图，推荐学习网址：<span class="exturl" data-url="aHR0cDovL2xjaGlmZm9uLmdpdGh1Yi5pby9SRW1hcC8=" title="http://lchiffon.github.io/REmap/">http://lchiffon.github.io/REmap/<i class="fa fa-external-link"></i></span> ；缺点，同googleVis一样，只能绘制一维的数据，同时地图上只能显示中文地名。</p>
<h1 id="2-_地图数据下载">2. 地图数据下载</h1><h2 id="Download_GADM_data"><span class="exturl" data-url="aHR0cHM6Ly9nYWRtLm9yZy9kb3dubG9hZF9jb3VudHJ5X3YzLmh0bWw=" title="https://gadm.org/download_country_v3.html">Download GADM data<i class="fa fa-external-link"></i></span></h2><p><img src="/images/map1.png" alt=""><br>但是从GDM网站下载的中国地图没有台湾，果断差评。</p>
<h2 id="GIS数据">GIS数据</h2><p><span class="exturl" data-url="aHR0cDovL2Nvcy5uYW1lL3dwLWNvbnRlbnQvdXBsb2Fkcy8yMDA5LzA3L2NoaW5hcHJvdmluY2Vib3JkZXJkYXRhX3Rhcl9nei56aXA=" title="http://cos.name/wp-content/uploads/2009/07/chinaprovinceborderdata_tar_gz.zip">http://cos.name/wp-content/uploads/2009/07/chinaprovinceborderdata_tar_gz.zip<i class="fa fa-external-link"></i></span><br>主要是下载三个中国行政区地图数据信息文件： bou2_4p.dbf，bou2_4p.shp和bou2_4p.shx；<br>使用中如果出现中文省份名称乱码，设置<code>Sys.setlocale(&quot;LC_ALL&quot;, &quot;chinese&quot;)</code>即可。<br>中国行政区地图数据信息数据中包含了925条记录，每条记录中都含有<br>面积（AREA）<br>周长（PERIMETER）<br>各种编号，ADCODE99 是国家基础地理信息中心定义的区域代码，共有 6 位数字，由省、地市、县各两位代码组成。<br>中文名（NAME）等字段,其中中文名（NAME）字段是以GBK编码的。可利用iconv 格式转换函数来转换各省名称<code>table(iconv(map$NAME, from = &quot;GBK&quot;))</code></p>
<p>解压后三个文件放到相同目录下；虽然只读取.shp 文件，.shx 和 .dbf文件也必须在同一个文件目录下才能读取成功。<br>但是没有中国南海的八段线的线条绘制数据，由于南海诸岛的面积较小，如果不使用八段线标记的话，有时候如果地图展示面积太小的，南海诸岛就几乎难以辨清。</p>
<h1 id="3-_地图绘制">3. 地图绘制</h1><h2 id="1-_Preparation">1. Preparation</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">setwd</span><span class="params">(<span class="string">"F:/Rwork/china_map"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(maptools)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(dplyr)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(RColorBrewer)</span></span></span><br><span class="line">Sys.setlocale(<span class="string">"LC_ALL"</span>, <span class="string">"chinese"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="2-_Map_Data">2. Map Data</h2><p>Download GIS数据：<span class="exturl" data-url="aHR0cDovL2Nvcy5uYW1lL3dwLWNvbnRlbnQvdXBsb2Fkcy8yMDA5LzA3L2NoaW5hcHJvdmluY2Vib3JkZXJkYXRhX3Rhcl9nei56aXA=" title="http://cos.name/wp-content/uploads/2009/07/chinaprovinceborderdata_tar_gz.zip">http://cos.name/wp-content/uploads/2009/07/chinaprovinceborderdata_tar_gz.zip<i class="fa fa-external-link"></i></span><br>解压后三个文件放到当前目录(<code>getwd()</code>)下；<br>虽然只读取.shp 文件，.shx 和 .dbf文件也必须在同一个文件目录下才能读取成功。<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">map_data</span> &lt;- readShapePoly(<span class="string">"bou2_4p.shp"</span>)</span><br><span class="line"><span class="title">names</span>(map_data)</span><br><span class="line"><span class="title">map_data</span>@<span class="class"><span class="keyword">data</span>$<span class="type">ID</span> &lt;- row.names(<span class="title">map_data</span>@<span class="title">data</span>)</span></span><br><span class="line"><span class="meta"># 去掉包含NA的数据</span></span><br><span class="line"><span class="title">map_data</span>@<span class="class"><span class="keyword">data</span> &lt;- na.omit(<span class="title">map_data</span>@<span class="title">data</span>)</span></span><br><span class="line"><span class="title">nrow</span>(map_data@<span class="class"><span class="keyword">data</span>)</span></span><br><span class="line"><span class="meta"># 可选，按照省份面积(AREA)筛选,主要为去掉南沙群岛和围绕南海的许多小岛</span></span><br><span class="line"><span class="type">Fmap_data</span> &lt;- subset(map_data, <span class="type">AREA</span> &gt; <span class="number">0.005</span>)</span><br><span class="line"><span class="title">nrow</span>(<span class="type">Fmap_data</span>@<span class="class"><span class="keyword">data</span>)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="添加省会拼音">添加省会拼音</h3><p>Create a data.frame called <strong>cnmapdf</strong> which contains id, prov_en and prov_cn and key map plotting info;<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">prov_cn</span> &lt;- unique(map_data$<span class="type">NAME</span>)</span><br><span class="line"><span class="title">prov_en</span> &lt;- c(<span class="string">"Heilongjiang"</span>, <span class="string">"Inner Mongolia"</span>, <span class="string">"Xinjiang"</span>, <span class="string">"Jilin"</span>,</span><br><span class="line">             <span class="string">"Liaoning"</span>, <span class="string">"Gansu"</span>, <span class="string">"Hebei"</span>, <span class="string">"Beijing"</span>, <span class="string">"Shanxi"</span>,</span><br><span class="line">             <span class="string">"Tianjin"</span>, <span class="string">"Shaanxi"</span>, <span class="string">"Ningxia"</span>, <span class="string">"Qinghai"</span>, <span class="string">"Shandong"</span>,</span><br><span class="line">             <span class="string">"Tibet"</span>, <span class="string">"Henan"</span>, <span class="string">"Jiangsu"</span>, <span class="string">"Anhui"</span>, <span class="string">"Sichuan"</span>, <span class="string">"Hubei"</span>,</span><br><span class="line">             <span class="string">"Chongqing"</span>, <span class="string">"Shanghai"</span>, <span class="string">"Zhejiang"</span>, <span class="string">"Hunan"</span>, <span class="string">"Jiangxi"</span>,</span><br><span class="line">             <span class="string">"Yunnan"</span>, <span class="string">"Guizhou"</span>, <span class="string">"Fujian"</span>, <span class="string">"Guangxi"</span>, <span class="string">"Taiwan"</span>, </span><br><span class="line">             <span class="string">"Guangdong"</span>, <span class="string">"Hong Kong"</span>, <span class="string">"Hainan"</span>)</span><br><span class="line"></span><br><span class="line"><span class="title">prov</span> &lt;- <span class="class"><span class="keyword">data</span>.frame(<span class="title">prov_cn</span>, <span class="title">prov_en</span>)</span></span><br><span class="line"><span class="title">id_prov</span> &lt;- map_data@<span class="class"><span class="keyword">data</span> %&gt;%</span></span><br><span class="line">  mutate(prov_en = sapply(<span class="type">NAME</span>, function(x) prov$prov_en[which(prov_cn == x)])) %&gt;%</span><br><span class="line">  mutate(prov_cn = <span class="keyword">as</span>.character(<span class="type">NAME</span>),prov_en = <span class="keyword">as</span>.character(prov_en)) %&gt;%</span><br><span class="line">  select(id = <span class="type">ID</span>, prov_cn, prov_en)</span><br><span class="line"></span><br><span class="line"><span class="title">cnmapdf</span> &lt;- plyr::join(fortify(map_data), id_prov, by = <span class="string">"id"</span>)</span><br><span class="line"><span class="title">head</span>(cnmapdf)</span><br></pre></td></tr></table></figure></p>
<h3 id="添加省会城市坐标">添加省会城市坐标</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">cap_coord</span> &lt;- c(</span><br><span class="line">  <span class="string">"Beijing"</span>, <span class="string">"北京"</span>, <span class="string">"Beijing"</span>, <span class="number">116.4666667</span>, <span class="number">39.9</span>,</span><br><span class="line">  <span class="string">"Shanghai"</span>, <span class="string">"上海"</span>, <span class="string">"Shanghai"</span>, <span class="number">121.4833333</span>, <span class="number">31.23333333</span>,</span><br><span class="line">  <span class="string">"Tianjin"</span>, <span class="string">"天津"</span>, <span class="string">"Tianjin"</span>, <span class="number">117.1833333</span>, <span class="number">39.15</span>,</span><br><span class="line">  <span class="string">"Chongqing"</span>, <span class="string">"重庆"</span>, <span class="string">"Chongqing"</span>, <span class="number">106.5333333</span>, <span class="number">29.53333333</span>,</span><br><span class="line">  <span class="string">"Harbin"</span>, <span class="string">"哈尔滨"</span>, <span class="string">"Heilongjiang"</span>, <span class="number">126.6833333</span>, <span class="number">45.75</span>,</span><br><span class="line">  <span class="string">"Changchun"</span>, <span class="string">"长春"</span>, <span class="string">"Jilin"</span>, <span class="number">125.3166667</span>, <span class="number">43.86666667</span>,</span><br><span class="line">  <span class="string">"Shenyang"</span>, <span class="string">"沈阳"</span>, <span class="string">"Liaoning"</span>, <span class="number">123.4</span>, <span class="number">41.83333333</span>,</span><br><span class="line">  <span class="string">"Hohhot"</span>, <span class="string">"呼和浩特"</span>, <span class="string">"Inner Mongolia"</span>, <span class="number">111.8</span>, <span class="number">40.81666667</span>,</span><br><span class="line">  <span class="string">"Shijiazhuang"</span>, <span class="string">"石家庄"</span>, <span class="string">"Hebei"</span>, <span class="number">114.4666667</span>, <span class="number">38.03333333</span>,</span><br><span class="line">  <span class="string">"Taiyuan"</span>, <span class="string">"太原"</span>, <span class="string">"Shanxi"</span>, <span class="number">112.5666667</span>, <span class="number">37.86666667</span>,</span><br><span class="line">  <span class="string">"Jinan"</span>, <span class="string">"济南"</span>,<span class="string">"Shandong"</span>, <span class="number">117</span>, <span class="number">36.63333333</span>,</span><br><span class="line">  <span class="string">"Zhengzhou"</span>, <span class="string">"郑州"</span>, <span class="string">"Henan"</span>, <span class="number">113.7</span>, <span class="number">34.8</span>, </span><br><span class="line">  <span class="string">"Xi'an"</span>, <span class="string">"西安"</span>, <span class="string">"Shaanxi"</span>, <span class="number">108.9</span>, <span class="number">34.26666667</span>,</span><br><span class="line">  <span class="string">"Lanzhou"</span>, <span class="string">"兰州"</span>, <span class="string">"Gansu"</span>, <span class="number">103.8166667</span>, <span class="number">36.05</span>,</span><br><span class="line">  <span class="string">"Yinchuan"</span>, <span class="string">"银川"</span>, <span class="string">"Ningxia"</span>, <span class="number">106.2666667</span>, <span class="number">38.33333333</span>,</span><br><span class="line">  <span class="string">"Xining"</span>, <span class="string">"西宁"</span>, <span class="string">"Qinghai"</span>, <span class="number">101.75</span>, <span class="number">36.63333333</span>,</span><br><span class="line">  <span class="string">"Urumqi"</span>, <span class="string">"乌鲁木齐"</span>, <span class="string">"Xinjiang"</span>, <span class="number">87.6</span>, <span class="number">43.8</span>,</span><br><span class="line">  <span class="string">"Hefei"</span>, <span class="string">"合肥"</span>, <span class="string">"Anhui"</span>, <span class="number">117.3</span>, <span class="number">31.85</span>,</span><br><span class="line">  <span class="string">"Nanjing"</span>, <span class="string">"南京"</span>, <span class="string">"Jiangsu"</span>, <span class="number">118.8333333</span>, <span class="number">32.03333333</span>,</span><br><span class="line">  <span class="string">"Hangzhou"</span>, <span class="string">"杭州"</span>, <span class="string">"Zhejiang"</span>, <span class="number">120.15</span>, <span class="number">30.23333333</span>,</span><br><span class="line">  <span class="string">"Changsha"</span>, <span class="string">"长沙"</span>, <span class="string">"Hunan"</span>, <span class="number">113</span>, <span class="number">28.18333333</span>,</span><br><span class="line">  <span class="string">"Nanchang"</span>, <span class="string">"南昌"</span>, <span class="string">"Jiangxi"</span>, <span class="number">115.8666667</span>, <span class="number">28.68333333</span>,</span><br><span class="line">  <span class="string">"Wuhan"</span>, <span class="string">"武汉"</span>, <span class="string">"Hubei"</span>, <span class="number">114.35</span>, <span class="number">30.61666667</span>,</span><br><span class="line">  <span class="string">"Chengdu"</span>, <span class="string">"成都"</span>, <span class="string">"Sichuan"</span>, <span class="number">104.0833333</span>, <span class="number">30.65</span>,</span><br><span class="line">  <span class="string">"Guiyang"</span>, <span class="string">"贵阳"</span>, <span class="string">"Guizhou"</span>, <span class="number">106.7</span>, <span class="number">26.58333333</span>,</span><br><span class="line">  <span class="string">"Fuzhou"</span>, <span class="string">"福州"</span>, <span class="string">"Fujian"</span>, <span class="number">119.3</span>, <span class="number">26.08333333</span>,</span><br><span class="line">  <span class="string">"Taibei"</span>, <span class="string">"台北"</span>, <span class="string">"Taiwan"</span>, <span class="number">121.5166667</span>, <span class="number">25.05</span>,</span><br><span class="line">  <span class="string">"Guangzhou"</span>, <span class="string">"广州"</span>, <span class="string">"Guangdong"</span>, <span class="number">113.25</span>, <span class="number">23.13333333</span>,</span><br><span class="line">  <span class="string">"Haikou"</span>, <span class="string">"海口"</span>, <span class="string">"Hainan"</span>, <span class="number">110.3333333</span>, <span class="number">20.03333333</span>,</span><br><span class="line">  <span class="string">"Nanning"</span>, <span class="string">"南宁"</span>, <span class="string">"Guangxi"</span>, <span class="number">108.3333333</span>, <span class="number">22.8</span>,</span><br><span class="line">  <span class="string">"Kunming"</span>, <span class="string">"昆明"</span>, <span class="string">"Yunnan"</span>, <span class="number">102.6833333</span>, <span class="number">25</span>,</span><br><span class="line">  <span class="string">"Lhasa"</span>, <span class="string">"拉萨"</span>, <span class="string">"Tibet"</span>, <span class="number">91.16666667</span>, <span class="number">29.66666667</span>,</span><br><span class="line">  <span class="string">"Hong Kong"</span>, <span class="string">"香港"</span>, <span class="string">"Hong Kong"</span>, <span class="number">114.1666667</span>, <span class="number">22.3</span>,</span><br><span class="line">  <span class="string">"Macau"</span>, <span class="string">"澳门"</span>, <span class="string">"Macau"</span>, <span class="number">113.5</span>, <span class="number">22.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="title">cap_coord</span> &lt;- <span class="keyword">as</span>.<span class="class"><span class="keyword">data</span>.frame(<span class="title">matrix</span>(<span class="title">cap_coord</span>, <span class="title">nrow</span> = 34, <span class="title">byrow</span> = <span class="type">TRUE</span>))</span></span><br><span class="line"><span class="title">names</span>(cap_coord) &lt;- c(<span class="string">"city_en"</span>, <span class="string">"city_cn"</span>, <span class="string">"prov_en"</span>, <span class="string">"long"</span>, <span class="string">"lat"</span>)</span><br><span class="line"><span class="title">cap_coord</span> &lt;- cap_coord %&gt;%</span><br><span class="line">  mutate(prov_en = <span class="keyword">as</span>.vector(prov_en),</span><br><span class="line">         city_en = <span class="keyword">as</span>.vector(city_en),</span><br><span class="line">         city_cn = <span class="keyword">as</span>.vector(city_cn),</span><br><span class="line">         cap_long = <span class="keyword">as</span>.double(<span class="keyword">as</span>.vector(long)),</span><br><span class="line">         cap_lat = <span class="keyword">as</span>.double(<span class="keyword">as</span>.vector(lat))) %&gt;%</span><br><span class="line">  select(prov_en, city_en, city_cn, cap_long, cap_lat)</span><br><span class="line"></span><br><span class="line"><span class="title">head</span>(cap_coord)</span><br><span class="line"><span class="title">cnmapdf</span> &lt;- plyr::join(cnmapdf, cap_coord, by = <span class="string">"prov_en"</span>, <span class="class"><span class="keyword">type</span> = "full")</span></span><br></pre></td></tr></table></figure>
<h3 id="筛选南海区域和添加九段线">筛选南海区域和添加九段线</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Ncnmapdf &lt;- cnmapdf</span><br><span class="line">Ncnmapdf<span class="variable">$class</span>&lt;-rep(<span class="string">"Mainland"</span>,nrow(Ncnmapdf))</span><br><span class="line">Width&lt;-<span class="number">9</span></span><br><span class="line">Height&lt;-<span class="number">9</span></span><br><span class="line">long_Start&lt;-<span class="number">124</span></span><br><span class="line">lat_Start&lt;-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">df_Nanhai&lt;-Ncnmapdf[Ncnmapdf<span class="variable">$long</span>&gt;<span class="number">106.55</span> &amp; Ncnmapdf<span class="variable">$long</span>&lt;<span class="number">123.58</span>,]</span><br><span class="line">df_Nanhai&lt;-df_Nanhai[df_Nanhai<span class="variable">$lat</span>&gt;<span class="number">4.61</span> &amp; df_Nanhai<span class="variable">$lat</span>&lt;<span class="number">25.45</span>,]</span><br><span class="line"></span><br><span class="line">min_long&lt;-min(df_Nanhai<span class="variable">$long</span>, na<span class="selector-class">.rm</span> = TRUE)</span><br><span class="line">min_lat&lt;-min(df_Nanhai<span class="variable">$lat</span>, na<span class="selector-class">.rm</span> = TRUE)</span><br><span class="line">max_long&lt;-max(df_Nanhai<span class="variable">$long</span>, na<span class="selector-class">.rm</span> = TRUE)</span><br><span class="line">max_lat&lt;-max(df_Nanhai<span class="variable">$lat</span>, na<span class="selector-class">.rm</span> = TRUE)</span><br><span class="line"></span><br><span class="line">df_Nanhai<span class="variable">$long</span>&lt;-(df_Nanhai<span class="variable">$long</span>-min_long)/(max_long-min_long)*Width+long_Start</span><br><span class="line">df_Nanhai<span class="variable">$lat</span>&lt;-(df_Nanhai<span class="variable">$lat</span>-min_lat)/(max_lat-min_lat)*Height+lat_Start</span><br><span class="line">df_Nanhai<span class="variable">$class</span>&lt;-rep(<span class="string">"NanHai"</span>,nrow(df_Nanhai))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ncnmapdf&lt;-rbind(Ncnmapdf,df_Nanhai)</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#df_NanHaiLine</span>:Nanhai Line</span><br><span class="line">df_NanHaiLine &lt;- read.csv(<span class="string">"中国南海九段线.csv"</span>)  </span><br><span class="line"><span class="function"><span class="title">colnames</span><span class="params">(df_NanHaiLine)</span></span>&lt;-c(<span class="string">"long"</span>,<span class="string">"lat"</span>,<span class="string">"ID"</span>)</span><br><span class="line"></span><br><span class="line">df_NanHaiLine<span class="variable">$long</span>&lt;-(df_NanHaiLine<span class="variable">$long</span>-min_long)/(max_long-min_long)*Width+long_Start</span><br><span class="line">df_NanHaiLine<span class="variable">$lat</span>&lt;-(df_NanHaiLine<span class="variable">$lat</span>-min_lat)/(max_lat-min_lat)*Height+lat_Start</span><br></pre></td></tr></table></figure>
<h2 id="3-_开始绘制地图">3. 开始绘制地图</h2><h3 id="选择一个省画图">选择一个省画图</h3><p>默认绘制的地图的形状有些扁平。这是因为，在绘图的过程中，默认把经度和纬度作为普通数据，均匀平等对待，绘制在笛卡尔坐标系上造成的。其实，地球的球面图形如何映射到平面图上，在地理学上是有一系列不同的专业算法的。地图不应该画在普通的笛卡尔坐标系上，而是要画在地理学专业的坐标系上。在这一点上，R 的 ggplot2 包提供了专门的coord_map()函数。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">shanghai &lt;- cnmapdf[cnmapdf<span class="variable">$prov_en</span> == <span class="string">"Shanghai"</span>,]</span><br><span class="line">shanghai %&gt;%</span><br><span class="line">  ggplot(aes(x = long, y = lat,<span class="built_in"> group </span>= group, <span class="attribute">fill</span>=factor(prov_en))) +</span><br><span class="line">  geom_polygon( color = <span class="string">"grey"</span>) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  ggtitle(<span class="string">"上海直辖市"</span>) +</span><br><span class="line">  xlab(<span class="string">"经度"</span>) +</span><br><span class="line">  ylab(<span class="string">"维度"</span>) +</span><br><span class="line">  scale_fill_brewer(<span class="attribute">palette</span>=<span class="string">"Paired"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/map3.png" alt=""></p>
<h3 id="画多个省">画多个省</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">map1 &lt;- cnmapdf %&gt;%</span><br><span class="line">  filter(prov_en %<span class="keyword">in</span>% c(<span class="string">"Jiangsu"</span>, <span class="string">"Zhejiang"</span>, <span class="string">"Shanghai"</span>))  %&gt;%</span><br><span class="line">  ggplot() +</span><br><span class="line">  geom_polygon(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = prov_cn), color = <span class="string">"grey"</span>)</span><br><span class="line"></span><br><span class="line">coord_delta_cap &lt;- subset(cap_coord, prov_en %<span class="keyword">in</span>% c(<span class="string">"Zhejiang"</span>, <span class="string">"Shanghai"</span>, <span class="string">"Jiangsu"</span>))</span><br><span class="line">map1 +</span><br><span class="line">  geom_point(data = coord_delta_cap, aes(x = cap_long, y = cap_lat)) +</span><br><span class="line">  geom_text(data = coord_delta_cap, aes(cap_long, cap_lat - .25, label = city_cn)) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  ggtitle(<span class="string">"长江三角洲"</span>) +</span><br><span class="line">  xlab(<span class="string">"经度"</span>) +</span><br><span class="line">  ylab(<span class="string">"维度"</span>) +</span><br><span class="line">  scale_fill_brewer(<span class="attribute">palette</span>=<span class="string">"Set2"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map4.png" alt=""></p>
<h3 id="南海诸岛局部放大的全国地图">南海诸岛局部放大的全国地图</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">nb.cols &lt;- length(unique(Ncnmapdf$prov_en))</span><br><span class="line">mycolors &lt;- colorRampPalette(brewer.pal(<span class="number">8</span>, <span class="string">"Set2"</span>))(nb.cols)</span><br><span class="line"></span><br><span class="line">map00 &lt;- ggplot()+</span><br><span class="line">  geom_polygon(<span class="attr">data=Ncnmapdf,</span> aes(<span class="attr">x=long,</span> <span class="attr">y=lat,</span> <span class="attr">group=interaction(class,group),fill=prov_cn),colour="grey",size=0.25)+</span> </span><br><span class="line">  <span class="comment">#中国地图，包括中国主体部分和长方形方块内的南海诸岛数据</span></span><br><span class="line">  geom_rect(aes(<span class="attr">xmin=long_Start,</span> <span class="attr">xmax=long_Start+Width+1,</span> <span class="attr">ymin=lat_Start-1,</span> <span class="attr">ymax=lat_Start+Height),fill=NA,</span> <span class="attr">colour="black",size=0.25)+</span></span><br><span class="line">  <span class="comment">#绘制长方形方框</span></span><br><span class="line">  geom_line(<span class="attr">data=df_NanHaiLine,</span> aes(<span class="attr">x=long,</span> <span class="attr">y=lat,</span> <span class="attr">group=ID),</span> <span class="attr">colour="black",</span> <span class="attr">size=1)+</span>  </span><br><span class="line">  <span class="comment">#绘制长方形方框内的中国南海八段线 </span></span><br><span class="line">  <span class="comment">#scale_fill_manual(values = colorRampPalette(rev(brewer.pal(11,'Spectral')))(33))+</span></span><br><span class="line">  theme(legend.<span class="attr">position</span> = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_manual(<span class="attr">values</span> = mycolors) +</span><br><span class="line">  coord_cartesian()+</span><br><span class="line">  ylim(<span class="number">15</span>,<span class="number">55</span>)+</span><br><span class="line">  theme(</span><br><span class="line">    <span class="comment">#legend.position=c(0.15,0.2),</span></span><br><span class="line">    legend.<span class="attr">background</span> = element_blank()</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">Ncoord_delta_cap &lt;- subset(cap_coord, prov_en %<span class="keyword">in</span>% unique(Ncnmapdf$prov_en))</span><br><span class="line"><span class="comment"># 解决重叠地名</span></span><br><span class="line">library(ggrepel)</span><br><span class="line">spec.city &lt;- c(<span class="string">"香港"</span>,<span class="string">"澳门"</span>)</span><br><span class="line">Ncap_map_data01 &lt;- Ncoord_delta_cap[Ncoord_delta_cap$city_cn %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">Ncap_map_data02 &lt;- Ncoord_delta_cap[!Ncoord_delta_cap$city_cn %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">map00 + geom_point(<span class="attr">data=Ncap_map_data02,aes(x=cap_long,</span> <span class="attr">y=</span> cap_lat),<span class="attr">shape=1,colour="white")</span> +</span><br><span class="line">          geom_text(<span class="attr">data=Ncap_map_data02,aes(x=cap_long,</span> <span class="attr">y=</span> cap_lat,<span class="attr">label=city_cn))</span> +</span><br><span class="line">          geom_text_repel(<span class="attr">data=Ncap_map_data01,aes(x=cap_long,</span> <span class="attr">y=</span> cap_lat,<span class="attr">label=city_cn))</span> +</span><br><span class="line">          annotate(<span class="string">"text"</span>, <span class="attr">x=132.6,</span> <span class="attr">y=15.5,</span> <span class="attr">label="南海诸岛")</span> +</span><br><span class="line">          theme_void() + </span><br><span class="line">          theme(legend.<span class="attr">position</span> = <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map17.png" alt=""></p>
<h3 id="全国地图">全国地图</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">map0 &lt;- cnmapdf %&gt;%</span><br><span class="line">  filter(prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))  %&gt;%</span><br><span class="line">  ggplot() +</span><br><span class="line">  geom_polygon(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = <span class="string">"white"</span>), color = <span class="string">"grey"</span>) +</span><br><span class="line">  scale_fill_identity()</span><br><span class="line">coord_delta_cap &lt;- subset(cap_coord, prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))</span><br><span class="line"><span class="comment"># 解决重叠地名</span></span><br><span class="line">library(ggrepel)</span><br><span class="line">spec.city &lt;- c(<span class="string">"香港"</span>,<span class="string">"澳门"</span>)</span><br><span class="line">cap_map_data01 &lt;- coord_delta_cap[coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">cap_map_data02 &lt;- coord_delta_cap[!coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">cnmap &lt;-  map0 + geom_point(<span class="attribute">data</span>=cap_map_data02,aes(x=cap_long, y= cap_lat),<span class="attribute">shape</span>=1,colour="white") +</span><br><span class="line">          geom_text(<span class="attribute">data</span>=cap_map_data02,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">          geom_text_repel(<span class="attribute">data</span>=cap_map_data01,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">          coord_map() +</span><br><span class="line">          theme_void() + </span><br><span class="line">          theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">          scale_fill_identity()</span><br><span class="line">cnmap</span><br></pre></td></tr></table></figure>
<p><img src="/images/map5.png" alt=""><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">map1 &lt;- cnmapdf %&gt;%</span><br><span class="line">  filter(prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))  %&gt;%</span><br><span class="line">  ggplot() +</span><br><span class="line">  geom_polygon(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = prov_cn), color = <span class="string">"grey"</span>)</span><br><span class="line"></span><br><span class="line">coord_delta_cap &lt;- subset(cap_coord, prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))</span><br><span class="line"></span><br><span class="line">nb.cols &lt;- length(unique(coord_delta_cap<span class="variable">$prov_en</span>))</span><br><span class="line">mycolors &lt;- colorRampPalette(brewer.pal(8, <span class="string">"Set2"</span>))(nb.cols)</span><br><span class="line"></span><br><span class="line">map1 +</span><br><span class="line">  geom_point(data = coord_delta_cap, aes(x = cap_long, y = cap_lat)) +</span><br><span class="line">  geom_text(data = coord_delta_cap, aes(cap_long, cap_lat - .25, label = city_cn)) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  ggtitle(<span class="string">"中国"</span>) +</span><br><span class="line">  xlab(<span class="string">"经度"</span>) +</span><br><span class="line">  ylab(<span class="string">"维度"</span>) +</span><br><span class="line">  theme_void() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_manual(values = mycolors)</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/map6.png" alt=""></p>
<h3 id="解决重叠地名">解决重叠地名</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(ggrepel)</span><br><span class="line">spec.city &lt;- c(<span class="string">"香港"</span>,<span class="string">"澳门"</span>)</span><br><span class="line">cap_map_data1 &lt;- coord_delta_cap[coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">cap_map_data2 &lt;- coord_delta_cap[!coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">map1 + geom_point(<span class="attribute">data</span>=cap_map_data2,aes(x=cap_long, y= cap_lat),<span class="attribute">shape</span>=1,colour="white") +</span><br><span class="line">  geom_text(<span class="attribute">data</span>=cap_map_data2,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">  geom_text_repel(<span class="attribute">data</span>=cap_map_data1,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  theme_void() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_manual(values = mycolors)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map7.png" alt=""></p>
<h3 id="颜色标注全国地图某几个省">颜色标注全国地图某几个省</h3><p><span class="exturl" data-url="aHR0cHM6Ly9jb3N4Lm9yZy8yMDA5LzA3L2RyYXdpbmctY2hpbmEtbWFwLXVzaW5nLXIv" title="https://cosx.org/2009/07/drawing-china-map-using-r/">https://cosx.org/2009/07/drawing-china-map-using-r/<i class="fa fa-external-link"></i></span><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">par(mar=rep(<span class="number">0</span>,<span class="number">4</span>))</span><br><span class="line">library(maps)</span><br><span class="line">library(mapdata)</span><br><span class="line">getColor = function(mapdata, provname, provcol, othercol)&#123;</span><br><span class="line">	f = function(x, y) ifelse(x %in% y, which(y == x), <span class="number">0</span>)</span><br><span class="line">	colIndex = sapply(mapdata@data$NAME, f, provname)</span><br><span class="line">	fg = c(othercol, provcol)[colIndex + <span class="number">1</span>]</span><br><span class="line">	return(fg)</span><br><span class="line">&#125;</span><br><span class="line">provname = c(<span class="string">"北京市"</span>, <span class="string">"天津市"</span>, <span class="string">"上海市"</span>, <span class="string">"重庆市"</span>)</span><br><span class="line">provcol = c(<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"purple"</span>)</span><br><span class="line">plot(map_data, col = getColor(map_data, provname, provcol, <span class="string">"white"</span>))</span><br><span class="line">points(cap_coord$cap_long, cap_coord$cap_lat, pch = <span class="number">19</span>, col = rgb(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>))</span><br><span class="line">text(cap_coord$cap_long, cap_coord$cap_lat, cap_coord[, <span class="number">3</span>], cex = <span class="number">0.9</span>, col = rgb(<span class="number">0</span>,<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>), </span><br><span class="line">     pos = c(<span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">2</span>))</span><br><span class="line">axis(<span class="number">1</span>, lwd = <span class="number">0</span>); axis(<span class="number">2</span>, lwd = <span class="number">0</span>); axis(<span class="number">3</span>, lwd = <span class="number">0</span>); axis(<span class="number">4</span>, lwd = <span class="number">0</span>)</span><br><span class="line">as.character(na.omit(unique(map_data@data$NAME)))</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/map8.png" alt=""></p>
<h3 id="颜色标注全国地图某几个省_(推荐)">颜色标注全国地图某几个省 (推荐)</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">provname = c(<span class="string">"北京市"</span>, <span class="string">"天津市"</span>, <span class="string">"上海市"</span>, <span class="string">"重庆市"</span>)</span><br><span class="line">provcol = c(<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"purple"</span>)</span><br><span class="line">getColors = function(mapdata, provname, provcol, othercol)&#123;</span><br><span class="line">	f = function(x, y) ifelse(x %<span class="keyword">in</span>% y, which(y == x), 0)</span><br><span class="line">	colIndex = sapply(mapdata<span class="variable">$prov_cn</span>, f, provname)</span><br><span class="line">	fg = c(othercol, provcol)[colIndex + 1]</span><br><span class="line">	return(fg)</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">mc</span>=getColors(cnmapdf, provname, provcol, <span class="string">"white"</span>)</span><br><span class="line">map2 &lt;- cnmapdf %&gt;%</span><br><span class="line">  filter(prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))  %&gt;%</span><br><span class="line">  ggplot() +</span><br><span class="line">  geom_polygon(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = mc), color = <span class="string">"grey"</span>)</span><br><span class="line"></span><br><span class="line">coord_delta_cap &lt;- subset(cap_coord, prov_en %<span class="keyword">in</span>% unique(cnmapdf<span class="variable">$prov_en</span>))</span><br><span class="line"><span class="comment"># 解决重叠地名</span></span><br><span class="line">library(ggrepel)</span><br><span class="line">spec.city &lt;- c(<span class="string">"香港"</span>,<span class="string">"澳门"</span>)</span><br><span class="line">cap_map_data21 &lt;- coord_delta_cap[coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">cap_map_data22 &lt;- coord_delta_cap[!coord_delta_cap<span class="variable">$city_cn</span> %<span class="keyword">in</span>% spec.city,]</span><br><span class="line">map2 + geom_point(<span class="attribute">data</span>=cap_map_data22,aes(x=cap_long, y= cap_lat),<span class="attribute">shape</span>=1,colour="white") +</span><br><span class="line">  geom_text(<span class="attribute">data</span>=cap_map_data22,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">  geom_text_repel(<span class="attribute">data</span>=cap_map_data21,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn)) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  theme_void() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_identity()</span><br></pre></td></tr></table></figure>
<p><img src="/images/map9.png" alt=""></p>
<h2 id="4-_地图添加数据">4. 地图添加数据</h2><p>实例数据下载：<span class="exturl" data-url="aHR0cDovL2RhdGEuc3RhdHMuZ292LmNuL2Vhc3lxdWVyeS5odG0/Y249RTAxMDM=" title="http://data.stats.gov.cn/easyquery.htm?cn=E0103">中华人民共和国国家统计局<i class="fa fa-external-link"></i></span></p>
<h3 id="Heatmap">Heatmap</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">democn &lt;- read.csv(<span class="string">"China_pop.csv"</span>, stringsAsFactors = F, check.<span class="attribute">names</span>=<span class="literal">FALSE</span>)</span><br><span class="line">library(tidyr)</span><br><span class="line">library(reshape2)</span><br><span class="line">democndf &lt;- melt(democn,variable.name =<span class="string">"year"</span>, value.name = <span class="string">"population"</span>)</span><br><span class="line">head(spread(democndf, year, population))</span><br><span class="line"></span><br><span class="line">map2df &lt;- cnmapdf %&gt;% </span><br><span class="line">  plyr::join(subset(democndf, year == <span class="string">"2018年"</span>), by = <span class="string">"prov_cn"</span>) %&gt;%</span><br><span class="line">  mutate(population = as.numeric(population))</span><br><span class="line">  </span><br><span class="line">map2df %&gt;%</span><br><span class="line">  ggplot() +</span><br><span class="line">  geom_polygon(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = population), color = <span class="string">"grey"</span>) +</span><br><span class="line">  geom_point(<span class="attribute">data</span>=cap_map_data22,aes(x=cap_long, y= cap_lat),<span class="attribute">shape</span>=1,colour="white") +</span><br><span class="line">  geom_text(<span class="attribute">data</span>=cap_map_data22,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn),size=2) +</span><br><span class="line">  geom_text_repel(<span class="attribute">data</span>=cap_map_data21,aes(x=cap_long, y= cap_lat,<span class="attribute">label</span>=city_cn),size=2) +</span><br><span class="line">  scale_fill_gradient(low = <span class="string">"red"</span>, high = <span class="string">"yellow"</span>) +</span><br><span class="line">  theme_void()</span><br></pre></td></tr></table></figure>
<p><img src="/images/map10.png" alt=""><br>多个图<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">map3df &lt;- cnmapdf %&gt;% </span><br><span class="line">  plyr::join(democndf, by = <span class="string">"prov_cn"</span>) %&gt;%</span><br><span class="line">  mutate(population = as.numeric(population)) %&gt;%</span><br><span class="line">  na.omit()</span><br><span class="line">map3df %&gt;%</span><br><span class="line">  ggplot(aes(x = long, y = lat,<span class="built_in"> group </span>= group, fill = population)) +</span><br><span class="line">  geom_polygon(color = <span class="string">"grey"</span>, lwd = .1) +</span><br><span class="line">  coord_equal() +</span><br><span class="line">  facet_wrap(~year)</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/map11.png" alt=""></p>
<h3 id="Bubbles">Bubbles</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">map1 + </span><br><span class="line">  geom_point(<span class="name">data</span> = map2df, aes(<span class="name">cap_long</span>, cap_lat, size = population), shape = <span class="number">21</span>, fill=<span class="string">"#9070c7"</span>,colour=<span class="string">"grey"</span>, alpha = .<span class="number">5</span>) +</span><br><span class="line">  scale_size_area(<span class="name">max_size=5</span>) +</span><br><span class="line">  geom_text(<span class="name">data=cap_map_data2</span>,aes(<span class="name">x=cap_long</span>, y= cap_lat,label=city_cn),size=2,vjust=0,nudge_y=0.<span class="number">5</span>) +</span><br><span class="line">  geom_text_repel(<span class="name">data=cap_map_data1</span>,aes(<span class="name">x=cap_long</span>, y= cap_lat,label=city_cn),size=2,vjust=0,nudge_y=0.<span class="number">5</span>) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  theme_void() + </span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_manual(<span class="name">values</span> = mycolors)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map12.png" alt=""></p>
<h3 id="Bar">Bar</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">map1 + </span><br><span class="line">  geom_errorbar(<span class="name">data=map2df</span>,aes(<span class="name">x=cap_long</span>, ymin=cap_lat, ymax=cap_lat + population/3000 ),</span><br><span class="line">                colour=<span class="string">"blue"</span>,size=2, width=0,alpha=0.<span class="number">5</span>) +</span><br><span class="line">  geom_text(<span class="name">data=cap_map_data2</span>,aes(<span class="name">x=cap_long</span>, y= cap_lat,label=city_cn),size=2,vjust=0,nudge_y=0.<span class="number">5</span>) +</span><br><span class="line">  geom_text_repel(<span class="name">data=cap_map_data1</span>,aes(<span class="name">x=cap_long</span>, y= cap_lat,label=city_cn),size=2,vjust=0,nudge_y=0.<span class="number">5</span>) +</span><br><span class="line">  coord_map() +</span><br><span class="line">  theme_void() + </span><br><span class="line">  theme(<span class="name">legend</span>.position = <span class="string">"none"</span>) +</span><br><span class="line">  scale_fill_manual(<span class="name">values</span> = mycolors)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map13.png" alt=""></p>
<h2 id="5-_世界地图">5. 世界地图</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">library</span><span class="params">(rworldmap)</span></span></span><br><span class="line">met &lt;- as<span class="selector-class">.data</span><span class="selector-class">.frame</span>(read.csv(<span class="string">"MetObjects_5k-sample.csv"</span>))</span><br><span class="line">countries<span class="selector-class">.met</span> &lt;- as<span class="selector-class">.data</span><span class="selector-class">.frame</span>(table(met<span class="variable">$Country</span>))</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(countries.met)</span></span></span><br><span class="line"><span class="function"><span class="title">colnames</span><span class="params">(countries.met)</span></span> &lt;- c(<span class="string">"country"</span>, <span class="string">"value"</span>)</span><br><span class="line">matched &lt;- joinCountryData2Map(countries<span class="selector-class">.met</span>, joinCode=<span class="string">"NAME"</span>, nameJoinColumn=<span class="string">"country"</span>)</span><br><span class="line"><span class="function"><span class="title">mapCountryData</span><span class="params">(matched, nameColumnToPlot=<span class="string">"value"</span>, mapTitle=<span class="string">"Met Collection Country Sample"</span>, catMethod = <span class="string">"pretty"</span>, colourPalette = <span class="string">"heat"</span>,oceanCol=<span class="string">"aliceblue"</span>)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="/images/map14.png" alt=""></p>
<h3 id="仅显示某一区域">仅显示某一区域</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapCountryData(matched, <span class="attribute">nameColumnToPlot</span>=<span class="string">"value"</span>, <span class="attribute">mapTitle</span>=<span class="string">"Met Collection in Eurasia"</span>, <span class="attribute">mapRegion</span>=<span class="string">"Eurasia"</span>, <span class="attribute">colourPalette</span>=<span class="string">"heat"</span>, <span class="attribute">catMethod</span>=<span class="string">"pretty"</span>, <span class="attribute">oceanCol</span>=<span class="string">"aliceblue"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/images/map15.png" alt=""><br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(dplyr)</span><br><span class="line"></span><br><span class="line">WorldData &lt;- map_data('world') %&gt;% filter(region != <span class="string">"Antarctica"</span>) %&gt;% fortify</span><br><span class="line"></span><br><span class="line">df &lt;- data.frame(<span class="attr">region=c('Hungary','Lithuania','Argentina'),</span> </span><br><span class="line">                 <span class="attr">value=c(4,10,11),</span> </span><br><span class="line">                 <span class="attr">stringsAsFactors=FALSE)</span></span><br><span class="line"></span><br><span class="line">p &lt;- ggplot() +</span><br><span class="line">    geom_map(<span class="attr">data</span> = WorldData, <span class="attr">map</span> = WorldData,</span><br><span class="line">                  aes(<span class="attr">x</span> =long , <span class="attr">y</span> = lat, <span class="attr">group</span> = group, <span class="attr">map_id=region),</span></span><br><span class="line">                  <span class="attr">fill</span> = <span class="string">"white"</span>, <span class="attr">colour</span> = <span class="string">"#7f7f7f"</span>, <span class="attr">size=0.5)</span> + </span><br><span class="line">    geom_map(<span class="attr">data</span> = df, <span class="attr">map=WorldData,</span> aes(<span class="attr">fill=value,</span> <span class="attr">map_id=region),colour="#7f7f7f",</span> <span class="attr">size=0.5)</span> +</span><br><span class="line">    coord_map(<span class="string">"rectangular"</span>, <span class="attr">lat0=0,</span> <span class="attr">xlim=c(-180,180),</span> <span class="attr">ylim=c(-60,</span> <span class="number">90</span>)) +</span><br><span class="line">    scale_fill_continuous(<span class="attr">low="thistle2",</span> <span class="attr">high="darkred",</span> <span class="attr">guide="colorbar")</span> +</span><br><span class="line">    scale_y_continuous(<span class="attr">breaks=c())</span> +</span><br><span class="line">    scale_x_continuous(<span class="attr">breaks=c())</span> +</span><br><span class="line">    labs(<span class="attr">fill="legend",</span> <span class="attr">title="Title",</span> <span class="attr">x="",</span> <span class="attr">y="")</span> +</span><br><span class="line">    theme(<span class="attr">text</span> = element_text( <span class="attr">color</span> = <span class="string">"#FFFFFF"</span>)</span><br><span class="line">        ,panel.<span class="attr">background</span> = element_rect(<span class="attr">fill</span> = <span class="string">"aliceblue"</span>)</span><br><span class="line">        ,plot.<span class="attr">background</span> = element_rect(<span class="attr">fill</span> = <span class="string">"aliceblue"</span>)</span><br><span class="line">        ,panel.<span class="attr">grid</span> = element_blank()</span><br><span class="line">        ,plot.<span class="attr">title</span> = element_text(<span class="attr">size</span> = <span class="number">30</span>)</span><br><span class="line">        ,plot.<span class="attr">subtitle</span> = element_text(<span class="attr">size</span> = <span class="number">10</span>)</span><br><span class="line">        ,axis.<span class="attr">text</span> = element_blank()</span><br><span class="line">        ,axis.<span class="attr">title</span> = element_blank()</span><br><span class="line">        ,axis.<span class="attr">ticks</span> = element_blank()</span><br><span class="line">        ,legend.<span class="attr">position</span> = <span class="string">"right"</span></span><br><span class="line">        )</span><br><span class="line">    <span class="comment">#theme_bw()</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/map16.png" alt=""></p>
<h2 id="6-_Info">6. Info</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># R version 3.4.2 (2017-09-28)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Running under: Windows 10 x64 (build 17134)</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Matrix products: default</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># locale:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [1] LC_COLLATE=Chinese (Simplified)_China.936 </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [2] LC_CTYPE=Chinese (Simplified)_China.936   </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [3] LC_MONETARY=Chinese (Simplified)_China.936</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [4] LC_NUMERIC=C                              </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [5] LC_TIME=Chinese (Simplified)_China.936    </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># attached base packages:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># other attached packages:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [1] rworldmap_1.3-6    reshape2_1.4.3     tidyr_0.8.3       </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [4] mapdata_2.3.0      maps_3.3.0         ggrepel_0.8.0     </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [7] RColorBrewer_1.1-2 ggplot2_3.1.0      dplyr_0.8.0.1     </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [10] maptools_0.9-5     sp_1.3-1          </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># loaded via a namespace (and not attached):</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [1] Rcpp_1.0.0       pillar_1.3.1     compiler_3.4.2   plyr_1.8.4      </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [5] tools_3.4.2      dotCall64_1.0-0  digest_0.6.18    evaluate_0.13   </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#  [9] tibble_2.0.1     gtable_0.2.0     lattice_0.20-38  pkgconfig_2.0.2 </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [13] rlang_0.3.1      mapproj_1.2.6    yaml_2.2.0       spam_2.2-2      </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [17] xfun_0.5         withr_2.1.2      stringr_1.4.0    knitr_1.21      </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [21] fields_9.8-3     grid_3.4.2       tidyselect_0.2.5 glue_1.3.0      </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [25] R6_2.4.0         foreign_0.8-71   rmarkdown_1.11   purrr_0.3.1     </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [29] searcher_0.0.3   magrittr_1.5     scales_1.0.0     htmltools_0.3.6 </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [33] assertthat_0.2.0 colorspace_1.4-0 labeling_0.3     stringi_1.3.1   </span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># [37] lazyeval_0.2.1   munsell_0.5.0    crayon_1.3.4</span></span></span><br></pre></td></tr></table></figure>
<h1 id="4-_参考">4. 参考</h1><p><span class="exturl" data-url="aHR0cDovL3BhcGFjb2Nob24uY29tLzIwMTUvMTAvMTUvQ29kYWdlLTExLXItdmlzdWFsaXphdGlvbi0yLWNuLW1hcC0yLw==" title="http://papacochon.com/2015/10/15/Codage-11-r-visualization-2-cn-map-2/">R Visual. - China Map Part II<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGF0YW5vdmlhLmNvbS9lbi9ibG9nL2dncGxvdC1jb2xvcnMtYmVzdC10cmlja3MteW91LXdpbGwtbG92ZS8=" title="https://www.datanovia.com/en/blog/ggplot-colors-best-tricks-you-will-love/">https://www.datanovia.com/en/blog/ggplot-colors-best-tricks-you-will-love/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGF0YW5vdmlhLmNvbS9lbi9ibG9nL3RvcC1yLWNvbG9yLXBhbGV0dGVzLXRvLWtub3ctZm9yLWdyZWF0LWRhdGEtdmlzdWFsaXphdGlvbi8=" title="https://www.datanovia.com/en/blog/top-r-color-palettes-to-know-for-great-data-visualization/">https://www.datanovia.com/en/blog/top-r-color-palettes-to-know-for-great-data-visualization/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5lYXN5Y2hhcnRzLmNsdWIvcG9zdC8xNw==" title="http://www.easycharts.club/post/17">标准中国地图的绘制<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在重测序文章中经常见到用地图来描述测序样品分布，而地图涉及到主权，属敏感问题，但在R中可轻(fu)松(za)复现。&lt;br&gt;&lt;img src=&quot;/images/map0.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="map" scheme="http://tiramisutes.github.io/tags/map/"/>
    
  </entry>
  
  <entry>
    <title>分子生物学 or 生物信息学, that&#39;s a question</title>
    <link href="http://tiramisutes.github.io/2019/04/18/Biotechnology-Vs-Bioinformatics.html"/>
    <id>http://tiramisutes.github.io/2019/04/18/Biotechnology-Vs-Bioinformatics.html</id>
    <published>2019-04-18T05:40:50.000Z</published>
    <updated>2019-04-19T15:50:42.566Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/BB.png" alt=""><br><strong>分子生物学（Molecular biology）</strong>是对生物在分子层次上的研究，是生物学和化学之间跨学科的研究，其研究领域涵盖了遗传学、生物化学和生物物理学等学科。分子生物学主要致力于对细胞中不同系统之间相互作用的理解，包括DNA，RNA和蛋白质生物合成之间的关系以及了解它们之间的相互作用是如何被调控的。 在我们的研究中主要涉及基因功能和代谢通路解析；<br><strong>生物信息学（Bioinformatics)</strong>利用应用数学、信息学、统计学和计算机科学的方法研究生物学的问题。生物信息学的研究材料和结果就是各种各样的生物学数据，其研究工具是计算机，研究方法包括对生物学数据的搜索（收集和筛选）、处理（编辑、整理、管理和显示）及利用（计算、模拟）。当前主要的研究方向有：序列比对、序列组装、基因识别、基因重组、蛋白质结构预测、基因表达、蛋白质反应的预测，以及创建进化模型。<br>自迈克尔·沃特曼（Michael Waterman）率先将数学和计算方法引入生物学研究开始，如今这门交叉学科作为后起之秀正逐渐渗透到生物学研究的多个领域，21世纪是生命科学的世纪，但也是一个信息化的时代，如果做分子的不懂生信，做生信的不懂分子，如何让自己走的更远？<br>工欲善其事，必先利其器，各行各业都有其不二法宝，科研工作亦当如此；<br><a id="more"></a></p>
<h2 id="1-_浏览器">1. 浏览器</h2><p>最好的浏览器当然是 Google Chrome (不接受任何反驳)，简洁无广告净化双眼；再配合其他插件 (<a href="http://tiramisutes.github.io/tiramisutes.github.io/2015/07/25/chrome.html">http://tiramisutes.github.io/tiramisutes.github.io/2015/07/25/chrome.html</a>) ，只能用如虎添翼来形容；<br><img src="/images/chrome.png" alt=""></p>
<h2 id="2-_文献检索">2. 文献检索</h2><p>最好用的当然也是无所不能的 Google (不接受任何反驳)；<br><img src="/images/paper2.png" alt=""><br>实在不行 NCBI 的PubMed也凑合，配合 Scholarscope (<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2Nob2xhcnNjb3BlLmNuLw==" title="http://blog.scholarscope.cn/">http://blog.scholarscope.cn/<i class="fa fa-external-link"></i></span>) 还可以显示期刊领域排名和IF等信息；<br><img src="/images/NCBI_PM.png" alt=""><br>对不起，请再也不要说不会下载文献 (sci-hub.tw)；<br><img src="/images/wenxian.png" alt=""><br><img src="/images/wenxian2.png" alt=""></p>
<h2 id="3-_NCBI_数据库">3. NCBI 数据库</h2><p>NCBI作为生物类主要数据库之一，查序列再顺手做个blast比对也是常规操作，看完下图让你以后的比对有更多的选择；<br><img src="/images/NCBI_BS.png" alt=""><br><img src="/images/NCBI_BS2.png" alt=""><br><img src="/images/NCBI_BS3.png" alt=""></p>
<h2 id="4-_文献管理">4. 文献管理</h2><p>文献最主要两种使用方式就是阅读和写文章时的引用，业内巨头EndNote大家很熟悉，但开源的Zotero其实可以弥补非正版EndNote的缺陷；身处云的时代怎么能没有同步功能，完全没有安全感；Zotero网页点击即可保存文献，文献管理、同步、甚至手机端阅读样样精通；<br><img src="/images/paper.png" alt=""></p>
<h2 id="5-_文本编辑">5. 文本编辑</h2><p>fasta等序列文件的察看，没有比较就没有伤害，同样的文件不同的打开方式，格然不同的阅读效果，轻量可打开绝大多文件类型且支持功能扩展的 Sublime (<span class="exturl" data-url="aHR0cDovL3d3dy5zdWJsaW1ldGV4dC5jb20v" title="http://www.sublimetext.com/">http://www.sublimetext.com/<i class="fa fa-external-link"></i></span>) 值得你拥有；<br><img src="/images/wenben.png" alt=""></p>
<h2 id="6-_数据安全">6. 数据安全</h2><p>有备无患，辛辛苦苦得来的实验数据实时备份准没错，硬盘和云端双保险最佳；免费版坚果云和会员版百度云可供选择；当然免费的经特殊处理也可以，详细见：<a href="http://tiramisutes.github.io/tiramisutes.github.io/2015/07/28/Linux-backup.html">Linux和windows定时备份数据到百度云盘</a></p>
<hr>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我是分隔线</p>
<hr>
<p>好了，如果你看到这里了，可选择性的配备你的工作站，开始接下来的进阶👇</p>
<h2 id="7-_序列比对">7. 序列比对</h2><p>windows基础版推荐简单方便且直观的 DNAMAN；<br><img src="/images/bidui.png" alt=""><br>如果你序列太多，则最好Linux下计算，软件首选目前公认比对精确度最高的，需要调节的参数比较少的 MAFFT；</p>
<h2 id="8-_进化构建">8. 进化构建</h2><p>NJ法，ML法，BI法是目前主流的建树方法，MP法目前相对用得较少，每种方法都有它一定的优点，同时也存在着缺点。因为进化树的构建是一个统计学问题，我们所构建出来的进化树只是对真实的进化关系的评估或者模拟。如果采用一个适当的方法，那么所构建的进化树就会接近真实的“进化树”，所以对于相同的数据集，推荐用两种及两种以上的方法建系统发育树进行分析，互相比照。</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>方法</strong></th>
<th style="text-align:center"><strong>适用范围</strong></th>
<th style="text-align:center"><strong>优点</strong></th>
<th style="text-align:center"><strong>缺点</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">邻接法 neighbor-joining (NJ)</td>
<td style="text-align:center">远缘序列且进化距离不大</td>
<td style="text-align:center">计算速度快，结果 相对准确</td>
<td style="text-align:center">序列上的所有位点都被同等对待，而所分析序列的进化距离不能太大</td>
</tr>
<tr>
<td style="text-align:center">最大似然法 maximum likelihood (ML)</td>
<td style="text-align:center">跨物种比较 ，有模型有模型的情况下ML是与进化事实最吻合的树</td>
<td style="text-align:center">很好的统计学基础，大样本时似然法可以获得参数统计的最小方差，在进化模型确定的情况下，ML法是与进化事实吻合最好的建树算法</td>
<td style="text-align:center">计算量大，耗时时间长；依赖于合适的替代模型。</td>
</tr>
<tr>
<td style="text-align:center">贝叶斯法 Bayesian</td>
<td style="text-align:center">大而复杂的数据集</td>
<td style="text-align:center">具有坚实的数学和统计学基础，可以处理复杂和接近实际情况的进化模型</td>
<td style="text-align:center">对进化模型敏感，涉及较多的统计学假设和参数</td>
</tr>
<tr>
<td style="text-align:center">最大简约法 maximum parsimony (MP)</td>
<td style="text-align:center">所要比较的序列的碱基差别小；对于序列上的每一个碱基有近似相等的变异率； 没有过多的颠换/转换的倾向；所检验的序列的碱基数目较多（大于几千个碱基）；</td>
<td style="text-align:center">某些特殊的分子数据如插入、缺失等序列</td>
<td style="text-align:center">只适于序列数目N≤12。存在较多回复突变或平行突变时，结果较差。推测的树不是唯一的，变异大的序列会出现长枝吸引而导致建树错误</td>
</tr>
</tbody>
</table>
<p>进化树分类通常为有根树和无根树，有根树反映树上物种（基因）进化的时间顺序，无根树只反映分类单元间的距离，不涉及共同祖先问题；<br><img src="/images/tree.png" alt=""></p>
<p>Bootstrape是常用的系统进化树评估优化方法，树枝上的Bootstrape检验值表示该分支通过检验的次数占总次数的百分比，其值大小（&gt;70）反映树枝的可信度；</p>
<p>windows下推荐MEGA，比对进化一步到位，支持最常用的ML和NJ算法；<br>如果你序列太多，则最好Linux下计算，软件推荐Phylip，RaxML，IQ-tree和MrBayes；</p>
<p>美化推荐<span class="exturl" data-url="aHR0cHM6Ly9pdG9sLmVtYmwuZGUvaW5kZXguc2h0bWw=" title="https://itol.embl.de/index.shtml">iTOL<i class="fa fa-external-link"></i></span>，反正用过的都说好；</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/BB.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;strong&gt;分子生物学（Molecular biology）&lt;/strong&gt;是对生物在分子层次上的研究，是生物学和化学之间跨学科的研究，其研究领域涵盖了遗传学、生物化学和生物物理学等学科。分子生物学主要致力于对细胞中不同系统之间相互作用的理解，包括DNA，RNA和蛋白质生物合成之间的关系以及了解它们之间的相互作用是如何被调控的。 在我们的研究中主要涉及基因功能和代谢通路解析；&lt;br&gt;&lt;strong&gt;生物信息学（Bioinformatics)&lt;/strong&gt;利用应用数学、信息学、统计学和计算机科学的方法研究生物学的问题。生物信息学的研究材料和结果就是各种各样的生物学数据，其研究工具是计算机，研究方法包括对生物学数据的搜索（收集和筛选）、处理（编辑、整理、管理和显示）及利用（计算、模拟）。当前主要的研究方向有：序列比对、序列组装、基因识别、基因重组、蛋白质结构预测、基因表达、蛋白质反应的预测，以及创建进化模型。&lt;br&gt;自迈克尔·沃特曼（Michael Waterman）率先将数学和计算方法引入生物学研究开始，如今这门交叉学科作为后起之秀正逐渐渗透到生物学研究的多个领域，21世纪是生命科学的世纪，但也是一个信息化的时代，如果做分子的不懂生信，做生信的不懂分子，如何让自己走的更远？&lt;br&gt;工欲善其事，必先利其器，各行各业都有其不二法宝，科研工作亦当如此；&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Biology" scheme="http://tiramisutes.github.io/tags/Biology/"/>
    
  </entry>
  
  <entry>
    <title>PacBio-BioNano-Genome数据上传NCBI经历</title>
    <link href="http://tiramisutes.github.io/2019/04/05/PBGNCBI.html"/>
    <id>http://tiramisutes.github.io/2019/04/05/PBGNCBI.html</id>
    <published>2019-04-05T01:28:11.000Z</published>
    <updated>2021-10-21T12:48:34.982Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/sra.png" alt=""><br><a id="more"></a></p>
<h2 id="1-_PacBio原始下机bam格式数据上传">1. PacBio原始下机bam格式数据上传</h2><p>自PacBio Sequel平台开始，PacBio原始下机数据均为bam格式，该如何上传NCBI呢？<br><img src="/images/PBG1.png" alt=""><br>NCBI的<strong>SRA_metadata_acc.xlsx</strong>文件提供PacBio格式为PacBio RS平台的HDF5格式，而第一个bam格式则认为是比对结果文件，需要在assembly列提供比对基因组信息；<br><img src="/images/PBG2.png" alt=""><br>这该如何是好？万能的NCBI工作人员给我们支招了👇</p>
<blockquote>
<p>For unaligned bam files please enter ‘unaligned’ in the ‘assembly’ column.</p>
</blockquote>
<h2 id="2-_BioNano数据上传">2. BioNano数据上传</h2><p>进入<span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi9zdWJzL3N1cGZpbGVzLw==" title="https://submit.ncbi.nlm.nih.gov/subs/supfiles/">Supplementary Files<i class="fa fa-external-link"></i></span>,选择BioNano原始Map数据或混合组装 (hybrid assembly) 过程数据上传；<br>根据<a href=""></a>介绍可选择文件类型为：CMAP，COORD (混合组装过程)，XMAP，SMAP (结构变异数据) 和下机数据BNX；</p>
<h2 id="3-_基因组数据上传">3. 基因组数据上传</h2><p>Denovo组装基因组上传时通常需上传测序相关原始数据，首先参考<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo0MDAwLzIwMTYvMDgvMzAvTkNCSS1zdWJtaXNzaW9uLmh0bWw=" title="http://localhost:4000/2016/08/30/NCBI-submission.html">测序数据上传NCBI总结<i class="fa fa-external-link"></i></span>提交专门上传基因组测序原始数据的BioProject和BioSample；<br>准备基因组<strong>fa(未注释基因组)/sqn(已注释基因组)</strong>格式文件，进入<span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi9zdWJzL2dlbm9tZS8=" title="https://submit.ncbi.nlm.nih.gov/subs/genome/">Genome<i class="fa fa-external-link"></i></span>上传；</p>
<h3 id="3-1_准备数据清单">3.1 准备数据清单</h3><ul>
<li>基因组fa/sqn文件</li>
<li>BioProject 号</li>
<li>BioSample 号</li>
<li>WGS 或 non-wgs genome<br>  <img src="/images/WGSorNot.png" alt=""></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9hc3NlbWJseS9hZ3AvQUdQX1NwZWNpZmljYXRpb24v" title="https://www.ncbi.nlm.nih.gov/assembly/agp/AGP_Specification/">AGP<i class="fa fa-external-link"></i></span>文件，可通过<span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wcm9qZWN0cy9nZW5vbWUvYXNzZW1ibHkvYWdwL2FncF92YWxpZGF0ZS5jZ2k=" title="https://www.ncbi.nlm.nih.gov/projects/genome/assembly/agp/agp_validate.cgi">AGP validation on-line<i class="fa fa-external-link"></i></span>进行文件格式确认或者<span class="exturl" data-url="ZnRwOi8vZnRwLm5jYmkubmloLmdvdi90b29sYm94L25jYmlfdG9vbHMvY29udmVydGVycy9ieV9wcm9ncmFtL2FncF92YWxpZGF0ZS8=" title="ftp://ftp.ncbi.nih.gov/toolbox/ncbi_tools/converters/by_program/agp_validate/">下载软件<i class="fa fa-external-link"></i></span>在命令行确认 (<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NqYWNrbWFuL2Zhc3Rhc2NyaXB0cy9ibG9iL21hc3Rlci9mYXRvYWdw" title="https://github.com/sjackman/fastascripts/blob/master/fatoagp">fatoagp<i class="fa fa-external-link"></i></span>可根据fa文件生成AGP文件; <span class="exturl" data-url="aHR0cHM6Ly93d3cuaG1wZGFjYy5vcmcvZG9jL2Zhc3RhMmFwZy5wbA==" title="https://www.hmpdacc.org/doc/fasta2apg.pl">fasta2apg.pl<i class="fa fa-external-link"></i></span>根据fa文件生成AGP文件且输出分隔的contig.fa和scaffold.fa)</li>
<li>其他可选注释信息</li>
</ul>
<h2 id="4-_tbl2asn_使用">4. tbl2asn 使用</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9nZW5iYW5rL3RibDJhc24y" title="https://www.ncbi.nlm.nih.gov/genbank/tbl2asn2">tbl2asn<i class="fa fa-external-link"></i></span>主要用于命令行下生成 <code>gb</code> 或 <code>sqn</code> 格式文件来提交数据到GenBank数据库；<br>直接输入<code>tbl2asn -</code>来察看详细参数；<br>详细准备数据见： <span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQks1MzcwOS8jX2diYW5rcXVpY2tzdGFydF9TdWJtaXNzaW9uX3VzaW5nX3RibDJhc25f" title="https://www.ncbi.nlm.nih.gov/books/NBK53709/#_gbankquickstart_Submission_using_tbl2asn_">Submission using tbl2asn<i class="fa fa-external-link"></i></span>，即新建目录来存储相关数据，且除<code>template.sbt</code>外，其他文件均使用相同前缀名称；<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">template.sbt (this is the only file whose<span class="built_in"> prefix </span>is different. Leave the<span class="built_in"> prefix </span>as is).</span><br><span class="line">chr01.fsa</span><br><span class="line">chr01.tbl</span><br><span class="line">chr01.qvl</span><br></pre></td></tr></table></figure></p>
<h3 id="4-1_特殊参数解释">4.1 特殊参数解释</h3><ul>
<li><code>-i</code> 指定fa文件名，且一定不能包含路径，只能是文件名;</li>
<li><code>-M</code> 参数会覆盖部分其他参数；</li>
<li><code>-l</code> 只有当 <code>-M</code> 设置为 <code>t</code> 时才可用；</li>
<li><code>-a s</code>： fa文件包含多个序列，结果生成单个提交文件；</li>
</ul>
<h3 id="4-2_运行实例">4.2 运行实例</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd NCBI_Genome</span><br><span class="line">linux64<span class="selector-class">.tbl2asn</span> -<span class="selector-tag">p</span> . -r . -t template<span class="selector-class">.sbt</span> -<span class="selector-tag">i</span> genome<span class="selector-class">.fa</span> -<span class="selector-tag">a</span> s -j <span class="string">"[organism=xx][genotype=xx][tech=wgs][country=China]"</span> -V vbgt -k c -Z discrep<span class="selector-class">.txt</span> -N <span class="number">1.0</span> -L T -n xx</span><br></pre></td></tr></table></figure>
<h3 id="4-3_流程化运行">4.3 流程化运行</h3><p>请参考： <a href="https://tiramisutes.github.io/Genome_Scripts/">WGS2NCBI - toolkit for preparing genomes for submission to NCBI</a></p>
<h2 id="5-_fasta+GFF_转_Genebank/EMBL">5. fasta+GFF 转 Genebank/EMBL</h2><p>参考 <a href="https://tiramisutes.github.io/Genome_Scripts/">Genome_Scripts</a> 项目👇<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="string">"""Convert a GFF and associated FASTA file into GenBank format.</span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">    gff_convert.py -f genbank -s &lt;GFF annotation file&gt; &lt;FASTA sequence file&gt;</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Bio <span class="keyword">import</span> SeqIO</span><br><span class="line"><span class="keyword">from</span> Bio.Alphabet <span class="keyword">import</span> generic_dna</span><br><span class="line"><span class="keyword">from</span> Bio <span class="keyword">import</span> Seq</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> BCBio <span class="keyword">import</span> GFF</span><br><span class="line"></span><br><span class="line">parser=argparse.ArgumentParser(</span><br><span class="line">    description=<span class="string">'''Script that converts GFF + Fasta to GBK or EMBL '''</span>,</span><br><span class="line">    epilog=<span class="string">"""hope (2019)  http://tiramisutes.github.io/2019/04/05/PBGNCBI.html"""</span>)</span><br><span class="line">parser.add_argument(<span class="string">"gff"</span>, help=<span class="string">'GFF file'</span>)</span><br><span class="line">parser.add_argument(<span class="string">"fasta"</span>, help=<span class="string">'Fasta file'</span>)</span><br><span class="line">parser.add_argument(<span class="string">"-f"</span>, <span class="string">"--format"</span>, choices=[<span class="string">'genbank'</span>, <span class="string">'embl'</span>])</span><br><span class="line">parser.add_argument(<span class="string">"-s"</span>,<span class="string">"--split"</span>, action=<span class="string">'store_true'</span>, help=<span class="string">'Split output into single files, 1 per contig'</span>)</span><br><span class="line">parser.add_argument(<span class="string">"-o"</span>,<span class="string">"--output"</span>, help=<span class="string">'Set the directory of output file/files'</span>)</span><br><span class="line">args=parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">    parser.print_usage()</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_fix_ncbi_id</span><span class="params">(fasta_iter)</span>:</span></span><br><span class="line">    <span class="string">"""GenBank identifiers can only be 16 characters; try to shorten NCBI.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> rec <span class="keyword">in</span> fasta_iter:</span><br><span class="line">        <span class="keyword">if</span> len(rec.name) &gt; <span class="number">16</span> <span class="keyword">and</span> rec.name.find(<span class="string">"|"</span>) &gt; <span class="number">0</span>:</span><br><span class="line">            new_id = [x <span class="keyword">for</span> x <span class="keyword">in</span> rec.name.split(<span class="string">"|"</span>) <span class="keyword">if</span> x][<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Warning: shortening NCBI name %s to %s"</span> % (rec.id, new_id)</span><br><span class="line">            rec.id = new_id</span><br><span class="line">            rec.name = new_id</span><br><span class="line">        <span class="keyword">yield</span> rec</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_check_gff</span><span class="params">(gff_iterator)</span>:</span></span><br><span class="line">    <span class="string">"""Check GFF files before feeding to SeqIO to be sure they have sequences.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> rec <span class="keyword">in</span> gff_iterator:</span><br><span class="line">        <span class="keyword">if</span> isinstance(rec.seq, Seq.UnknownSeq):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Warning: FASTA sequence not found for '%s' in GFF file"</span> % (</span><br><span class="line">                    rec.id)</span><br><span class="line">            rec.seq.alphabet = generic_dna</span><br><span class="line">        <span class="keyword">yield</span> _flatten_features(rec)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_flatten_features</span><span class="params">(rec)</span>:</span></span><br><span class="line">    <span class="string">"""Make sub_features in an input rec flat for output.</span></span><br><span class="line"><span class="string">    GenBank does not handle nested features, so we want to make</span></span><br><span class="line"><span class="string">    everything top level.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> rec.features:</span><br><span class="line">        cur = [f]</span><br><span class="line">        <span class="keyword">while</span> len(cur) &gt; <span class="number">0</span>:</span><br><span class="line">            nextf = []</span><br><span class="line">            <span class="keyword">for</span> curf <span class="keyword">in</span> cur:</span><br><span class="line">                out.append(curf)</span><br><span class="line">                <span class="keyword">if</span> len(curf.sub_features) &gt; <span class="number">0</span>:</span><br><span class="line">                    nextf.extend(curf.sub_features)</span><br><span class="line">            cur = nextf</span><br><span class="line">    rec.features = out</span><br><span class="line">    <span class="keyword">return</span> rec</span><br><span class="line"></span><br><span class="line">gff_file = args.gff</span><br><span class="line">fasta_file = args.fasta</span><br><span class="line">format = args.format</span><br><span class="line">output_dir = args.output</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> args.split:</span><br><span class="line">    <span class="keyword">if</span> format == <span class="string">"genbank"</span>:</span><br><span class="line">        print(<span class="string">"Output set to "</span> + format + <span class="string">", splitting files and writting individual records to directory: "</span> + output_dir)</span><br><span class="line">        fasta_input = SeqIO.to_dict(SeqIO.parse(fasta_file, <span class="string">"fasta"</span>, generic_dna))</span><br><span class="line">        <span class="keyword">for</span> rec <span class="keyword">in</span> GFF.parse(gff_file, fasta_input):</span><br><span class="line">            SeqIO.write(_check_gff(_fix_ncbi_id([rec])), open(output_dir + <span class="string">"/"</span> + rec.id + <span class="string">".gbk"</span>, <span class="string">"w"</span>), <span class="string">"genbank"</span>)</span><br><span class="line">    <span class="keyword">if</span> format == <span class="string">"embl"</span>:</span><br><span class="line">        print(<span class="string">"Output set to "</span> + format + <span class="string">", splitting files and writting individual records to directory: "</span> + output_dir)</span><br><span class="line">        fasta_input = SeqIO.to_dict(SeqIO.parse(fasta_file, <span class="string">"fasta"</span>, generic_dna))</span><br><span class="line">        <span class="keyword">for</span> rec <span class="keyword">in</span> GFF.parse(gff_file, fasta_input):</span><br><span class="line">            SeqIO.write(_check_gff(_fix_ncbi_id([rec])), open(output_dir + <span class="string">"/"</span> + rec.id + <span class="string">".embl"</span>, <span class="string">"w"</span>), <span class="string">"embl"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">if</span> format == <span class="string">"genbank"</span>:</span><br><span class="line">        out_file = output_dir + <span class="string">"/%s.gb"</span> % os.path.splitext(os.path.basename(gff_file))[<span class="number">0</span>]</span><br><span class="line">        print(<span class="string">"Output set to "</span> + format + <span class="string">", writing file to "</span> + out_file)</span><br><span class="line">        fasta_input = SeqIO.to_dict(SeqIO.parse(fasta_file, <span class="string">"fasta"</span>, generic_dna))</span><br><span class="line">        gff_iter = GFF.parse(gff_file, fasta_input)</span><br><span class="line">        SeqIO.write(_check_gff(_fix_ncbi_id(gff_iter)), out_file, <span class="string">"genbank"</span>)</span><br><span class="line">    <span class="keyword">if</span> format == <span class="string">"embl"</span>:</span><br><span class="line">        out_file = output_dir + <span class="string">"/%s.embl"</span> % os.path.splitext(os.path.basename(gff_file))[<span class="number">0</span>]</span><br><span class="line">        print(<span class="string">"Output set to "</span> + format + <span class="string">", writing file to "</span> + out_file)</span><br><span class="line">        fasta_input = SeqIO.to_dict(SeqIO.parse(fasta_file, <span class="string">"fasta"</span>, generic_dna))</span><br><span class="line">        gff_iter = GFF.parse(gff_file, fasta_input)</span><br><span class="line">        SeqIO.write(_check_gff(_fix_ncbi_id(gff_iter)), out_file, <span class="string">"embl"</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="6-_通过FileZilla上传">6. 通过FileZilla上传</h2><p>完成SRA前面内容填充后即可到如下页面，记得使用FileZilla提交时一定要设置<strong>Remote Site</strong>。<br><img src="/images/NCBIfilezilla.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/sra.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="NCBI_submission" scheme="http://tiramisutes.github.io/tags/NCBI-submission/"/>
    
  </entry>
  
  <entry>
    <title>Nature Communications | 苹果为什么那么红</title>
    <link href="http://tiramisutes.github.io/2019/04/03/apple.html"/>
    <id>http://tiramisutes.github.io/2019/04/03/apple.html</id>
    <published>2019-04-03T05:14:26.000Z</published>
    <updated>2019-04-03T13:39:19.126Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/RedApple.jpg" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;研究表明，苹果的祖先原是灌木，大约6000万年前地球遭遇巨型陨石袭击时，大量灰尘被推入大气层中，遮蔽了阳光，降低了植物的光合作用，进而对全球各地的生态系统造成毁灭性的影响，令地球上的大部分生物包括恐龙灭绝，而苹果的祖先却死里逃生，通过进化获得了新生。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;苹果、葡萄、柑桔和香蕉并称为世界四大水果，而苹果更是四大水果之冠。“一天一个苹果”是人们熟知的健康口号。自19世纪起威尔士就有俗语说明苹果和健康的关系：“一天一苹果，医生远离我”（An apple a day keeps the doctor away）。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;的确，苹果含有丰富的糖类、有机酸、纤维素、维生素、矿物质、多酚及黄酮类营养物质，被科学家称为“全方位的健康水果”。依照美国农业部的数据，一份约重242克的苹果热量为126卡，含有大量的膳食纤维及维他命C。苹果皮中含有许多不确定营养价值的植物化学成分，在体外实验中可能有抗氧化作用。苹果中含有槲皮素、儿茶素及原花色素B2等酚类物质。【维基百科：苹果】<br><a id="more"></a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同时苹果也是蔷薇科中种类最多和最具经济效益的水果，所以不仅在生活中受人们喜欢，在科学研究中也备受青睐。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;苹果基因组对于遗传研究和育种（抗寒，口味，成熟期等）具有重要的意义，同样高质量的染色体级参考基因组（High quality chromosome-scale reference genome）能够更加真实的反应物种基因组信息；截至目前为止（2019年4月），共有4篇高水平文章报道了苹果基因组研究情况。<br><img src="/images/AppleGenome.png" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;基因组研究揭示苹果其实是接受了部分“西方价值观”的亚洲移民【<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ3Vva3IuY29tL2FydGljbGUvNDQwNzczLw==" title="https://www.guokr.com/article/440773/">果壳 | 苹果：饱含历史又饱受沧桑<i class="fa fa-external-link"></i></span>】。2017年国际著名学术期刊 Nature Communications 更是以 《<span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE0NjctMDE3LTAwMzM2LTc=" title="https://www.nature.com/articles/s41467-017-00336-7">Genome re-sequencing reveals the history of apple and supports a two-stage model for fruit enlargement<i class="fa fa-external-link"></i></span>》为题在分子水平上揭示了苹果起源、演化和驯化的规律，<strong>并证明世界栽培苹果起源于我国新疆</strong>。<br><img src="/images/apple2.png" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;苹果基因组中首先被测序的是二倍体品种金冠苹果（<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvR29sZGVuX0RlbGljaW91cw==" title="https://en.wikipedia.org/wiki/Golden_Delicious">Golden Delicious<i class="fa fa-external-link"></i></span>），在2017年 Nature Genetics 文章中其基因组Scaffolds N50已达到5.558Mb，属高质量参考基因组水平，通过基因组信息揭示了发生于21MYA前的转座子（transposable elements）爆炸式扩增与天山山脉（苹果的起源中心）的隆起时期相吻合，表明 TEs 在苹果祖先种的多样化和与梨的分歧中起到重要的作用；<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2019年4月2日，国际著名学术期刊 Nature Communications 以 《A high-quality apple genome assembly reveals the association of a retrotransposon and red fruit colour》 为题发表了来自中国农科院（辽宁）等单位联合的苹果基因组最新成果，在基因组水平揭示了苹果为什么那么红的原因。<br><img src="/images/Hanfuapple.png" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;既然已经有高质量参考基因组那么还有必要再测一个吗？当然有，如同人类基因组计划和精准医疗，金冠苹果（Golden Delicious）是美国主栽品种，而中国苹果常栽品种可分为：元帅系，金冠系和富士系，且中国苹果现在栽种面积最大的是富士系苹果，以红富士为主要的栽种品种 (<span class="exturl" data-url="aHR0cDovL2R5LjE2My5jb20vdjIvYXJ0aWNsZS9kZXRhaWwvRE5KNkU3QlMwNTM4MFgyUy5odG1s" title="http://dy.163.com/v2/article/detail/DNJ6E7BS05380X2S.html">苹果种类及中国苹果常栽品种<i class="fa fa-external-link"></i></span>)：</p>
<hr>
<ul>
<li>元帅系：1872年在美国爱德华州与“钟花”苹果的根苗中发现的，1894年命名，1895年开始推广，又名蛇果。</li>
<li>金冠系：19世纪末在美国弗吉尼亚州发现，果实较大，又名黄元帅，金帅，为一重要的高产品种，成熟后表面金黄，甜酸爽口。</li>
<li>富士系：由日本农林水产省果树试验场盛冈分场培育，1962年命名，1966年引入中国，统称为红富士，目前已选出100多个品系。红富士是世界上最著名的晚熟品种，果实有风味好，晚熟，耐储存等优点，现在是世界上栽种面积最大的品种。</li>
</ul>
<hr>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次测序品种 Hanfu (Dongguang x <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRnVqaV8oYXBwbGU=" title="https://en.wikipedia.org/wiki/Fuji_(apple">Fuji<i class="fa fa-external-link"></i></span>)) (<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQUYlOTIlRTUlQUYlOEMlRTglOEIlQjklRTYlOUUlOUMvNjExNTkyOT9mcj1hbGFkZGlu" title="https://baike.baidu.com/item/%E5%AF%92%E5%AF%8C%E8%8B%B9%E6%9E%9C/6115929?fr=aladdin">寒富苹果<i class="fa fa-external-link"></i></span>)，是沈阳农业大学于1978年以抗寒性强而果实品质差的东光为母本与果实品质极上而抗寒性差的富士为父本进行杂交，选育出的抗寒、丰产、果实品质优、短枝性状明显的优良苹果品种。【摘自百度百科】 该品种尽管与金冠属相同种（Species），但因生长环境和杂交亲本不同，其表型和基因组间必然会存在差异，获取该栽培种的特定基因组信息对于了解基因组进化过程和阐明复杂性状的遗传具有重要意义；<br><img src="/images/Overapple.png" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过联合 Illumina paired-end short reads, PacBio single-molecule real-time (SMRT) sequencing, chromosome conformation capture (Hi-C) sequencing 和 optical mapping 技术，得到了基因组大小为658.90 Mb，Scaffold N50达37.14Mb的纯合系HFTH1苹果基因组。通过与金冠苹果（Golden Delicious）基因组的比较，共鉴定出18,047个缺失，12,101个插入和14个大片段的<span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXQuY2xvdWQuZWR1LnR3L2NvbnRlbnQvanVuaW9yL2Jpby90Y193Yy90ZXh0Ym9vay9jaDA4L3N1cHBseTgtNC0wLmh0bQ==" title="https://market.cloud.edu.tw/content/junior/bio/tc_wc/textbook/ch08/supply8-4-0.htm">倒位<i class="fa fa-external-link"></i></span>，且活跃的转座子是造成基因组内广泛的变异发生的主要原因。更重要的是基因组水平研究揭示了一个长末端重复反转录转座子插入到<em>MdMYB1</em>基因的上游与苹果的红色果皮表型相关联，而<em>MdMYB1</em>转录因子是调控花青素合成的核心<span class="exturl" data-url="aHR0cHM6Ly9kd3ouY24vU2xWa2pzTWU=" title="https://dwz.cn/SlVkjsMe">转录激活因子<i class="fa fa-external-link"></i></span>，这解释了苹果为什么会变红的分子机制，同时高质量的参考基因组也为解密苹果的重要农艺性状奠定了基础。。<br><img src="/images/apple3.png" alt=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;该研究受到农业科技创新计划（No.CAAS-ASTIP-2016-RIP-02 和 CAAS-XTCX2016），中国农业研究系统专项资金（No.CARS-27）和中央公益性科研机构基础研究经费（No.1610182016020 和 Y2019XK09）的支持。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/RedApple.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;研究表明，苹果的祖先原是灌木，大约6000万年前地球遭遇巨型陨石袭击时，大量灰尘被推入大气层中，遮蔽了阳光，降低了植物的光合作用，进而对全球各地的生态系统造成毁灭性的影响，令地球上的大部分生物包括恐龙灭绝，而苹果的祖先却死里逃生，通过进化获得了新生。&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;苹果、葡萄、柑桔和香蕉并称为世界四大水果，而苹果更是四大水果之冠。“一天一个苹果”是人们熟知的健康口号。自19世纪起威尔士就有俗语说明苹果和健康的关系：“一天一苹果，医生远离我”（An apple a day keeps the doctor away）。&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;的确，苹果含有丰富的糖类、有机酸、纤维素、维生素、矿物质、多酚及黄酮类营养物质，被科学家称为“全方位的健康水果”。依照美国农业部的数据，一份约重242克的苹果热量为126卡，含有大量的膳食纤维及维他命C。苹果皮中含有许多不确定营养价值的植物化学成分，在体外实验中可能有抗氧化作用。苹果中含有槲皮素、儿茶素及原花色素B2等酚类物质。【维基百科：苹果】&lt;br&gt;
    
    </summary>
    
      <category term="文献" scheme="http://tiramisutes.github.io/categories/%E6%96%87%E7%8C%AE/"/>
    
    
      <category term="基因组" scheme="http://tiramisutes.github.io/tags/%E5%9F%BA%E5%9B%A0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>纳米孔测序系列之基础介绍</title>
    <link href="http://tiramisutes.github.io/2019/03/12/Oxford-Nanopore.html"/>
    <id>http://tiramisutes.github.io/2019/03/12/Oxford-Nanopore.html</id>
    <published>2019-03-12T13:39:59.000Z</published>
    <updated>2019-03-12T15:21:03.081Z</updated>
    
    <content type="html"><![CDATA[<h2 id="纳米孔测序技术">纳米孔测序技术</h2><p><img src="/images/NANOPORE.png" alt=""><br>纳米孔测序技术（<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tLw==" title="https://nanoporetech.com/">Oxford Nanopore Technologies<i class="fa fa-external-link"></i></span>, 又称第四代测序技术）是最近几年兴起的新一代测序技术。<br>目前市场上广泛接受的纳米孔测序平台是Oxford Nanopore Technologies（ONT）公司的<strong>MinION</strong>，<strong>GridION X5</strong> 和 <strong>PromethION</strong> 三款不同类型测序仪。ONT测序的特点是单分子测序，测序读长长，测序速度快，测序数据实时监控，机器方便携带等。<br>据<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvSW05RHhVQ0x5N0V0cVBYMDNHNTFEUQ==" title="https://mp.weixin.qq.com/s/Im9DxUCLy7EtqPX03G51DQ">百迈客公布的不同物种实测数据显示<i class="fa fa-external-link"></i></span>：</p>
<blockquote>
<p><strong>基因组:</strong> 目前测序平均reads长度在20Kb以上，最长reads的N50高达48kKb左右，而最长reads可达到惊人的1.29M；<br><strong>转录组:</strong> raw data数据量在2.5~4.4Gb，reads数为2.8~3.9M，其中N50在1.5kb左右，平均长度为1.0kb，平均质量值Q7以上。在对其进行质控后，其基因组比对率在85%左右。</p>
</blockquote>
<a id="more"></a>
<p>读长和数据正确性是人们最为关心的两个方面，记得Nanopore测序器公布之初最大的缺陷就是超高的测序错误率 (5-15%)，同样据<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvSW05RHhVQ0x5N0V0cVBYMDNHNTFEUQ==" title="https://mp.weixin.qq.com/s/Im9DxUCLy7EtqPX03G51DQ">百迈客公布结果显示<i class="fa fa-external-link"></i></span>经过ONT公司科研人员的不断努力，目前的测序结果不仅有超长的测序读长，<strong>下机数据碱基的平均准确率达到~86% (未经过纠错与polish的数据), 且与PacBio的准确率 (~85%)相当。而且组装后经过纠错与polish后碱基的准确度均在99.99%以上。</strong></p>
<h2 id="工作原理">工作原理</h2><p>在充满电解液的腔内，带有纳米级小孔的绝缘防渗膜将腔体分成2个小室，如图1，当电压作用于电解液室，离子或其他小分子物质可穿过小孔，形成稳定的可检测的离子电流。掌握纳米孔的尺寸和表面特性、施加的电压及溶液条件，可检测不同类型的生物分子。<br>由于组成DNA的四种碱基腺嘌呤(A)、鸟嘌呤(G)、胞嘧啶(C)和胸腺嘧啶(T)的分子结构及体积大小均不同，单链DNA(ssDNA)在核酸外切酶的作用下被迅速逐一切割成脱氧核糖核苷酸分子，当单个碱基在电场驱使下通过纳米级的小孔时，不同碱基的化学性质差异导致穿越纳米孔时引起的电流的变化幅度不同，从而得到所测DNA的序列信息。<br><img src="https://i.imgur.com/jIBFldt.jpg" alt=""></p>
<h2 id="测序过程">测序过程</h2><p><img src="https://nanoporetech.com/sites/default/files/s3/sequencing-animated.gif" alt=""><br>MinION纳米孔测序仪的核心是一个有2,048个纳米孔，分成512组，由专用集成电路控制的flow cell。测序原理见下图a所示：首先，将双分子DNA连接lead adaptor（蓝色），hairpin adaptor（红色）和trailing adaptor（棕色）；当测序开始，lead adaptor带领测序分子进入由酶控制的纳米孔，lead adaptor后是template read（即待测序的DNA分子）通过纳米孔，hairpin adaptor的作用是DNA双链测序的保证，然后complement read（待测序分子的互补链）通过纳米孔，最后是trailing adaptor通过。在上述测序方法中，template read和complement read依次通过纳米孔，利用pairwise alignment，它们组合成2D read；而在另外一种测序方法中，不使用hairpin adaptor，只测序template read，最终形成1D read。后一种测序方法通量更高，但是测序准确性低于2D read。每个接头序列（adaptor）通过纳米孔引起的电流变化不同（图1c），这种差别可以用来做碱基识别。<br><img src="http://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fs13059-016-1103-0/MediaObjects/13059_2016_1103_Fig1_HTML.gif" alt=""></p>
<h2 id="测序平台简介">测序平台简介</h2><h3 id="MinION">MinION</h3><p>ONT最知名产品，仅有U盘大小，插入普通PC电脑即可运行，曾登上国际空间站，完成太空测序；MinION一次可运行一个flow cells，产出约10-30Gb的测序数据，运行时长约48小时；</p>
<h3 id="GridION">GridION</h3><p>GridION X5系统的测序部分包含五个 flow cells，这些flow cells可单独使用或协同使用，并通过USB连接到计算机。利用现有的试剂和软件每运行48小时可生成高达150GB的测序数据。GridION X5的出现填补了MinION和PromethION之间的空白。</p>
<h3 id="PromethION">PromethION</h3><p>PromethION是ONT推出的最新款超高通量测序设备，它支持实时、长读长、直接DNA和RNA测序工作流程。PromethION一次可运行24 (PromethION 24) 到48 (PromethION 48) 个测序芯片，按照每张测序芯片包含3,000个纳米孔通道，所有芯片同时运行将可产出高达7.6Tb甚至是15Tb的数据，这能够满足超高通量的、快速周转测序需求。适用于大规模群体遗传学研究和大型动植物基因组测序项目；</p>
<h2 id="应用领域">应用领域</h2><h3 id="基因组组装">基因组组装</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL1dHU19Bc3NlbWJseV93aGl0ZV9wYXBlci5wZGY/c3VibWlzc2lvbkd1aWQ9NDBhNzU0NmItOWU1MS00MmU3LWJkZTktYjVkZGVmM2MzNTEy" title="https://nanoporetech.com/sites/default/files/s3/white-papers/WGS_Assembly_white_paper.pdf?submissionGuid=40a7546b-9e51-42e7-bde9-b5ddef3c3512">Nanopore sequencing The advantages of long reads for genome assembly<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/oKux1MP.jpg" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Assembler name</strong></th>
<th style="text-align:center">Algorithms</th>
<th style="text-align:center">Errorcorrection</th>
<th style="text-align:center">Link</th>
<th style="text-align:center">Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LQS</td>
<td style="text-align:center">DALIGNER,  Celera OLC</td>
<td style="text-align:center">Nanocorrect, Nanopolish</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2p0cy9uYW5vcG9saXNo" title="https://github.com/jts/nanopolish">https://github.com/jts/nanopolish<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Loman (2015)</td>
</tr>
<tr>
<td style="text-align:center">Canu</td>
<td style="text-align:center">MHAP,  Celera OLC</td>
<td style="text-align:center">Canu</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmJsL2NhbnU=" title="https://github.com/marbl/canu">https://github.com/marbl/canu<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Berlin (2015)</td>
</tr>
<tr>
<td style="text-align:center">Canu</td>
<td style="text-align:center">MHAP,  Celera OLC</td>
<td style="text-align:center">Racon, Pilon</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25hbm9wb3JldGVjaC9vbnQtYXNzZW1ibHktcG9saXNo" title="https://github.com/nanoporetech/ont-assembly-polish">https://github.com/nanoporetech/ont-assembly-polish<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">nanoporetech</td>
</tr>
<tr>
<td style="text-align:center">Miniasm</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoMy9taW5pYQ==" title="https://github.com/lh3/minia">https://github.com/lh3/minia<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Li (2016)</td>
</tr>
<tr>
<td style="text-align:center">Miniasm</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center">Racon</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2lzb3ZpYy9yYWNvbg==" title="https://github.com/isovic/racon">https://github.com/isovic/racon<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Vaser (2017)</td>
</tr>
<tr>
<td style="text-align:center">Ra-integrate</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmlva29zdGVsYWMvcmEtaW50ZWdyYXRlLw==" title="https://github.com/mariokostelac/ra-integrate/">https://github.com/mariokostelac/ra-integrate/<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Sovic (2016)</td>
</tr>
<tr>
<td style="text-align:center">ALLPATHS-LG</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center">ALLPATHS-LG</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly93d3cuYnJvYWRpbnN0aXR1dGUub3JnL3NvZnR3YXJlL2FsbHBhdGhzbGcvYmxvZy8/cGFnZV9pZA==" title="https://www.broadinstitute.org/software/allpathslg/blog/?page_id">https://www.broadinstitute.org/software/allpathslg/blog/?page_id<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Gnerrea (2011)</td>
</tr>
<tr>
<td style="text-align:center">SPAdes</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center">SPAdes</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cDovL2Jpb2luZi5zcGJhdS5ydS9zcGFkZXM=" title="http://bioinf.spbau.ru/spades">http://bioinf.spbau.ru/spades<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Bankevich (2012)</td>
</tr>
<tr>
<td style="text-align:center">SMART  denovo</td>
<td style="text-align:center">Smith-Waterm, dot matrix</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3J1YW5qdWUvc21hcnRkZW5vdm8=" title="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Ruan</td>
</tr>
<tr>
<td style="text-align:center">ABruijn</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZlbmRlcmdsYXNzL0FCcnVpam4=" title="https://github.com/fenderglass/ABruijn">https://github.com/fenderglass/ABruijn<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Lin (2016)</td>
</tr>
</tbody>
</table>
<h3 id="宏基因租">宏基因租</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL094Zm9yZCUyME5hbm9wb3JlJTIwV2hpdGVwYXBlciUyMC0lMjBNZXRhZ2Vub21pY3MucGRmP3N1Ym1pc3Npb25HdWlkPWZmN2E1YmQxLThiYTgtNDE0Mi1hYzJmLTA0ZWNjYjk2NzE3OQ==" title="https://nanoporetech.com/sites/default/files/s3/white-papers/Oxford%20Nanopore%20Whitepaper%20-%20Metagenomics.pdf?submissionGuid=ff7a5bd1-8ba8-4142-ac2f-04eccb967179">Nanopore sequencing Addressing the challenges of metagenomics for environmental and clinical research<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/8inx1GT.jpg" alt=""></p>
<h3 id="变异分析">变异分析</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL1N0cnVjdHVyYWwlMjB2YXJpYXRpb25fd2hpdGUlMjBwYXBlcl9GSU5BTC5wZGY/c3VibWlzc2lvbkd1aWQ9ODIwNGNjMTYtYTllZi00NTAwLWE3NjAtMzRjYmVlZGZlN2Jh" title="https://nanoporetech.com/sites/default/files/s3/white-papers/Structural%20variation_white%20paper_FINAL.pdf?submissionGuid=8204cc16-a9ef-4500-a760-34cbeedfe7ba">Nanopore sequencing The application and advantages of long-read nanopore sequencing to structural variation analysis<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/TOxo5KZ.jpg" alt=""></p>
<h3 id="甲基化分析">甲基化分析</h3><p>结合ONT单分子长读长的实时测序特性，ONT甲基化数据能够真实的还原碱基修饰信息，得到准确和类型丰富的检测结果；</p>
<hr>
<h2 id="参考资料">参考资料</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/c3JjPTExJmFtcDt0aW1lc3RhbXA9MTUwODU0OTI5NiZhbXA7dmVyPTQ2NSZhbXA7c2lnbmF0dXJlPTB5NHdwTDV0dXlMVHkxeHprS0RVSjhvemRMcUVOVFZqVWxZQzIwb2lRNllSNEZsLTFiOEZoaURUVnIwdXA4Z0c4aXI4YnRZNjA5c2tGaUJkWHc0dGNSaXVxYXZGT1JqNm44RG56REtzaG83a3hxT1F5Mzh0KjEyNzZTYzVZZ3hyJmFtcDtuZXc9MQ==" title="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1508549296&amp;ver=465&amp;signature=0y4wpL5tuyLTy1xzkKDUJ8ozdLqENTVjUlYC20oiQ6YR4Fl-1b8FhiDTVr0up8gG8ir8btY609skFiBdXw4tcRiuqavFORj6n8DnzDKsho7kxqOQy38t*1276Sc5Ygxr&amp;new=1">纳米孔测序技术发展简介<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvekJHWXllQTktbWlFZ25ZdGgxVFQtUQ==" title="https://mp.weixin.qq.com/s/zBGYyeA9-miEgnYth1TT-Q">全面解读第四代测序技术<i class="fa fa-external-link"></i></span></li>
<li>Jain, Miten, et al. “<span class="exturl" data-url="aHR0cHM6Ly9nZW5vbWViaW9sb2d5LmJpb21lZGNlbnRyYWwuY29tL2FydGljbGVzLzEwLjExODYvczEzMDU5LTAxNi0xMTAzLTA=" title="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1103-0">The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community.<i class="fa fa-external-link"></i></span>“ Genome biology 17.1 (2016): 239.</li>
<li>Leggett, Richard M., and Matthew D. Clark. “<span class="exturl" data-url="aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2p4Yi9hcnRpY2xlLWFic3RyYWN0L2RvaS8xMC4xMDkzL2p4Yi9lcngyODkvNDA5MzA1MC9BLXdvcmxkLW9mLW9wcG9ydHVuaXRpZXMtd2l0aC1uYW5vcG9yZS1zZXF1ZW5jaW5n" title="https://academic.oup.com/jxb/article-abstract/doi/10.1093/jxb/erx289/4093050/A-world-of-opportunities-with-nanopore-sequencing">A world of opportunities with nanopore sequencing<i class="fa fa-external-link"></i></span>.” Journal of Experimental Botany (2017): erx289.</li>
</ol>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;纳米孔测序技术&quot;&gt;纳米孔测序技术&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/images/NANOPORE.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;纳米孔测序技术（&lt;a href=&quot;https://nanoporetech.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Oxford Nanopore Technologies&lt;/a&gt;, 又称第四代测序技术）是最近几年兴起的新一代测序技术。&lt;br&gt;目前市场上广泛接受的纳米孔测序平台是Oxford Nanopore Technologies（ONT）公司的&lt;strong&gt;MinION&lt;/strong&gt;，&lt;strong&gt;GridION X5&lt;/strong&gt; 和 &lt;strong&gt;PromethION&lt;/strong&gt; 三款不同类型测序仪。ONT测序的特点是单分子测序，测序读长长，测序速度快，测序数据实时监控，机器方便携带等。&lt;br&gt;据&lt;a href=&quot;https://mp.weixin.qq.com/s/Im9DxUCLy7EtqPX03G51DQ&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;百迈客公布的不同物种实测数据显示&lt;/a&gt;：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;基因组:&lt;/strong&gt; 目前测序平均reads长度在20Kb以上，最长reads的N50高达48kKb左右，而最长reads可达到惊人的1.29M；&lt;br&gt;&lt;strong&gt;转录组:&lt;/strong&gt; raw data数据量在2.5~4.4Gb，reads数为2.8~3.9M，其中N50在1.5kb左右，平均长度为1.0kb，平均质量值Q7以上。在对其进行质控后，其基因组比对率在85%左右。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="ONS" scheme="http://tiramisutes.github.io/tags/ONS/"/>
    
  </entry>
  
  <entry>
    <title>研究人员的工作环境</title>
    <link href="http://tiramisutes.github.io/2019/03/12/Began-Study.html"/>
    <id>http://tiramisutes.github.io/2019/03/12/Began-Study.html</id>
    <published>2019-03-12T12:47:19.000Z</published>
    <updated>2019-03-16T13:54:09.747Z</updated>
    
    <content type="html"><![CDATA[<p>工欲善其事，必先利其器，各行各业都有其不二法宝，科研工作亦当如此，特别是在大数据和信息时代的21世纪，这些看似不起眼的日常却可以使我们的工作事半功倍，这里提供我的工作环境仅做参考；<br><a id="more"></a></p>
<h2 id="浏览器">浏览器</h2><p>最好的浏览器当然是 Google Chrome (不接受任何反驳)，简洁无广告净化双眼；再配合其他插件 (<a href="http://tiramisutes.github.io/tiramisutes.github.io/2015/07/25/chrome.html">http://tiramisutes.github.io/tiramisutes.github.io/2015/07/25/chrome.html</a>) ,只能用如虎添翼来形容；<br><img src="/images/chrome.png" alt=""></p>
<h2 id="文献检索">文献检索</h2><p>最好用的当然也是无所不能的 Google (不接受任何反驳)；<br><img src="/images/paper2.png" alt=""><br>实在不行 NCBI 的PubMed也凑合，配合 Scholarscope (<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2Nob2xhcnNjb3BlLmNuLw==" title="http://blog.scholarscope.cn/">http://blog.scholarscope.cn/<i class="fa fa-external-link"></i></span>) 还可以显示期刊领域排名和IF等信息；<br><img src="/images/NCBI_PM.png" alt=""></p>
<h2 id="NCBI_数据库">NCBI 数据库</h2><p>NCBI作为生物类主要数据库之一，查序列再顺手做个blast比对也是常规操作，看完下图让你以后的比对有更多的选择；<br><img src="/images/NCBI_BS.png" alt=""><br><img src="/images/NCBI_BS2.png" alt=""><br><img src="/images/NCBI_BS3.png" alt=""></p>
<h2 id="文献管理">文献管理</h2><p>文献最主要两种使用方式就是阅读和写文章时的引用，业内巨头EndNote大家很熟悉，但开源的Zotero其实可以弥补非正版EndNote的缺陷；身处云的时代怎么能没有同步功能，完全没有安全感；Zotero网页点击即可保存文献，文献管理、同步、甚至手机端阅读样样精通；<br><img src="/images/paper.png" alt=""></p>
<h2 id="文本编辑">文本编辑</h2><p>fasta等序列文件的察看，没有比较就没有伤害，同样的文件不同的打开方式，格然不同的阅读效果，轻量可打开绝大多文件类型且支持功能扩展的 Sublime (<span class="exturl" data-url="aHR0cDovL3d3dy5zdWJsaW1ldGV4dC5jb20v" title="http://www.sublimetext.com/">http://www.sublimetext.com/<i class="fa fa-external-link"></i></span>) 值得你拥有；<br><img src="/images/wenben.png" alt=""></p>
<h2 id="数据安全">数据安全</h2><p>有备无患，辛辛苦苦得来的实验数据实时备份准没错，硬盘和云端双保险最佳；免费版坚果云和会员版百度云可供选择；当然免费的经特殊处理也可以，详细见：<a href="http://tiramisutes.github.io/tiramisutes.github.io/2015/07/28/Linux-backup.html">Linux和windows定时备份数据到百度云盘</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;工欲善其事，必先利其器，各行各业都有其不二法宝，科研工作亦当如此，特别是在大数据和信息时代的21世纪，这些看似不起眼的日常却可以使我们的工作事半功倍，这里提供我的工作环境仅做参考；&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="技能" scheme="http://tiramisutes.github.io/tags/%E6%8A%80%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>流程化的qPCR数据分析</title>
    <link href="http://tiramisutes.github.io/2019/01/26/qPCR.html"/>
    <id>http://tiramisutes.github.io/2019/01/26/qPCR.html</id>
    <published>2019-01-26T03:33:32.000Z</published>
    <updated>2019-04-15T16:02:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/One-Step_vs-Two-large.jpg" alt=""><br>实验室经常要做qPCR实验，每次都是excel点点，好烦啊，特别是实验多的时候…干脆整一个流程省的每次浪费时间😃<br><a id="more"></a></p>
<p>就是下面这个喽👏</p>
<p>好处就是知道每一步是怎么计算的，心里有数 &lt;(￣▽￣)&gt;</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpcmFtaXN1dGVzL3FSQ1AtUGlwZWxpbmU=" title="https://github.com/tiramisutes/qRCP-Pipeline">qRCP-Pipeline<i class="fa fa-external-link"></i></span></p>
<p><img src="/images/qPCR.png" alt=""></p>
<p>但是，还需要代码，脚本什么的，我不会啊，好复杂(┬＿┬)</p>
<p><img src="/images/chenlong.jpg" alt=""></p>
<p>没事，别急，更简单的来了，你需要做的仅仅是准备你的qPCR结果，然后上传就可以得到figure和分析结果数据╰(￣▽￣)╮</p>
<p>怎么实现呢？ 传递们：<span class="exturl" data-url="aHR0cHM6Ly9paG9wZS5zaGlueWFwcHMuaW8vcVJULVBDUi1QaXBlbGluZS8=" title="https://ihope.shinyapps.io/qRT-PCR-Pipeline/">A shiny for analysis Real-Time PCR data<i class="fa fa-external-link"></i></span></p>
<p><img src="/images/qPCRshiny.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/One-Step_vs-Two-large.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;实验室经常要做qPCR实验，每次都是excel点点，好烦啊，特别是实验多的时候…干脆整一个流程省的每次浪费时间😃&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="qPCR" scheme="http://tiramisutes.github.io/tags/qPCR/"/>
    
  </entry>
  
  <entry>
    <title>一图看懂 Trinity 转录组分析</title>
    <link href="http://tiramisutes.github.io/2019/01/21/Trinity.html"/>
    <id>http://tiramisutes.github.io/2019/01/21/Trinity.html</id>
    <published>2019-01-21T03:22:14.000Z</published>
    <updated>2019-01-21T03:48:57.722Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Trinity.jpg" alt=""></p>
<p>图片不过瘾，猛击这里<strong>【<span class="exturl" data-url="aHR0cHM6Ly93d3cucHJvY2Vzc29uLmNvbS92aWV3L2xpbmsvNWM0NDY4OWJlNGIwOGE3NjgzYWU3NTRl" title="https://www.processon.com/view/link/5c44689be4b08a7683ae754e">Trinity流程<i class="fa fa-external-link"></i></span>】</strong>看高清原图。<br><a id="more"></a></p>
<iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:900px; height:600px;" src="https://www.processon.com/embed/5c44689be4b025fe7c84431c"></iframe>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Trinity.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;图片不过瘾，猛击这里&lt;strong&gt;【&lt;a href=&quot;https://www.processon.com/view/link/5c44689be4b08a7683ae754e&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Trinity流程&lt;/a&gt;】&lt;/strong&gt;看高清原图。&lt;br&gt;
    
    </summary>
    
      <category term="RNA-seq" scheme="http://tiramisutes.github.io/categories/RNA-seq/"/>
    
    
      <category term="Trinity" scheme="http://tiramisutes.github.io/tags/Trinity/"/>
    
  </entry>
  
  <entry>
    <title>有参考基因组的RNA-seq详细分析流程</title>
    <link href="http://tiramisutes.github.io/2018/12/04/ref-RNA-seq.html"/>
    <id>http://tiramisutes.github.io/2018/12/04/ref-RNA-seq.html</id>
    <published>2018-12-04T06:27:58.000Z</published>
    <updated>2019-05-16T07:51:54.568Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-_简介">1. 简介</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/RNAseq_workflow.png" alt=""><br>测序技术的普及使得RNA-seq进入寻常百姓家，单纯的qRT数据通量不再满足实验数据的需求，而RNA-seq的分析无非就是有参和无参两种方式；<br>本文主要就有参转录组的分析做简单介绍；<br>此外，有参转录组数据分析流程千千万，本文仅是其中一种，详细运行参数请多 <code>-help</code>；<br><a id="more"></a><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/hisat_stringtie_ballgown.png" alt=""></p>
<h2 id="2-_环境准备">2. 环境准备</h2><ul>
<li>质量检验<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvaW5mb3JtYXRpY3MuYmFicmFoYW0uYWMudWsvcHJvamVjdHMvZmFzdHFjLw==" title="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9tdWx0aXFjLmluZm8v" title="https://multiqc.info/">MultiQC<i class="fa fa-external-link"></i></span> (可选)</li>
</ul>
</li>
<li>reads 过滤与修剪<ul>
<li><span class="exturl" data-url="aHR0cDovL3d3dy51c2FkZWxsYWIub3JnL2Ntcy8/cGFnZT10cmltbW9tYXRpYw==" title="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
<li>序列比对<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9jY2Iuamh1LmVkdS9zb2Z0d2FyZS9oaXNhdDIvaW5kZXguc2h0bWw=" title="https://ccb.jhu.edu/software/hisat2/index.shtml">hisat2<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
<li>排序及格式转换<ul>
<li><span class="exturl" data-url="aHR0cDovL3NhbXRvb2xzLnNvdXJjZWZvcmdlLm5ldC8=" title="http://samtools.sourceforge.net/">samtools<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
<li>序列组装<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9jY2Iuamh1LmVkdS9zb2Z0d2FyZS9zdHJpbmd0aWUv" title="https://ccb.jhu.edu/software/stringtie/">StringTie<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
<li>差异表达分析<ul>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL3JlbGVhc2UvYmlvYy9odG1sL2JhbGxnb3duLmh0bWw=" title="http://www.bioconductor.org/packages/release/bioc/html/ballgown.html">Ballgown<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvaHRtbC9ERVNlcTIuaHRtbA==" title="https://www.bioconductor.org/packages/release/bioc/html/DESeq2.html">DESeq2<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvaHRtbC9lZGdlUi5odG1s" title="https://www.bioconductor.org/packages/release/bioc/html/edgeR.html">edgeR<i class="fa fa-external-link"></i></span></li>
</ul>
</li>
</ul>
<h2 id="3-_数据准备">3. 数据准备</h2><ul>
<li>目标物种基因组数据【基因组fa (genome.fa)和gff注释文件 (genome.gff3)】</li>
<li>测序 reads （实验室生成或NCBI下载）</li>
</ul>
<h2 id="4-_测序reads分析过程">4. 测序reads分析过程</h2><h3 id="4-1_SRA_转_fq_(可选)">4.1 SRA 转 fq (可选)</h3><p>参考 <span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQksxNTg5MDAv" title="https://www.ncbi.nlm.nih.gov/books/NBK158900/">Using the SRA Toolkit to convert .sra files into other formats<i class="fa fa-external-link"></i></span>,根据个人喜好选用相应工具将NCBI的SRA数据库下载SRA数据转化为fq格式；</p>
<h3 id="4-2_质控">4.2 质控</h3><p>FastQC 察看数据质量，Trimmomatic 来进行接头，低质量测序reads的过滤与修剪；<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> *gz |xargs -I [] <span class="keyword">echo</span> <span class="string">'nohup fastqc [] &amp;'</span>&gt;fastqc.<span class="keyword">sh</span></span><br><span class="line">./fastqc.<span class="keyword">sh</span></span><br><span class="line">multiqc ./</span><br></pre></td></tr></table></figure></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java -jar trimmomatic-<span class="number">0.30</span><span class="selector-class">.jar</span> PE \ </span><br><span class="line">-threads <span class="number">20</span> -phred33 reads1<span class="selector-class">.fastq</span> reads2<span class="selector-class">.fastq</span> \ </span><br><span class="line">reads1<span class="selector-class">.clean</span><span class="selector-class">.fastq</span> reads1<span class="selector-class">.unpaired</span><span class="selector-class">.fastq</span> reads2<span class="selector-class">.clean</span><span class="selector-class">.fastq</span> reads2<span class="selector-class">.unpaired</span><span class="selector-class">.fastq</span> \ </span><br><span class="line">ILLUMINACLIP:/Trimmomatic-<span class="number">0.30</span>/adapters/TruSeq3-PE<span class="selector-class">.fa</span>:<span class="number">2</span>:<span class="number">30</span>:<span class="number">10</span> \ </span><br><span class="line">LEADING:<span class="number">3</span> TRAILING:<span class="number">3</span> SLIDINGWINDOW:<span class="number">4</span>:<span class="number">15</span> MINLEN:<span class="number">50</span></span><br></pre></td></tr></table></figure>
<h3 id="4-3_序列比对">4.3 序列比对</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hisat2-build genome<span class="selector-class">.fa</span> genome</span><br><span class="line">hisat2 -x genome -<span class="number">1</span> read1<span class="selector-class">.fq</span><span class="selector-class">.gz</span> -<span class="number">2</span> read2<span class="selector-class">.fq</span><span class="selector-class">.gz</span> -S Sample<span class="selector-class">.sam</span> -<span class="selector-tag">p</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="4-4_排序及格式转换">4.4 排序及格式转换</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools <span class="keyword">view</span> -<span class="keyword">bS</span> <span class="keyword">Sample</span>.sam | samtools <span class="keyword">sort</span> -@ 8 - <span class="keyword">Sample</span>.sorted</span><br></pre></td></tr></table></figure>
<h3 id="4-5_序列组装">4.5 序列组装</h3><p>用StringTie对每个样本进行转录本组装<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Transcriptome assembly</span><br><span class="line">stringtie -p 8 -<span class="keyword">G</span> genome.gff3 -o <span class="keyword">Sample</span>.gtf –<span class="keyword">l</span> <span class="keyword">Sample</span>.sorted.bam</span><br><span class="line"># 获取所有*.gtf 文件名的列表， 并且每个文件名占据一行</span><br><span class="line"><span class="keyword">ls</span> | \grep <span class="string">"Sample"</span> | <span class="keyword">sort</span> -V | uniq | awk 'BEGIN&#123;OFS=<span class="string">"/"</span>&#125; &#123;<span class="keyword">print</span> <span class="variable">$1</span>,<span class="variable">$1</span><span class="string">".gtf"</span>&#125;' &gt; Sample_gtf.txt</span><br><span class="line"># Merges transcripts into a non-redundant <span class="keyword">set</span> of transcripts</span><br><span class="line">stringtie --<span class="keyword">merge</span> -p 8 -<span class="keyword">G</span> genome.gff3 -o merged.gtf Sample_gtf.txt</span><br><span class="line"># Expression level estimation</span><br><span class="line">stringtie –<span class="keyword">e</span> –B -p 8 -<span class="keyword">G</span> merged.gtf -o <span class="keyword">Sample</span>.gtf <span class="keyword">Sample</span>.sorted.bam</span><br></pre></td></tr></table></figure></p>
<h3 id="4-6_count_data_提取">4.6 count data 提取</h3><p>准备上述gtf结果文件sample文件 (sample_lst.txt)，格式如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sample1 <span class="tag">&lt;<span class="name">PATH_TO_Sample1.gtf</span>&gt;</span></span><br><span class="line">Sample2 <span class="tag">&lt;<span class="name">PATH_TO_Sample2.gtf</span>&gt;</span></span><br><span class="line">Sample3 <span class="tag">&lt;<span class="name">PATH_TO_Sample3.gtf</span>&gt;</span></span><br><span class="line">Sample4 <span class="tag">&lt;<span class="name">PATH_TO_Sample4.gtf</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>提取各样品count data<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prepDE<span class="selector-class">.py</span> -<span class="selector-tag">i</span> sample_lst.txt</span><br></pre></td></tr></table></figure></p>
<h2 id="5-_差异表达分析">5. 差异表达分析</h2><p>差异分析可参考<a href="http://tiramisutes.github.io/2018/07/02/No-Rep-RNA-seq.html">搭PacBio全长转录组便车的无重复样本RNA-seq分析</a>；<br>主要就是准备<strong>表型文件和上述的基因或转录本count 文件</strong>；<br>表型数据格式如下 (phenodata.csv)：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sample	group</span><br><span class="line">Sample1 leaf</span><br><span class="line">Sample2 leaf</span><br><span class="line">Sample3 root</span><br><span class="line">Sample4 root</span><br></pre></td></tr></table></figure></p>
<h3 id="5-1_DESeq2">5.1 DESeq2</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"DESeq2"</span>)</span><br><span class="line">countData &lt;- <span class="keyword">as</span>.matrix(read.csv(<span class="string">"gene_count_matrix.csv"</span>, row.names=<span class="string">"gene_id"</span>))</span><br><span class="line">colData &lt;- read.csv(<span class="string">"phenodata.csv"</span>, sep=<span class="string">"\t"</span>, row.names=<span class="number">1</span>)</span><br><span class="line">all(rownames(colData) %<span class="keyword">in</span>% colnames(countData))</span><br><span class="line">countData &lt;- countData[, rownames(colData)]</span><br><span class="line">all(rownames(colData) == colnames(countData))</span><br><span class="line">dds &lt;- DESeqDataSetFromMatrix(countData = countData, colData = colData, design = ~ group)</span><br><span class="line">dds &lt;- DESeq(dds)</span><br><span class="line">res &lt;- results(dds)</span><br><span class="line">(resOrdered &lt;- res[order(res$padj), ])</span><br></pre></td></tr></table></figure>
<h3 id="5-2_edgeR">5.2 edgeR</h3><p>edgeR 和上述 DESeq2相似，具体请参考其BiocManager 说明；</p>
<h3 id="5-3_Ballgown">5.3 Ballgown</h3><p>上述StringTie结果可直接用Ballgown读取来进行差异分析；<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="keyword">ballgown)</span></span><br><span class="line"><span class="keyword">pheno_data </span>&lt;- read.csv(<span class="string">"phenodata.csv"</span>)</span><br><span class="line"><span class="keyword">bg </span>&lt;- <span class="keyword">ballgown(dataDir </span>= <span class="string">"ballgown"</span>,</span><br><span class="line">               samplePattern = <span class="string">"sample"</span>,</span><br><span class="line">               pData = pheno_data)</span><br><span class="line">samplesNames(<span class="keyword">bg)</span></span><br><span class="line"><span class="keyword">bgfilt </span>&lt;-<span class="keyword">subset(bg,'rowVars(texpr(bg))&gt;1',genomesubset=TRUE)（过滤掉表达差异较小的基因）</span></span><br><span class="line"><span class="keyword">diff_genes </span>&lt;- stattest(<span class="keyword">bgfilt,feature='gene',covariate=【自变量】,adjustvars=【无关变量】,meas='FPKM')</span></span><br><span class="line"><span class="keyword">diff_genes </span>&lt;- arrange(<span class="keyword">diff_genes,pval)</span></span><br><span class="line"><span class="keyword">write.csv(diff_genes,'diff_genes.csv',row.names=FALSE)</span></span><br><span class="line"><span class="keyword"># </span>MA plot</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(cowplot)</span><br><span class="line">results_transcripts$mean &lt;- rowMeans(texpr(<span class="keyword">bg_chrX_filt))</span></span><br><span class="line"><span class="keyword"> </span></span><br><span class="line">ggplot(results_transcripts, aes(log2(mean), log2(fc), colour = qval&lt;<span class="number">0</span>.<span class="number">05</span>)) +</span><br><span class="line">  <span class="keyword">scale_color_manual(values=c("#999999", </span><span class="string">"#FF0000"</span>)) +</span><br><span class="line">  geom_point() +</span><br><span class="line">  geom_hline(yintercept=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ma_plot.png" alt=""></p>
<h2 id="6-_扩增阅读">6. 扩增阅读</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wdWJtZWQvMjc1NjAxNzE=" title="https://www.ncbi.nlm.nih.gov/pubmed/27560171">Transcript-level expression analysis of RNA-seq experiments with HISAT, StringTie and Ballgown<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dyaWZmaXRobGFiL3JuYXNlcV90dXRvcmlhbC93aWtpL1Jlc291cmNlcw==" title="https://github.com/griffithlab/rnaseq_tutorial/wiki/Resources">RNA-seq Wiki<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-_简介&quot;&gt;1. 简介&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/RNAseq_workflow.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;测序技术的普及使得RNA-seq进入寻常百姓家，单纯的qRT数据通量不再满足实验数据的需求，而RNA-seq的分析无非就是有参和无参两种方式；&lt;br&gt;本文主要就有参转录组的分析做简单介绍；&lt;br&gt;此外，有参转录组数据分析流程千千万，本文仅是其中一种，详细运行参数请多 &lt;code&gt;-help&lt;/code&gt;；&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="RNA-seq" scheme="http://tiramisutes.github.io/tags/RNA-seq/"/>
    
  </entry>
  
  <entry>
    <title>搭PacBio全长转录组便车的无重复样本RNA-seq分析</title>
    <link href="http://tiramisutes.github.io/2018/07/02/No-Rep-RNA-seq.html"/>
    <id>http://tiramisutes.github.io/2018/07/02/No-Rep-RNA-seq.html</id>
    <published>2018-07-02T04:36:32.000Z</published>
    <updated>2019-03-10T03:47:29.189Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/rnaseq-experiment-design.jpg" alt=""><br>RNA-seq 分析是我当年入门生信的敲门砖，有参/无参的分析，当然还有现在升级的基于PacBio全长转录组的Illumina RNA-seq分析；<br>测序样本的重复性很重要，但总是能接到一些无重复的样本，对于他们的分析就没有像三次重复那么的顺手和多选择；<br><a id="more"></a></p>
<h2 id="零、输入数据">零、输入数据</h2><p>输入数据通常为count结果，很多工具可以用于生成此counts table 文件，</p>
<ul>
<li>[x] 如基于基因组比对的htseq-count;</li>
<li>[x] 基于全基因组的转录组结果的<ul>
<li><span class="exturl" data-url="aHR0cDovL2NvbWJpbmUtbGFiLmdpdGh1Yi5pby9zYWxtb24v" title="http://combine-lab.github.io/salmon/">Salmon<i class="fa fa-external-link"></i></span> <span class="citation">(Patro et al. 2017)</span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5jcy5jbXUuZWR1L35ja2luZ3NmL3NvZnR3YXJlL3NhaWxmaXNoLw==" title="http://www.cs.cmu.edu/~ckingsf/software/sailfish/">Sailfish<i class="fa fa-external-link"></i></span> <span class="citation">(Patro, Mount, and Kingsford 2014)</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9wYWNodGVybGFiLmdpdGh1Yi5pby9rYWxsaXN0by9hYm91dC5odG1s" title="https://pachterlab.github.io/kallisto/about.html">kallisto<i class="fa fa-external-link"></i></span> <span class="citation">(Bray et al. 2016)</span></li>
<li><span class="exturl" data-url="aHR0cDovL2Rld2V5bGFiLmdpdGh1Yi5pby9SU0VNLw==" title="http://deweylab.github.io/RSEM/">RSEM<i class="fa fa-external-link"></i></span> <span class="citation">(Li and Dewey 2011)</span></li>
</ul>
</li>
</ul>
<p>上述软件通常第一步即对全转录组建立索引文件👇</p>
<h3 id="获取转录组">获取转录组</h3><p>For this example, we’ll be analyzing some Arabidopsis thaliana data, so we’ll download and index the A. thaliana transcriptome.<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl ftp:<span class="regexp">//</span>ftp.ensemblgenomes.org<span class="regexp">/pub/</span>plants<span class="regexp">/release-28/</span>fasta<span class="regexp">/arabidopsis_thaliana/</span>cdna<span class="regexp">/Arabidopsis_thaliana.TAIR10.28.cdna.all.fa.gz -o athal.fa.gz</span></span><br></pre></td></tr></table></figure></p>
<h3 id="建立索引">建立索引</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">salmon index -t athal<span class="selector-class">.fa</span><span class="selector-class">.gz</span> -<span class="selector-tag">i</span> athal_index</span><br></pre></td></tr></table></figure>
<h3 id="定量基因表达情况">定量基因表达情况</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> fn <span class="keyword">in</span> data/DRR0161&#123;25..40&#125;;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">samp=`basename <span class="variable">$&#123;fn&#125;</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Processing sample <span class="variable">$&#123;samp&#125;</span>"</span></span><br><span class="line">salmon quant -i athal_index -l A \</span><br><span class="line">         -1 <span class="variable">$&#123;fn&#125;</span>/<span class="variable">$&#123;samp&#125;</span>_1.fastq.gz \</span><br><span class="line">         -2 <span class="variable">$&#123;fn&#125;</span>/<span class="variable">$&#123;samp&#125;</span>_2.fastq.gz \</span><br><span class="line">         -p 8 -o quants/<span class="variable">$&#123;samp&#125;</span>_quant</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="后续差异基因分析">后续差异基因分析</h3><p>Once you have your quantification results you can use them for downstream analysis with differential expression tools like DESeq2, edgeR, limma, or sleuth. Using the tximport package, you can import salmon’s transcript-level quantifications and optionally aggregate them to the gene level for gene-level differential expression analysis. You can read more about how to import salmon’s results into DESeq2 by reading the tximport section of the excellent DESeq2 vignette. For instructions on importing for use with edgeR or limma, see the tximport vignette. For preparing salmon output for use with sleuth, see the wasabi package.</p>
<p>==<strong>首选 DESeq 的方法；</strong>==</p>
<h2 id="一、Analysing_no_replicate_RNA-seq_data_with_LPEseq_package">一、<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0p1bmdzb29HSU0vTFBFc2Vx" title="https://github.com/JungsooGIM/LPEseq">Analysing no replicate RNA-seq data with LPEseq package<i class="fa fa-external-link"></i></span></h2><blockquote>
<p>LPEseq was designed for the RNA-Seq data with a small number of replicates, especially with non-replicate in each class. Also LPEseq can be equally applied both count-base and FPKM-based (non-count values) input data. </p>
</blockquote>
<h2 id="二、IsoEM2">二、<span class="exturl" data-url="aHR0cHM6Ly9kbmEuZW5nci51Y29ubi5lZHUvP3BhZ2VfaWQ9MTA1" title="https://dna.engr.uconn.edu/?page_id=105">IsoEM2<i class="fa fa-external-link"></i></span></h2><h2 id="三、edgeR">三、<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvdmlnbmV0dGVzL2VkZ2VSL2luc3QvZG9jL2VkZ2VSVXNlcnNHdWlkZS5wZGY=" title="https://www.bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf">edgeR<i class="fa fa-external-link"></i></span></h2><blockquote>
<p> The quasi-likelihood method is highly recommended for differential expression analyses of bulk RNA-seq data as it gives stricter error rate control by accounting for the uncertainty in dispersion estimation. The likelihood ratio test can be useful in some special cases such as single cell RNA-seq and datasets with no replicates.</p>
</blockquote>
<h2 id="四、NOISeq:_Differential_Expression_in_RNA-seq">四、<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvdmlnbmV0dGVzL05PSVNlcS9pbnN0L2RvYy9OT0lTZXEucGRm" title="https://www.bioconductor.org/packages/release/bioc/vignettes/NOISeq/inst/doc/NOISeq.pdf">NOISeq: Differential Expression in RNA-seq<i class="fa fa-external-link"></i></span></h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">library(NOISeq)</span><br><span class="line">dat &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.tpm.csv"</span>,row.<span class="attr">names=1)</span></span><br><span class="line">mycounts &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.counts.csv"</span>,row.<span class="attr">names=1)</span></span><br><span class="line">myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/3sleuth_info.txt"</span>,<span class="attr">header=T)</span></span><br><span class="line">mydata &lt;- readData(<span class="attr">data</span> = mycounts, <span class="attr">factors</span> = myfactors)</span><br><span class="line">str(mydata)</span><br><span class="line">head(assayData(mydata)$exprs)</span><br><span class="line">head(pData(mydata))</span><br><span class="line">head(featureData(mydata)@data)</span><br><span class="line"></span><br><span class="line"><span class="attr">mycountsbio</span> = dat(mydata, <span class="attr">factor</span> = NULL, <span class="attr">type</span> = <span class="string">"countsbio"</span>)</span><br><span class="line">explo.plot(mycountsbio, <span class="attr">toplot</span> = <span class="number">1</span>, <span class="attr">samples</span> = <span class="number">1</span>, <span class="attr">plottype</span> = <span class="string">"boxplot"</span>)</span><br><span class="line"><span class="attr">mysaturation</span> = dat(mydata, <span class="attr">k</span> = <span class="number">0</span>, <span class="attr">ndepth</span> = <span class="number">7</span>, <span class="attr">type</span> = <span class="string">"saturation"</span>)</span><br><span class="line">explo.plot(mysaturation, <span class="attr">toplot</span> = <span class="number">1</span>, <span class="attr">samples</span> = <span class="number">1</span>:<span class="number">2</span>, <span class="attr">yleftlim</span> = NULL, <span class="attr">yrightlim</span> = NULL)</span><br><span class="line">explo.plot(mycountsbio, <span class="attr">toplot</span> = <span class="number">1</span>, <span class="attr">samples</span> = NULL, <span class="attr">plottype</span> = <span class="string">"barplot"</span>)</span><br><span class="line"><span class="attr">mycd</span> = dat(mydata, <span class="attr">type</span> = <span class="string">"cd"</span>, <span class="attr">norm</span> = FALSE, <span class="attr">refColumn</span> = <span class="number">1</span>)</span><br><span class="line"><span class="comment">## Normalization</span></span><br><span class="line"><span class="comment">## Differential expression: no replicates available</span></span><br><span class="line">myresults &lt;- noiseq(mydata, <span class="attr">factor</span> = <span class="string">"condition"</span>,<span class="attr">conditions</span> = c(<span class="string">"H0"</span>, <span class="string">"H1"</span>), <span class="attr">k</span> = NULL, <span class="attr">norm</span> = <span class="string">"n"</span>, <span class="attr">pnr</span> = <span class="number">0.2</span>,<span class="attr">nss</span> = <span class="number">5</span>, <span class="attr">v</span> = <span class="number">0.02</span>, <span class="attr">lc</span> = <span class="number">1</span>, <span class="attr">replicates</span> = <span class="string">"no"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">head(myresults@results[[<span class="number">1</span>]])</span><br><span class="line">mynoiseq.<span class="attr">deg</span> = degenes(myresults, <span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">M</span> = NULL)</span><br><span class="line">mynoiseq.<span class="attr">deg1</span> = degenes(myresults, <span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">M</span> = <span class="string">"up"</span>)</span><br><span class="line">mynoiseq.<span class="attr">deg2</span> = degenes(myresults, <span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">M</span> = <span class="string">"down"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DE.plot(myresults, <span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">graphic</span> = <span class="string">"expr"</span>, log.<span class="attr">scale</span> = TRUE)</span><br><span class="line">DE.plot(myresults, <span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">graphic</span> = <span class="string">"MD"</span>)</span><br><span class="line">DE.plot(myresults, <span class="attr">chromosomes</span> = c(<span class="number">1</span>, <span class="number">2</span>), log.<span class="attr">scale</span> = TRUE, <span class="attr">join</span> = FALSE,<span class="attr">q</span> = <span class="number">0.95</span>, <span class="attr">graphic</span> = <span class="string">"chrom"</span>)</span><br></pre></td></tr></table></figure>
<p>If NOISeq-sim has been used because no replicates are available, then it is preferable to use a higher threshold such as q = 0.9</p>
<h2 id="五、DESeq2">五、<span class="exturl" data-url="aHR0cHM6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL3JlbGVhc2UvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI2lucHV0LWRhdGE=" title="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#input-data">DESeq2<i class="fa fa-external-link"></i></span></h2><p><span class="exturl" data-url="aHR0cHM6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL3JlbGVhc2UvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI2Nhbi1pLXVzZS1kZXNlcTItdG8tYW5hbHl6ZS1hLWRhdGFzZXQtd2l0aG91dC1yZXBsaWNhdGVz" title="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#can-i-use-deseq2-to-analyze-a-dataset-without-replicates">Can I use DESeq2 to analyze a dataset without replicates?<i class="fa fa-external-link"></i></span> 和 <span class="exturl" data-url="aHR0cHM6Ly9zdXBwb3J0LmJpb2NvbmR1Y3Rvci5vcmcvcC83NzYyMy8=" title="https://support.bioconductor.org/p/77623/">Question: Deseq2 for RNAseq experiments without replicates<i class="fa fa-external-link"></i></span></p>
<blockquote>
<p>For an experiment without replicates, you should just run DESeq() as normal.</p>
</blockquote>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">library(DESeq2)</span><br><span class="line">raw_count &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.counts.csv"</span>, header=TRUE, row.names=<span class="number">1</span>)</span><br><span class="line">## <span class="number">4</span>舍<span class="number">5</span>入</span><br><span class="line">countdata1 &lt;- round(raw_count) </span><br><span class="line">head(countdata1)</span><br><span class="line">## 去掉整行是<span class="number">0</span>的行</span><br><span class="line">all &lt;- apply(countdata1, <span class="number">1</span>, function(x) all(x==<span class="number">0</span>) )</span><br><span class="line">newdata &lt;- countdata1[!all,]</span><br><span class="line">head (newdata)</span><br><span class="line">## 筛选行总和大于<span class="number">200</span>的行</span><br><span class="line">dat &lt;- newdata[rowSums(newdata &gt; <span class="number">200</span>) &gt;= <span class="number">1</span>,]</span><br><span class="line">countdata &lt;- <span class="keyword">as</span>.matrix(dat)</span><br><span class="line">head(countdata)</span><br><span class="line">## </span><br><span class="line">countData&lt;-countdata[,c(<span class="string">"controlH_1"</span>,<span class="string">"treatH1_1"</span>)]</span><br><span class="line">myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>,header=T)</span><br><span class="line">myfactors</span><br><span class="line">## 根据需要比较的样本筛选出相应的行</span><br><span class="line">colData &lt;- myfactors[c(<span class="number">1</span>,<span class="number">3</span>),]</span><br><span class="line">#colData &lt;- myfactors[which((myfactors$condition==<span class="string">"H0"</span>)|(myfactors$sample==<span class="string">"H1"</span>)),]</span><br><span class="line">dds &lt;- DESeqDataSetFromMatrix(</span><br><span class="line">       countData = countData,</span><br><span class="line">       colData = colData,</span><br><span class="line">       design = ~ condition)</span><br><span class="line">colData(dds)$condition &lt;- factor(colData(dds)$condition,levels=c(<span class="string">"H0"</span>,<span class="string">"H1"</span>))</span><br><span class="line">dds</span><br><span class="line">dds &lt;- DESeq(dds)</span><br><span class="line">res &lt;- results(dds)</span><br><span class="line">res &lt;- res[order(res$padj),]</span><br><span class="line">head(res)</span><br><span class="line">sum(res$padj &lt; <span class="number">0.1</span>, na.rm=TRUE)</span><br><span class="line">res05 &lt;- results(dds, alpha=<span class="number">0.05</span>)</span><br><span class="line">summary(res05)</span><br><span class="line">sum(res05$padj &lt; <span class="number">0.05</span>, na.rm=TRUE)</span><br></pre></td></tr></table></figure>
<p>或者利用 <span class="exturl" data-url="aHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvcmVsZWFzZS9iaW9jL3ZpZ25ldHRlcy90eGltcG9ydC9pbnN0L2RvYy90eGltcG9ydC5odG1sI2thbGxpc3RvLXdpdGgtdHN2LWZpbGVz" title="http://bioconductor.org/packages/release/bioc/vignettes/tximport/inst/doc/tximport.html#kallisto-with-tsv-files">tximport<i class="fa fa-external-link"></i></span>直接将多个kallisto结果文件abundance.tsv导入R中；</p>
<p><strong>tximport 导入数据</strong><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"tximport"</span>)</span><br><span class="line">samples &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>, header = <span class="literal">TRUE</span>)</span><br><span class="line">dir &lt;- <span class="string">"/public/home/zpxu/hulisong/results/kallisto"</span></span><br><span class="line">files &lt;- file.path(dir, samples<span class="variable">$sample</span>, <span class="string">"abundance.tsv"</span>)</span><br><span class="line">names(files) &lt;- samples<span class="variable">$sample</span></span><br><span class="line">txi.kallisto.tsv &lt;- tximport(files,<span class="built_in"> type </span>= <span class="string">"kallisto"</span>, <span class="attribute">txOut</span>=<span class="literal">TRUE</span>)</span><br><span class="line">head(txi.kallisto.tsv<span class="variable">$counts</span>)</span><br></pre></td></tr></table></figure></p>
<p><strong>DESeq2 进行差异表达计算</strong><br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"DESeq2"</span>)</span><br><span class="line">head(txi.kallisto.tsv$counts)</span><br><span class="line">raw_count &lt;- txi.kallisto.tsv$counts</span><br><span class="line">countdata1 &lt;- round(raw_count) </span><br><span class="line">head(countdata1)</span><br><span class="line">## 去掉整行是<span class="number">0</span>的行</span><br><span class="line">all &lt;- apply(countdata1, <span class="number">1</span>, function(x) all(x==<span class="number">0</span>) )</span><br><span class="line">newdata &lt;- countdata1[!all,]</span><br><span class="line">head (newdata)</span><br><span class="line">## 筛选行总和大于<span class="number">200</span>的行</span><br><span class="line">dat &lt;- newdata[rowSums(newdata &gt; <span class="number">200</span>) &gt;= <span class="number">1</span>,]</span><br><span class="line">countdata &lt;- <span class="keyword">as</span>.matrix(dat)</span><br><span class="line">head(countdata)</span><br><span class="line">countData &lt;- countdata[,c(<span class="string">"controlH_1"</span>, <span class="string">"treatH1_1"</span>)]</span><br><span class="line">myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>,header=T)</span><br><span class="line">myfactors</span><br><span class="line">## 根据需要比较的样本筛选出相应的行</span><br><span class="line">colData &lt;- myfactors[c(<span class="number">1</span>,<span class="number">3</span>),]</span><br><span class="line">dds &lt;- DESeqDataSetFromMatrix(</span><br><span class="line">       countData = countData,</span><br><span class="line">       colData = colData,</span><br><span class="line">       design = ~ condition)</span><br><span class="line">colData(dds)$condition &lt;- factor(colData(dds)$condition,levels=c(<span class="string">"H0"</span>,<span class="string">"H1"</span>))</span><br><span class="line">dds</span><br><span class="line">dds &lt;- DESeq(dds)</span><br><span class="line">res &lt;- results(dds)</span><br><span class="line">res &lt;- res[order(res$padj),]</span><br><span class="line">head(res)</span><br></pre></td></tr></table></figure></p>
<h2 id="六、DESeq">六、<span class="exturl" data-url="aHR0cHM6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL3JlbGVhc2UvYmlvYy92aWduZXR0ZXMvREVTZXEvaW5zdC9kb2MvREVTZXEucGRm" title="https://bioconductor.org/packages/release/bioc/vignettes/DESeq/inst/doc/DESeq.pdf">DESeq<i class="fa fa-external-link"></i></span></h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">library( <span class="string">"DESeq"</span> )</span><br><span class="line">raw_count &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.counts.csv"</span>, <span class="attribute">header</span>=<span class="literal">TRUE</span>, row.<span class="attribute">names</span>=1)</span><br><span class="line">head(raw_count)</span><br><span class="line">myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>,<span class="attribute">header</span>=T)</span><br><span class="line">countdata1 &lt;- round(raw_count)</span><br><span class="line">head(countdata1)</span><br><span class="line">all &lt;- apply(countdata1, 1, function(x) all(<span class="attribute">x</span>==0) )</span><br><span class="line">newdata &lt;- countdata1[!all,]</span><br><span class="line">head (newdata)</span><br><span class="line">countdata &lt;- as.matrix(newdata)</span><br><span class="line">head(countdata)</span><br><span class="line">condition = myfactors<span class="variable">$sample</span></span><br><span class="line">cds = newCountDataSet( countdata, condition )</span><br><span class="line"><span class="comment">## Normalisation</span></span><br><span class="line">cds = estimateSizeFactors(cds)</span><br><span class="line">sizeFactors( cds )</span><br><span class="line">head( counts( cds, <span class="attribute">normalized</span>=<span class="literal">TRUE</span> ) )</span><br><span class="line"><span class="comment">## Calling differential expression</span></span><br><span class="line">cds2 = cds[ ,c( <span class="string">"controlH_1"</span>, <span class="string">"treatH1_1"</span> ) ]</span><br><span class="line"><span class="comment">## 无生物学重复选 method="blind"和sharingMode="fit-only"</span></span><br><span class="line">cds2 = estimateDispersions( cds2, <span class="attribute">method</span>=<span class="string">"blind"</span>, <span class="attribute">sharingMode</span>=<span class="string">"fit-only"</span> )</span><br><span class="line"><span class="comment">## 察看cds2中包含的 conditions，因为nbinomTest函数的第二和第三个参数输入的是cds2中所包含的conditions</span></span><br><span class="line">dispTable(cds2) </span><br><span class="line">res = nbinomTest( cds2, <span class="string">"controlH_1"</span>, <span class="string">"treatH1_1"</span> )</span><br><span class="line">plotMA(res)</span><br><span class="line">hist(res<span class="variable">$pval</span>, <span class="attribute">breaks</span>=100, <span class="attribute">col</span>=<span class="string">"skyblue"</span>, <span class="attribute">border</span>=<span class="string">"slateblue"</span>, <span class="attribute">main</span>=<span class="string">""</span>)</span><br><span class="line"><span class="comment">## 根据FDR筛选显著差异的基因</span></span><br><span class="line">resSig = res[ res<span class="variable">$padj</span> &lt; 0.05, ]</span><br><span class="line"><span class="comment">## 按照 P 值排序</span></span><br><span class="line">head( resSig[ order(resSig<span class="variable">$pval</span>), ] )</span><br><span class="line">SDE &lt;- resSig[ order(resSig<span class="variable">$pval</span>), ]</span><br><span class="line"><span class="comment">## The most strongly down-regulated of the significant genes</span></span><br><span class="line">head( resSig[ order( resSig<span class="variable">$foldChange</span>, -resSig<span class="variable">$baseMean</span> ), ] )</span><br><span class="line">SDE_down &lt;- resSig[ order( resSig<span class="variable">$foldChange</span>, -resSig<span class="variable">$baseMean</span> ), ]</span><br><span class="line"><span class="comment">## The most strongly up-regulated ones</span></span><br><span class="line">head( resSig[ order( -resSig<span class="variable">$foldChange</span>, -resSig<span class="variable">$baseMean</span> ), ] )</span><br><span class="line">SDE_up &lt;- resSig[ order( -resSig<span class="variable">$foldChange</span>, -resSig<span class="variable">$baseMean</span> ), ]</span><br><span class="line">write.csv( res, <span class="attribute">file</span>=<span class="string">"My Pasilla Analysis Result Table.csv"</span>)</span><br><span class="line">addmargins( table(res2_sig = res<span class="variable">$padj</span> &lt; 0.05 ) )</span><br></pre></td></tr></table></figure>
<p>输出结果中 <strong>foldChange</strong> 和 <strong>log2FoldChange</strong> 列包含有 <code>Inf</code> 和 <code>-Inf</code>，根据 <span class="exturl" data-url="aHR0cDovL3NlcWFuc3dlcnMuY29tL2ZvcnVtcy9zaG93dGhyZWFkLnBocD90PTEzMDM3" title="http://seqanswers.com/forums/showthread.php?t=13037">Re-extracting refgene names after DESeq Analysis
<i class="fa fa-external-link"></i></span> 解释，是因为同一个基因在样本A中count极端大，而在样本 B 中为零造成的；那么如何避免这种问题出现呢？根据 <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMTUzNjEzLw==" title="https://www.biostars.org/p/153613/">Question: Statistical question (Deseq, Cuffdis) when one condition is zero?<i class="fa fa-external-link"></i></span> 解释，通常做法是全部数据都加一个较小的数值，但这也一个较小的数值也会在 <strong>log2FoldChange</strong> 时被放大；</p>
<blockquote>
<p>A popular strategy to cope with zeros is to add a small number to all counts so that you avoid division by zero and at the same time you don’t bias the results (e.g. 1000:0 is reasonably equivalent to 1001:1). Having said that, this is an issue that bugs me sometime when interpreting fold change ratios since small numbers can have a large effect which is not consistent with the biological interpretation. For example, if you add 1 to all your counts you could get log2(1001/1)= 9.97; if instead you add 0.1(biologically the same, I would argue) you get log2(1000.1/0.1)= 13.29, which is a big difference.</p>
</blockquote>
<p>结果中存在 <code>NA</code> 的解释见 <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvNjg4Njcv" title="https://www.biostars.org/p/68867/">Question: Deseq Infinite In Logfc And Na For P Value<i class="fa fa-external-link"></i></span> 和 <span class="exturl" data-url="aHR0cDovL3NlcWFuc3dlcnMuY29tL2ZvcnVtcy9zaG93dGhyZWFkLnBocD90PTE1MjA1" title="http://seqanswers.com/forums/showthread.php?t=15205">DESeq: “NA” generated in the resulted differentially expressed genes<i class="fa fa-external-link"></i></span>,不影响结果，直接去掉即可👇<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">mydf</span><span class="selector-attr">[complete.cases(mydf), ]</span></span><br><span class="line"><span class="selector-tag">resSig</span>&lt;<span class="selector-tag">-na</span><span class="selector-class">.omit</span>(<span class="selector-tag">resSig</span>)</span><br></pre></td></tr></table></figure></p>
<p>其他参考教程：<span class="exturl" data-url="aHR0cDovL3BlZGFnb2dpeC10YWdjLnVuaXYtbXJzLmZyL2NvdXJzZXMvQVNHMS9wcmFjdGljYWxzL3JuYXNlcV9kaWZmL3JuYXNlcV9kaWZmLmh0bWw=" title="http://pedagogix-tagc.univ-mrs.fr/courses/ASG1/practicals/rnaseq_diff/rnaseq_diff.html">RNA-Seq: differential expression using DESeq<i class="fa fa-external-link"></i></span></p>
<h3 id="多个组合比较差异基因分析">多个组合比较差异基因分析</h3><p>如下 <code>Cross_DF.R</code> 脚本可对不同组合进行差异基因的分析；</p>
<p>使用方式为：<code>Rscript Cross_DF.R controlH_1 treatH1_1 /public/home/zpxu/hulisong/results/123/ 0.05</code></p>
<p>其中，</p>
<ul>
<li>第一个参数(controlH_1)为比较的对照；</li>
<li>第二个参数(treatH1_1)为另外一组样本，即进行 <code>controlH_1</code> 和 <code>treatH1_1</code> 之间的比较来找出差异基因；</li>
<li>第三个参数(/public/home/zpxu/hulisong/results/123/) 为结果输出路径，包括保存的csv和pdf图片；</li>
<li>第四个参数(0.05) 为最后差异基因筛选时<code>padj</code>的阈值和画MA图片时的<code>padj</code>值；<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">arg &lt;- commandArgs(T)</span><br><span class="line">###### Input kallisto results ##########</span><br><span class="line">print(<span class="string">"Input kallisto results"</span>)</span><br><span class="line">library(<span class="string">"tximport"</span>)</span><br><span class="line">myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>, header = TRUE)</span><br><span class="line">dir &lt;- <span class="string">"/public/home/zpxu/hulisong/results/cds_kallisto"</span></span><br><span class="line">files &lt;- file.path(dir, myfactors$sample, <span class="string">"abundance.tsv"</span>)</span><br><span class="line">names(files) &lt;- myfactors$sample</span><br><span class="line">txi.kallisto.tsv &lt;- tximport(files, type = <span class="string">"kallisto"</span>, txOut=TRUE)</span><br><span class="line">head(txi.kallisto.tsv$counts)</span><br><span class="line">############## For DEGs ################</span><br><span class="line">library( <span class="string">"DESeq"</span> )</span><br><span class="line">raw_count &lt;- txi.kallisto.tsv$counts</span><br><span class="line">#raw_count &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.counts.csv"</span>, header=TRUE, row.names=<span class="number">1</span>)</span><br><span class="line">head(raw_count)</span><br><span class="line">#myfactors &lt;- read.table(<span class="string">"/public/home/zpxu/hulisong/scripts/count_sleuth_info.txt"</span>,header=T)</span><br><span class="line">countdata1 &lt;- round(raw_count)</span><br><span class="line">head(countdata1)</span><br><span class="line">all &lt;- apply(countdata1, <span class="number">1</span>, function(x) all(x==<span class="number">0</span>) )</span><br><span class="line">newdata &lt;- countdata1[!all,]</span><br><span class="line">head (newdata)</span><br><span class="line">countdata &lt;- <span class="keyword">as</span>.matrix(newdata)</span><br><span class="line">head(countdata)</span><br><span class="line">condition = myfactors$sample</span><br><span class="line">cds = newCountDataSet( countdata, condition )</span><br><span class="line"># Normalisation</span><br><span class="line">print(<span class="string">"Normalisation All Data"</span>)</span><br><span class="line">cds = estimateSizeFactors(cds)</span><br><span class="line">sizeFactors( cds )</span><br><span class="line">head( counts( cds, normalized=TRUE ) )</span><br><span class="line"># Select sample and do Variance estimation</span><br><span class="line">print(<span class="string">"Select sample and do Variance estimation"</span>)</span><br><span class="line">cds2 = cds[ ,c(arg[<span class="number">1</span>], arg[<span class="number">2</span>]) ]</span><br><span class="line">cds2 = estimateDispersions( cds2, method=<span class="string">"blind"</span>, sharingMode=<span class="string">"fit-only"</span>,fitType = <span class="string">"local"</span> )</span><br><span class="line">outdir &lt;- arg[<span class="number">3</span>]</span><br><span class="line">pdf(file=paste0(outdir,arg[<span class="number">1</span>],<span class="string">"_Vs_"</span>,arg[<span class="number">2</span>],<span class="string">".pdf"</span>))</span><br><span class="line">print(<span class="string">"Plot the per-gene estimates against the mean normalized counts per gene and overlay the fitted curve"</span>)</span><br><span class="line">plotDispEsts(cds2)</span><br><span class="line">#### Calling differential expression ###########</span><br><span class="line">print(<span class="string">"Calling differential expression"</span>)</span><br><span class="line">res = nbinomTest( cds2, arg[<span class="number">1</span>], arg[<span class="number">2</span>] )</span><br><span class="line">plotMA(res,col = ifelse(res$padj&gt;=arg[<span class="number">4</span>], <span class="string">"gray32"</span>, <span class="string">"red3"</span>), main=paste0(arg[<span class="number">1</span>],<span class="string">"_Vs_"</span>,arg[<span class="number">2</span>]))</span><br><span class="line">hist(res$pval, breaks=<span class="number">100</span>, col=<span class="string">"skyblue"</span>, border=<span class="string">"slateblue"</span>, main=paste0(arg[<span class="number">1</span>],<span class="string">"_Vs_"</span>,arg[<span class="number">2</span>]))</span><br><span class="line">resSig = res[ res$padj &lt; arg[<span class="number">4</span>], ]</span><br><span class="line">N_resSig &lt;- resSig[complete.cases(resSig), ]</span><br><span class="line">write.csv( N_resSig, paste0(outdir,arg[<span class="number">1</span>],<span class="string">"_Vs_"</span>,arg[<span class="number">2</span>],<span class="string">".csv"</span>),row.names = FALSE)</span><br><span class="line">############### The follows is option and can not do it If your want #####</span><br><span class="line">############### Variance stabilizing transformation ##########</span><br><span class="line">print(<span class="string">"Variance stabilizing transformation"</span>)</span><br><span class="line">vsd = varianceStabilizingTransformation( cds2 )</span><br><span class="line">library(<span class="string">"vsn"</span>)</span><br><span class="line">notAllZero = (rowSums(counts(cds))&gt;<span class="number">0</span>)</span><br><span class="line">meanSdPlot(log2(counts(cds)[notAllZero, ] + <span class="number">1</span>))</span><br><span class="line">meanSdPlot(vsd[notAllZero, ])</span><br><span class="line">########### Data quality assessment by sample clustering and visualisation ####</span><br><span class="line">print(<span class="string">"Data quality assessment by sample clustering and visualisation"</span>)</span><br><span class="line">print(<span class="string">"Heatmap of the count table"</span>)</span><br><span class="line">vsdFull = varianceStabilizingTransformation( cds2 )</span><br><span class="line">library(<span class="string">"RColorBrewer"</span>)</span><br><span class="line">library(<span class="string">"gplots"</span>)</span><br><span class="line">select = order(rowMeans(counts(cds2)), decreasing=TRUE)[<span class="number">1</span>:<span class="number">30</span>]</span><br><span class="line">hmcol = colorRampPalette(brewer.pal(<span class="number">9</span>, <span class="string">"GnBu"</span>))(<span class="number">100</span>)</span><br><span class="line">heatmap<span class="number">.2</span>(exprs(vsdFull)[select,], col = hmcol, trace=<span class="string">"none"</span>, margin=c(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">print(<span class="string">"Heatmap of the sample-to-sample distances"</span>)</span><br><span class="line">dists = dist( t( exprs(vsdFull) ) )</span><br><span class="line">mat = <span class="keyword">as</span>.matrix( dists )</span><br><span class="line">rownames(mat) = colnames(mat) = <span class="keyword">with</span>(pData(cds2), paste(condition, condition, sep=<span class="string">" : "</span>))</span><br><span class="line">heatmap<span class="number">.2</span>(mat, trace=<span class="string">"none"</span>, col = rev(hmcol), margin=c(<span class="number">13</span>, <span class="number">13</span>))</span><br><span class="line">print(<span class="string">"Principal component plot of the samples"</span>)</span><br><span class="line">print(plotPCA(vsdFull, intgroup=c(<span class="string">"condition"</span>, <span class="string">"condition"</span>)))</span><br><span class="line">dev.off()</span><br><span class="line">print(paste0(<span class="string">"Run Complete. Please Check The Results in Directory: "</span>,outdir))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>批量不同组合运行方式👇<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> treatR1_1 treatR2_1 treatR3_1 treatR4_1 treatR5_1</span><br><span class="line">do</span><br><span class="line">Rscript Cross_DF<span class="selector-class">.R</span> controlR_1 $&#123;i&#125; /public/home/zpxu/hulisong/results/<span class="number">123</span>/ <span class="number">0.05</span></span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<h2 id="七、LPEseq">七、<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0p1bmdzb29HSU0vTFBFc2VxL3dpa2k=" title="https://github.com/JungsooGIM/LPEseq/wiki">LPEseq<i class="fa fa-external-link"></i></span></h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"devtools"</span>)</span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(devtools)</span></span></span><br><span class="line"><span class="function"><span class="title">install_github</span><span class="params">(<span class="string">"iedenkim/LPEseq"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(LPEseq)</span></span></span><br><span class="line">TPM &lt;- read.csv(<span class="string">"/public/home/zpxu/hulisong/results/kallisto/All.tpm.csv"</span>,<span class="selector-tag">header</span> = T,row.names=<span class="number">1</span>)</span><br><span class="line">NewTPM &lt;- TPM[rowSums(TPM==<span class="number">0</span>)==<span class="number">0</span>,]</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(NewTPM)</span></span></span><br><span class="line"><span class="function"><span class="title">dim</span><span class="params">(NewTPM)</span></span></span><br><span class="line">TPM<span class="selector-class">.norm</span> &lt;- log(NewTPM, base = <span class="number">2</span>)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(TPM.norm)</span></span></span><br><span class="line">TPM<span class="selector-class">.result</span><span class="selector-class">.norep</span> &lt;- LPEseq.test(TPM<span class="selector-class">.norm</span>[,<span class="number">1</span>], TPM<span class="selector-class">.norm</span>[,<span class="number">4</span>])</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(TPM.result.norep)</span></span></span><br><span class="line">TPM<span class="selector-class">.result</span><span class="selector-class">.norep</span><span class="selector-class">.Sig</span> = TPM<span class="selector-class">.result</span><span class="selector-class">.norep</span>[TPM<span class="selector-class">.result</span><span class="selector-class">.norep</span><span class="variable">$q</span><span class="selector-class">.value</span> &lt; <span class="number">0.05</span>, ]</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(TPM.result.norep.Sig)</span></span></span><br><span class="line">write.table(TPM<span class="selector-class">.result</span><span class="selector-class">.norep</span><span class="selector-class">.Sig</span>, file=<span class="string">"result_file.txt"</span>, quote=F, sep=<span class="string">"\t"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="八、GFOLD">八、<span class="exturl" data-url="aHR0cHM6Ly9iaXRidWNrZXQub3JnL2ZlZWxkZWFkL2dmb2xkL3dpa2kvTWFudWFs" title="https://bitbucket.org/feeldead/gfold/wiki/Manual">GFOLD<i class="fa fa-external-link"></i></span></h2><p>基于基因组比对的bam文件计算差异表达基因；</p>
<h3 id="Example_1:_Count_reads_and_rank_genes">Example 1: Count reads and rank genes</h3><p>In the following example, hg19Ref.gtf is the ucsc knownGene table in GTF format for hg19; sample1.sam and sample2.sam are the mapped reads in SAM format.<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gfold count -ann hg19Ref<span class="selector-class">.gtf</span> -tag sample1<span class="selector-class">.sam</span> -o sample1.read_cnt</span><br><span class="line">gfold count -ann hg19Ref<span class="selector-class">.gtf</span> -tag sample2<span class="selector-class">.sam</span> -o sample2.read_cnt</span><br><span class="line">gfold diff -s1 sample1 -s2 sample2 -suf <span class="selector-class">.read_cnt</span> -o sample1VSsample2.diff</span><br></pre></td></tr></table></figure></p>
<h3 id="Example_2:_Count_reads">Example 2: Count reads</h3><p>This example utilizes samtools to produce mapped reads in SAM format from BAM format.<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools view sample1.bam | gfold count -ann hg19Ref.gtf -<span class="keyword">tag</span> <span class="title">stdin</span> -o sample1.read_cnt</span><br></pre></td></tr></table></figure></p>
<h3 id="Example_3:_Identify_differentially_expressed_genes_without_replicates">Example 3: Identify differentially expressed genes without replicates</h3><p>Suppose there are two samples: sample1 and sample2 with corresponding read count file being sample1.read_cnt sample2.read_cnt. This example finds differentially expressed genes using default parameters on two samples<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gfold <span class="keyword">diff </span>-<span class="built_in">s1</span> sample1 -<span class="built_in">s2</span> sample2 -suf .read_cnt -o sample1VSsample2.<span class="keyword">diff</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Example_4:_Identify_differentially_expressed_genes_with_replicates">Example 4: Identify differentially expressed genes with replicates</h3><p>This example finds differentially expressed genes using default parameters on two group of samples.<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gfold <span class="keyword">diff </span>-<span class="built_in">s1</span> sample1,sample2,sample3 -<span class="built_in">s2</span> sample4,sample5,sample6 -suf .read_cnt -o <span class="number">123</span>VS456.<span class="keyword">diff</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Example_5:_Identify_differentially_expressed_genes_with_replicates_only_in_one_condition">Example 5: Identify differentially expressed genes with replicates only in one condition</h3><p>This example finds differentially expressed genes using default parameters on two group of samples. Only the first group contains replicates. In this case, the variance estimated based on the first group will be used as the variance of the second group.<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gfold <span class="keyword">diff </span>-<span class="built_in">s1</span> sample1,sample2 -<span class="built_in">s2</span> sample3 -suf .read_cnt -o <span class="number">12</span>VS3.<span class="keyword">diff</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/rnaseq-experiment-design.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;RNA-seq 分析是我当年入门生信的敲门砖，有参/无参的分析，当然还有现在升级的基于PacBio全长转录组的Illumina RNA-seq分析；&lt;br&gt;测序样本的重复性很重要，但总是能接到一些无重复的样本，对于他们的分析就没有像三次重复那么的顺手和多选择；&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="RNA-seq" scheme="http://tiramisutes.github.io/tags/RNA-seq/"/>
    
  </entry>
  
  <entry>
    <title>PacBio基因组组装之MARVEL</title>
    <link href="http://tiramisutes.github.io/2018/05/01/MARVEL.html"/>
    <id>http://tiramisutes.github.io/2018/05/01/MARVEL.html</id>
    <published>2018-05-01T13:13:19.000Z</published>
    <updated>2018-09-28T02:38:04.601Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-_软件介绍">1. 软件介绍</h2><p>PacBio三代数据基因组组装，针对低测序深度的组装;<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/MARVEL.png" alt=""><br><a id="more"></a></p>
<h2 id="2-_软件安装">2. 软件安装</h2><p>软件主页：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NjaGxvaS9NQVJWRUw=" title="https://github.com/schloi/MARVEL">The MARVEL Assembler<i class="fa fa-external-link"></i></span><br>clone 后发现目录下没有 <code>configure</code> 文件，而是<code>configure.ac</code>文件，怎么安装？？？</p>
<h3 id="2-1-_加载所需环境">2.1. 加载所需环境</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">source /public/home/software/.bashrc</span><br><span class="line">module load Autoconf/2.69</span><br><span class="line"><span class="comment">## added python3.6</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/public/home/zpxu/miniconda3/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"<span class="variable">$PATH</span>:/public/home/zpxu/miniconda3/lib"</span></span><br></pre></td></tr></table></figure>
<p>版本检测<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">autoreconf --<span class="keyword">version</span></span><br><span class="line"><span class="keyword">python</span> --<span class="keyword">version</span></span><br></pre></td></tr></table></figure></p>
<p>然后运行 <code>autoreconf</code> 来生成 <code>configure</code> 文件。</p>
<h3 id="2-2-_安装">2.2. 安装</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 注意此目录与git clone 的 MARVEL 目录不同</span></span><br><span class="line">.<span class="regexp">/configure --prefix=/</span>public<span class="regexp">/home/</span>cotton<span class="regexp">/software/</span>MARVEL-bin</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p><code>make install</code> 后提示如下信息<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------------------------------------</span><br><span class="line">Installation into /public/home/cotton/software/MARVEL-bin finished.</span><br><span class="line">Don't forget to include /public/home/cotton/software/MARVEL-bin/lib.python in your PYTHONPATH.</span><br><span class="line">---------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-_添加PYTHONPATH">2.3. 添加PYTHONPATH</h3><p>参见：<span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQwMjE2OC9wZXJtYW5lbnRseS1hZGQtYS1kaXJlY3RvcnktdG8tcHl0aG9ucGF0aA==" title="https://stackoverflow.com/questions/3402168/permanently-add-a-directory-to-pythonpath">Permanently add a directory to PYTHONPATH
<i class="fa fa-external-link"></i></span><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PYTHONPATH</span>=<span class="string">"<span class="variable">$PYTHONPATH</span>:/public/home/cotton/software/MARVEL-bin/lib.python"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3-_软件使用">3. 软件使用</h2><p>整体过程如下：</p>
<ol>
<li>overlap</li>
<li>patch reads</li>
<li>overlap (again)</li>
<li>scrubbing</li>
<li>assembly graph construction and touring</li>
<li>optional read correction</li>
<li>fasta file creation<br>实际运行主要经过两个过程，<strong>READ PATCHING PHASE</strong> 和 <strong>ASSEMBLY PHASE</strong>，即reads的处理阶段（<code>DBprepare.py</code>）和组装阶段（<code>do.py</code>）；</li>
</ol>
<h3 id="3-1-_初始化数据库:_DBprepare-py">3.1. 初始化数据库: DBprepare.py</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/public/</span>home<span class="regexp">/cotton/</span>software<span class="regexp">/MARVEL-bin/</span>scripts<span class="regexp">/DBprepare.py ECOL p6.25x.fasta</span></span><br></pre></td></tr></table></figure>
<p><code>DBprepare.py</code> 实际上是一个集成的python脚本，里面包含大约4步MARVEL程序 (<code>FA2db</code>,<code>DBsplit</code>,<code>DBdust</code> 和 <code>HPCdaligner</code>)。</p>
<p>运行完成将生成 <code>ECOL.db</code>，两个隐藏文件<code>.ECOL.idx</code> 和 <code>.ECOL.bps</code> ，两个plan后缀的文件；</p>
<h3 id="3-2-_组装:_do-py">3.2. 组装: do.py</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">##!/usr/bin/env python</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> marvel</span><br><span class="line"><span class="keyword">import</span> marvel.config</span><br><span class="line"><span class="keyword">import</span> marvel.queue</span><br><span class="line"></span><br><span class="line">###### settings</span><br><span class="line"></span><br><span class="line">DB         = <span class="string">"ECOL"</span>                         ## database name,需修改，和DBprepare.py中命名一样</span><br><span class="line">COVERAGE   = <span class="number">25</span>                             ## coverage <span class="keyword">of</span> the dataset，需修改</span><br><span class="line">DB_FIX     = DB + <span class="string">"_FIX"</span>                    ## name <span class="keyword">of</span> the database containing the patched reads</span><br><span class="line">PARALLEL   = multiprocessing.cpu_count()    ## number <span class="keyword">of</span> available processors</span><br><span class="line"></span><br><span class="line">###### patch raw reads</span><br><span class="line"></span><br><span class="line">q = marvel.queue.queue(DB, COVERAGE, PARALLEL)</span><br><span class="line"></span><br><span class="line">###### run daligner to create initial overlaps</span><br><span class="line">q.plan(<span class="string">"&#123;db&#125;.dalign.plan"</span>)</span><br><span class="line"></span><br><span class="line">###### run LAmerge to merge overlap blocks</span><br><span class="line">q.plan(<span class="string">"&#123;db&#125;.merge.plan"</span>)</span><br><span class="line"></span><br><span class="line">## create quality and trim annotation (tracks) for each overlap block</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAq -b &#123;block&#125; &#123;db&#125; &#123;db&#125;.&#123;block&#125;.las"</span>)</span><br><span class="line">## merge quality and trim tracks</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; q"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; trim"</span>)</span><br><span class="line"></span><br><span class="line">## run LAfix to patch reads based on overlaps</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAfix -g -1 &#123;db&#125; &#123;db&#125;.&#123;block&#125;.las &#123;db&#125;.&#123;block&#125;.fixed.fasta"</span>)</span><br><span class="line">## join all fixed fasta files</span><br><span class="line">q.single(<span class="string">"!cat &#123;db&#125;.*.fixed.fasta &gt; &#123;db&#125;.fixed.fasta"</span>)</span><br><span class="line"></span><br><span class="line">## create a new Database <span class="keyword">of</span> fixed reads (-j numOfThreads, -g genome size)</span><br><span class="line">q.single(<span class="string">"&#123;path_scripts&#125;/DBprepare.py -s 50 -r 2 -j 4 -g 4600000 &#123;db_fixed&#125; &#123;db&#125;.fixed.fasta"</span>, db_fixed = DB_FIX)</span><br><span class="line"></span><br><span class="line">## run the commands</span><br><span class="line">q.process()</span><br><span class="line"></span><br><span class="line">########## assemble patched reads</span><br><span class="line"></span><br><span class="line">q = marvel.queue.queue(DB_FIX, COVERAGE, PARALLEL)</span><br><span class="line"></span><br><span class="line">###### run daligner to create overlaps</span><br><span class="line">q.plan(<span class="string">"&#123;db&#125;.dalign.plan"</span>)</span><br><span class="line">###### run LAmerge to merge overlap blocks</span><br><span class="line">q.plan(<span class="string">"&#123;db&#125;.merge.plan"</span>)</span><br><span class="line"></span><br><span class="line">###### start scrubbing pipeline</span><br><span class="line"></span><br><span class="line">########## for larger genomes (&gt; <span class="number">100</span>MB) LAstitch can be run <span class="keyword">with</span> the -L option (preload reads)</span><br><span class="line">########## <span class="keyword">with</span> the -L option two passes over the overlap files are performed:</span><br><span class="line">########## first to buffer all reads and a second time to stitch them</span><br><span class="line">########## <span class="keyword">otherwise</span> the random file access can make LAstitch pretty slow.</span><br><span class="line">########## Another option would be, to keep the whole db <span class="keyword">in</span> cache (/dev/shm/)</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAstitch -f 50 &#123;db&#125; &#123;db&#125;.&#123;block&#125;.las &#123;db&#125;.&#123;block&#125;.stitch.las"</span>)</span><br><span class="line"></span><br><span class="line">########## create quality and trim annotation (tracks) for each overlap block and merge them</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAq -s 5 -T trim0 -b &#123;block&#125; &#123;db&#125; &#123;db&#125;.&#123;block&#125;.stitch.las"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; q"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; trim0"</span>)</span><br><span class="line"></span><br><span class="line">########## create a repeat annotation (tracks) for each overlap block and merge them</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LArepeat -c &#123;coverage&#125; -b &#123;block&#125; &#123;db&#125; &#123;db&#125;.&#123;block&#125;.stitch.las"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; repeats"</span>)</span><br><span class="line"></span><br><span class="line">########## detects <span class="string">"borders"</span> <span class="keyword">in</span> overlaps due to bad regions within reads that were not detected</span><br><span class="line">########## <span class="keyword">in</span> LAfix. Those regions can be quite big (several Kb). If gaps within a read are</span><br><span class="line">########## detected LAgap chooses the longer part oft the read <span class="keyword">as</span> valid range. The other part(s) are</span><br><span class="line">########## discarded</span><br><span class="line">########## option -L (see LAstitch) is also available</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAgap -t trim0 &#123;db&#125; &#123;db&#125;.&#123;block&#125;.stitch.las &#123;db&#125;.&#123;block&#125;.gap.las"</span>)</span><br><span class="line"></span><br><span class="line">########## create a new trim1 track, (trim0 is kept)</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAq -s 5 -u -t trim0 -T trim1 -b &#123;block&#125; &#123;db&#125; &#123;db&#125;.&#123;block&#125;.gap.las"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/TKmerge -d &#123;db&#125; trim1"</span>)</span><br><span class="line"></span><br><span class="line">########## based on different filter critera filter out: local-alignments, repeat induced-alifnments</span><br><span class="line">########## previously discarded alignments, ....</span><br><span class="line">########## -r repeats, -t trim1 ... use repeats and trim1 track</span><br><span class="line">########## -n <span class="number">500</span>  ... overlaps must be anchored by at least <span class="number">500</span> bases (non-repeats)</span><br><span class="line">########## -u <span class="number">0</span>    ... overlaps <span class="keyword">with</span> unaligned bases according to the trim1 interval are discarded</span><br><span class="line">########## -o <span class="number">2000</span> ... overlaps shorter than <span class="number">2</span>k bases are discarded</span><br><span class="line">########## -p      ... purge overlaps, overlaps are not written into the output file</span><br><span class="line">########## option -L (see LAstitch) is also available</span><br><span class="line">q.block(<span class="string">"&#123;path&#125;/LAfilter -n 300 -r repeats -t trim1 -T -o 2000 -u 0 &#123;db&#125; &#123;db&#125;.&#123;block&#125;.gap.las &#123;db&#125;.&#123;block&#125;.filtered.las"</span>)</span><br><span class="line"></span><br><span class="line">########## merge all filtered overlap files into one overlap file</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/LAmerge -S filtered &#123;db&#125; &#123;db&#125;.filtered.las"</span>)</span><br><span class="line"></span><br><span class="line">########## create overlap graph</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/OGbuild -t trim1 &#123;db&#125; &#123;db&#125;.filtered.las &#123;db&#125;.graphml"</span>)</span><br><span class="line"></span><br><span class="line">########## tour the overlap graph and create contigs paths</span><br><span class="line">q.single(<span class="string">"&#123;path_scripts&#125;/OGtour.py -c &#123;db&#125; &#123;db&#125;.graphml"</span>)</span><br><span class="line"></span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/LAcorrect -j 4 -r &#123;db&#125;.tour.rids &#123;db&#125; &#123;db&#125;.filtered.las &#123;db&#125;.corrected"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/FA2db -c &#123;db&#125;_CORRECTED [expand:&#123;db&#125;.corrected.*.fasta]"</span>)</span><br><span class="line"></span><br><span class="line">########## create contig fasta files</span><br><span class="line">q.single(<span class="string">"&#123;path_scripts&#125;/tour2fasta.py -c &#123;db&#125;_CORRECTED -t trim1 &#123;db&#125; &#123;db&#125;.tour.graphml &#123;db&#125;.tour.paths"</span>)</span><br><span class="line"></span><br><span class="line">###### optional: create a layout <span class="keyword">of</span> the overlap graph which can viewed <span class="keyword">in</span> a Browser (svg) or Gephi (dot)</span><br><span class="line">## q.single(<span class="string">"&#123;path&#125;/OGlayout -R &#123;db&#125;.tour.graphml &#123;db&#125;.tour.layout.svg"</span>)</span><br><span class="line">q.single(<span class="string">"&#123;path&#125;/OGlayout -R &#123;db&#125;.tour.graphml &#123;db&#125;.tour.layout.dot"</span>)</span><br><span class="line"></span><br><span class="line">q.process()</span><br></pre></td></tr></table></figure>
<h2 id="4-_软件运行实例">4. 软件运行实例</h2><h3 id="4-1-_分步运行">4.1. 分步运行</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9uYXR1cmUyNTQ1OA==" title="https://www.nature.com/articles/nature25458">The axolotl genome and the evolution of key tissue formation regulators<i class="fa fa-external-link"></i></span> 基因组组装过程，来源于MARVEL的Github主页的 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NjaGxvaS9NQVJWRUwvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvYXhvbG90bC9SRUFETUU=" title="https://github.com/schloi/MARVEL/blob/master/examples/axolotl/README">MARVEL/examples/axolotl/README<i class="fa fa-external-link"></i></span> <strong>（初始化数据库时经过Fix的修正过程）</strong><br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">This file contains the steps we took to assemble the axolotl genome.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## READ PATCHING PHASE</span><br><span class="line"></span><br><span class="line">## create initial database</span><br><span class="line">FA2db -v -x <span class="number">2000</span> -b AXOLOTL -f axoFiles.txt</span><br><span class="line"></span><br><span class="line">## split database into blocks</span><br><span class="line">DBsplit AXOLOTL</span><br><span class="line"></span><br><span class="line">## create dust track</span><br><span class="line">DBdust AXOLOTL</span><br><span class="line"></span><br><span class="line">## create daligner and merge plans, replace SERVER and PORT</span><br><span class="line">HPCdaligner -v -t <span class="number">100</span> -D SERVER:PORT -r1 -j16 --dal <span class="number">32</span> --mrg <span class="number">32</span> -o AXOLOTL AXOLOTL</span><br><span class="line">################################################################## DBprepare.py 脚本可运行上诉<span class="number">4</span>步 ######################################################################################################</span><br><span class="line">## start dynamic repeat masking server on SERVER:PORT, replace PORT （可跳过）</span><br><span class="line">DMserver -t <span class="number">16</span> -p PORT -C AXOLOTL <span class="number">40</span> AXOLOTL_CP</span><br><span class="line">################################################################################################################################################################################################################################</span><br><span class="line">## AXOLOTL.daligner.plan 和 AXOLOTL.merge.plan 是 DBprepare.py 生成的结果，内容是一些运行LAmerge和daligner程序的命令</span><br><span class="line">## run daligner to create initial overlaps</span><br><span class="line">AXOLOTL.daligner.plan</span><br><span class="line"></span><br><span class="line">## after all daligner jobs are finshied the dynamic repeat masker has to be shut down （可跳过）</span><br><span class="line">DMctl -h HOST -p PORT shutdown</span><br><span class="line"></span><br><span class="line">###### run LAmerge to merge overlap blocks</span><br><span class="line">AXOLOTL.merge.plan</span><br><span class="line">##############################################################################################################################################################################</span><br><span class="line">## create quality and trim annotation (tracks) for each overlap block for each database block</span><br><span class="line">LAq -b &lt;block&gt; AXOLOTL AXOLOTL.&lt;block&gt;.las</span><br><span class="line"></span><br><span class="line">TKmerge -d AXOLOTL q</span><br><span class="line">TKmerge -d AXOLOTL trim</span><br><span class="line"></span><br><span class="line">## run LAfix to patch reads based on overlaps for each database block</span><br><span class="line">LAfix -c -x <span class="number">2000</span> AXOLOTL AXOLOTL.&lt;block&gt;.las AXOLOTL.&lt;block&gt;.fixed.fasta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">########## ASSEMBLY PHASE</span><br><span class="line"></span><br><span class="line">## create a new database <span class="keyword">with</span> the fixed reads</span><br><span class="line">FA2db -v -x <span class="number">2000</span> -c AXOLOTL_FIX AXOLOTL.*.fixed.fasta</span><br><span class="line"></span><br><span class="line">## split database into blocks</span><br><span class="line">DBsplit AXOLOTL_FIX</span><br><span class="line"></span><br><span class="line">## combine repeat tracks maskr and maskc that were created during read patching phase</span><br><span class="line">TKcombine AXOLOTL_FIX mask maskr maskc</span><br><span class="line"></span><br><span class="line">## create daligner and merge plans, replace SERVER and PORT</span><br><span class="line">HPCdaligner -v -t <span class="number">100</span> -D SERVER:PORT -m mask -r2 -j16 --dal <span class="number">32</span> --mrg <span class="number">32</span> -o AXOLOTL_FIX AXOLOTL_FIX</span><br><span class="line"></span><br><span class="line">## start dynamic repeat masking server on SERVER:PORT, replace PORT</span><br><span class="line">DMserver -t <span class="number">16</span> -p PORT -C AXOLOTL_FIX <span class="number">40</span> AXOLOTL_CP</span><br><span class="line"></span><br><span class="line">###### run daligner to create overlaps</span><br><span class="line">AXOLOTL_FIX.dalign.plan</span><br><span class="line"></span><br><span class="line">## after all daligner jobs are finshied the dynamic repeat masker has to be shut down</span><br><span class="line">DMctl -h HOST -p PORT shutdown</span><br><span class="line"></span><br><span class="line">###### run LAmerge to merge overlap blocks</span><br><span class="line">AXOLOTL_FIX.merge.plan</span><br><span class="line"></span><br><span class="line">###### SCRUBBING PHASE</span><br><span class="line"></span><br><span class="line">## repair alignments that prematurely stopped due to left-over errors <span class="keyword">in</span> the reads for each database block</span><br><span class="line">LAstitch -f <span class="number">50</span> AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.las AXOLOTL_FIX.&lt;block&gt;.stitch.las</span><br><span class="line"></span><br><span class="line">## create quality and trim annotation for each database block</span><br><span class="line">LAq -T trim0 -s <span class="number">5</span> -b &lt;block&gt; AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.stitch.las</span><br><span class="line"></span><br><span class="line">TKmerge -d AXOLOTL_FIX q</span><br><span class="line">TKmerge -d AXOLOTL_FIX trim0</span><br><span class="line"></span><br><span class="line">## create a repeat annotation for each database block</span><br><span class="line">LArepeat -c &lt;coverage&gt; -l <span class="number">1.5</span> -h <span class="number">2.0</span> -b &lt;block&gt; AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.stitch.las</span><br><span class="line"></span><br><span class="line">TKmerge -d AXOLOTL_FIX repeats</span><br><span class="line"></span><br><span class="line">## merge duplicate &amp; overlapping annotation repeat annotation and masking server output</span><br><span class="line">TKcombine &#123;db&#125; frepeats repeats maskc maskr</span><br><span class="line"></span><br><span class="line">## remove gaps (ie. due to chimeric reads, ...) for each database block</span><br><span class="line">LAgap -s <span class="number">100</span> -t trim0 AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.stitch.las AXOLOTL_FIX.&lt;block&gt;.gap.las</span><br><span class="line"></span><br><span class="line">## recalculate the trim track based on the cleaned up gaps for each database block</span><br><span class="line">LAq -u -t trim0 -T trim1 -b &lt;block&gt; AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.gap.las</span><br><span class="line"></span><br><span class="line">TKmerge -d AXOLOTL_FIX trim1</span><br><span class="line"></span><br><span class="line">## filter repeat induced alignments and try to resolve repeat modules for each database block</span><br><span class="line">LAfilter -p -s <span class="number">100</span> -n <span class="number">300</span> -r frepeats -t trim1 -o <span class="number">1000</span> -u <span class="number">0</span> AXOLOTL_FIX AXOLOTL_FIX.&lt;block&gt;.gap.las AXOLOTL_FIX.&lt;block&gt;.filtered.las</span><br><span class="line"></span><br><span class="line">## not much is left now, so we can merge everything into a single las file</span><br><span class="line">LAmerge -S filtered AXOLOTL_FIX AXOLOTL_FIX.filtered.las</span><br><span class="line"></span><br><span class="line">## create overlap graph</span><br><span class="line">mkdir -p components</span><br><span class="line">OGbuild -t trim1 -s -c <span class="number">1</span> AXOLOTL_FIX AXOLOTL_FIX.filtered.las components/AXOLOTL_FIX</span><br><span class="line"></span><br><span class="line">## tour the overlap graph and create contigs paths for each components<span class="comment">/*.graphml</span></span><br><span class="line"><span class="comment">OGtour.py -c AXOLOTL_FIX &lt;component.graphml&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## create contig fasta files for each components/*.paths</span></span><br><span class="line"><span class="comment">tour2fasta.py -t trim1 AXOLOTL_FIX &lt;component.graphml&gt; &lt;component.paths&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="4-2-_集合运行">4.2. 集合运行</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">source /public/home/software/.bashrc</span><br><span class="line">export PATH=<span class="string">"/public/home/cotton/software/MARVEL-bin/bin:$PATH"</span></span><br><span class="line">export PATH=<span class="string">"/public/home/zpxu/miniconda3/bin:$PATH"</span></span><br><span class="line">export LD_LIBRARY_PATH=<span class="string">"$PATH:/public/home/zpxu/miniconda3/lib"</span></span><br><span class="line"></span><br><span class="line">cd /public/home/zpxu/AS/results/MARVEL</span><br><span class="line">fa=<span class="string">"/public/home/zpxu/AS/PacBio/bmk_nh_filtered_subreads.fasta"</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">"1. initially the database"</span></span><br><span class="line">DBprepare<span class="selector-class">.py</span> AS $&#123;fa&#125;</span><br><span class="line">cd /public/home/zpxu/AS/results/MARVEL</span><br><span class="line">#<span class="selector-id">#sed</span> -<span class="selector-tag">i</span> <span class="string">"s/^/\/public\/home\/cotton\/software\/MARVEL-bin\/bin\//g"</span> /public/home/zpxu/AS/results/MARVEL/AS<span class="selector-class">.dalign</span><span class="selector-class">.plan</span></span><br><span class="line">#<span class="selector-id">#sed</span> -<span class="selector-tag">i</span> <span class="string">"s/^/\/public\/home\/cotton\/software\/MARVEL-bin\/bin\//g"</span> /public/home/zpxu/AS/results/MARVEL/AS<span class="selector-class">.merge</span><span class="selector-class">.plan</span></span><br><span class="line">python /public/home/zpxu/AS/scripts/MARVEL_do.py</span><br></pre></td></tr></table></figure>
<h2 id="5-_疑问参数">5. 疑问参数</h2><h3 id="5-1-_线程数目参数">5.1. 线程数目参数</h3><p><code>-j</code>参数表示线程数，需为2的幂次。</p>
<h3 id="5-2-_HPCdaligner_的_-D_SERVER:PORT">5.2. HPCdaligner 的 -D SERVER:PORT</h3><p>解释见：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NjaGxvaS9NQVJWRUwvaXNzdWVzLzc=" title="https://github.com/schloi/MARVEL/issues/7">HPCdaligner parameter &lt;-D host:port&gt; ##7<i class="fa fa-external-link"></i></span>，即重复序列多的基因组组装需要设置此参数，如果不是则不需要设置此参数和运行随后的 <code>DMserver</code> 步骤。如下即可：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HPCdaligner -v -t <span class="number">100</span> -r1 -j16 --dal <span class="number">32</span> --mrg <span class="number">32</span> -o AXOLOTL AXOLOTL</span><br></pre></td></tr></table></figure></p>
<h3 id="5-3-_DMserver_的_-p_PORT_和_expected-coverage">5.3. DMserver 的 -p PORT 和 expected.coverage</h3><p>Dynamic repeat Masking server主要目的在于降低大基因组组装对于计算机CPU和内存的需求，</p>
<blockquote>
<p>While preliminary calculations for computational time and storage space estimated over multiple millions of CPU hours and &gt;2 PB of storage for one daligner run, the usage of a dynamic repeat masking server (below) reduced this dramatically to 150,000 CPU hours and 120 Tb of storage space for the complete pipeline.</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-_软件介绍&quot;&gt;1. 软件介绍&lt;/h2&gt;&lt;p&gt;PacBio三代数据基因组组装，针对低测序深度的组装;&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/MARVEL.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="MARVEL" scheme="http://tiramisutes.github.io/tags/MARVEL/"/>
    
  </entry>
  
  <entry>
    <title>HiC分析主要内容</title>
    <link href="http://tiramisutes.github.io/2018/05/01/HiC.html"/>
    <id>http://tiramisutes.github.io/2018/05/01/HiC.html</id>
    <published>2018-05-01T11:23:42.000Z</published>
    <updated>2018-09-28T02:36:06.069Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Chromosome_conformation_techniques.jpg/800px-Chromosome_conformation_techniques.jpg" alt=""><br><a id="more"></a></p>
<h2 id="零、常识介绍">零、常识介绍</h2><blockquote>
<p>Mammalian genomes are spatially organized into compartments, topologically associating domains (TADs), and loops to facilitate gene regulation and other chromosomal functions.</p>
<p>3D interactions mostly occur within chromosomes (cis) rather than between chromosomes (trans), all methods detected more cis than trans interactions.</p>
</blockquote>
<h2 id="一、鉴定染色体交互_(identify_chromatin_interactions)">一、鉴定染色体交互 (identify chromatin interactions)</h2><blockquote>
<p>Chromatin interactions are contacts between regions far from each other on the linear DNA sequence but close in 3D space；</p>
</blockquote>
<hr>
<table>
<thead>
<tr>
<th>Function</th>
<th>Method</th>
<th>vailability</th>
<th>Programming language</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chromatin interactions</td>
<td>Fit-Hi-C</td>
<td><span class="exturl" data-url="aHR0cDovL25vYmxlLmdzLndhc2hpbmd0b24uZWR1L3Byb2ovZml0LWhpLWM=" title="http://noble.gs.washington.edu/proj/fit-hi-c">http://noble.gs.washington.edu/proj/fit-hi-c<i class="fa fa-external-link"></i></span></td>
<td>Python</td>
</tr>
<tr>
<td>Chromatin interactions</td>
<td>GOTHiC</td>
<td><span class="exturl" data-url="aHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvcmVsZWFzZS9iaW9jL2h0bWwvR09USGlDLmh0bWw=" title="http://bioconductor.org/packages/release/bioc/html/GOTHiC.html">http://bioconductor.org/packages/release/bioc/html/GOTHiC.html<i class="fa fa-external-link"></i></span></td>
<td>R</td>
</tr>
<tr>
<td>Chromatin interactions</td>
<td>HOMER</td>
<td><span class="exturl" data-url="aHR0cDovL2hvbWVyLnVjc2QuZWR1L2hvbWVyL2ludGVyYWN0aW9ucy9IaUNtYXRyaWNlcy5odG1s" title="http://homer.ucsd.edu/homer/interactions/HiCmatrices.html">http://homer.ucsd.edu/homer/interactions/HiCmatrices.html<i class="fa fa-external-link"></i></span></td>
<td>Perl, R</td>
</tr>
<tr>
<td>Chromatin interactions</td>
<td>HIPPIE</td>
<td><span class="exturl" data-url="aHR0cDovL3dhbmdsYWIucGNiaS51cGVubi5lZHUvaGlwcGllLw==" title="http://wanglab.pcbi.upenn.edu/hippie/">http://wanglab.pcbi.upenn.edu/hippie/<i class="fa fa-external-link"></i></span></td>
<td>Python, Perl, R</td>
</tr>
<tr>
<td>Chromatin interactions</td>
<td>diffHic</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL3JlbGVhc2UvYmlvYy9odG1sL2RpZmZIaWMuaHRtbA==" title="https://bioconductor.org/packages/release/bioc/html/diffHic.html">https://bioconductor.org/packages/release/bioc/html/diffHic.html<i class="fa fa-external-link"></i></span></td>
<td>R, Python</td>
</tr>
<tr>
<td>Chromatin interactions</td>
<td>HiCCUPS</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlci93aWtpL0Rvd25sb2Fk" title="https://github.com/theaidenlab/juicer/wiki/Download">https://github.com/theaidenlab/juicer/wiki/Download<i class="fa fa-external-link"></i></span></td>
<td>Java</td>
</tr>
<tr>
<td>TADs</td>
<td>HiCseg</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL0hpQ3NlZy9pbmRleC5odG1s" title="https://cran.r-project.org/web/packages/HiCseg/index.html">https://cran.r-project.org/web/packages/HiCseg/index.html<i class="fa fa-external-link"></i></span></td>
<td>R</td>
</tr>
<tr>
<td>TADs</td>
<td>TADbit</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tLzNER2Vub21lcy9UQURiaXQ=" title="https://github.com/3DGenomes/TADbit">https://github.com/3DGenomes/TADbit<i class="fa fa-external-link"></i></span></td>
<td>Python</td>
</tr>
<tr>
<td>TADs</td>
<td>DomainCaller</td>
<td><span class="exturl" data-url="aHR0cDovL2Nocm9tb3NvbWUuc2RzYy5lZHUvbW91c2UvaGktYy9kb3dubG9hZC5odG1s" title="http://chromosome.sdsc.edu/mouse/hi-c/download.html">http://chromosome.sdsc.edu/mouse/hi-c/download.html<i class="fa fa-external-link"></i></span></td>
<td>Matlab, Perl</td>
</tr>
<tr>
<td>TADs</td>
<td>InsulationScore</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Rla2tlcmxhYi9jcmFuZS1uYXR1cmUtMjAxNQ==" title="https://github.com/dekkerlab/crane-nature-2015">https://github.com/dekkerlab/crane-nature-2015<i class="fa fa-external-link"></i></span></td>
<td>Perl</td>
</tr>
<tr>
<td>TADs</td>
<td>Arrowhead</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlci93aWtpL0Rvd25sb2Fk" title="https://github.com/theaidenlab/juicer/wiki/Download">https://github.com/theaidenlab/juicer/wiki/Download<i class="fa fa-external-link"></i></span></td>
<td>Java</td>
</tr>
<tr>
<td>TADs</td>
<td>TADtree</td>
<td><span class="exturl" data-url="aHR0cDovL2NvbXBiaW8uY3MuYnJvd24uZWR1L3Byb2plY3RzL3RhZHRyZWUv" title="http://compbio.cs.brown.edu/projects/tadtree/">http://compbio.cs.brown.edu/projects/tadtree/<i class="fa fa-external-link"></i></span></td>
<td>Python</td>
</tr>
<tr>
<td>TADs</td>
<td>Armatus</td>
<td><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpbmdzZm9yZGdyb3VwL2FybWF0dXM=" title="https://github.com/kingsfordgroup/armatus">https://github.com/kingsfordgroup/armatus<i class="fa fa-external-link"></i></span></td>
<td>C++</td>
</tr>
</tbody>
</table>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/HiCaly.png" alt="image"><br>【上述图表来源于：<span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9ubWV0aC40MzI1" title="https://www.nature.com/articles/nmeth.4325">Comparison of computational methods for Hi-C data analysis<i class="fa fa-external-link"></i></span>】</p>
<blockquote>
<p>The total number of interactions called by each method increased with the number of reads retained by the filtering step for all tools at any resolution, although the rate of increase varied from tool to tool.</p>
</blockquote>
<h2 id="二、Topologically_Associating_Domains_(TADs)">二、Topologically Associating Domains (TADs)</h2><blockquote>
<p>TADs are structural domains consisting of chromatin regions that are highly self-interacting but have limited interaction with regions in other domains;</p>
</blockquote>
<hr>
<p><span class="exturl" data-url="aHR0cDovL2NvbXBiaW8uY3MuYnJvd24uZWR1L3Byb2plY3RzL3RhZHRyZWUv" title="http://compbio.cs.brown.edu/projects/tadtree/">TADtree: an algorithm the identification of hierarchical topological domains in Hi-C data<i class="fa fa-external-link"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlci93aWtpL0Fycm93aGVhZA==" title="https://github.com/theaidenlab/juicer/wiki/Arrowhead">Arrowhead: for finding contact domains<i class="fa fa-external-link"></i></span></p>
<blockquote>
<p>Used bin size (resolution) of at least 40 kb for TAD calling;</p>
</blockquote>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/public/</span>home<span class="regexp">/cotton/</span>software<span class="regexp">/juicer/</span>data</span><br><span class="line">java -jar ..<span class="regexp">/CPU/</span>juicer_tools.jar arrowhead -r <span class="number">40000</span> -k NONE test.hic test_contact_domains_list</span><br></pre></td></tr></table></figure>
<h2 id="三、Compartments">三、Compartments</h2><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2Jpb2luZm9ybWF0aWNzL2FkdmFuY2UtYXJ0aWNsZS9kb2kvMTAuMTA5My9iaW9pbmZvcm1hdGljcy9idHg4MDIvNDczNTE1Ng==" title="https://academic.oup.com/bioinformatics/advance-article/doi/10.1093/bioinformatics/btx802/4735156">CscoreTool: fast Hi-C compartment analysis at high resolution<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlci93aWtpL0VpZ2VudmVjdG9y" title="https://github.com/theaidenlab/juicer/wiki/Eigenvector">Eigenvector: used to delineate compartments in Hi-C data at coarse resolution<i class="fa fa-external-link"></i></span></li>
</ul>
<blockquote>
<p>The genome-wide chromosome conformation capture (Hi-C) has revealed that the eukaryotic genome can be partitioned into A and B compartments that have distinctive chromatin and transcription features. </p>
<p>The current method for calculating A/B compartments is based on the Principal Component Analysis (PCA) of the normalized Hi-C interaction matrix (Lieberman-Aiden et al., 2009). The first eigenvector (Principal Component 1, PC1) of the correlation matrix is then defined as the compartment score, and genomic windows with positive or negative compartment scores are defined as A or B compartment, respectively.</p>
</blockquote>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /<span class="meta">public</span>/home/cotton/software/juicer/data</span><br><span class="line">java -jar ../<span class="meta">CPU</span>/juicer_tools.jar eigenvector KR <span class="keyword">test</span>.hic <span class="number">1</span> <span class="built_in">BP</span> <span class="number">1000000</span> &gt; <span class="keyword">test</span>.Compartments</span><br></pre></td></tr></table></figure>
<p>hic 文件来源于 3D DNA 流程或 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlci93aWtpL1ByZQ==" title="https://github.com/theaidenlab/juicer/wiki/Pre">java -Xmx2g -jar juicebox_tools.jar pre<i class="fa fa-external-link"></i></span>;</p>
<h2 id="四、Chromatin_loops">四、Chromatin loops</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/loop.png" alt="image"></p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DMjYzODc2OS8=" title="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2638769/">Chromatin loops in gene regulation<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5jZWxsLmNvbS9jZWxsLXN5c3RlbXMvYWJzdHJhY3QvUzI0MDUtNDcxMigxNw==" title="http://www.cell.com/cell-systems/abstract/S2405-4712(17">CTCF-Mediated Chromatin Loops between Promoter and Gene Body Regulate Alternative Splicing across Individuals<i class="fa fa-external-link"></i></span>30488-X)</li>
<li><span class="exturl" data-url="aHR0cDovL2VtYm9qLmVtYm9wcmVzcy5vcmcvY29udGVudC8zNi8yNC8zNTczLmxvbmc=" title="http://emboj.embopress.org/content/36/24/3573.long">Topologically associating domains and chromatin loops depend on cohesin and are regulated by CTCF, WAPL, and PDS5 proteins<i class="fa fa-external-link"></i></span></li>
</ul>
<blockquote>
<p>HiCCUPS is an algorithm for finding chromatin loops.</p>
</blockquote>
<p>HiCCUPS 算法包含在 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZWFpZGVubGFiL2p1aWNlcg==" title="https://github.com/theaidenlab/juicer">juicer<i class="fa fa-external-link"></i></span> 软件中，可按照如下手动单独运行（有GPU节点使用）：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java -Xmx2g -jar ./CPU/juicer_tools<span class="selector-class">.jar</span> hiccups -h</span><br><span class="line">java -Xmx2g -jar ./CPU/juicer_tools<span class="selector-class">.jar</span> hiccups /public/home/cotton/software/<span class="number">3</span>d-dna/xzp/Hs1<span class="selector-class">.split</span><span class="selector-class">.hic</span> all_hiccups_loops</span><br><span class="line"></span><br><span class="line">java -Xmx2g -jar ./CPU/juicer_tools<span class="selector-class">.jar</span> hiccups -r <span class="number">40000</span> -<span class="selector-tag">p</span> <span class="number">1</span> -<span class="selector-tag">i</span> <span class="number">3</span> -f <span class="number">0.1</span> -d <span class="number">80000</span> --ignore_sparsity /public/home/cotton/software/<span class="number">3</span>d-dna/xzp/Hs1<span class="selector-class">.split</span><span class="selector-class">.hic</span> hiccups_40kb</span><br></pre></td></tr></table></figure></p>
<h2 id="五、软件性能比较">五、软件性能比较</h2><h3 id="过滤步骤">过滤步骤</h3><ol>
<li>HiCCUPS retained the largest number of aligned reads, although it is worth noting that HiCCUPS filters only PCR duplicates without discarding other potential artifact reads.</li>
<li>diffHic filtered the highest proportion of aligned reads in most data sets (from 27% to 94%, depending on the data set); but, given its higher alignment rate, still retained a large number of reads.</li>
</ol>
<h3 id="Identification_of_chromatin_interactions">Identification of chromatin interactions</h3><ol>
<li>GOTHiC called the highest number of cis interactions;</li>
<li>diffHic found the largest number of trans interactions;</li>
<li>HiCCUPS, which aggregates nearby peaks into a single interaction, identified fewer interactions than all other tools.</li>
<li>For interaction callers, HOMER and HiCCUPS yielded the highest proportion of interactions with a potential biological significance—although the potential of HiCCUPS could be fully exploited only in the analysis of very high-resolution data sets.</li>
</ol>
<h3 id="Distance_between_the_interacting_points_in_cis">Distance between the interacting points in cis</h3><ol>
<li>GOTHiC found interactions at shorter mean distance at both 5- and 40-kb resolutions;</li>
<li>At 5 kb, Fit-Hi-C called interactions at an average distance of more than 10 Mb; which was expected, as Fit-Hi-C is designed to call <strong>midrange interactions</strong>.</li>
<li>At low resolution, GOTHiC had the highest concordance, most likely because it called a large number of short-range interactions in every sample replicate.</li>
<li>At high resolution, the interactions found by HiCCUPS were the most conserved among replicates.</li>
<li>At 5kb resolution, HiCCUPS and HOMER called the highest proportion of promoter–enhancer interactions, although not the highest absolute number.</li>
</ol>
<h3 id="cis_interaction_正确性和敏感性">cis interaction 正确性和敏感性</h3><ol>
<li>GOTHiC recovered the largest number of true-positive interactions. HOMER and Fit-Hi-C performed comparably to GOTHiC, although they called a smaller number of total interactions.</li>
<li>In high-resolution data sets, diffHic recalled the highest number of true positives, although HOMER identified more true positives than any other tool at comparable numbers of called interactions.</li>
<li>The highest sensitivity was achieved by Fit-Hi-C.</li>
</ol>
<h3 id="Identification_of_topologically_associating_domains">Identification of topologically associating domains</h3><ol>
<li>The number of TADs did not increase with the number of reads retained after filtering for all tools, with the exception of Arrowhead.</li>
<li>At 40-kb resolution, TADtree called the largest (7,638) and Arrowhead the smallest (636) number of TADs. Conversely, at 1-Mb resolution, InsulationScore returned the largest number of TADs.</li>
<li>Note that some methods (HiCseg, TADbit, InsulationScore) partition chromosomes in a continuous set of TADs, whereas the others allow gaps between TADs. Arrowhead and TADtree, which adopt multiscale approaches, returned nested TADs.</li>
<li>TADs identified by HiCseg were also the most reproducible when using the overlap coefficient.</li>
</ol>
<h2 id="六、分析流程">六、分析流程</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/HIC2.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Chromosome_conformation_techniques.jpg/800px-Chromosome_conformation_techniques.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="HiC" scheme="http://tiramisutes.github.io/tags/HiC/"/>
    
  </entry>
  
  <entry>
    <title>学IGV必看的初级教程</title>
    <link href="http://tiramisutes.github.io/2018/02/05/IGV.html"/>
    <id>http://tiramisutes.github.io/2018/02/05/IGV.html</id>
    <published>2018-02-05T08:06:54.000Z</published>
    <updated>2018-11-19T09:07:23.198Z</updated>
    
    <content type="html"><![CDATA[<p><span class="exturl" data-url="aHR0cDovL3NvZnR3YXJlLmJyb2FkaW5zdGl0dXRlLm9yZy9zb2Z0d2FyZS9pZ3Yv" title="http://software.broadinstitute.org/software/igv/">Integrative Genomics Viewer (IGV)<i class="fa fa-external-link"></i></span>作为一个高性能的可视化工具，可以交互式的察看综合的基因组相关数据，也友好的支持多种数据类型，自然是生信工作者必须使用的利器之一。<span class="exturl" data-url="aHR0cDovL3NvZnR3YXJlLmJyb2FkaW5zdGl0dXRlLm9yZy9zb2Z0d2FyZS9pZ3YvYm9vay9leHBvcnQvaHRtbA==" title="http://software.broadinstitute.org/software/igv/book/export/html">官网也提供了很详细的使用讲解<i class="fa fa-external-link"></i></span>，这里仅是根据我目前需要学习摘录部分做的整理，后面有时间在做其他整理。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IGVV.png" alt=""><br><a id="more"></a></p>
<h2 id="1-_输入数据准备">1. 输入数据准备</h2><p>IGV可以导入多种类型的数据，详见下文的<a href="">数据导入</a>介绍，此处主要说的是排序后的 <code>bwa</code> 的比对文件：<code>bowtie2/BWA + samtools (samtools view&gt;samtools sort&gt;samtools index)</code> 处理结果或RNA-seq的 Tophat结果；</p>
<h2 id="2-_主界面">2. 主界面</h2><h3 id="2-1_基础主界面">2.1 基础主界面</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/igvlouts.jpg" alt=""></p>
<ol>
<li>工具栏；</li>
<li>红框表示显示当前染色体的相应区域；</li>
<li>刻度线表示所处位置坐标；</li>
<li>tracks区域，也即 Alignment Track区；主要的信息区，通常会显示甲基化、基因表达、拷贝数、杂合性缺失（Loss of Heterozygosity）、突变等信息；对应的有三种显示形式：Collapsed、Squished 和 Expanded；</li>
<li>特征显示区；蓝色粗线—外显子区域，细线内含子区域，空白—基因间隙；</li>
<li>列出 Track names，即导入的比对结果名称；</li>
<li>属性面板；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/track.jpg" alt=""></li>
</ol>
<h3 id="2-2_结果界面说明">2.2 结果界面说明</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/1IGV.png" alt=""></p>
<ol>
<li>(1) 处可手动输入想要察看的染色体/contigs/scaffolds编号，然后回车察看；</li>
<li>(2) 处是参考序列对应的核酸序列，其中四种核酸分别用不同的颜色表示：(<strong><span style="color: green;">A</span></strong>, <strong><span style="color: blue;">C</span></strong>, <strong><span style="color: orange;">G</span></strong>, <strong><span style="color: red;">T</span></strong>)，下面为对应的翻译的氨基酸序列，甲硫氨酸（<strong><span style="color: green;">M</span></strong>）用绿色表示，终止密码子（<strong><span style="color: red;">*</span></strong>）红色星号表示；当右上角的标尺足够大时此区域才会显示；</li>
<li>(3) 处不同颜色条表示排序方式，鼠标停留在此处右键选择 <code>&lt;Color alignments by&gt;</code> 可选取不同的颜色形式；同时每一个长条对应的序列和比对信息可以鼠标右键选择来拷贝；每一个长条都是由一系列的核酸序列组成，可通行 <code>&lt;Show all bases&gt;</code> 来显示；比对的reads长条也可通过成对的形式显示；</li>
<li>(4) 处鼠标停留时会显示此处碱基统计信息，例如在此处显示为红蓝色，红色是T，蓝色是C，红色方块大于蓝色，表示所有比对到这一位置的序列中这一位点碱基是T的序列大于C的，即C可能是突变；当导入数据为比对的bam数据时，此处所在区域为 Coverage Track，</li>
</ol>
<h2 id="3-_数据导入">3. 数据导入</h2><p>当数据通过 <code>&lt;File&gt;</code> 导入时，IGV通过导入文件的扩展名来确认数据格式 (file format)，进而确定数据类型 (data type)，再确定数据展现的 Track 形式 (track default display options)；如下所示（此默认值均可修改）：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IGV2.png" alt=""></p>
<h2 id="4-_察看序列比对结果">4. 察看序列比对结果</h2><ol>
<li>可通过 <code>View &gt;&gt;Preferences &gt;&gt;Alignments</code>  面板设置相关参数;</li>
<li>在 Track 区不进行 <code>Color alignments by</code> 的情况下，alignments 只有亮灰和白色两种长条，其中白色的比对质量为零 (mapping quality equal to zero)；</li>
<li>插入：用紫色的 <code>I</code> 或红色的 <code>I</code> （当插入的碱基数多余预设的阀值时）表示；鼠标停留察看详细的插入碱基情况；</li>
<li>缺失：黑条表示；<img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IGV3.png" alt=""></li>
<li><code>Sort alignments by</code> 可对Track区域进行排序，如想返回最初结果则选择 <code>Re-pack alignments</code> 即可；</li>
<li>默认情况下 <code>Track Alignments</code> 区以左图紧凑的单个 reads 的形式展示，通过 <code>View as pairs</code> 可成对显示，且中间以细线连接 (右图)；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/paired-paired.png" alt=""><br>在左图中按住 <code>Ctrl</code> 键鼠标左击某一个长条 (a read)，将以相同的彩色颜色显示出与其配对 (paired mate) 的另一条 read。黑色的表示没有与之配对的另一条read。选中一条 read 后右键 <code>Go to Mate</code> 将会跳转到与其配对 (paired mate) 的另一条 read。If the paired reads have a large insert size, the paired mate will not be highlighted. 右键选择 <code>Clear Selections</code> 来清除所有选择的reads。同时注意到不同reads会用不同的颜色表示 (蓝色：插入大小小于期望值；红色：插入大小大于期望值；绿色、青色、深蓝色：倒置、重复、易位事件)，更多详情见：<span class="exturl" data-url="aHR0cDovL3NvZnR3YXJlLmJyb2FkaW5zdGl0dXRlLm9yZy9zb2Z0d2FyZS9pZ3YvaW50ZXJwcmV0aW5nX2luc2VydF9zaXpl" title="http://software.broadinstitute.org/software/igv/interpreting_insert_size">Interpreting Color by Insert Size<i class="fa fa-external-link"></i></span> 和 <span class="exturl" data-url="aHR0cDovL3NvZnR3YXJlLmJyb2FkaW5zdGl0dXRlLm9yZy9zb2Z0d2FyZS9pZ3YvaW50ZXJwcmV0aW5nX3BhaXJfb3JpZW50YXRpb25z" title="http://software.broadinstitute.org/software/igv/interpreting_pair_orientations">Interpreting Color by Pair Orientation<i class="fa fa-external-link"></i></span>；低分辨率下在 Track Alignments 区域选择 <code>Color alignments by &gt;&gt; insert size and pair orientation</code> 时比对的reads会显示不同的颜色 (Red have larger than expected inferred sizes, and therefore indicate possible deletions; Blue have smaller than expected inferred sizes, and therefore indicate insertions；实心灰代表比对质量比较高的测序片段，空心灰代表比对到此处的测序片段也可以比对到其他位点。)，高分辨率下，可以精确到每个位点的碱基类型：当比对序列上与参考基因组相同的超过80%时，用灰色表示；否则用红色-T，蓝色-C，绿色-A，橙色-G；Translocations on the same chromosome can be detected by color-coding for pair orientation, whereas translocations between two chromosomes can be detected by coloring by insert size. </li>
<li><code>Paired-end alignment tracks</code> 时 (<code>View as pairs</code>)，右键选择 <code>View mate region in split screen</code> 可分隔显示；可实现多个分隔；在下图①处右键选择 <code>Switch to standard view</code> 或鼠标左键双击可返回单个分区；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/NGS_split.png" alt=""></li>
</ol>
<h2 id="5-_察看可变剪切情况">5. 察看可变剪切情况</h2><ol>
<li><p>Loaded junctions data in the standard <code>.bed</code> format (例如TopHat’s “junctions.bed”等输出文件)；</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|<span class="comment">-- accepted_hits.bam</span></span><br><span class="line">|<span class="comment">-- accepted_hits.bam.bai</span></span><br><span class="line">|<span class="comment">-- deletions.bed</span></span><br><span class="line">|<span class="comment">-- insertions.bed</span></span><br><span class="line">|<span class="comment">-- junctions.bed</span></span><br><span class="line">|<span class="comment">-- unmapped.bam</span></span><br><span class="line">`<span class="comment">-- unmapped.bam.bai</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>载入RNA-seq比对基因组bam文件<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IGVSP.png" alt=""><br><strong><span class="exturl" data-url="aHR0cHM6Ly9zb2Z0d2FyZS5icm9hZGluc3RpdHV0ZS5vcmcvc29mdHdhcmUvaWd2L3NwbGljZV9qdW5jdGlvbnM=" title="https://software.broadinstitute.org/software/igv/splice_junctions">图示说明<i class="fa fa-external-link"></i></span>：</strong></p>
</li>
</ol>
<ul>
<li>红色向上弧形表示可变剪切基因位于正链，蓝色向下为负链；</li>
<li>弧形的高度和厚度(thickness)与reads覆盖度成比例；</li>
</ul>
<h2 id="6-_察看变异">6. 察看变异</h2><h3 id="6-1_Mutation_Files：MAF_(mutation_annotation_format)_and_MUT_(mutation)文件；">6.1 Mutation Files：MAF (mutation annotation format) and MUT (mutation)文件；</h3><h3 id="6-2_VCF_Files">6.2 VCF Files</h3><p><img src="http://software.broadinstitute.org/software/igv/sites/cancerinformatics.org.igv/files/images/vcfwgenotypes.jpg" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:left"><img src="http://software.broadinstitute.org/software/igv/sites/cancerinformatics.org.igv/files/images/callout_1.jpg" alt=""></th>
<th style="text-align:left">Each bar across the top of the plot shows the allele fraction for a single locus.</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><img src="http://software.broadinstitute.org/software/igv/sites/cancerinformatics.org.igv/files/images/callout_2.jpg" alt=""></td>
<td style="text-align:left">The genotypes for each locus in each sample. Dark blue = heterozygous, Cyan = homozygous variant, Grey = reference.  Filtered entries are transparent.</td>
</tr>
</tbody>
</table>
<h2 id="7-_参考资料">7. 参考资料</h2><p><span class="exturl" data-url="aHR0cDovL3d3dy5ub3ZvZ2VuZS5jb20vdGVjaC9zdXBwb3IvZ2VuZS1jYWxzcy9jb21wcmVoZW5zaXZlLzE2MjQuaHRtbA==" title="http://www.novogene.com/tech/suppor/gene-calss/comprehensive/1624.html">IGV应用教程<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://software.broadinstitute.org/software/igv/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Integrative Genomics Viewer (IGV)&lt;/a&gt;作为一个高性能的可视化工具，可以交互式的察看综合的基因组相关数据，也友好的支持多种数据类型，自然是生信工作者必须使用的利器之一。&lt;a href=&quot;http://software.broadinstitute.org/software/igv/book/export/html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;官网也提供了很详细的使用讲解&lt;/a&gt;，这里仅是根据我目前需要学习摘录部分做的整理，后面有时间在做其他整理。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IGVV.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="IGV" scheme="http://tiramisutes.github.io/tags/IGV/"/>
    
  </entry>
  
  <entry>
    <title>A Beginner’s Guide to Learn R Programming</title>
    <link href="http://tiramisutes.github.io/2017/12/15/R-class.html"/>
    <id>http://tiramisutes.github.io/2017/12/15/R-class.html</id>
    <published>2017-12-15T01:57:52.000Z</published>
    <updated>2018-09-28T02:42:53.239Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Author: hope @Huazhong Agricultural University</strong></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rclass.png" alt=""><br><a id="more"></a></p>
<h1 id="一、数据操作">一、数据操作</h1><h2 id="循环_(Loops)">循环 (Loops)</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">library(tibble)</span><br><span class="line">set.seed(<span class="number">7</span>)</span><br><span class="line">df &lt;- tibble(</span><br><span class="line">  a = rnorm(<span class="number">10</span>),</span><br><span class="line">  b = rnorm(<span class="number">10</span>),</span><br><span class="line">  c = rnorm(<span class="number">10</span>),</span><br><span class="line">  d = rnorm(<span class="number">10</span>)</span><br><span class="line">  )</span><br><span class="line">median(df$a)</span><br><span class="line">median(df$b)</span><br><span class="line">median(df$c)</span><br><span class="line">median(df$d)</span><br><span class="line"><span class="built_in">output</span> &lt;- vector(<span class="string">"double"</span>, ncol(df))  # <span class="number">1.</span> <span class="built_in">output</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq_along(df)) &#123;            # <span class="number">2.</span> sequence</span><br><span class="line">  <span class="built_in">output</span><span class="string">[[i]]</span> &lt;- median(df<span class="string">[[i]]</span>)      # <span class="number">3.</span> body</span><br><span class="line">  &#125;</span><br><span class="line"><span class="built_in">output</span></span><br><span class="line">apply(df,<span class="number">2</span>,median)</span><br></pre></td></tr></table></figure>
<h2 id="数据转换_(Data_transformation)_清洗和整理">数据转换 (Data transformation) 清洗和整理</h2><h3 id="数据环境载入">数据环境载入</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">library</span><span class="params">(nycflights13)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(tidyverse)</span></span></span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(flights)</span></span></span><br><span class="line"><span class="function"><span class="title">unique</span><span class="params">(flights<span class="variable">$month</span>)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="1-1_筛选:_filter()">1.1 筛选: filter()</h3><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">jan1</span> &lt;- filter(<span class="name">flights</span>, month == <span class="number">1</span>, day == <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h3 id="1-2_排列:_arrange()">1.2 排列: arrange()</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arrange(<span class="name">flights</span>, year, month, day)</span><br><span class="line">arrange(<span class="name">flights</span>, desc(<span class="name">arr_delay</span>))</span><br></pre></td></tr></table></figure>
<h3 id="1-3_选择:_select()">1.3 选择: select()</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>(flights, <span class="keyword">year</span>, <span class="keyword">month</span>, <span class="keyword">day</span>)</span><br></pre></td></tr></table></figure>
<h3 id="1-4_变形:_mutate()">1.4 变形: mutate()</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flights_sml &lt;- select(<span class="name">flights</span>, </span><br><span class="line">                      year<span class="symbol">:day</span>, </span><br><span class="line">                      ends_with(<span class="string">"delay"</span>), </span><br><span class="line">                      distance, </span><br><span class="line">                      air_time</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="新添加的列可以用于后续计算">新添加的列可以用于后续计算</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mutate<span class="params">(flights_sml,</span></span><br><span class="line"><span class="params">       <span class="attr">gain</span> = arr_delay - dep_delay,</span></span><br><span class="line"><span class="params">       <span class="attr">hours</span> = air_time / 60,</span></span><br><span class="line"><span class="params">       <span class="attr">gain_per_hour</span> = gain / hours</span></span><br><span class="line"><span class="params">)</span></span><br></pre></td></tr></table></figure>
<h4 id="只保留变形后的列">只保留变形后的列</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">transmute<span class="params">(flights,</span></span><br><span class="line"><span class="params">          <span class="attr">gain</span> = arr_delay - dep_delay,</span></span><br><span class="line"><span class="params">          <span class="attr">hours</span> = air_time / 60,</span></span><br><span class="line"><span class="params">          <span class="attr">gain_per_hour</span> = gain / hours</span></span><br><span class="line"><span class="params">)</span></span><br></pre></td></tr></table></figure>
<h3 id="1-5_汇总:_summarise()">1.5 汇总: summarise()</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summarise(<span class="name">flights</span>, delay = mean(<span class="name">dep_delay</span>, na.rm = TRUE))</span><br></pre></td></tr></table></figure>
<h3 id="1-6_分组:_group_by()">1.6 分组: group_by()</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">by_day &lt;- group_by(<span class="name">flights</span>, year, month, day)</span><br><span class="line">summarise(<span class="name">by_day</span>, delay = mean(<span class="name">dep_delay</span>, na.rm = TRUE))</span><br><span class="line">filter(<span class="name">flights</span>, year == <span class="number">2013</span>, month == <span class="number">1</span>, day == <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="1-7_管道函数(%&gt;%)_和_绘图">1.7 管道函数(%&gt;%) 和 绘图</h3><figure class="highlight plain"><figcaption><span>message</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delays &lt;- flights %&gt;% </span><br><span class="line">  group_by(dest) %&gt;% </span><br><span class="line">  summarise(</span><br><span class="line">    count = n(),</span><br><span class="line">    dist = mean(distance, na.rm = TRUE),</span><br><span class="line">    delay = mean(arr_delay, na.rm = TRUE)</span><br><span class="line">  ) %&gt;% </span><br><span class="line">  filter(count &gt; 20, dest != &quot;HNL&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">ggplot(data = delays, mapping = aes(x = dist, y = delay)) +</span><br><span class="line">  geom_point(aes(size = count), alpha = 1/3) +</span><br><span class="line">  geom_smooth(se = FALSE)</span><br></pre></td></tr></table></figure>
<h2 id="数据整形_(Reshaping_Data)">数据整形 (Reshaping Data)</h2><h3 id="tibble_型数据">tibble 型数据</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(tibble)</span><br><span class="line">friends_data &lt;- data_frame(</span><br><span class="line">  name = c(<span class="string">"Nicolas"</span>, <span class="string">"Thierry"</span>, <span class="string">"Bernard"</span>, <span class="string">"Jerome"</span>),</span><br><span class="line">  age = c(<span class="number">27</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">26</span>),</span><br><span class="line">  height = c(<span class="number">180</span>, <span class="number">170</span>, <span class="number">185</span>, <span class="number">169</span>),</span><br><span class="line">  married = c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">TRUE</span>)</span><br><span class="line">)</span><br><span class="line"># Print</span><br><span class="line">friends_data</span><br></pre></td></tr></table></figure>
<h3 id="tibble_与_常规_data_frame_的差别">tibble 与 常规 data frame 的差别</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span><span class="params">(<span class="string">"iris"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">class</span><span class="params">(iris)</span></span></span><br><span class="line">my_data &lt;- as_data_frame(iris)</span><br><span class="line"><span class="function"><span class="title">class</span><span class="params">(my_data)</span></span></span><br><span class="line">my_data2 &lt;- as<span class="selector-class">.data</span><span class="selector-class">.frame</span>(my_data)</span><br></pre></td></tr></table></figure>
<h3 id="基本数据载入">基本数据载入</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"tidyr"</span>)</span><br><span class="line">my_data &lt;- USArrests[c(<span class="number">1</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>), ]</span><br><span class="line">my_data</span><br><span class="line">my_data &lt;- cbind(<span class="section">state</span> = rownames(my_data), my_data)</span><br><span class="line">my_data</span><br></pre></td></tr></table></figure>
<h3 id="gather(data,_key,_value,_…)">gather(data, key, value, …)</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_data2 &lt;- gather(<span class="name">my_data</span>,</span><br><span class="line">                   key = <span class="string">"arrest_attribute"</span>,</span><br><span class="line">                   value = <span class="string">"arrest_estimate"</span>,</span><br><span class="line">                   -state)</span><br><span class="line">my_data2</span><br></pre></td></tr></table></figure>
<h3 id="spread(data,_key,_value)">spread(data, key, value)</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_data3 &lt;- spread(<span class="name">my_data2</span>, </span><br><span class="line">                   key = <span class="string">"arrest_attribute"</span>,</span><br><span class="line">                   value = <span class="string">"arrest_estimate"</span></span><br><span class="line">)</span><br><span class="line">my_data3</span><br></pre></td></tr></table></figure>
<h3 id="unite(data,_col,_…,_sep_=_“_”)">unite(data, col, …, sep = “_”)</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_data4 &lt;- unite(<span class="name">my_data</span>,</span><br><span class="line">                  col = <span class="string">"Murder_Assault"</span>,</span><br><span class="line">                  Murder, Assault,</span><br><span class="line">                  sep = <span class="string">"_"</span>)</span><br><span class="line">my_data4</span><br></pre></td></tr></table></figure>
<h3 id="separate(data,_col,_into,_sep_=_“[^[:alnum:]]+”)">separate(data, col, into, sep = “[^[:alnum:]]+”)</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_data5 &lt;- separate(<span class="name">my_data4</span>,</span><br><span class="line">         col = <span class="string">"Murder_Assault"</span>,</span><br><span class="line">         into = c(<span class="string">"Murder"</span>, <span class="string">"Assault"</span>),</span><br><span class="line">         sep = <span class="string">"_"</span>)</span><br><span class="line">my_data5</span><br></pre></td></tr></table></figure>
<h3 id="管道函数(%&gt;%)">管道函数(%&gt;%)</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_data6 &lt;- my_data %&gt;% gather(<span class="attr">key</span> = <span class="string">"arrest_attribute"</span>,</span><br><span class="line">                   <span class="attr">value</span> = <span class="string">"arrest_estimate"</span>,</span><br><span class="line">                   Murder:UrbanPop) %&gt;%</span><br><span class="line">  unite(<span class="attr">col</span> = <span class="string">"attribute_estimate"</span>,</span><br><span class="line">        arrest_attribute, arrest_estimate)</span><br></pre></td></tr></table></figure>
<h2 id="关系型数据_(Relational_data)">关系型数据 (Relational data)</h2><h3 id="数据载入">数据载入</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(tidyverse)</span><br><span class="line">library(nycflights13)</span><br><span class="line"><span class="comment"># nycflights13 contains four tibbles that are related to the flights table.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>(<span class="title">flights</span>)</span></span><br><span class="line">flights</span><br></pre></td></tr></table></figure>
<h3 id="Mutating_joins">Mutating joins</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">flights2 &lt;- flights %&gt;% </span><br><span class="line">  <span class="keyword">select</span>(year:day, hour, origin, dest, tailnum, carrier)</span><br><span class="line">flights2</span><br><span class="line">flights2 %&gt;%</span><br><span class="line">  <span class="keyword">select</span>(-origin, -dest) %&gt;% </span><br><span class="line">  left_join(airlines, by = <span class="string">"carrier"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Filtering_joins">Filtering joins</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">top_dest &lt;- flights %&gt;%</span><br><span class="line">  count(dest, <span class="keyword">sort</span> = TRUE) %&gt;%</span><br><span class="line">  head(<span class="number">5</span>)</span><br><span class="line">flights %&gt;% </span><br><span class="line">  semi_join(top_dest)</span><br><span class="line">dim(flights)</span><br><span class="line">dim(flights %&gt;% semi_join(top_dest))</span><br><span class="line">flights %&gt;%</span><br><span class="line">  anti_join(planes, by = <span class="string">"tailnum"</span>) %&gt;%</span><br><span class="line">  count(tailnum, <span class="keyword">sort</span> = TRUE)</span><br></pre></td></tr></table></figure>
<h3 id="Set_operations">Set operations</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">df1 &lt;- tribble(</span><br><span class="line">  ~x, ~y,</span><br><span class="line">  <span class="number">1</span>,  <span class="number">1</span>,</span><br><span class="line">  <span class="number">2</span>,  <span class="number">1</span></span><br><span class="line">)</span><br><span class="line">df2 &lt;- tribble(</span><br><span class="line">  ~x, ~y,</span><br><span class="line">  <span class="number">1</span>,  <span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,  <span class="number">2</span></span><br><span class="line">)</span><br><span class="line">df1</span><br><span class="line">df2</span><br><span class="line">intersect(df1, df2)</span><br><span class="line"><span class="class"><span class="keyword">union</span>(<span class="title">df1</span>, <span class="title">df2</span>)</span></span><br><span class="line">setdiff(df1, df2)</span><br></pre></td></tr></table></figure>
<h1 id="二、Plotting_in_R_for_Biologists">二、Plotting in R for Biologists</h1><h2 id="ggplot2绘图">ggplot2绘图</h2><h2 id="1-_散点图">1. 散点图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggplot2</span>)</span><br><span class="line">p &lt;- ggplot(<span class="name">data=mpg</span>, mapping=aes(<span class="name">x=cty</span>, y=hwy))</span><br><span class="line">p + geom_point()</span><br></pre></td></tr></table></figure>
<h3 id="将年份映射到颜色属性">将年份映射到颜色属性</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">mpg</span>,aes(<span class="name">x=cty</span>, y=hwy, colour=factor(<span class="name">year</span>)))</span><br><span class="line">p + geom_point()</span><br></pre></td></tr></table></figure>
<h3 id="增加平滑曲线">增加平滑曲线</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> + <span class="selector-tag">geom_point</span>() + <span class="selector-tag">stat_smooth</span>()</span><br></pre></td></tr></table></figure>
<h3 id="分面">分面</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> + <span class="selector-tag">geom_point</span>() + <span class="selector-tag">stat_smooth</span>()+<span class="selector-tag">facet_wrap</span>(~ year, ncol=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="2-_直方图">2. 直方图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">mpg</span>,aes(<span class="name">x=hwy</span>))</span><br><span class="line">p + geom_histogram()</span><br></pre></td></tr></table></figure>
<h3 id="统计变换+分面">统计变换+分面</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p + geom_histogram(<span class="name">aes</span>(<span class="name">fill=factor</span>(<span class="name">year</span>),y=..density..), alpha=0.<span class="number">3</span>,colour='black') +</span><br><span class="line">  stat_density(<span class="name">geom=</span>'line',position='identity',size=1.<span class="number">5</span>, aes(<span class="name">colour=factor</span>(<span class="name">year</span>))) +</span><br><span class="line">  facet_wrap(~year,ncol=1)</span><br></pre></td></tr></table></figure>
<h2 id="3-_条形图">3. 条形图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">x=class</span>))</span><br><span class="line">p + geom_bar()</span><br></pre></td></tr></table></figure>
<h3 id="根据计数排序后绘制的条形图">根据计数排序后绘制的条形图</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class2 &lt;- mpg<span class="variable">$class</span></span><br><span class="line">class2 &lt;- reorder(class2,class2,length)</span><br><span class="line">mpg<span class="variable">$class2</span> &lt;- class2</span><br><span class="line">p &lt;- ggplot(mpg, aes(<span class="attribute">x</span>=class2))</span><br><span class="line">p + geom_bar(aes(<span class="attribute">fill</span>=class2))</span><br></pre></td></tr></table></figure>
<h2 id="4-饼图">4.饼图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">x</span> = factor(<span class="number">1</span>), fill = factor(<span class="name">class</span>))) +</span><br><span class="line">  geom_bar(<span class="name">width</span> = <span class="number">1</span>)</span><br><span class="line">p + coord_polar(<span class="name">theta</span> = <span class="string">"y"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="改变填充颜色">改变填充颜色</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p + coord_polar(<span class="name">theta</span> = <span class="string">"y"</span>) + scale_fill_brewer(<span class="name">palette=</span><span class="string">"Dark2"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5-箱线图">5.箱线图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(<span class="name">mpg</span>, aes(<span class="name">class</span>,hwy,fill=class))</span><br><span class="line">p + geom_boxplot()</span><br></pre></td></tr></table></figure>
<h2 id="6-小提琴图">6.小提琴图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p + geom_violin(<span class="name">alpha=0</span>.<span class="number">3</span>,width=0.<span class="number">9</span>)+</span><br><span class="line">  geom_jitter(<span class="name">shape=21</span>)</span><br></pre></td></tr></table></figure>
<h2 id="7-密度图">7.密度图</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">set.seed(1234)</span><br><span class="line">df &lt;- data.frame(</span><br><span class="line">  <span class="attribute">sex</span>=factor(rep(c("F", <span class="string">"M"</span>), <span class="attribute">each</span>=200)),</span><br><span class="line">  <span class="attribute">weight</span>=round(c(rnorm(200, <span class="attribute">mean</span>=55, <span class="attribute">sd</span>=5),</span><br><span class="line">                 rnorm(200, <span class="attribute">mean</span>=65, <span class="attribute">sd</span>=5)))</span><br><span class="line">)</span><br><span class="line">head(df)</span><br><span class="line">p &lt;- ggplot(df, aes(<span class="attribute">x</span>=weight, <span class="attribute">color</span>=sex)) +</span><br><span class="line">  geom_density()</span><br><span class="line">p</span><br></pre></td></tr></table></figure>
<h2 id="8-线图">8.线图</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;- data.frame(sex = rep(c(<span class="string">"Female"</span>, <span class="string">"Male"</span>), <span class="attribute">each</span>=3),</span><br><span class="line">                  <span class="attribute">time</span>=c("breakfeast", <span class="string">"Lunch"</span>, <span class="string">"Dinner"</span>),</span><br><span class="line">                  <span class="attribute">bill</span>=c(10, 30, 15, 13, 40, 17) )</span><br><span class="line">head(df2)</span><br><span class="line">ggplot(df2, aes(<span class="attribute">x</span>=time, <span class="attribute">y</span>=bill, <span class="attribute">group</span>=sex)) +</span><br><span class="line">  geom_line(aes(<span class="attribute">linetype</span>=sex, <span class="attribute">color</span>=sex))+</span><br><span class="line">  geom_point(aes(<span class="attribute">color</span>=sex))+</span><br><span class="line">  theme(legend.<span class="attribute">position</span>=<span class="string">"top"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="9-热图">9.热图</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">pheatmap</span>)</span><br><span class="line">test = matrix(<span class="name">rnorm</span>(<span class="number">200</span>), <span class="number">20</span>, <span class="number">10</span>)</span><br><span class="line">colnames(<span class="name">test</span>) = paste(<span class="string">"Test"</span>, <span class="number">1</span>:<span class="number">10</span>, sep = <span class="string">""</span>)</span><br><span class="line">rownames(<span class="name">test</span>) = paste(<span class="string">"Gene"</span>, <span class="number">1</span>:<span class="number">20</span>, sep = <span class="string">""</span>)</span><br><span class="line">pheatmap(<span class="name">test</span>, color = colorRampPalette(<span class="name">c</span>(<span class="string">"navy"</span>, <span class="string">"white"</span>, <span class="string">"firebrick3"</span>))(<span class="number">50</span>))</span><br></pre></td></tr></table></figure>
<h2 id="10-相关性分析图">10.相关性分析图</h2><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">library(corrplot)</span><br><span class="line">mydata &lt;- select(mtcars,hp,disp,wt,qsec,mpg,drat)</span><br><span class="line">source(<span class="string">"http://www.sthda.com/upload/rquery_cormat.r"</span>)</span><br><span class="line">rquery.cormat&lt;-function(x, type=c(<span class="string">'lower'</span>, <span class="string">'upper'</span>, <span class="string">'full'</span>, <span class="string">'flatten'</span>),</span><br><span class="line">                        graph=TRUE, graphType=c(<span class="string">"correlogram"</span>, <span class="string">"heatmap"</span>),</span><br><span class="line">                        col=NULL, ...)</span><br><span class="line">&#123;</span><br><span class="line">  library(corrplot)</span><br><span class="line">  # Helper functions</span><br><span class="line">  #+++++++++++++++++</span><br><span class="line">  # Compute the matrix <span class="keyword">of</span> correlation p-values</span><br><span class="line">  cor.pmat &lt;- function(x, ...) &#123;</span><br><span class="line">    mat &lt;- <span class="keyword">as</span>.matrix(x)</span><br><span class="line">    n &lt;- ncol(mat)</span><br><span class="line">    p.mat&lt;- matrix(NA, n, n)</span><br><span class="line">    diag(p.mat) &lt;- <span class="number">0</span></span><br><span class="line">    for (i <span class="keyword">in</span> <span class="number">1</span>:(n - <span class="number">1</span>)) &#123;</span><br><span class="line">      for (j <span class="keyword">in</span> (i + <span class="number">1</span>):n) &#123;</span><br><span class="line">        tmp &lt;- cor.test(mat[, i], mat[, j], ...)</span><br><span class="line">        p.mat[i, j] &lt;- p.mat[j, i] &lt;- tmp$p.value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    colnames(p.mat) &lt;- rownames(p.mat) &lt;- colnames(mat)</span><br><span class="line">    p.mat</span><br><span class="line">  &#125;</span><br><span class="line">  # Get lower triangle <span class="keyword">of</span> the matrix</span><br><span class="line">  getLower.tri&lt;-function(mat)&#123;</span><br><span class="line">    upper&lt;-mat</span><br><span class="line">    upper[upper.tri(mat)]&lt;-<span class="string">""</span></span><br><span class="line">    mat&lt;-<span class="keyword">as</span>.data.frame(upper)</span><br><span class="line">    mat</span><br><span class="line">  &#125;</span><br><span class="line">  # Get upper triangle <span class="keyword">of</span> the matrix</span><br><span class="line">  getUpper.tri&lt;-function(mat)&#123;</span><br><span class="line">    lt&lt;-mat</span><br><span class="line">    lt[lower.tri(mat)]&lt;-<span class="string">""</span></span><br><span class="line">    mat&lt;-<span class="keyword">as</span>.data.frame(lt)</span><br><span class="line">    mat</span><br><span class="line">  &#125;</span><br><span class="line">  # Get flatten matrix</span><br><span class="line">  flattenCorrMatrix &lt;- function(cormat, pmat) &#123;</span><br><span class="line">    ut &lt;- upper.tri(cormat)</span><br><span class="line">    data.frame(</span><br><span class="line">      row = rownames(cormat)[row(cormat)[ut]],</span><br><span class="line">      column = rownames(cormat)[col(cormat)[ut]],</span><br><span class="line">      cor  =(cormat)[ut],</span><br><span class="line">      p = pmat[ut]</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  # Define color</span><br><span class="line">  <span class="keyword">if</span> (is.null(col)) &#123;</span><br><span class="line">    col &lt;- colorRampPalette(c(<span class="string">"#67001F"</span>, <span class="string">"#B2182B"</span>, <span class="string">"#D6604D"</span>, </span><br><span class="line">                              <span class="string">"#F4A582"</span>, <span class="string">"#FDDBC7"</span>, <span class="string">"#FFFFFF"</span>, <span class="string">"#D1E5F0"</span>, <span class="string">"#92C5DE"</span>, </span><br><span class="line">                              <span class="string">"#4393C3"</span>, <span class="string">"#2166AC"</span>, <span class="string">"#053061"</span>))(<span class="number">200</span>)</span><br><span class="line">    col&lt;-rev(col)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  # Correlation matrix</span><br><span class="line">  cormat&lt;-signif(cor(x, use = <span class="string">"complete.obs"</span>, ...),<span class="number">2</span>)</span><br><span class="line">  pmat&lt;-signif(cor.pmat(x, ...),<span class="number">2</span>)</span><br><span class="line">  # Reorder correlation matrix</span><br><span class="line">  ord&lt;-corrMatOrder(cormat, order=<span class="string">"hclust"</span>)</span><br><span class="line">  cormat&lt;-cormat[ord, ord]</span><br><span class="line">  pmat&lt;-pmat[ord, ord]</span><br><span class="line">  # Replace correlation coeff by symbols</span><br><span class="line">  sym&lt;-symnum(cormat, abbr.colnames=FALSE)</span><br><span class="line">  # Correlogram</span><br><span class="line">  <span class="keyword">if</span>(graph &amp; graphType[<span class="number">1</span>]==<span class="string">"correlogram"</span>)&#123;</span><br><span class="line">    corrplot(cormat, type=ifelse(type[<span class="number">1</span>]==<span class="string">"flatten"</span>, <span class="string">"lower"</span>, type[<span class="number">1</span>]),</span><br><span class="line">             tl.col=<span class="string">"black"</span>, tl.srt=<span class="number">45</span>,col=col,...)</span><br><span class="line">  &#125;</span><br><span class="line">  else <span class="keyword">if</span>(graphType[<span class="number">1</span>]==<span class="string">"heatmap"</span>)</span><br><span class="line">    heatmap(cormat, col=col, symm=TRUE)</span><br><span class="line">  # Get lower/upper triangle</span><br><span class="line">  <span class="keyword">if</span>(type[<span class="number">1</span>]==<span class="string">"lower"</span>)&#123;</span><br><span class="line">    cormat&lt;-getLower.tri(cormat)</span><br><span class="line">    pmat&lt;-getLower.tri(pmat)</span><br><span class="line">  &#125;</span><br><span class="line">  else <span class="keyword">if</span>(type[<span class="number">1</span>]==<span class="string">"upper"</span>)&#123;</span><br><span class="line">    cormat&lt;-getUpper.tri(cormat)</span><br><span class="line">    pmat&lt;-getUpper.tri(pmat)</span><br><span class="line">    sym=t(sym)</span><br><span class="line">  &#125;</span><br><span class="line">  else <span class="keyword">if</span>(type[<span class="number">1</span>]==<span class="string">"flatten"</span>)&#123;</span><br><span class="line">    cormat&lt;-flattenCorrMatrix(cormat, pmat)</span><br><span class="line">    pmat=NULL</span><br><span class="line">    sym=NULL</span><br><span class="line">  &#125;</span><br><span class="line">  list(r=cormat, p=pmat, sym=sym)</span><br><span class="line">&#125;</span><br><span class="line">rquery.cormat(mydata, type=<span class="string">"full"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="11-主成份分析(PCA)">11.主成份分析(PCA)</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">z1 &lt;- rnorm(10000, <span class="attribute">mean</span>=1, <span class="attribute">sd</span>=1)</span><br><span class="line">z2 &lt;- rnorm(10000, <span class="attribute">mean</span>=3, <span class="attribute">sd</span>=3)</span><br><span class="line">z3 &lt;- rnorm(10000, <span class="attribute">mean</span>=5, <span class="attribute">sd</span>=5)</span><br><span class="line">z4 &lt;- rnorm(10000, <span class="attribute">mean</span>=7, <span class="attribute">sd</span>=7)</span><br><span class="line">z5 &lt;- rnorm(10000, <span class="attribute">mean</span>=9, <span class="attribute">sd</span>=9)</span><br><span class="line">mydata &lt;- matrix(c(z1, z2, z3, z4, z5), 2500, 20, <span class="attribute">byrow</span>=T, <span class="attribute">dimnames</span>=list(paste("R", 1:2500, <span class="attribute">sep</span>=<span class="string">""</span>), paste(<span class="string">"C"</span>, 1:20, <span class="attribute">sep</span>=<span class="string">""</span>))) </span><br><span class="line">pca &lt;- prcomp(mydata, <span class="attribute">scale</span>=T) </span><br><span class="line">summary(pca)</span><br><span class="line">summary(pca)<span class="variable">$importance</span>[, 1:6]</span><br><span class="line">x11(<span class="attribute">height</span>=6, <span class="attribute">width</span>=12, <span class="attribute">pointsize</span>=12); par(<span class="attribute">mfrow</span>=c(1,3))</span><br><span class="line">mycolors &lt;- c(<span class="string">"red"</span>, <span class="string">"green"</span>, <span class="string">"blue"</span>, <span class="string">"magenta"</span>, <span class="string">"black"</span>)</span><br><span class="line">plot(pca<span class="variable">$x</span>[,1:2], <span class="attribute">pch</span>=20, <span class="attribute">col</span>=mycolors[sort(rep(1:5, 500))])</span><br><span class="line">pairs(pca<span class="variable">$x</span>[,1:4], <span class="attribute">pch</span>=20, <span class="attribute">col</span>=mycolors[sort(rep(1:5, 500))])</span><br><span class="line">library(scatterplot3d)</span><br><span class="line">scatterplot3d(pca<span class="variable">$x</span>[,1:3], <span class="attribute">pch</span>=20, <span class="attribute">color</span>=mycolors[sort(rep(1:5, 500))])</span><br></pre></td></tr></table></figure>
<h2 id="12-气泡图_(Bubbles_)">12.气泡图 (Bubbles )</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">require(ggplot2)</span><br><span class="line">df<span class="tag">&lt;<span class="name">-</span> <span class="attr">read.csv</span>("<span class="attr">Bubbles.csv</span>")</span></span><br><span class="line"><span class="tag"><span class="attr">ggplot</span>(<span class="attr">df</span>, <span class="attr">aes</span>(<span class="attr">x</span> = <span class="string">id,y</span>=<span class="string">Term,label</span> = <span class="string">Term))</span> +</span></span><br><span class="line"><span class="tag">  <span class="attr">geom_point</span>(<span class="attr">aes</span>(<span class="attr">size</span> = <span class="string">Input_number,</span> <span class="attr">colour</span> = <span class="string">P.Value))</span> + </span></span><br><span class="line"><span class="tag">  #<span class="attr">geom_text</span>(<span class="attr">hjust</span> = <span class="string">1,</span> <span class="attr">size</span> = <span class="string">2)</span> +</span></span><br><span class="line"><span class="tag">  <span class="attr">scale_size</span>(<span class="attr">range</span> = <span class="string">c(1,15))</span> +</span></span><br><span class="line"><span class="tag">  <span class="attr">scale_x_continuous</span>(<span class="attr">breaks</span> = <span class="string">seq(1,</span> <span class="attr">15</span>, <span class="attr">2</span>)) +</span></span><br><span class="line"><span class="tag">  <span class="attr">scale_colour_gradientn</span>(<span class="attr">colours</span>=<span class="string">rainbow(4))</span> +</span></span><br><span class="line"><span class="tag">  <span class="attr">theme_bw</span>()</span></span><br></pre></td></tr></table></figure>
<h2 id="美化_(themes_and_background)">美化 (themes and background)</h2><h2 id="ggplot2自带主题">ggplot2自带主题</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &lt;- ggplot(iris, aes(Sepal<span class="selector-class">.Length</span>, Sepal<span class="selector-class">.Width</span>, colour = Species))+</span><br><span class="line">  geom_point()</span><br><span class="line">p</span><br><span class="line"><span class="selector-tag">p</span> + theme_classic()</span><br></pre></td></tr></table></figure>
<h2 id="主题包">主题包</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="name">ggthemes</span>)</span><br><span class="line">p + theme_calc()+ scale_colour_calc()+</span><br><span class="line">  ggtitle(<span class="string">"Iris data"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="定制主题">定制主题</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p + theme(</span><br><span class="line">  panel.<span class="attr">background</span> = element_rect(<span class="attr">fill</span> = <span class="string">"lightblue"</span>,</span><br><span class="line">                                  <span class="attr">colour</span> = <span class="string">"lightblue"</span>,</span><br><span class="line">                                  <span class="attr">size</span> = <span class="number">0.5</span>, <span class="attr">linetype</span> = <span class="string">"solid"</span>),</span><br><span class="line">  panel.grid.<span class="attr">major</span> = element_line(<span class="attr">size</span> = <span class="number">0.5</span>, <span class="attr">linetype</span> = 'solid',</span><br><span class="line">                                  <span class="attr">colour</span> = <span class="string">"white"</span>), </span><br><span class="line">  panel.grid.<span class="attr">minor</span> = element_line(<span class="attr">size</span> = <span class="number">0.25</span>, <span class="attr">linetype</span> = 'solid',</span><br><span class="line">                                  <span class="attr">colour</span> = <span class="string">"white"</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h1 id="三、复杂图形修改">三、复杂图形修改</h1><p></p><p></p><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/20111210_WOC210.gif" alt=""><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">library</span><span class="params">(ggplot2)</span></span></span><br><span class="line"><span class="selector-id">#dat</span> &lt;- read.csv(<span class="string">"https://github.com/tiramisutes/myscripts-R/blob/master/EconomistData.csv"</span>)</span><br><span class="line">dat &lt;- read.csv(<span class="string">"C:/Users/hope/Desktop/R-class//EconomistData.csv"</span>)</span><br></pre></td></tr></table></figure><p></p>
<h2 id="Basic_plot">Basic plot</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pc1 &lt;- ggplot(<span class="name">dat</span>,aes(<span class="name">x</span> = CPI, y = HDI, color = Region))+</span><br><span class="line">  geom_point()</span><br><span class="line">pc1</span><br></pre></td></tr></table></figure>
<h2 id="Trend_line">Trend line</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pc2 &lt;- pc1 +</span><br><span class="line">  geom_smooth(aes(<span class="keyword">group</span> = <span class="number">1</span>),</span><br><span class="line">              <span class="function"><span class="keyword">method</span> = "<span class="title">lm</span>",</span></span><br><span class="line"><span class="function">              <span class="title">formula</span> = <span class="title">y</span> ~ <span class="title">log</span><span class="params">(x)</span>,</span></span><br><span class="line"><span class="function">              <span class="title">se</span> = <span class="title">FALSE</span>,</span></span><br><span class="line"><span class="function">              <span class="title">color</span> = "<span class="title">red</span>")</span></span><br><span class="line"><span class="function"><span class="title">pc2</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Open_points">Open points</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pc3 &lt;- ggplot(<span class="name">dat</span>,aes(<span class="name">x</span> = CPI, y = HDI, color = Region))+</span><br><span class="line">  geom_point(<span class="name">shape</span> = <span class="number">1</span>, size = <span class="number">4</span>) +</span><br><span class="line">  geom_smooth(<span class="name">aes</span>(<span class="name">group</span> = <span class="number">1</span>),</span><br><span class="line">              method = <span class="string">"lm"</span>,</span><br><span class="line">              formula = y ~ log(<span class="name">x</span>),</span><br><span class="line">              se = FALSE,</span><br><span class="line">              color = <span class="string">"red"</span>)</span><br><span class="line">pc3</span><br></pre></td></tr></table></figure>
<h2 id="选择性的标注想要的点">选择性的标注想要的点</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pointsToLabel &lt;- c(<span class="string">"Russia"</span>, <span class="string">"Venezuela"</span>, <span class="string">"Iraq"</span>, <span class="string">"Myanmar"</span>, <span class="string">"Sudan"</span>,</span><br><span class="line">                   <span class="string">"Afghanistan"</span>, <span class="string">"Congo"</span>, <span class="string">"Greece"</span>, <span class="string">"Argentina"</span>, <span class="string">"Brazil"</span>,</span><br><span class="line">                   <span class="string">"India"</span>, <span class="string">"Italy"</span>, <span class="string">"China"</span>, <span class="string">"South Africa"</span>, <span class="string">"Spane"</span>,</span><br><span class="line">                   <span class="string">"Botswana"</span>, <span class="string">"Cape Verde"</span>, <span class="string">"Bhutan"</span>, <span class="string">"Rwanda"</span>, <span class="string">"France"</span>,</span><br><span class="line">                   <span class="string">"United States"</span>, <span class="string">"Germany"</span>, <span class="string">"Britain"</span>, <span class="string">"Barbados"</span>, <span class="string">"Norway"</span>, <span class="string">"Japan"</span>,</span><br><span class="line">                   <span class="string">"New Zealand"</span>, <span class="string">"Singapore"</span>)</span><br><span class="line">library(<span class="string">"ggrepel"</span>)</span><br><span class="line">pc4 &lt;- pc3 +  geom_text_repel(<span class="name">aes</span>(<span class="name">label</span> = Country),</span><br><span class="line">                              color = <span class="string">"gray20"</span>,</span><br><span class="line">                              data = subset(<span class="name">dat</span>, Country %in% pointsToLabel),</span><br><span class="line">                              force = <span class="number">10</span>)</span><br><span class="line">pc4</span><br></pre></td></tr></table></figure>
<h2 id="修改图例值和顺序">修改图例值和顺序</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dat<span class="variable">$Region</span> &lt;- <span class="keyword">factor</span>(dat<span class="variable">$Region</span>,</span><br><span class="line">                     <span class="keyword">levels</span> = c(<span class="string">"EU W. Europe"</span>,</span><br><span class="line">                                <span class="string">"Americas"</span>,</span><br><span class="line">                                <span class="string">"Asia Pacific"</span>,</span><br><span class="line">                                <span class="string">"East EU Cemt Asia"</span>,</span><br><span class="line">                                <span class="string">"MENA"</span>,</span><br><span class="line">                                <span class="string">"SSA"</span>),</span><br><span class="line">                     labels = c(<span class="string">"OECD"</span>,</span><br><span class="line">                                <span class="string">"Americas"</span>,</span><br><span class="line">                                <span class="string">"Asia &amp;\nOceania"</span>,</span><br><span class="line">                                <span class="string">"Central &amp;\nEastern Europe"</span>,</span><br><span class="line">                                <span class="string">"Middle East &amp;\nnorth Africa"</span>,</span><br><span class="line">                                <span class="string">"Sub-Saharan\nAfrica"</span>))</span><br><span class="line">pc4<span class="variable">$data</span> &lt;- dat</span><br><span class="line">pc4</span><br></pre></td></tr></table></figure>
<h2 id="利用scale来修改x，y轴，颜色和标出title">利用scale来修改x，y轴，颜色和标出title</h2><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pc5 &lt;- pc4 +</span><br><span class="line">  scale_x_continuous(<span class="name">name</span> = <span class="string">"Corruption Perceptions Index, 2011 (10=least corrupt)"</span>,</span><br><span class="line">                     limits = c(.<span class="number">9</span>, <span class="number">10.5</span>),</span><br><span class="line">                     breaks = <span class="number">1</span>:<span class="number">10</span>) +</span><br><span class="line">  scale_y_continuous(<span class="name">name</span> = <span class="string">"Human Development Index, 2011 (1=Best)"</span>,</span><br><span class="line">                     limits = c(<span class="number">0.2</span>, <span class="number">1.0</span>),</span><br><span class="line">                     breaks = seq(<span class="number">0.2</span>, <span class="number">1.0</span>, by = <span class="number">0.1</span>)) +</span><br><span class="line">  scale_color_manual(<span class="name">name</span> = <span class="string">""</span>,</span><br><span class="line">                     values = c(<span class="string">"#24576D"</span>,</span><br><span class="line">                                <span class="string">"#099DD7"</span>,</span><br><span class="line">                                <span class="string">"#28AADC"</span>,</span><br><span class="line">                                <span class="string">"#248E84"</span>,</span><br><span class="line">                                <span class="string">"#F2583F"</span>,</span><br><span class="line">                                <span class="string">"#96503F"</span>)) +</span><br><span class="line">  ggtitle(<span class="string">"Corruption and Human development"</span>) +</span><br><span class="line">  theme(<span class="name">plot</span>.title = element_text(<span class="name">hjust</span> = <span class="number">0.5</span>))</span><br><span class="line">pc5</span><br></pre></td></tr></table></figure>
<h2 id="微调主题">微调主题</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">library(grid)</span><br><span class="line">pc6 &lt;- pc5 +</span><br><span class="line">  theme_minimal() + <span class="comment"># start with a minimal theme and add what we need</span></span><br><span class="line">  theme(<span class="attr">text</span> = element_text(<span class="attr">color</span> = <span class="string">"gray20"</span>),</span><br><span class="line">        legend.<span class="attr">position</span> = c(<span class="string">"top"</span>), <span class="comment"># position the legend in the upper left </span></span><br><span class="line">        legend.<span class="attr">direction</span> = <span class="string">"horizontal"</span>,</span><br><span class="line">        legend.<span class="attr">justification</span> = <span class="number">0.1</span>, <span class="comment"># anchor point for legend.position.</span></span><br><span class="line">        legend.<span class="attr">text</span> = element_text(<span class="attr">size</span> = <span class="number">11</span>, <span class="attr">color</span> = <span class="string">"gray10"</span>),</span><br><span class="line">        axis.<span class="attr">text</span> = element_text(<span class="attr">face</span> = <span class="string">"italic"</span>),</span><br><span class="line">        axis.title.<span class="attr">x</span> = element_text(<span class="attr">vjust</span> = -<span class="number">1</span>), <span class="comment"># move title away from axis</span></span><br><span class="line">        axis.title.<span class="attr">y</span> = element_text(<span class="attr">vjust</span> = <span class="number">2</span>), <span class="comment"># move away for axis</span></span><br><span class="line">        axis.ticks.<span class="attr">y</span> = element_blank(), <span class="comment"># element_blank() is how we remove elements</span></span><br><span class="line">        axis.<span class="attr">line</span> = element_line(<span class="attr">color</span> = <span class="string">"gray40"</span>, <span class="attr">size</span> = <span class="number">0.5</span>),</span><br><span class="line">        axis.line.<span class="attr">y</span> = element_blank(),</span><br><span class="line">        panel.grid.<span class="attr">major</span> = element_line(<span class="attr">color</span> = <span class="string">"gray50"</span>, <span class="attr">size</span> = <span class="number">0.5</span>),</span><br><span class="line">        panel.grid.major.<span class="attr">x</span> = element_blank()</span><br><span class="line">  )</span><br><span class="line">pc6</span><br></pre></td></tr></table></figure>
<h1 id="四、RNA-Seq_(DESeq2)">四、RNA-Seq (DESeq2)</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">library</span><span class="params">(DESeq2)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(limma)</span></span></span><br><span class="line"><span class="function"><span class="title">library</span><span class="params">(pasilla)</span></span></span><br><span class="line"><span class="function"><span class="title">data</span><span class="params">(pasillaGenes)</span></span></span><br><span class="line">exprSet=counts(pasillaGenes)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(exprSet)</span></span></span><br><span class="line">colData &lt;- data.frame(row.names=colnames(exprSet), </span><br><span class="line">                      group_list=group_list</span><br><span class="line">)</span><br><span class="line">dds &lt;- DESeqDataSetFromMatrix(countData = exprSet,</span><br><span class="line">                              colData = colData,</span><br><span class="line">                              design = ~ group_list)</span><br><span class="line">dds</span><br><span class="line">dds2 &lt;- DESeq(dds)</span><br><span class="line"><span class="function"><span class="title">resultsNames</span><span class="params">(dds2)</span></span></span><br><span class="line">res &lt;-  results(dds2, contrast=c(<span class="string">"group_list"</span>,<span class="string">"treated"</span>,<span class="string">"untreated"</span>)) </span><br><span class="line">resOrdered &lt;- res[<span class="attribute">order</span>(res<span class="variable">$padj</span>),]</span><br><span class="line">resOrdered=as<span class="selector-class">.data</span><span class="selector-class">.frame</span>(resOrdered)</span><br><span class="line"><span class="function"><span class="title">head</span><span class="params">(resOrdered)</span></span></span><br></pre></td></tr></table></figure>
<h1 id="五、写在最后">五、写在最后</h1><p></p><p></p><br><i class="fa fa-commenting-o" aria-hidden="true"></i>本页内容对应PPT详细请见<a href="http://tiramisutes.github.io/code/">A Beginner’s Guide to Learn R Programming</a>，其他更多优质资源请阅读 <span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvQ1p0N1VSWlFJUXdCbWRRRmNlUVVpZw==" title="https://mp.weixin.qq.com/s/CZt7URZQIQwBmdQFceQUig">R语言的最好资源，一个就够！<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Author: hope @Huazhong Agricultural University&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rclass.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="Basics_R" scheme="http://tiramisutes.github.io/tags/Basics-R/"/>
    
  </entry>
  
  <entry>
    <title>Oxford Nanopore Sequencing</title>
    <link href="http://tiramisutes.github.io/2017/10/21/Oxford-Nanopore-sequencing.html"/>
    <id>http://tiramisutes.github.io/2017/10/21/Oxford-Nanopore-sequencing.html</id>
    <published>2017-10-21T03:47:31.000Z</published>
    <updated>2018-09-28T02:39:29.704Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://i.imgur.com/yN026ub.jpg" alt=""></p>
<h2 id="纳米孔测序技术">纳米孔测序技术</h2><p>纳米孔测序技术（又称第四代测序技术）是最近几年兴起的新一代测序技术。目前测序长度可以达到150kb；<br><a id="more"></a><br>目前市场上广泛接受的纳米孔测序平台是Oxford Nanopore Technologies（ONT）公司的<strong>MinION</strong>纳米孔测序仪。它的特点是单分子测序，测序读长长（超过150kb），测序速度快，测序数据实时监控，机器方便携带等。<br>纳米孔分析技术起源于Coulter计数器的发明以及单通道电流的记录技术。生理与医学诺贝尔奖获得者Neher和Sakamann在1976年利用膜片钳技术测量膜电势，研究膜蛋白及离子通道，推动了纳米孔测序技术的实际应用进程。1996年，Kasianowicz 等提出了利用α-溶血素对DNA测序的新设想，是生物纳米孔单分子测序的里程碑标志。随后，MspA孔蛋白、噬菌体Phi29连接器等生物纳米孔的研究报道，丰富了纳米孔分析技术的研究。Li等在2001年开启了固态纳米孔研究的新时代。经过十几年的发展，现如今固态纳米孔技术日益发展成熟。<br>目前用于DNA测序的纳米孔有两类：生物纳米孔(由某种蛋白质分子镶崁在磷脂膜上组成)和固态纳米孔(包括各种硅基材料、SiNx、碳纳米管、石墨烯、玻璃纳米管等)。DNA链的直径非常小(双链DNA直径约为2nm，单链DNA直径约为1nm)，对所采用的纳米孔的尺寸要求较苛刻。</p>
<h2 id="工作原理">工作原理</h2><p>在充满电解液的腔内，带有纳米级小孔的绝缘防渗膜将腔体分成2个小室，如图1，当电压作用于电解液室，离子或其他小分子物质可穿过小孔，形成稳定的可检测的离子电流。掌握纳米孔的尺寸和表面特性、施加的电压及溶液条件，可检测不同类型的生物分子。<br>由于组成DNA的四种碱基腺嘌呤(A)、鸟嘌呤(G)、胞嘧啶(C)和胸腺嘧啶(T)的分子结构及体积大小均不同，单链DNA(ssDNA)在核酸外切酶的作用下被迅速逐一切割成脱氧核糖核苷酸分子，当单个碱基在电场驱使下通过纳米级的小孔时，不同碱基的化学性质差异导致穿越纳米孔时引起的电流的变化幅度不同，从而得到所测DNA的序列信息。<br><img src="https://i.imgur.com/jIBFldt.jpg" alt=""></p>
<h2 id="测序过程">测序过程</h2><p><img src="https://nanoporetech.com/sites/default/files/s3/sequencing-animated.gif" alt=""><br><strong>Nanopore sequencing:</strong> (a) A biological nanopore is inserted into an electrically resistant synthetic membrane. A potential is applied across the membrane, resulting in ion flow. Library DNA molecules have adaptors with aliphatic tethers (not shown) which preferentially locate to the membrane for a localized library concentration. (b) The motor protein bound to the other adaptor docks with the pore, and passes the DNA molecule through it. (c) Bases in the nanopore cause disruptions in the current which are characteristic of their sequence (blue line). In some basecallers, the signal is further refined to events (red line) which correspond to distinct pore kmers.<br><img src="https://i.imgur.com/KPXsxqL.jpg" alt=""><br>MinION纳米孔测序仪的核心是一个有2,048个纳米孔，分成512组，由专用集成电路控制的flow cell。测序原理见下图a所示：首先，将双分子DNA连接lead adaptor（蓝色），hairpin adaptor（红色）和trailing adaptor（棕色）；当测序开始，lead adaptor带领测序分子进入由酶控制的纳米孔，lead adaptor后是template read（即待测序的DNA分子）通过纳米孔，hairpin adaptor的作用是DNA双链测序的保证，然后complement read（待测序分子的互补链）通过纳米孔，最后是trailing adaptor通过。在上述测序方法中，template read和complement read依次通过纳米孔，利用pairwise alignment，它们组合成2D read；而在另外一种测序方法中，不使用hairpin adaptor，只测序template read，最终形成1D read。后一种测序方法通量更高，但是测序准确性低于2D read。每个接头序列（adaptor）通过纳米孔引起的电流变化不同（图1c），这种差别可以用来做碱基识别。<br><img src="http://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fs13059-016-1103-0/MediaObjects/13059_2016_1103_Fig1_HTML.gif" alt=""></p>
<h2 id="分析工具">分析工具</h2><p><img src="https://i.imgur.com/Uu7ZkbE.jpg" alt=""><br>目前针对Nanopore测序数据的生物信息分析工具已经研发，包括最新的国产三代数据组装软件 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hpYW9jaHVhbmxlL01FQ0FUI1MtaW5zdGFsbGF0aW9u" title="MECAT">MECAT<i class="fa fa-external-link"></i></span>和老牌的 <span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3Jlc291cmNlLWNlbnRyZS90b29scy9tYXN1cmNhLWFzc2VtYmxlci12ZXJzaW9uLTMyMi1oeWJyaWQtb250LWdlbm9tZS1hc3NlbWJseQ==" title="https://nanoporetech.com/resource-centre/tools/masurca-assembler-version-322-hybrid-ont-genome-assembly">MaSuRCA<i class="fa fa-external-link"></i></span>等，详细支持软件目录见：<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3Jlc291cmNlLWNlbnRyZS90b29scw==" title="https://nanoporetech.com/resource-centre/tools">https://nanoporetech.com/resource-centre/tools<i class="fa fa-external-link"></i></span>。</p>
<h2 id="主要应用领域">主要应用领域</h2><h3 id="1-_基因组组装">1. 基因组组装</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL1dHU19Bc3NlbWJseV93aGl0ZV9wYXBlci5wZGY/c3VibWlzc2lvbkd1aWQ9NDBhNzU0NmItOWU1MS00MmU3LWJkZTktYjVkZGVmM2MzNTEy" title="https://nanoporetech.com/sites/default/files/s3/white-papers/WGS_Assembly_white_paper.pdf?submissionGuid=40a7546b-9e51-42e7-bde9-b5ddef3c3512">Nanopore sequencing The advantages of long reads for genome assembly<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/oKux1MP.jpg" alt=""></p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Assembler name</strong></th>
<th style="text-align:center">Algorithms</th>
<th style="text-align:center">Errorcorrection</th>
<th style="text-align:center">Link</th>
<th style="text-align:center">Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">LQS</td>
<td style="text-align:center">DALIGNER,  Celera OLC</td>
<td style="text-align:center">Nanocorrect, Nanopolish</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2p0cy9uYW5vcG9saXNo" title="https://github.com/jts/nanopolish">https://github.com/jts/nanopolish<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Loman (2015)</td>
</tr>
<tr>
<td style="text-align:center">Canu</td>
<td style="text-align:center">MHAP,  Celera OLC</td>
<td style="text-align:center">Canu</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmJsL2NhbnU=" title="https://github.com/marbl/canu">https://github.com/marbl/canu<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Berlin (2015)</td>
</tr>
<tr>
<td style="text-align:center">Canu</td>
<td style="text-align:center">MHAP,  Celera OLC</td>
<td style="text-align:center">Racon, Pilon</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25hbm9wb3JldGVjaC9vbnQtYXNzZW1ibHktcG9saXNo" title="https://github.com/nanoporetech/ont-assembly-polish">https://github.com/nanoporetech/ont-assembly-polish<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">nanoporetech</td>
</tr>
<tr>
<td style="text-align:center">Miniasm</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoMy9taW5pYQ==" title="https://github.com/lh3/minia">https://github.com/lh3/minia<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Li (2016)</td>
</tr>
<tr>
<td style="text-align:center">Miniasm</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center">Racon</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2lzb3ZpYy9yYWNvbg==" title="https://github.com/isovic/racon">https://github.com/isovic/racon<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Vaser (2017)</td>
</tr>
<tr>
<td style="text-align:center">Ra-integrate</td>
<td style="text-align:center">OLC</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcmlva29zdGVsYWMvcmEtaW50ZWdyYXRlLw==" title="https://github.com/mariokostelac/ra-integrate/">https://github.com/mariokostelac/ra-integrate/<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Sovic (2016)</td>
</tr>
<tr>
<td style="text-align:center">ALLPATHS-LG</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center">ALLPATHS-LG</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly93d3cuYnJvYWRpbnN0aXR1dGUub3JnL3NvZnR3YXJlL2FsbHBhdGhzbGcvYmxvZy8/cGFnZV9pZA==" title="https://www.broadinstitute.org/software/allpathslg/blog/?page_id">https://www.broadinstitute.org/software/allpathslg/blog/?page_id<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Gnerrea (2011)</td>
</tr>
<tr>
<td style="text-align:center">SPAdes</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center">SPAdes</td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cDovL2Jpb2luZi5zcGJhdS5ydS9zcGFkZXM=" title="http://bioinf.spbau.ru/spades">http://bioinf.spbau.ru/spades<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Bankevich (2012)</td>
</tr>
<tr>
<td style="text-align:center">SMART  denovo</td>
<td style="text-align:center">Smith-Waterm, dot matrix</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3J1YW5qdWUvc21hcnRkZW5vdm8=" title="https://github.com/ruanjue/smartdenovo">https://github.com/ruanjue/smartdenovo<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Ruan</td>
</tr>
<tr>
<td style="text-align:center">ABruijn</td>
<td style="text-align:center">de Bruijn  graph</td>
<td style="text-align:center"></td>
<td style="text-align:center"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZlbmRlcmdsYXNzL0FCcnVpam4=" title="https://github.com/fenderglass/ABruijn">https://github.com/fenderglass/ABruijn<i class="fa fa-external-link"></i></span></td>
<td style="text-align:center">Lin (2016)</td>
</tr>
</tbody>
</table>
<h3 id="2-_宏基因租">2. 宏基因租</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL094Zm9yZCUyME5hbm9wb3JlJTIwV2hpdGVwYXBlciUyMC0lMjBNZXRhZ2Vub21pY3MucGRmP3N1Ym1pc3Npb25HdWlkPWZmN2E1YmQxLThiYTgtNDE0Mi1hYzJmLTA0ZWNjYjk2NzE3OQ==" title="https://nanoporetech.com/sites/default/files/s3/white-papers/Oxford%20Nanopore%20Whitepaper%20-%20Metagenomics.pdf?submissionGuid=ff7a5bd1-8ba8-4142-ac2f-04eccb967179">Nanopore sequencing Addressing the challenges of metagenomics for environmental and clinical research<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/8inx1GT.jpg" alt=""></p>
<h3 id="3-_变异分析">3. 变异分析</h3><p>【<span class="exturl" data-url="aHR0cHM6Ly9uYW5vcG9yZXRlY2guY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvczMvd2hpdGUtcGFwZXJzL1N0cnVjdHVyYWwlMjB2YXJpYXRpb25fd2hpdGUlMjBwYXBlcl9GSU5BTC5wZGY/c3VibWlzc2lvbkd1aWQ9ODIwNGNjMTYtYTllZi00NTAwLWE3NjAtMzRjYmVlZGZlN2Jh" title="https://nanoporetech.com/sites/default/files/s3/white-papers/Structural%20variation_white%20paper_FINAL.pdf?submissionGuid=8204cc16-a9ef-4500-a760-34cbeedfe7ba">Nanopore sequencing The application and advantages of long-read nanopore sequencing to structural variation analysis<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/TOxo5KZ.jpg" alt=""></p>
<h2 id="PacBio_vs-_Oxford_Nanopore_sequencing">PacBio vs. Oxford Nanopore sequencing</h2><p><img src="https://bloggenohub.files.wordpress.com/2017/06/capture8.png?w=630" alt=""><br>二者是目前主要的长reads测序技术，且具同样的缺点：高的错误率，但基于二者测序原理的差异，相较于Oxford Nanopore（MinION测序数据目前只有92%的准确性）而言PacBio错误率较低；就测序通量而言，Oxford Nanopore可同时测序多个分子，固通量较高；Oxford Nanopore测序仪体积仅有U盘大小，便于携带且测序费用低；</p>
<h2 id="参考资料">参考资料</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/c3JjPTExJmFtcDt0aW1lc3RhbXA9MTUwODU0OTI5NiZhbXA7dmVyPTQ2NSZhbXA7c2lnbmF0dXJlPTB5NHdwTDV0dXlMVHkxeHprS0RVSjhvemRMcUVOVFZqVWxZQzIwb2lRNllSNEZsLTFiOEZoaURUVnIwdXA4Z0c4aXI4YnRZNjA5c2tGaUJkWHc0dGNSaXVxYXZGT1JqNm44RG56REtzaG83a3hxT1F5Mzh0KjEyNzZTYzVZZ3hyJmFtcDtuZXc9MQ==" title="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1508549296&amp;ver=465&amp;signature=0y4wpL5tuyLTy1xzkKDUJ8ozdLqENTVjUlYC20oiQ6YR4Fl-1b8FhiDTVr0up8gG8ir8btY609skFiBdXw4tcRiuqavFORj6n8DnzDKsho7kxqOQy38t*1276Sc5Ygxr&amp;new=1">纳米孔测序技术发展简介<i class="fa fa-external-link"></i></span></li>
<li>Jain, Miten, et al. “<span class="exturl" data-url="aHR0cHM6Ly9nZW5vbWViaW9sb2d5LmJpb21lZGNlbnRyYWwuY29tL2FydGljbGVzLzEwLjExODYvczEzMDU5LTAxNi0xMTAzLTA=" title="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1103-0">The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community.<i class="fa fa-external-link"></i></span>“ Genome biology 17.1 (2016): 239.</li>
<li>Leggett, Richard M., and Matthew D. Clark. “<span class="exturl" data-url="aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2p4Yi9hcnRpY2xlLWFic3RyYWN0L2RvaS8xMC4xMDkzL2p4Yi9lcngyODkvNDA5MzA1MC9BLXdvcmxkLW9mLW9wcG9ydHVuaXRpZXMtd2l0aC1uYW5vcG9yZS1zZXF1ZW5jaW5n" title="https://academic.oup.com/jxb/article-abstract/doi/10.1093/jxb/erx289/4093050/A-world-of-opportunities-with-nanopore-sequencing">A world of opportunities with nanopore sequencing<i class="fa fa-external-link"></i></span>.” Journal of Experimental Botany (2017): erx289.</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmdlbm9odWIuY29tLzIwMTcvMDYvMTYvcGFjYmlvLXZzLW94Zm9yZC1uYW5vcG9yZS1zZXF1ZW5jaW5nLw==" title="https://blog.genohub.com/2017/06/16/pacbio-vs-oxford-nanopore-sequencing/">PacBio vs. Oxford Nanopore sequencing<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://i.imgur.com/yN026ub.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;纳米孔测序技术&quot;&gt;纳米孔测序技术&lt;/h2&gt;&lt;p&gt;纳米孔测序技术（又称第四代测序技术）是最近几年兴起的新一代测序技术。目前测序长度可以达到150kb；&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="ONS" scheme="http://tiramisutes.github.io/tags/ONS/"/>
    
  </entry>
  
  <entry>
    <title>RNAi介导的抗虫效应</title>
    <link href="http://tiramisutes.github.io/2017/09/04/RNAi-Insect.html"/>
    <id>http://tiramisutes.github.io/2017/09/04/RNAi-Insect.html</id>
    <published>2017-09-04T09:56:53.000Z</published>
    <updated>2019-03-10T03:52:22.771Z</updated>
    
    <content type="html"><![CDATA[<p>在植物中表达dsRNA来达到抗虫的策略起始于陈晓亚院士的棉花中表达棉铃虫细胞色素单氧酶P450基因(CYP6AE14 )的dsRNA ，削弱幼虫对棉酚抗性【<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3YyNS9uMTEvZnVsbC9uYnQxMzUyLmh0bWw=" title="http://www.nature.com/nbt/journal/v25/n11/full/nbt1352.html">Silencing a cotton bollworm P450 monooxygenase gene by plant-mediated RNAi impairs larval tolerance of gossypol<i class="fa fa-external-link"></i></span>】,之后不同学者将其运用于实验中（【<span class="exturl" data-url="aHR0cDovL29ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS8xMC4xMTExL25waC4xNDYzNi9hYnN0cmFjdA==" title="http://onlinelibrary.wiley.com/doi/10.1111/nph.14636/abstract">A transgenic strategy for controlling plant bugs (Adelphocoris suturalis) through expression of double-stranded RNA homologous to fatty acyl-coenzyme A reductase in cotton<i class="fa fa-external-link"></i></span>】）。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/dsRNA-cotton.jpg" alt=""><br><a id="more"></a></p>
<h2 id="作用机制">作用机制</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/RNAi-Insect.jpg" alt=""><br>Figure 1. An Updated Model of <strong>RNAi-Mediated Crop Protection from Insect Pests</strong>. <strong>Insecticidal dsRNAs</strong> expressed in planta either undergo processing into small interfering RNAs (siRNAs) or are <strong>imported into insect cells</strong> upon feeding on the plant, presumably by <strong>homologs of the double-stranded RNA (dsRNA) transport protein SID</strong> (originally discovered and subsequently characterized in detail in Caenorhabditis elegans [30]) and/or by <strong>endocytosis</strong>. Because <strong>insects do not possess RNA-dependent RNA polymerases (RdRPs)</strong>, and therefore silencing signals cannot be amplified in insect cells, <em>the RNAi response in the insect is largely dependent on the input of dsRNA that is taken up from the host plant</em>. Efficient processing of dsRNAs expressed from the plant nuclear genome into siRNAs constrains the RNAi effect on the insect. This obstacle can be overcome by high-level expression of long dsRNAs in <strong>plastids (chloroplasts)</strong>, a double membrane-surrounded cell organelle that <strong>lacks an RNAi machinery</strong>. Consequently, long dsRNAs produced inside the plastid are protected from cleavage by Dicer enzymes and remain stable. In this way, plastid expression of insecticidal dsRNAs provided complete protection of potato plants against the Colorado potato beetle [19]. However, <strong>dsRNase enzyme(s) present in the midgut of lepidopteran insects, such as the cotton bollworm, may degrade dsRNAs</strong> upon release from ingested leaf material and thus impede the RNAi responses.</p>
<h2 id="术语">术语</h2><ul>
<li><strong>dsRNA-specific ribonuclease(dsRNase):</strong> an enzyme, typically an endoribonuclease, that specifically <strong>degrades dsRNAs</strong>.</li>
<li><strong>RNA-dependent RNA polymerase(RdRP):</strong> an RNA polymerase capable of using single-stranded RNA as template to synthesize a complementary RNA strand. By catalyzing the replication of RNA, <strong>RdRPs can amplify silencing signals generated by dsRNAs</strong>.</li>
<li><strong>Small interfering RNA (siRNA):</strong> a class of small non-coding RNA molecules (typically 20–25 bp) that function in post-transcriptional gene silencing. siRNAs are generated from dsRNA in the RNA interference(RNAi) pathway and induce the degradation of mRNAs with complementary sequences. siRNA不仅能引导RISC切割同源单链mRNA，而且可作为引物与靶RNA结合并在RNA聚合酶(RNA-dependent RNA polymerase，RdRP）作用下合成更多新的dsRNA，新合成的dsRNA再由Dicer切割产生大量的次级siRNA(Secondary siRNAs)，从而使RNAi的作用进一步放大，最终将靶mRNA完全降解。</li>
</ul>
<h2 id="干涉效率和面临挑战">干涉效率和面临挑战</h2><p>Most of the dsRNA is processed into siRNAs in the plant, which are taken up much less efficiently by insect cells than is long dsRNA.</p>
<ul>
<li>The concentration of insecticidal dsRNA in the plant tissue consumed is particularly important.</li>
<li>The length of the dsRNA fragment produced in the plant.</li>
<li>The physiology of the insect gut or hemolymph.</li>
<li>The choice of the target gene to be silenced in the insect.</li>
</ul>
<h2 id="参考文献">参考文献</h2><p>1.Luo, J. et al. A transgenic strategy for controlling plant bugs (Adelphocoris suturalis) through expression of double-stranded RNA homologous to fatty acyl-coenzyme A reductase in cotton. New Phytol 215, 1173–1185 (2017).<br>2.Zhang, J., Khan, S. A., Heckel, D. G. &amp; Bock, R. <span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MwMTY3Nzc5OTE3MzAwOTAy" title="http://www.sciencedirect.com/science/article/pii/S0167779917300902">Next-Generation Insect-Resistant Plants: RNAi-Mediated Crop Protection<i class="fa fa-external-link"></i></span>. Trends in Biotechnology 35, 871–882 (2017).</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在植物中表达dsRNA来达到抗虫的策略起始于陈晓亚院士的棉花中表达棉铃虫细胞色素单氧酶P450基因(CYP6AE14 )的dsRNA ，削弱幼虫对棉酚抗性【&lt;a href=&quot;http://www.nature.com/nbt/journal/v25/n11/full/nbt1352.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Silencing a cotton bollworm P450 monooxygenase gene by plant-mediated RNAi impairs larval tolerance of gossypol&lt;/a&gt;】,之后不同学者将其运用于实验中（【&lt;a href=&quot;http://onlinelibrary.wiley.com/doi/10.1111/nph.14636/abstract&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;A transgenic strategy for controlling plant bugs (Adelphocoris suturalis) through expression of double-stranded RNA homologous to fatty acyl-coenzyme A reductase in cotton&lt;/a&gt;】）。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/dsRNA-cotton.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="RNAi Insect" scheme="http://tiramisutes.github.io/tags/RNAi-Insect/"/>
    
  </entry>
  
  <entry>
    <title>你真的懂Illumina数据质量控制吗？</title>
    <link href="http://tiramisutes.github.io/2017/09/04/Illumina-QC.html"/>
    <id>http://tiramisutes.github.io/2017/09/04/Illumina-QC.html</id>
    <published>2017-09-04T07:03:02.000Z</published>
    <updated>2018-09-28T02:36:37.768Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/SeqLab-workflow-v2.png" alt=""><br><a id="more"></a></p>
<h2 id="1-_FastQC察看">1. FastQC察看</h2><h2 id="2-_进行reads的修剪和过滤">2. 进行reads的修剪和过滤</h2><h3 id="Short-insert_paired_end_reads">Short-insert paired end reads</h3><p>接头序列：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">PrefixPE/1</span></span><br><span class="line">TACACTCTTTCCCTACACGACGCTCTTCCGATCT</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">PrefixPE/2</span></span><br><span class="line">GTGACTGGAGTTCAGACGTGTGCTCTTCCGATCT</span><br></pre></td></tr></table></figure></p>
<p>Trimmomatic等通常的质控软件。</p>
<h3 id="Long_Mate_Pair_libraries">Long Mate Pair libraries</h3><p>接头序列：<span class="exturl" data-url="aHR0cHM6Ly93d3cuaWxsdW1pbmEuY29tL2RvY3VtZW50cy9wcm9kdWN0cy90ZWNobm90ZXMvdGVjaG5vdGVfbmV4dGVyYV9tYXRlcGFpcl9kYXRhX3Byb2Nlc3NpbmcucGRm" title="https://www.illumina.com/documents/products/technotes/technote_nextera_matepair_data_processing.pdf">technote_nextera_matepair_data_processing.pdf<i class="fa fa-external-link"></i></span><br><img src="https://i.imgur.com/Myj3jya.jpg" alt=""><br>针对此类数据的处理软件主要是：nextclip和skewer，从文章结果来看后者略优。【<span class="exturl" data-url="aHR0cHM6Ly93d3cucmVzZWFyY2hnYXRlLm5ldC9wcm9maWxlL0hvbmdzaGFuX0ppYW5nL3B1YmxpY2F0aW9uLzI2MzA5OTgxOV9Ta2V3ZXJfQV9mYXN0X2FuZF9hY2N1cmF0ZV9hZGFwdGVyX3RyaW1tZXJfZm9yX25leHQtZ2VuZXJhdGlvbl9zZXF1ZW5jaW5nX3BhaXJlZC1lbmRfcmVhZHMvbGlua3MvMGE4NWU1M2FiYmJhMzQ2YTNlMDAwMDAwL1NrZXdlci1BLWZhc3QtYW5kLWFjY3VyYXRlLWFkYXB0ZXItdHJpbW1lci1mb3ItbmV4dC1nZW5lcmF0aW9uLXNlcXVlbmNpbmctcGFpcmVkLWVuZC1yZWFkcy5wZGY=" title="https://www.researchgate.net/profile/Hongshan_Jiang/publication/263099819_Skewer_A_fast_and_accurate_adapter_trimmer_for_next-generation_sequencing_paired-end_reads/links/0a85e53abbba346a3e000000/Skewer-A-fast-and-accurate-adapter-trimmer-for-next-generation-sequencing-paired-end-reads.pdf">Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads<i class="fa fa-external-link"></i></span>】<br><img src="https://i.imgur.com/rEo8RWi.jpg" alt=""></p>
<h4 id="处理软件：nextclip_(同时移除PCR_duplicates)">处理软件：<span class="exturl" data-url="aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2Jpb2luZm9ybWF0aWNzL2FydGljbGUtbG9va3VwL2RvaS8xMC4xMDkzL2Jpb2luZm9ybWF0aWNzL2J0dDcwMg==" title="https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btt702">nextclip<i class="fa fa-external-link"></i></span> (同时移除PCR duplicates)</h4><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">./nextclip -d -i ~/AS/raw_reads/AS8K_R1.fastq -j ~/AS/raw_reads/AS8K_R2.fastq -o output</span><br><span class="line"></span><br><span class="line">NextClip v1<span class="number">.3</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">                n:</span> <span class="number">18</span></span><br><span class="line"><span class="symbol">                b:</span> <span class="number">100</span></span><br><span class="line"><span class="symbol">          Entries:</span> <span class="number">26214400</span></span><br><span class="line">       Entry size: <span class="number">24</span></span><br><span class="line">  Memory required: <span class="number">856</span> MB</span><br><span class="line"></span><br><span class="line">Creating hash tables for duplicate storage...</span><br><span class="line"><span class="symbol">Hash:</span></span><br><span class="line"> unique kmers: <span class="number">0</span></span><br><span class="line"><span class="symbol"> Capacity:</span> <span class="number">26214400</span> </span><br><span class="line"><span class="symbol"> Occupied:</span> <span class="number">0.00</span>%</span><br><span class="line"><span class="symbol"> Pruned:</span> <span class="number">0</span> (-nan%)</span><br><span class="line"><span class="symbol"> Collisions:</span></span><br><span class="line"><span class="symbol">Adaptor:</span> CTGTCTCTTATACACATCTAGATGTGTATAAGAGACAG</span><br><span class="line"></span><br><span class="line">Opening input filename <span class="meta-keyword">/public/</span>home<span class="meta-keyword">/zpxu/</span>AS/raw_reads/AS8K_R1.fastq</span><br><span class="line">Opening input filename <span class="meta-keyword">/public/</span>home<span class="meta-keyword">/zpxu/</span>AS/raw_reads/AS8K_R2.fastq</span><br><span class="line">Opening output file output_A_R1.fastq</span><br><span class="line">Opening output file output_A_R2.fastq</span><br><span class="line">Opening output file output_B_R1.fastq</span><br><span class="line">Opening output file output_B_R2.fastq</span><br><span class="line">Opening output file output_C_R1.fastq</span><br><span class="line">Opening output file output_C_R2.fastq</span><br><span class="line">Opening output file output_D_R1.fastq</span><br><span class="line">Opening output file output_D_R2.fastq</span><br><span class="line"><span class="symbol">Hash:</span></span><br><span class="line"> unique kmers: <span class="number">25546550</span></span><br><span class="line"><span class="symbol"> Capacity:</span> <span class="number">26214400</span> </span><br><span class="line"><span class="symbol"> Occupied:</span> <span class="number">97.45</span>%</span><br><span class="line"><span class="symbol"> Pruned:</span> <span class="number">0</span> (<span class="number">0.00</span>%)</span><br><span class="line"><span class="symbol"> Collisions:</span></span><br><span class="line">         tries <span class="number">0</span>: <span class="number">32059454</span></span><br><span class="line">         tries <span class="number">1</span>: <span class="number">649509</span></span><br><span class="line">         tries <span class="number">2</span>: <span class="number">192228</span></span><br><span class="line">         tries <span class="number">3</span>: <span class="number">76759</span></span><br><span class="line">         tries <span class="number">4</span>: <span class="number">35001</span></span><br><span class="line">         tries <span class="number">5</span>: <span class="number">17641</span></span><br><span class="line">         tries <span class="number">6</span>: <span class="number">9035</span></span><br><span class="line">         tries <span class="number">7</span>: <span class="number">4943</span></span><br><span class="line">         tries <span class="number">8</span>: <span class="number">2774</span></span><br><span class="line">         tries <span class="number">9</span>: <span class="number">1495</span></span><br><span class="line">too much rehashing!! Rehash=<span class="number">26</span></span><br></pre></td></tr></table></figure>
<p><strong>如上，若出现<code>too much rehashing!! Rehash=26</code>的错误信息则增大<code>[-n | --number_of_reads] Approximate number of reads (default 20,000,000)</code>参数值；</strong><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/nextclip -d -e -i ~/</span>AS<span class="regexp">/raw_reads/</span>AS3K_R1.fastq -j <span class="regexp">~/AS/</span>raw_reads/AS3K_R2.fastq -o <span class="number">33</span>AS3K -n <span class="number">30000000</span></span><br><span class="line"></span><br><span class="line">NextClip v1<span class="number">.3</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">                n:</span> <span class="number">19</span></span><br><span class="line"><span class="symbol">                b:</span> <span class="number">100</span></span><br><span class="line"><span class="symbol">          Entries:</span> <span class="number">52428800</span></span><br><span class="line">       Entry <span class="string">size:</span> <span class="number">24</span></span><br><span class="line">  Memory <span class="string">required:</span> <span class="number">1456</span> MB</span><br><span class="line"></span><br><span class="line">Creating hash tables <span class="keyword">for</span> duplicate storage...</span><br><span class="line"><span class="string">Hash:</span></span><br><span class="line"> unique <span class="string">kmers:</span> <span class="number">0</span></span><br><span class="line"><span class="symbol"> Capacity:</span> <span class="number">52428800</span> </span><br><span class="line"><span class="symbol"> Occupied:</span> <span class="number">0.00</span>%</span><br><span class="line"><span class="symbol"> Pruned:</span> <span class="number">0</span> (-nan%)</span><br><span class="line"><span class="symbol"> Collisions:</span></span><br><span class="line"><span class="string">Adaptor:</span> CTGTCTCTTATACACATCTAGATGTGTATAAGAGACAG</span><br><span class="line"></span><br><span class="line">Opening input filename <span class="regexp">/public/</span>home<span class="regexp">/zpxu/</span>AS<span class="regexp">/raw_reads/</span>AS3K_R1.fastq</span><br><span class="line">Opening input filename <span class="regexp">/public/</span>home<span class="regexp">/zpxu/</span>AS<span class="regexp">/raw_reads/</span>AS3K_R2.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_A_R1.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_A_R2.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_B_R1.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_B_R2.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_C_R1.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_C_R2.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_D_R1.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_D_R2.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_E_R1.fastq</span><br><span class="line">Opening output file <span class="number">33</span>AS3K_E_R2.fastq</span><br><span class="line"><span class="string">Warning:</span> read shorter than minimum read size (<span class="number">64</span>) - ignoring</span><br><span class="line">GC <span class="string">bases:</span> <span class="number">9705583313</span>  AT <span class="string">bases:</span> <span class="number">12168077887</span></span><br><span class="line"></span><br><span class="line"><span class="string">Hash:</span></span><br><span class="line"> unique <span class="string">kmers:</span> <span class="number">28281698</span></span><br><span class="line"><span class="symbol"> Capacity:</span> <span class="number">52428800</span> </span><br><span class="line"><span class="symbol"> Occupied:</span> <span class="number">53.94</span>%</span><br><span class="line"><span class="symbol"> Pruned:</span> <span class="number">0</span> (<span class="number">0.00</span>%)</span><br><span class="line"><span class="symbol"> Collisions:</span></span><br><span class="line">         tries <span class="number">0</span>: <span class="number">72912204</span></span><br><span class="line"></span><br><span class="line">Counting duplicates...</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>%      [========                                                                                            ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">10</span>%     [==========                                                                                          ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">20</span>%     [====================                                                                                ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">23</span>%     [=======================                                                                             ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">25</span>%     [=========================                                                                           ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">67</span>%     [===================================================================                                 ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">83</span>%     [===================================================================================                 ]<span class="string">Warning:</span> count (<span class="number">999</span>) exceeds maximum - treated <span class="keyword">as</span> <span class="number">999</span></span><br><span class="line"><span class="number">100</span>%    [====================================================================================================]</span><br><span class="line"></span><br><span class="line">SUMMARY</span><br><span class="line"></span><br><span class="line">     Strict match <span class="string">parameters:</span> <span class="number">34</span>, <span class="number">18</span></span><br><span class="line">    Relaxed match <span class="string">parameters:</span> <span class="number">32</span>, <span class="number">17</span></span><br><span class="line">           Minimum read <span class="string">size:</span> <span class="number">25</span></span><br><span class="line">                   Trim <span class="string">ends:</span> <span class="number">19</span></span><br><span class="line"></span><br><span class="line">        Number of read <span class="string">pairs:</span> <span class="number">72966745</span></span><br><span class="line">   Number of duplicate <span class="string">pairs:</span> <span class="number">44626706</span>  <span class="number">61.16</span> %</span><br><span class="line">Number of pairs containing <span class="string">N:</span> <span class="number">54541</span>     <span class="number">0.07</span> %</span><br><span class="line"></span><br><span class="line">   R1 Num reads with <span class="string">adaptor:</span> <span class="number">16173479</span>  <span class="number">22.17</span> %</span><br><span class="line">   R1 Num with external <span class="string">also:</span> <span class="number">4375021</span>   <span class="number">6.00</span> %</span><br><span class="line">       R1 <span class="keyword">long</span> adaptor <span class="string">reads:</span> <span class="number">11092453</span>  <span class="number">15.20</span> %</span><br><span class="line">          R1 reads too <span class="string">short:</span> <span class="number">5081026</span>   <span class="number">6.96</span> %</span><br><span class="line">     R1 Num reads no <span class="string">adaptor:</span> <span class="number">12162760</span>  <span class="number">16.67</span> %</span><br><span class="line">  R1 no adaptor but <span class="string">external:</span> <span class="number">5248876</span>   <span class="number">7.19</span> %</span><br><span class="line"></span><br><span class="line">   R2 Num reads with <span class="string">adaptor:</span> <span class="number">14902833</span>  <span class="number">20.42</span> %</span><br><span class="line">   R2 Num with external <span class="string">also:</span> <span class="number">4406543</span>   <span class="number">6.04</span> %</span><br><span class="line">       R2 <span class="keyword">long</span> adaptor <span class="string">reads:</span> <span class="number">9987006</span>   <span class="number">13.69</span> %</span><br><span class="line">          R2 reads too <span class="string">short:</span> <span class="number">4915827</span>   <span class="number">6.74</span> %</span><br><span class="line">     R2 Num reads no <span class="string">adaptor:</span> <span class="number">13433406</span>  <span class="number">18.41</span> %</span><br><span class="line">  R2 no adaptor but <span class="string">external:</span> <span class="number">5653578</span>   <span class="number">7.75</span> %</span><br><span class="line"></span><br><span class="line">   Total pairs <span class="keyword">in</span> category <span class="string">A:</span> <span class="number">11389962</span>  <span class="number">15.61</span> %</span><br><span class="line">         A pairs <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">5627734</span>   <span class="number">7.71</span> %</span><br><span class="line">           A pairs too <span class="string">short:</span> <span class="number">5762228</span>   <span class="number">7.90</span> %</span><br><span class="line">A external clip <span class="keyword">in</span> <span class="number">1</span> or <span class="string">both:</span> <span class="number">18225</span>     <span class="number">0.02</span> %</span><br><span class="line">     A bases before <span class="string">clipping:</span> <span class="number">3416988600</span></span><br><span class="line">       A total bases <span class="string">written:</span> <span class="number">749338798</span></span><br><span class="line"></span><br><span class="line">   Total pairs <span class="keyword">in</span> category <span class="string">B:</span> <span class="number">3422082</span>   <span class="number">4.69</span> %</span><br><span class="line">         B pairs <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">1695273</span>   <span class="number">2.32</span> %</span><br><span class="line">           B pairs too <span class="string">short:</span> <span class="number">1726809</span>   <span class="number">2.37</span> %</span><br><span class="line">B external clip <span class="keyword">in</span> <span class="number">1</span> or <span class="string">both:</span> <span class="number">47947</span>     <span class="number">0.07</span> %</span><br><span class="line">     B bases before <span class="string">clipping:</span> <span class="number">1026624600</span></span><br><span class="line">       B total bases <span class="string">written:</span> <span class="number">323696037</span></span><br><span class="line"></span><br><span class="line">   Total pairs <span class="keyword">in</span> category <span class="string">C:</span> <span class="number">4565902</span>   <span class="number">6.26</span> %</span><br><span class="line">         C pairs <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">2610991</span>   <span class="number">3.58</span> %</span><br><span class="line">           C pairs too <span class="string">short:</span> <span class="number">1954911</span>   <span class="number">2.68</span> %</span><br><span class="line">C external clip <span class="keyword">in</span> <span class="number">1</span> or <span class="string">both:</span> <span class="number">143843</span>    <span class="number">0.20</span> %</span><br><span class="line">     C bases before <span class="string">clipping:</span> <span class="number">1369770600</span></span><br><span class="line">       C total bases <span class="string">written:</span> <span class="number">509149505</span></span><br><span class="line"></span><br><span class="line">   Total pairs <span class="keyword">in</span> category <span class="string">D:</span> <span class="number">8649889</span>   <span class="number">11.85</span> %</span><br><span class="line">         D pairs <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">3667738</span>   <span class="number">5.03</span> %</span><br><span class="line">           D pairs too <span class="string">short:</span> <span class="number">4982151</span>   <span class="number">6.83</span> %</span><br><span class="line">D external clip <span class="keyword">in</span> <span class="number">1</span> or <span class="string">both:</span> <span class="number">5627647</span>   <span class="number">7.71</span> %</span><br><span class="line">     D bases before <span class="string">clipping:</span> <span class="number">2594966700</span></span><br><span class="line">       D total bases <span class="string">written:</span> <span class="number">899148840</span></span><br><span class="line"></span><br><span class="line">   Total pairs <span class="keyword">in</span> category <span class="string">E:</span> <span class="number">308404</span>    <span class="number">0.42</span> %</span><br><span class="line">         E pairs <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">196969</span>    <span class="number">0.27</span> %</span><br><span class="line">           E pairs too <span class="string">short:</span> <span class="number">111435</span>    <span class="number">0.15</span> %</span><br><span class="line">E external clip <span class="keyword">in</span> <span class="number">1</span> or <span class="string">both:</span> <span class="number">37111</span>     <span class="number">0.05</span> %</span><br><span class="line">     E bases before <span class="string">clipping:</span> <span class="number">92521200</span></span><br><span class="line">       E total bases <span class="string">written:</span> <span class="number">29751268</span></span><br><span class="line"></span><br><span class="line">          Total usable <span class="string">pairs:</span> <span class="number">10130967</span>  <span class="number">13.88</span> %</span><br><span class="line">             All <span class="keyword">long</span> <span class="string">enough:</span> <span class="number">13798705</span>  <span class="number">18.91</span> %</span><br><span class="line">    All categories too <span class="string">short:</span> <span class="number">14537534</span>  <span class="number">19.92</span> %</span><br><span class="line">      Duplicates not <span class="string">written:</span> <span class="number">44630506</span>  <span class="number">61.17</span> %</span><br><span class="line"></span><br><span class="line">         Category B became <span class="string">E:</span> <span class="number">90789</span>     <span class="number">0.12</span> %</span><br><span class="line">         Category C became <span class="string">E:</span> <span class="number">217615</span>    <span class="number">0.30</span> %</span><br><span class="line">          Overall GC <span class="string">content:</span> <span class="number">44.37</span> %</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Done. Completed <span class="keyword">in</span> <span class="number">4414</span> seconds.</span><br></pre></td></tr></table></figure></p>
<p><strong>结果文件中的A,B和C category合并后用于后续分析。</strong></p>
<h4 id="处理软件：_skewer">处理软件： <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JlbGlwbW9jL3NrZXdlcg==" title="https://github.com/relipmoc/skewer">skewer<i class="fa fa-external-link"></i></span></h4><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> ./skewer -m mp -i ~/AS/raw_reads/AS8K_R1.fastq ~/AS/raw_reads/AS8K_R2.fastq -o AS8K -t <span class="number">5</span></span><br><span class="line">.<span class="comment">--. .-.</span></span><br><span class="line">: .<span class="comment">--': :.-.</span></span><br><span class="line">`. `. : `<span class="string">'.'</span> .<span class="comment">--. .-..-..-. .--. .--.</span></span><br><span class="line">_`, :: . `.<span class="string">' '</span>_.<span class="string">': `; `; :'</span> <span class="string">'_.'</span>: ..<span class="string">'</span></span><br><span class="line"><span class="string">`.__.'</span>:_;:_;`.__.<span class="string">'`.__.__.'</span>`.__.<span class="string">':_;</span></span><br><span class="line"><span class="string">skewer v0.2.2 [April 4, 2016]</span></span><br><span class="line"><span class="string">Parameters used:</span></span><br><span class="line"><span class="string">-- 3'</span> end adapter sequence (-x):        AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC</span><br><span class="line"><span class="comment">-- paired 3' end adapter sequence (-y): AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTA</span></span><br><span class="line"><span class="comment">-- junction adapter sequence (-j):      CTGTCTCTTATACACATCTAGATGTGTATAAGAGACAG</span></span><br><span class="line"><span class="comment">-- maximum error ratio allowed (-r):    0.100</span></span><br><span class="line"><span class="comment">-- maximum indel error ratio allowed (-d):      0.030</span></span><br><span class="line"><span class="comment">-- minimum read length allowed after trimming (-l):     18</span></span><br><span class="line"><span class="comment">-- file format (-f):            Sanger/Illumina 1.8+ FASTQ (auto detected)</span></span><br><span class="line"><span class="comment">-- minimum overlap length for junction adapter detection (-k):  19</span></span><br><span class="line"><span class="comment">-- redistribute reads based on junction information (-i):       yes</span></span><br><span class="line">Sat Sep  <span class="number">2</span> <span class="number">21</span>:<span class="number">43</span>:<span class="number">52</span> <span class="number">2017</span> &gt;&gt; started</span><br><span class="line">|================================================<span class="function">=&gt;</span>| (<span class="number">100.00</span>%)</span><br><span class="line">Sat Sep  <span class="number">2</span> <span class="number">22</span>:<span class="number">53</span>:<span class="number">41</span> <span class="number">2017</span> &gt;&gt; done (<span class="number">4120.338</span>s)</span><br><span class="line"><span class="number">61751767</span> read <span class="built_in">pairs</span> processed; of <span class="name">these</span>:</span><br><span class="line"> <span class="number">2750894</span> ( <span class="number">4.45</span>%) non-junction read <span class="built_in">pairs</span> filtered out by contaminant control</span><br><span class="line"> <span class="number">6682698</span> (<span class="number">10.82</span>%) short read <span class="built_in">pairs</span> filtered out after trimming by size control</span><br><span class="line"><span class="number">31458966</span> (<span class="number">50.94</span>%) empty read <span class="built_in">pairs</span> filtered out after trimming by size control</span><br><span class="line"><span class="number">20859209</span> (<span class="number">33.78</span>%) read <span class="built_in">pairs</span> available; of <span class="name">these</span>:</span><br><span class="line"><span class="number">17141247</span> (<span class="number">82.18</span>%) trimmed read <span class="built_in">pairs</span> available after processing</span><br><span class="line"> <span class="number">3717962</span> (<span class="number">17.82</span>%) untrimmed read <span class="built_in">pairs</span> available after processing</span><br><span class="line">log has been saved to <span class="string">"/public/home/zpxu/AS/raw_reads/AS8K_R1-trimmed.log"</span>.</span><br></pre></td></tr></table></figure>
<h3 id="两类reads的去除比例">两类reads的去除比例</h3><p><strong>After trimming and quality filtering, 56% of long-insert reads from each of the three mate-pair libraries and 95% of paired-end reads were retained on average.</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Trimmend.jpg" alt=""></p>
<h3 id="实际同样数据运行结果比较">实际同样数据运行结果比较</h3><table>
<thead>
<tr>
<th style="text-align:center">FastQ files</th>
<th style="text-align:center">read length</th>
<th style="text-align:center">median</th>
<th style="text-align:center">mean</th>
<th style="text-align:center">stdev</th>
<th style="text-align:center">FF</th>
<th style="text-align:center">FR</th>
<th style="text-align:center">RF</th>
<th style="text-align:center">RR</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">AS3K_R2_nextclip.fq.is.txt</td>
<td style="text-align:center">83</td>
<td style="text-align:center">2510</td>
<td style="text-align:center">2307.246</td>
<td style="text-align:center">764.2089</td>
<td style="text-align:center">36</td>
<td style="text-align:center">781</td>
<td style="text-align:center">9164</td>
<td style="text-align:center">19</td>
</tr>
<tr>
<td style="text-align:center">AS5K_R2_nextclip.fq.is.txt</td>
<td style="text-align:center">84</td>
<td style="text-align:center">4444</td>
<td style="text-align:center">3974.787</td>
<td style="text-align:center">1506.76</td>
<td style="text-align:center">54</td>
<td style="text-align:center">773</td>
<td style="text-align:center">9127</td>
<td style="text-align:center">46</td>
</tr>
<tr>
<td style="text-align:center">AS8K_R2_nextclip.fq.is.txt</td>
<td style="text-align:center">81</td>
<td style="text-align:center">5825</td>
<td style="text-align:center">4733.265</td>
<td style="text-align:center">2530.765</td>
<td style="text-align:center">150</td>
<td style="text-align:center">1167</td>
<td style="text-align:center">8543</td>
<td style="text-align:center">140</td>
</tr>
<tr>
<td style="text-align:center">AS3K-trimmed-pair2.fastq.is.txt.skewer</td>
<td style="text-align:center">102</td>
<td style="text-align:center">2493</td>
<td style="text-align:center">2319.141</td>
<td style="text-align:center">725.1056</td>
<td style="text-align:center">26</td>
<td style="text-align:center">1912</td>
<td style="text-align:center">8049</td>
<td style="text-align:center">13</td>
</tr>
<tr>
<td style="text-align:center">AS5K-trimmed-pair2.fastq.is.txt.skewer</td>
<td style="text-align:center">106</td>
<td style="text-align:center">4460</td>
<td style="text-align:center">4042.562</td>
<td style="text-align:center">1443.632</td>
<td style="text-align:center">30</td>
<td style="text-align:center">2333</td>
<td style="text-align:center">7608</td>
<td style="text-align:center">29</td>
</tr>
<tr>
<td style="text-align:center">AS8K-trimmed-pair2.fastq.is.txt.skewer</td>
<td style="text-align:center">111</td>
<td style="text-align:center">5945</td>
<td style="text-align:center">4935.393</td>
<td style="text-align:center">2446.029</td>
<td style="text-align:center">112</td>
<td style="text-align:center">3607</td>
<td style="text-align:center">6212</td>
<td style="text-align:center">69</td>
</tr>
</tbody>
</table>
<h2 id="3-_FastUniq_去除_paired_reads_的PCR重复">3. FastUniq 去除 paired reads 的PCR重复</h2><p>建议先trim，然后在来用这个软件来去除dup,因为，这个软件是比较以后，随机保留相同的pair的中一个，如果不先trim，容易保留质量差的哪一个，而且即使trim后，它也能处理不同长度的pair。 【<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzY3MDQ0NTI0MDEwMWxxYXQuaHRtbA==" title="http://blog.sina.com.cn/s/blog_670445240101lqat.html">每日一生信—FastUniq去除paired reads的duplicates<i class="fa fa-external-link"></i></span>】</p>
<h3 id="单个文库/input_list-txt_多次运行">单个文库/input_list.txt 多次运行</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat AS285.list</span><br><span class="line">AS285A_R1<span class="selector-class">.clean</span><span class="selector-class">.fastq</span></span><br><span class="line">AS285A_R2<span class="selector-class">.clean</span><span class="selector-class">.fastq</span></span><br><span class="line">fastuniq -<span class="selector-tag">i</span> AS285<span class="selector-class">.list</span> -o AS285A_R1<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span> -<span class="selector-tag">p</span> AS285A_R2<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span></span><br></pre></td></tr></table></figure>
<h3 id="或者多个文库写在同一个input_list-txt时输出结果会将多个文库合并成一个文件；">或者多个文库写在同一个input_list.txt时输出结果会将多个文库合并成一个文件；</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat input_list.txt</span><br><span class="line">input_R1_1.fastq</span><br><span class="line">input_R1_2.fastq</span><br><span class="line">input_R2_1.fastq</span><br><span class="line">input_R2_2.fastq</span><br><span class="line">fastuniq -<span class="selector-tag">i</span> input_list<span class="selector-class">.txt</span> -t <span class="selector-tag">q</span> -o output_1<span class="selector-class">.fastq</span> -<span class="selector-tag">p</span> output_2<span class="selector-class">.fastq</span> -c <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>报错：内存问题,在大内存节点运行。<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Error </span>in Reading pair-end FASTQ sequence!</span><br></pre></td></tr></table></figure></p>
<h2 id="4-_进行reads_的纠正">4. 进行reads 的纠正</h2><p><strong>BLESS和Musket有相似的纠正结果，前者一直报错；</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/jiucuo.jpg" alt=""></p>
<h4 id="BLESS"><span class="exturl" data-url="aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2Jpb2luZm9ybWF0aWNzL2FydGljbGUvMzAvMTAvMTM1NC8yNjY1NzEvQkxFU1MtQmxvb20tZmlsdGVyLWJhc2VkLWVycm9yLWNvcnJlY3Rpb24tc29sdXRpb24=" title="https://academic.oup.com/bioinformatics/article/30/10/1354/266571/BLESS-Bloom-filter-based-error-correction-solution">BLESS<i class="fa fa-external-link"></i></span></h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source /public/home/software/.bashrc</span><br><span class="line">module load BLESS/<span class="number">1.02</span></span><br><span class="line">cd /public/home/zpxu/AS/clean_reads</span><br><span class="line">bless -read1 AS3k_R1<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span> -read2 AS3k_R2<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span> -prefix ../bless/AS3k_R12<span class="selector-class">.rd</span><span class="selector-class">.clean</span> -kmerlength <span class="number">31</span></span><br></pre></td></tr></table></figure>
<p>报错：<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Checking input read files</span><br><span class="line"></span><br><span class="line"><span class="keyword">ERROR: </span>Irregular quality score range 35<span class="string">-75</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Musket_-_a_multistage_k-mer_spectrum_based_corrector"><span class="exturl" data-url="aHR0cDovL211c2tldC5zb3VyY2Vmb3JnZS5uZXQvaG9tZXBhZ2UuaHRt" title="http://musket.sourceforge.net/homepage.htm">Musket - a multistage k-mer spectrum based corrector<i class="fa fa-external-link"></i></span></h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">musket AS485_R1<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span> AS485_R2<span class="selector-class">.rd</span><span class="selector-class">.clean</span><span class="selector-class">.fastq</span> -omulti AS485 -inorder -<span class="selector-tag">p</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>至此，经过Trim，去PCR duplicates和纠正后的reads可用于后续的基因组组装等其他分析。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/SeqLab-workflow-v2.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="IlluminaQC" scheme="http://tiramisutes.github.io/tags/IlluminaQC/"/>
    
  </entry>
  
  <entry>
    <title>Circos安装和使用</title>
    <link href="http://tiramisutes.github.io/2017/05/29/Circos.html"/>
    <id>http://tiramisutes.github.io/2017/05/29/Circos.html</id>
    <published>2017-05-29T09:51:59.000Z</published>
    <updated>2018-10-26T04:14:41.903Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装主页">安装主页</h2><p><img src="http://i.imgur.com/XrKrXqj.jpg" alt=""></p>
<h5 id="安装主页-1"><span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvY29uZmlndXJhdGlvbi8=" title="http://www.circos.ca/documentation/tutorials/configuration/">安装主页<i class="fa fa-external-link"></i></span></h5><h5 id="已发表文章circos图(http://circos-ca/in_literature/scientific/)"><span class="exturl" data-url="aHR0cDovL2NpcmNvcy5jYS9pbWFnZXMvc2NpZW50aWZpY19saXRlcmF0dXJlLw==" title="http://circos.ca/images/scientific_literature/">已发表文章circos图<i class="fa fa-external-link"></i></span>(<span class="exturl" data-url="aHR0cDovL2NpcmNvcy5jYS9pbl9saXRlcmF0dXJlL3NjaWVudGlmaWMv" title="http://circos.ca/in_literature/scientific/">http://circos.ca/in_literature/scientific/<i class="fa fa-external-link"></i></span>)</h5><h5 id="教程和数据下载"><span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2Evc29mdHdhcmUvZG93bmxvYWQvdHV0b3JpYWxzLw==" title="http://www.circos.ca/software/download/tutorials/">教程和数据下载<i class="fa fa-external-link"></i></span></h5><h5 id="Creating_Circos_Plots"><span class="exturl" data-url="aHR0cDovL2p1cmEud2kubWl0LmVkdS9iaW8vZWR1Y2F0aW9uL2hvdF90b3BpY3MvQ2lyY29zL0NpcmNvcy5wZGY=" title="http://jura.wi.mit.edu/bio/education/hot_topics/Circos/Circos.pdf">Creating Circos Plots<i class="fa fa-external-link"></i></span></h5><h2 id="<!-more->"><a id="more"></a></h2><h3 id="下载最新版circos"><span class="exturl" data-url="aHR0cDovL2NpcmNvcy5jYS9zb2Z0d2FyZS9kb3dubG9hZC9jaXJjb3Mv" title="http://circos.ca/software/download/circos/">下载最新版circos<i class="fa fa-external-link"></i></span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> wget http://circos.ca/distribution/circos-0.69-4.tgz</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tar -xzvf circos-0.69-4.tgz</span></span><br></pre></td></tr></table></figure>
<h3 id="检查perl模块缺失情况"><span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvY29uZmlndXJhdGlvbi9wZXJsX2FuZF9tb2R1bGVzLw==" title="http://www.circos.ca/documentation/tutorials/configuration/perl_and_modules/">检查perl模块缺失情况<i class="fa fa-external-link"></i></span></h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ cd circos<span class="number">-0.69</span><span class="number">-4</span></span><br><span class="line">$ bin/circos <span class="params">-modules</span></span><br><span class="line">ok       <span class="number">1.38</span> Carp</span><br><span class="line">ok       <span class="number">0.38</span> Clone</span><br><span class="line">missing            Config<span class="type">::General</span></span><br><span class="line">ok        <span class="number">3.3</span> Cwd</span><br><span class="line">ok      <span class="number">2.154</span> <span class="built_in">Data</span><span class="type">::Dumper</span></span><br><span class="line">ok       <span class="number">2.39</span> Digest<span class="type">::MD5</span></span><br><span class="line">ok       <span class="number">2.77</span> File<span class="type">::Basename</span></span><br><span class="line">ok        <span class="number">3.3</span> File<span class="type">::Spec</span><span class="type">::Functions</span></span><br><span class="line">ok       <span class="number">0.22</span> File<span class="type">::Temp</span></span><br><span class="line">ok       <span class="number">1.50</span> FindBin</span><br><span class="line">ok       <span class="number">0.39</span> Font<span class="type">::TTF</span><span class="type">::Font</span></span><br><span class="line">ok       <span class="number">2.44</span> GD</span><br><span class="line">ok        <span class="number">0.2</span> GD<span class="type">::Polyline</span></span><br><span class="line">ok       <span class="number">2.38</span> Getopt<span class="type">::Long</span></span><br><span class="line">ok       <span class="number">1.14</span> IO<span class="type">::File</span></span><br><span class="line">ok      <span class="number">0.416</span> <span class="built_in">List</span><span class="type">::MoreUtils</span></span><br><span class="line">ok       <span class="number">1.46</span> <span class="built_in">List</span><span class="type">::Util</span></span><br><span class="line">ok       <span class="number">0.01</span> Math<span class="type">::Bezier</span></span><br><span class="line">ok       <span class="number">1.60</span> Math<span class="type">::BigFloat</span></span><br><span class="line">ok       <span class="number">0.07</span> Math<span class="type">::Round</span></span><br><span class="line">ok       <span class="number">0.08</span> Math<span class="type">::VecStat</span></span><br><span class="line">ok    <span class="number">1.01</span>_03 Memoize</span><br><span class="line">ok       <span class="number">1.17</span> POSIX</span><br><span class="line">missing            <span class="keyword">Params</span><span class="type">::Validate</span></span><br><span class="line">ok       <span class="number">1.36</span> Pod<span class="type">::Usage</span></span><br><span class="line">missing            Readonly</span><br><span class="line">ok <span class="number">2016060801</span> Regexp<span class="type">::Common</span></span><br><span class="line">missing            SVG</span><br><span class="line">missing            <span class="built_in">Set</span><span class="type">::IntSpan</span></span><br><span class="line">missing            Statistics<span class="type">::Basic</span></span><br><span class="line">ok       <span class="number">2.20</span> Storable</span><br><span class="line">ok       <span class="number">1.11</span> Sys<span class="type">::Hostname</span></span><br><span class="line">ok      <span class="number">2.0</span><span class="number">.0</span> Text<span class="type">::Balanced</span></span><br><span class="line">missing            Text<span class="type">::Format</span></span><br><span class="line">ok     <span class="number">1.9721</span> Time<span class="type">::HiRes</span></span><br></pre></td></tr></table></figure>
<p><code>cpanm</code>来安装缺失模块</p>
<h3 id="检测GD是否能用于画图，最终能生成diag-png文件">检测GD是否能用于画图，最终能生成diag.png文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/gddiag</span><br></pre></td></tr></table></figure>
<h3 id="检测circos最终是否正确安装">检测circos最终是否正确安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/circos -<span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd example</span><br><span class="line">./<span class="keyword">run</span><span class="bash"></span></span><br></pre></td></tr></table></figure></p>
<p>将在当前example目录下生成如下circos.png图和run.out记录屏幕输出<br><img src="http://i.imgur.com/ZkOgjPN.jpg" alt=""></p>
<h3 id="Circos的使用">Circos的使用</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">circos -<span class="keyword">conf</span> etc/circos.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<h3 id="参数解释如下：">参数解释如下：</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">version             查询circos版本</span></span><br><span class="line"><span class="ruby">-modules             检测perl模块</span></span><br><span class="line"><span class="ruby">-conf &lt;string&gt;       输入主配置文件</span></span><br></pre></td></tr></table></figure>
<p>详细参数见：<span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvcmVmZXJlbmNlL2NvbW1hbmRfbGluZS8=" title="http://www.circos.ca/documentation/tutorials/reference/command_line/">COMMAND LINE PARAMETERS<i class="fa fa-external-link"></i></span><br><code>image.generic.conf</code> 配置文件设置图形输出文件夹和名称；</p>
<h3 id="Circos配置文件详解"><span class="exturl" data-url="aHR0cHM6Ly93d3cucGxvYi5vcmcvYXJ0aWNsZS84NDI0Lmh0bWw=" title="https://www.plob.org/article/8424.html">Circos配置文件详解<i class="fa fa-external-link"></i></span></h3><p>Circos的使用主要通过输入一个主配置文件<code>circos.conf</code> 和 若干其他类型的配制文件。<br>该主配置文件的内容格式主要以各种区块表示，大区块中可以包含小区块。<br>此外，有些配置信息一般不需要改动，比如颜色，字体等。我们一般将这类信息保存到一个独立的配置文件中。只需要在主配置文件中通过include声明包含这些独立的配置文件名，即表示使用其配置信息。<br>例如，最常用的放置到主配置文件头部的数行包括：</p>
<ul>
<li>基因组染色体组型数据文件karyotype<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="keyword">include</span> karyotype.<span class="keyword">and</span>.layout.conf<span class="meta">&gt;&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>例如，最常用的放置到主配置文件尾部的数行包括：</p>
<ul>
<li><p>设置生成的图片参数</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">image</span>&gt;</span><br><span class="line">&lt;&lt;include etc/<span class="built_in">image</span>.conf&gt;&gt;</span><br><span class="line">&lt;/<span class="built_in">image</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置颜色，字体，填充模式的配置信息</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="keyword">include</span> etc/colors_fonts_patterns.conf<span class="meta">&gt;&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>系统与debug参数</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;<span class="keyword">include</span> etc/housekeeping.conf<span class="meta">&gt;&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>一般绘图需要以下配置文件：</strong></p>
<table>
<thead>
<tr>
<th>conf配置文件</th>
<th>内容和作用说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>circos.conf</td>
<td>主配置文件</td>
</tr>
<tr>
<td>karyotype.and.layout.conf</td>
<td>基因组染色体组型数据</td>
</tr>
<tr>
<td>ideogram.conf</td>
<td>描述基因组染色体组型数据中染色体展示形式</td>
</tr>
<tr>
<td>ticks.conf</td>
<td>描述基因组染色体组型数据中染色体大小展示形式</td>
</tr>
<tr>
<td>image.conf</td>
<td>生成图片参数</td>
</tr>
<tr>
<td>highlight.conf</td>
<td>基因组染色体组型数据</td>
</tr>
<tr>
<td>colors_fonts_patterns.conf</td>
<td>颜色，字体，填充模式的配置信息</td>
</tr>
<tr>
<td>ousekeeping.conf</td>
<td>系统与debug参数</td>
</tr>
</tbody>
</table>
<p><strong>运行<code>circos -conf etc/circos.conf</code>程序时，circos先从circos.conf所在路径文件夹下搜索所需的配置文件</strong></p>
<h2 id="1-_karyotype-and-layout-conf_指定主要数据配置文件">1. <code>karyotype.and.layout.conf</code> 指定主要数据配置文件</h2><ul>
<li><strong>karyotype 染色体组型</strong><ul>
<li>指定基因组 karyotype文件存放路径</li>
<li>karyotype 文件定义 names, sizes and colors of chromosomes that you will use in the image.<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">指定染色体组型的文件</span></span><br><span class="line">karyotype = data/karyotype/karyotype.human.txt,data/karyotype/karyotype.mouse.txt,data/karyotype/karyotype.rat.txt</span><br><span class="line">chromosomes_order_by_karyotype = yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置长度单位，以下设置表示 1M 长度的序列代表为 1u</span></span><br><span class="line">chromosomes_units              = 1000000</span><br><span class="line">默认设置下是将 karyotype 文件中所有的染色体都展示出来。当然，也可能根据需要仅展示指定的 chromosomes, 使用如下的参数进行设置</span><br><span class="line">chromosomes_display_default    = no</span><br><span class="line"><span class="meta">#</span><span class="bash"> 以下参数设置指定的 chromosomes 用于展示到圈图中。// 中是一个正则表达式，匹配的 chromosomes 用于展示到圈图中。其匹配的对象是 karyotype 文件中的第 3 列。也可以直接列出需要展示的 chromosomes， 例如：hs1;hs2;hs3;hs4 。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">chromosomes         = -/[XY]/;-/hs(1[1-9]|2\d)$/;-/rn/;-/mm/;rn1;mm1</span></span><br><span class="line">chromosomes          = -/[XY]/;-/rn/;-/mm/;rn1;mm1</span><br><span class="line"><span class="meta">#</span><span class="bash">chromosomes         = hs4;hs3;hs5;hs7;hs8;hs12;hs6;hs11;hs14;hs13;mm1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">chromosomes_order   = hs1,hs2,mm2,mm1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">设置各个 ideograms 的颜色，karyotype 文件最后一列指定了各个 chromosomes 的颜色，而使用 chromosomes_color 参数也能修改颜色。</span></span><br><span class="line">chromosomes_color    = /mm/=blues-5-seq-4,/rn/=reds-5-seq-4</span><br><span class="line"><span class="meta">#</span><span class="bash">使 hs2， hs3 和 hs4 在圈图上的展示方向是反向的。</span></span><br><span class="line">chromosomes_reverse  = /hs[234]/</span><br><span class="line"><span class="meta">#</span><span class="bash"> rn1 and mm1 scaled to each occupy 1/4 of the figure</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以下设置各个 ideograms 的大小。其总长度为 1 ，hs1 的长度为 0.5， hs2，hs3 和 hs4 这 3 个 chromosomes 的总长度为 0.5，并且这 3 个 chromosomes 的长度是分布均匀的。注意前者的单位是 r， 后者使用了正则表达式对应多个 chromosomes， 其单位于是为 rn 。</span></span><br><span class="line">chromosomes_scale   = rn1=0.25r,mm1:0.25r</span><br><span class="line"><span class="meta">#</span><span class="bash"> /hs/=0.5rn - relative scaling, normalized by number of ideograms matching /hs/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">              this is equivalent to /hs/=0.0227r (0.5/22).</span></span><br><span class="line"><span class="meta">#</span><span class="bash">chromosomes_scale   = /hs/=0.5rn</span></span><br><span class="line"><span class="meta">#</span><span class="bash">默认下在 ideogram.conf 中统一设置了 ideogram 的位置，可以使用此参数调整指定 ideogram 的位置。</span></span><br><span class="line">chromosomes_radius = hs2:1.05r;hs3:1.20r;hs4:1.35r;hs5:1.15r;hs6:1.05r</span><br><span class="line"><span class="meta">#</span><span class="bash"> karyotype 文件最后一列指定了各个 chromosomes 的颜色，而使用 chromosomes_color 参数也能修改颜色。当然，使用如下方式进行颜色的修改，则更加直观。以下方式是对颜色重新进行定义。chr1，chr2，chr3 和 chr4 对应着 karyotype 文件最后一列的值，代表着颜色的类型。此处使用 color block 来对其进行重新定义。注意重新定义的时候需要加符号 * </span></span><br><span class="line">&lt;colors&gt;</span><br><span class="line">chr1* = red</span><br><span class="line">chr2* = orange</span><br><span class="line">chr3* = green</span><br><span class="line">chr4* = blue</span><br><span class="line">&lt;/colors&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><img src="http://i.imgur.com/JK17z8t.png" alt=""></p>
<ul>
<li><strong>染色体组型数据文件格式和内容</strong><ul>
<li>[x] 内容: <span class="exturl" data-url="aHR0cDovL2NpcmNvcy5jYS9kb2N1bWVudGF0aW9uL3R1dG9yaWFscy9pZGVvZ3JhbXMva2FyeW90eXBl" title="http://circos.ca/documentation/tutorials/ideograms/karyotype">制作自己基因组的karyotype file<i class="fa fa-external-link"></i></span></li>
<li>[x]脚本制作自己的karyotype文件，其中的颜色值可从<code>/public/home/zpxu/bin/circos-0.69-4/etc/colors.unix.txt</code> 或 <code>/public/home/zpxu/bin/circos-0.69-4/etc/colors.ucsc.conf</code>文件中选取</li>
</ul>
</li>
</ul>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#染色体 -   染色体编号(ID) 图显示名称(Label)     起始   结束    颜色</span></span><br><span class="line">chr -   Gmax01 <span class="number"> 1 </span> <span class="number"> 0 </span> <span class="number"> 56831624 </span>   chr1</span><br><span class="line">chr -   Gmax02 <span class="number"> 2 </span> <span class="number"> 0 </span> <span class="number"> 48577505 </span>  	chr2</span><br><span class="line">chr -   Gmax03 <span class="number"> 3 </span> <span class="number"> 0 </span> <span class="number"> 45779781 </span>   chr3</span><br></pre></td></tr></table></figure>
<ul>
<li><p>[x] 解释:</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">染色体：chr，这一列定义表明这是一个染色体；</span><br><span class="line">   - ：短线占位符，这个占位符通常用来定义所属关系，对于染色体来说，没有所属；</span><br><span class="line">染色体编号(ID)： ID是染色体唯一且不能重复的标识。如果一个染色体组型文件里面包含多个不同来源的染色体组，设置ID最好的办法就是使用前缀。</span><br><span class="line">                    比如hs=homo sapiens, mm=mus musculus等等。有时候你可以使用hs19做为前缀来明示数据来源版本。</span><br><span class="line">                    其实，即使是只有一个来源的染色体组，也最好使用前缀，以规范文件格式。</span><br><span class="line">                    比如上面的示例，就是我绘图的大豆的基因组，因而我在设置染色体编号（ID）的时候，使用了Gmax01 …的格式，</span><br><span class="line">                    自己可以根据自己的染色体来设置。</span><br><span class="line">图显名称(<span class="built_in">Label</span>)：是将来用于显示在图上的文本。<span class="built_in">Label</span>主要是在图中显示的名称，我这里就直接使用<span class="number">1</span>,<span class="number">2</span>, …表示，</span><br><span class="line">                    但是如果有多个物种的基因组，或者来自不同的样品，品系的，还是要加以区分。</span><br><span class="line">起始、结束(<span class="built_in">START</span>和END)：定义了染色体的大小。</span><br><span class="line">                    对于染色体组型文件，需要指明的是，这里的<span class="built_in">START</span>和END应该是染色体本身的大小，而不是你想绘制部分的起止位置。</span><br><span class="line">                    对于指定绘制部分将由其它文件来定义。</span><br><span class="line">颜色(<span class="built_in">COLOR</span>)：是于定义显示的颜色。如果染色体组不以条纹(cytogenetic bands)图谱覆盖的话，那么就会以这里设置的颜色显示。</span><br><span class="line">                对于人类基因组而言，circos预设了与染色体相同的名字做为颜色名，比如chr1, chr2, … chrX, chrY, chrUn.</span><br></pre></td></tr></table></figure>
</li>
<li><p>[x] 关于染色体上加上条纹图谱的信息：<strong>可选内容</strong></p>
</li>
<li><p>[x] 一般的，我们都会在染色体组型文件当中加上条纹图谱的信息，这样才会让染色体图谱看上去有被染色的效果。文件格式与之前的一致，也只有七列。这里的DOMAIN就是染色体组型当中的ID就好了，其它的定义与前面的一致。下面就是一个例子。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">band    DOMAIN  ID  LABEL   START   END COLOR</span><br><span class="line">band    hs1     p36<span class="number">.33</span>  p36<span class="number">.33</span>  <span class="number">0</span>   <span class="number">2300000</span>     gneg</span><br><span class="line">band    hs1     p36<span class="number">.32</span>  p36<span class="number">.32</span>  <span class="number">2300000</span>     <span class="number">5400000</span>     gpos25</span><br><span class="line">band    hs1     p36<span class="number">.31</span>  p36<span class="number">.31</span>  <span class="number">5400000</span>     <span class="number">7200000</span>     gneg</span><br><span class="line">band    hs1     p36<span class="number">.23</span>  p36<span class="number">.23</span>  <span class="number">7200000</span>     <span class="number">9200000</span>     gpos25</span><br><span class="line">band    hs1     p36<span class="number">.22</span>  p36<span class="number">.22</span>  <span class="number">9200000</span>     <span class="number">12700000</span>    gneg</span><br></pre></td></tr></table></figure>
</li>
<li><p>[x] cytogenetic bands的名称例子：1p36.33</p>
</li>
<li>[x] 其命名规则是之前的数字、字母为染色体代号，一般是数字或者X,Y。而之后会有字母p或者q。p代表短臂，q代表长臂。而每个band都会有颜色深浅的不同，这里主要以gpos和gneg来区别。为了和真实值更接近，circos还定义了一系列的灰度。<br><img src="http://i.imgur.com/YyH4sq4.jpg" alt=""><span class="exturl" data-url="aHR0cDovL21pc3MuaWVwaC5uZXQvYXJjaGl2ZXMvNjI4" title="http://miss.ieph.net/archives/628"><img src="http://i.imgur.com/lFmo23A.jpg" alt="alt text"><i class="fa fa-external-link"></i></span><ul>
<li><strong>自己额外显示的数据文件</strong></li>
</ul>
</li>
<li><p>SNP的密度显示track，那么就拿这样一个track来做一个示例：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#染色体编号 起始位置    终止位置    value</span><br><span class="line">Gmax01  <span class="number">0</span>   <span class="number">999999</span>  <span class="number">0.000301</span></span><br><span class="line">Gmax01  <span class="number">1000000</span>     <span class="number">1999999</span>     <span class="number">0.001321</span></span><br><span class="line">Gmax01  <span class="number">2000000</span>     <span class="number">2999999</span>     <span class="number">0.001050</span></span><br><span class="line">Gmax01  <span class="number">3000000</span>     <span class="number">3999999</span>     <span class="number">0.003027</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>文件内容解释：</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">染色体编号：一定要与基因组信息文件中的染色体编号保持一致，不然绘图的时候会出错；</span><br><span class="line">起始位置、终止位置：这是你要统计的这个区段的的范围；</span><br><span class="line"><span class="keyword">value</span>：则是值，根据情况，比如我这里是统计的SNP的密度，那么这个值就是在这个染色体区段范围类，染色体的密度，</span><br><span class="line">           如果是统计数量，那么这个值就是数目。</span><br></pre></td></tr></table></figure>
</li>
<li><p>每个track都有自己对应的数据，而且不同的绘图类型，所需要的数据结构可能都不一样，这时你就需要根据自己的需求来准备数据文件。</p>
</li>
<li>不同显示数据的track对应的数据文件的格式，其实数据的格式都很好理解，如果你想绘制什么样的图，可以在官网上找到相关的数据类型结构，你只要根据这个结构来做好你的数据，就没什么问题。</li>
</ul>
<h2 id="2-_ideogram-conf_显示染色体：不需要额外指定文件">2. <code>ideogram.conf</code> 显示染色体：不需要额外指定文件</h2><p>将染色体在圈图上展示出来，代表每个染色体的图形，称为ideogram。<br>更详细解释见：<span class="exturl" data-url="aHR0cHM6Ly93d3cucGxvYi5vcmcvYXJ0aWNsZS8xMDYzOC5odG1s" title="https://www.plob.org/article/10638.html">circos绘图ideogram.conf文件的配置<i class="fa fa-external-link"></i></span> 和 <span class="exturl" data-url="aHR0cDovL2Jsb2cucWl1YmlvLmNvbTo4MDgwL2FyY2hpdmVzLzI1MTk=" title="http://blog.qiubio.com:8080/archives/2519">Circos系列教程（二）染色体示意图ideograms<i class="fa fa-external-link"></i></span>(有各种细节修改解释)<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;ideogram&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">### 设定 ideograms 之间的空隙</span></span><br><span class="line">&lt;spacing&gt;</span><br><span class="line"><span class="comment"># 设置圈图中染色体之间的空隙大小，以下设置为每个空隙大小为周长的 0.5%</span></span><br><span class="line">default = 0.005r</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以设置指定两条染色体之间的空隙</span></span><br><span class="line"><span class="comment">#&lt;pairwise hsY;hs1&gt;</span></span><br><span class="line"><span class="comment"># 以下设定为两条染色体之间的空隙约为圆的 20 度角。</span></span><br><span class="line"><span class="comment">#spacing = 20r</span></span><br><span class="line"><span class="comment">#&lt;/pairwise&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/spacing&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">## 设定 ideograms </span></span><br><span class="line"><span class="comment"># 设定 ideograms 的位置，以下设定 ideograms 在图离圆心的 90% 处，修改染色体圆圈的大小，即空出较多边缘空间</span></span><br><span class="line">radius           = 0.90r</span><br><span class="line"><span class="comment"># 设定 ideograms 的厚度，可以使用 r（比例关系） 或 p（像素）作为单位</span></span><br><span class="line">thickness        = 20p</span><br><span class="line"><span class="comment"># 设定 ideograms 是否填充颜色。填充的颜色取决于 karyotype 指定的文件的最后一列。</span></span><br><span class="line">fill             = yes</span><br><span class="line"><span class="comment"># 设定 ideograms 轮廓的颜色及其厚度。如果没有该参数或设定其厚度为0，则表示没有轮廓。</span></span><br><span class="line">stroke_color     = dgrey</span><br><span class="line">stroke_thickness = 2p</span><br><span class="line"></span><br><span class="line"><span class="comment">## 设定 label 的显示</span></span><br><span class="line"><span class="comment"># 设定是否显示 label 。 label 对应着 karyotype 文件的第 4 列。如果其值为 yes，则必须要有 label_radius 参数来设定 label 的位置，否则会报错并不能生成结果。</span></span><br><span class="line">show_label       = yes</span><br><span class="line"><span class="comment"># 设定 label 的字体</span></span><br><span class="line">label_font       = default</span><br><span class="line"><span class="comment"># 设定 label 的位置</span></span><br><span class="line">label_radius     = 1r+90p</span><br><span class="line"><span class="comment"># 设定 label 的字体大小</span></span><br><span class="line">label_size       = 40</span><br><span class="line"><span class="comment"># 设定 label 的字体方向，yes 是易于浏览的方向。</span></span><br><span class="line">label_parallel   = yes</span><br><span class="line"></span><br><span class="line">&lt;/ideogram&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="染色体标签显示：LABELS">染色体标签显示：<span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvaWRlb2dyYW1zL2xhYmVscy9pbWFnZXM=" title="http://www.circos.ca/documentation/tutorials/ideograms/labels/images">LABELS<i class="fa fa-external-link"></i></span></h3><h2 id="3-_ticks-conf_以刻度形式显示染色体大小：不需要额外指定文件">3. <code>ticks.conf</code> 以刻度形式显示染色体大小：不需要额外指定文件</h2><p>将染色体的大小以刻度的形式在圈图上展示出来。<br><img src="http://i.imgur.com/LqhtHZN.png" alt=""><br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 是否显示 ticks</span></span><br><span class="line">show_ticks         = yes</span><br><span class="line"><span class="comment"># 是否显示 ticks 的 lables</span></span><br><span class="line">show_tick_labels    = yes</span><br><span class="line"></span><br><span class="line"><span class="comment">## 设定 ticks</span></span><br><span class="line">&lt;ticks&gt;</span><br><span class="line"><span class="comment">## ticks 的设置</span></span><br><span class="line"><span class="comment"># 设定 ticks 的位置</span></span><br><span class="line">radius           = 1r</span><br><span class="line"><span class="comment"># 设定 ticks 的颜色</span></span><br><span class="line">color            = black</span><br><span class="line"><span class="comment"># 设定 ticks 的厚度</span></span><br><span class="line">thickness        = 2p</span><br><span class="line"><span class="comment"># 设定 ticks' label 的值的计算。将该刻度对应位置的值 * multiplier 得到能展示到圈图上的 label 值。</span></span><br><span class="line">multiplier       = 1e-6</span><br><span class="line"><span class="comment"># label 值的格式化方法。%d 表示结果为整数；%f 结果为浮点数； %.1f 结果为小数点后保留1位； %.2f 结果为小数点后保留2位。</span></span><br><span class="line">format           = %d</span><br><span class="line"></span><br><span class="line"><span class="comment">## 以下设置了 2 个 ticks，前者是小刻度，后者是大刻度。</span></span><br><span class="line">&lt;tick&gt;</span><br><span class="line"><span class="comment"># 设置每个刻度代表的长度。若其单位为 u，则必须要设置 chromosomes_units 参数。比如设置 chromosomes_units = 1000000，则如下 5u 表示每个刻度代表 5M 长度的基因组序列。</span></span><br><span class="line">spacing        = 5u</span><br><span class="line"><span class="comment"># 设置 tick 的长度</span></span><br><span class="line">size           = 10p</span><br><span class="line">&lt;/tick&gt;</span><br><span class="line"></span><br><span class="line">&lt;tick&gt;</span><br><span class="line">spacing        = 25u</span><br><span class="line">size           = 15p</span><br><span class="line"><span class="comment"># 由于设置的是大刻度，以下用于设置展示 ticks' label。</span></span><br><span class="line">show_label     = yes</span><br><span class="line"><span class="comment"># 设置 ticks' label 的字体大小</span></span><br><span class="line">label_size     = 20p</span><br><span class="line"><span class="comment"># 设置 ticks' label 离 ticks 的距离</span></span><br><span class="line">label_offset   = 10p</span><br><span class="line">format         = %d</span><br><span class="line">&lt;/tick&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ticks&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="4-_links-conf_以曲线连接显示基因组内部区域之间的联系_：需指定links文件">4. <code>links.conf</code> 以曲线连接显示基因组内部区域之间的联系 ：需指定links文件</h2><p>基因组内部不同的序列区域之间有联系，将之使用线条进行连接，从而展示到圈图上。常见的是重复序列之间的连接。<br>更多详细内容见：<span class="exturl" data-url="aHR0cDovL2Jsb2cucWl1YmlvLmNvbTo4MDgwL2FyY2hpdmVzLzI1NTQ=" title="http://blog.qiubio.com:8080/archives/2554">Circos系列教程（四）连线 links<i class="fa fa-external-link"></i></span><br><img src="http://i.imgur.com/LpR2JnK.png" alt=""></p>
<h3 id="数据结构">数据结构</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LABEL	ID	START	END</span><br><span class="line">segdup00001	hs1	<span class="number">465</span>	<span class="number">30596</span></span><br><span class="line">segdup00001	hs2	<span class="number">114046768</span>	<span class="number">114076456</span></span><br><span class="line">segdup00002	hs1	<span class="number">486</span>	<span class="number">76975</span></span><br><span class="line">segdup00002	hs15	<span class="number">100263879</span>	<span class="number">100338121</span></span><br></pre></td></tr></table></figure>
<p>这里的LABEL是连线的名称，因为两点确定一条线，所以基本上连线的数据都是同一个名称出现两行数据，分别记录线两端对应的染色体组位置。ID对应的是karyotypes数据文件当中的ID，start和end分别定义起始和终止的位置。</p>
<h3 id="或者是：">或者是：</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ID1    START    END    ID2    START    END</span><br><span class="line"><span class="keyword">A</span><span class="number">01 27231996</span> <span class="number">27234600</span> D<span class="number">01 19250453</span> <span class="number">19253070</span></span><br><span class="line"><span class="keyword">A</span><span class="number">03 98657717</span> <span class="number">98660412</span> <span class="keyword">A</span><span class="number">13 3532356</span> <span class="number">3534210</span></span><br><span class="line"><span class="keyword">A</span><span class="number">03 97671503</span> <span class="number">97673317</span> D<span class="number">02 64857836</span> <span class="number">64860545</span></span><br><span class="line"><span class="keyword">A</span><span class="number">03 98657717</span> <span class="number">98660412</span> D<span class="number">02 65834252</span> <span class="number">65836940</span></span><br></pre></td></tr></table></figure>
<h3 id="配置文件">配置文件</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;links&gt;</span><br><span class="line"></span><br><span class="line">&lt;link&gt;</span><br><span class="line"><span class="comment"># 指定 link 文件的路径，其文件格式为：</span></span><br><span class="line"><span class="comment"># chr1  start   end     chr2    start   end</span></span><br><span class="line"><span class="comment"># hs1   465     30596   hs2     114046768       114076456</span></span><br><span class="line"><span class="comment"># 表明这两个染色体区域有联系，例如这个区域的序列长度&gt;1kb且序列相似性&gt;=90%。</span></span><br><span class="line">file          = data/5/segdup.txt</span><br><span class="line"><span class="comment"># 设置 link 曲线的半径</span></span><br><span class="line">radius        = 0.8r</span><br><span class="line"><span class="comment"># 设置贝塞尔曲线半径，该值设大后曲线扁平，使图像不太好看。</span></span><br><span class="line">bezier_radius = 0r</span><br><span class="line"><span class="comment"># 设置 link 曲线的颜色</span></span><br><span class="line">color         = black_a4</span><br><span class="line"><span class="comment"># 设置 link 曲线的厚度</span></span><br><span class="line">thickness     = 2</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line"><span class="comment"># 以下可以设置多个 rules，用来对 link 文件的每一行进行过滤或展示进行设定。每个 rule 都有一个 condition 参数；如果该 condition 为真，除非 flow=continue ，则不</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 link 文件中该行数据是染色体内部的 link，则不对其进行展示</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition     = var(intrachr)</span><br><span class="line">show          = no</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 link 曲线的颜色与 ideogram 的颜色一致，否则为统一的颜色。</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line"><span class="comment"># condition 为真，则执行该 block 的内容</span></span><br><span class="line">condition     = 1</span><br><span class="line"><span class="comment"># 设置 link 曲线的颜色为第 2 条染色体的颜色。对应这 link 文件中第 4 列数据对应的染色体的名称</span></span><br><span class="line">color         = eval(var(chr2))</span><br><span class="line"><span class="comment"># 虽然 condition 为真，但依然检测下一个 rule</span></span><br><span class="line">flow          = continue</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 link 起始于 hs1，则其 link 曲线半径为 0.99r</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition     = from(hs1)</span><br><span class="line">radius1       = 0.99r</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 link 结束于 hs1，则其 link 曲线半径为 0.99r</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition     = to(hs1)</span><br><span class="line">radius2       = 0.99r</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/link&gt;</span><br><span class="line"></span><br><span class="line">&lt;/links&gt;</span><br></pre></td></tr></table></figure>
<h2 id="5-_plots_histogram-conf_以直方图形式展示数据：需指定额外数据">5. <code>plots_histogram.conf</code> 以直方图形式展示数据：需指定额外数据</h2><p>将基因组序列的GC含量，表达量等以直方图的形式在圈图中展示出来。以下作了两个直方图，并对分别添上背景或网格线。<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;plot&gt;</span><br><span class="line"><span class="comment"># 设定为直方图</span></span><br><span class="line">type = histogram</span><br><span class="line"><span class="comment"># 数据文件格式，为 4 列：</span></span><br><span class="line"><span class="comment"># chromosome	start	end	data</span></span><br><span class="line"><span class="comment"># hs1	0	1999999	180.0000</span></span><br><span class="line">file = data/5/segdup.hs1234.hist.txt</span><br><span class="line"><span class="comment"># 设置直方图的位置，r1 要比 r0 大。直方图的方向默认为向外。</span></span><br><span class="line">r1   = 0.88r</span><br><span class="line">r0   = 0.81r</span><br><span class="line"><span class="comment"># 直方图的填充颜色</span></span><br><span class="line">fill_color = vdgrey</span><br><span class="line"><span class="comment"># 默认下直方图轮廓厚度为 1px，若不需要轮廓，则设置其厚度为0，或在 etc/tracks/histogram.conf 中修改。</span></span><br><span class="line">thickness = 0p</span><br><span class="line"><span class="comment"># 直方图是由 bins （条行框）所构成的。若 bins 在坐标上不相连，最好设置不要将其bins连接到一起。例如：</span></span><br><span class="line"><span class="comment"># hs1 10 20 0.5</span></span><br><span class="line"><span class="comment"># hs1 30 40 0.25</span></span><br><span class="line"><span class="comment"># 上述数据设置值为 yes 和 no 时，图形是不一样的。</span></span><br><span class="line">extend_bin = no</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下添加 rule ，不在 hs1 上添加直方图。</span></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定直方图的背景颜色</span></span><br><span class="line">&lt;backgrounds&gt;</span><br><span class="line">show  = data</span><br><span class="line"></span><br><span class="line">&lt;background&gt;</span><br><span class="line">color = vvlgrey</span><br><span class="line">&lt;/background&gt;</span><br><span class="line">&lt;background&gt;</span><br><span class="line">color = vlgrey</span><br><span class="line">y0    = 0.2r</span><br><span class="line">y1    = 0.5r</span><br><span class="line">&lt;/background&gt;</span><br><span class="line">&lt;background&gt;</span><br><span class="line">color = lgrey</span><br><span class="line">y0    = 0.5r</span><br><span class="line">y1    = 0.8r</span><br><span class="line">&lt;/background&gt;</span><br><span class="line">&lt;background&gt;</span><br><span class="line">color = grey</span><br><span class="line">y0    = 0.8r</span><br><span class="line">&lt;/background&gt;</span><br><span class="line"></span><br><span class="line">&lt;/backgrounds&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br><span class="line"></span><br><span class="line">&lt;plot&gt;</span><br><span class="line">type = histogram</span><br><span class="line"><span class="comment"># 此处直方图的数据文件第 4 列是多个由逗号分割的数值，需要制作叠加的直方图。</span></span><br><span class="line">file = data/5/segdup.hs1234.stacked.txt</span><br><span class="line">r1   = 0.99r</span><br><span class="line">r0   = 0.92r</span><br><span class="line"><span class="comment"># 给 4 个值按顺序填充不同的颜色</span></span><br><span class="line">fill_color  = hs1,hs2,hs3,hs4</span><br><span class="line">thickness = 0p</span><br><span class="line">orientation = in</span><br><span class="line">extend_bin  = no</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在直方图中添加坐标网格线</span></span><br><span class="line">&lt;axes&gt;</span><br><span class="line">show = data</span><br><span class="line">thickness = 1</span><br><span class="line">color     = lgrey</span><br><span class="line"></span><br><span class="line">&lt;axis&gt;</span><br><span class="line">spacing   = 0.1r</span><br><span class="line">&lt;/axis&gt;</span><br><span class="line">&lt;axis&gt;</span><br><span class="line">spacing   = 0.2r</span><br><span class="line">color     = grey</span><br><span class="line">&lt;/axis&gt;</span><br><span class="line">&lt;axis&gt;</span><br><span class="line">position  = 0.5r</span><br><span class="line">color     = red</span><br><span class="line">&lt;/axis&gt;</span><br><span class="line">&lt;axis&gt;</span><br><span class="line">position  = 0.85r</span><br><span class="line">color     = green</span><br><span class="line">thickness = 2</span><br><span class="line">&lt;/axis&gt;</span><br><span class="line"></span><br><span class="line">&lt;/axes&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="6-_plots_heatmap-conf_以热图形式显示数据_：需额外指定数据">6. <code>plots_heatmap.conf</code> 以热图形式显示数据 ：需额外指定数据</h2><p>基因组一个区域内有多组数据时，适合以热图形式显示数据。比如基因表达量。<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">&lt;plot&gt;</span><br><span class="line"><span class="comment"># 绘制 heat map</span></span><br><span class="line">type  = heatmap</span><br><span class="line"><span class="comment"># 设定数据文件路径。</span></span><br><span class="line"><span class="comment">#文件格式描述：文件有 5 列</span></span><br><span class="line"><span class="comment"># chrID start   end     data    class</span></span><br><span class="line"><span class="comment"># hs1 0 1999999 113.0000 id=hs1</span></span><br><span class="line"><span class="comment"># hs1 0 1999999 40.0000 id=hs4</span></span><br><span class="line"><span class="comment"># hs1 0 1999999 20.0000 id=hs2</span></span><br><span class="line"><span class="comment"># hs1 0 1999999 7.0000 id=hs3</span></span><br><span class="line">file  = data/5/segdup.hs1234.heatmap.txt</span><br><span class="line"><span class="comment"># 设定图形所处位置</span></span><br><span class="line">r1    = 0.89r</span><br><span class="line">r0    = 0.88r</span><br><span class="line"><span class="comment"># 设定热图的颜色。颜色为 hs3 ，以及相应带不同透明程度的 5 种颜色。</span></span><br><span class="line">color = hs1_a5,hs1_a4,hs1_a3,hs1_a2,hs1_a1,hs1</span><br><span class="line"><span class="comment"># 设定 scale_log_base 参数。计算颜色的方法如下：</span></span><br><span class="line"><span class="comment"># f = (value - min) / ( max - min )    热图中每个方块代表着一个值，并给予相应的颜色标示。一系列的值 [min,max] 对应一系列的颜色 c[n], i=0..N</span></span><br><span class="line"><span class="comment"># n = N * f ** (1/scale_log_base)</span></span><br><span class="line"><span class="comment"># 由上面两个公式计算出代表颜色的 n 值。</span></span><br><span class="line"><span class="comment"># 若 scale_log_base = 1，则数值与颜色的变化是线性的；</span></span><br><span class="line"><span class="comment"># 若 scale_log_base &gt; 1，则颜色向小方向靠近；</span></span><br><span class="line"><span class="comment"># 若 scale_log_base &lt; 1，则颜色向大方向靠近。</span></span><br><span class="line">scale_log_base = 5</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仅显示 id = hs1 的数据</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition = var(id) ne <span class="string">"hs1"</span></span><br><span class="line">show      = no</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br><span class="line"></span><br><span class="line">&lt;plot&gt;</span><br><span class="line">type  = heatmap</span><br><span class="line">file  = data/5/segdup.hs1234.heatmap.txt</span><br><span class="line">r1    = 0.90r</span><br><span class="line">r0    = 0.89r</span><br><span class="line">color = hs2_a5,hs2_a4,hs2_a3,hs2_a2,hs2_a1,hs2</span><br><span class="line">scale_log_base = 5</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line"></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition = var(id) ne <span class="string">"hs2"</span></span><br><span class="line">show      = no</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br><span class="line"></span><br><span class="line">&lt;plot&gt;</span><br><span class="line">type  = heatmap</span><br><span class="line">file  = data/5/segdup.hs1234.heatmap.txt</span><br><span class="line">r1    = 0.91r</span><br><span class="line">r0    = 0.90r</span><br><span class="line">color = hs3_a5,hs3_a4,hs3_a3,hs3_a2,hs3_a1,hs3</span><br><span class="line">scale_log_base = 5</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line"></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition = var(id) ne <span class="string">"hs3"</span></span><br><span class="line">show      = no</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br><span class="line"></span><br><span class="line">&lt;plot&gt;</span><br><span class="line">type  = heatmap</span><br><span class="line">file  = data/5/segdup.hs1234.heatmap.txt</span><br><span class="line">r1    = 0.92r</span><br><span class="line">r0    = 0.91r</span><br><span class="line">color = hs4_a5,hs4_a4,hs4_a3,hs4_a2,hs4_a1,hs4</span><br><span class="line">scale_log_base = 5</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line"></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition = var(id) ne <span class="string">"hs4"</span></span><br><span class="line">show      = no</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line"></span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="7-_plots_text-conf_以文本形式显示数据_：需额外指定数据">7. <code>plots_text.conf</code> 以文本形式显示数据 ：需额外指定数据</h2><p>若需要在圈图上显示一些基因的名称，此时需要以文本形式显示数据。<br><strong>参数的图形解释见 ：<span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvMmRfdHJhY2tzL3RleHRfMS9pbWFnZXM=" title="http://www.circos.ca/documentation/tutorials/2d_tracks/text_1/images">6 — 2D DATA TRACKS<i class="fa fa-external-link"></i></span></strong><br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;plot&gt;</span><br><span class="line"><span class="comment"># 显示出文字</span></span><br><span class="line">type  = text</span><br><span class="line"><span class="comment"># 数据文件路径</span></span><br><span class="line">file  = data/6/genes.labels.txt</span><br><span class="line"><span class="comment"># 显示在图形中的位置,r1值需大于r0值，r0 = 1r时表示标签显示在圆圈外；</span></span><br><span class="line"><span class="comment"># r1和r0间的差值空间是用来显示标签的区域，所以当所显示标签文本很长时必须加大这一空间，否则标签文本不能显示；</span></span><br><span class="line">r1    = 0.8r</span><br><span class="line">r0    = 0.6r</span><br><span class="line">r0    = 1r</span><br><span class="line">r1    = 1r+800p</span><br><span class="line"><span class="comment"># 标签的字体</span></span><br><span class="line">label_font = light</span><br><span class="line"><span class="comment"># 标签大小</span></span><br><span class="line">label_size = 12p</span><br><span class="line"><span class="comment"># 文字边缘的大小，设置较小则不同单词就可能会连接到一起了。</span></span><br><span class="line"><span class="comment"># padding  - text margin in angular direction</span></span><br><span class="line"><span class="comment"># rpadding - text margin in radial direction</span></span><br><span class="line">rpadding   = 5p</span><br><span class="line"><span class="comment"># 设置是否需要在 label 前加一条线，用来指出 lable 的位置。</span></span><br><span class="line">show_links     = no</span><br><span class="line">link_dims      = 0p,2p,5p,2p,2p</span><br><span class="line">link_thickness = 2p</span><br><span class="line">link_color     = black</span><br><span class="line"></span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;&lt;<span class="keyword">include</span> exclude.hs1.rule&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 rule ，对 label 中含有字母 a 或 b 的特异性显示</span></span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition  = var(value) =~ /a/i</span><br><span class="line">label_font = bold</span><br><span class="line">flow       = continue</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line">&lt;rule&gt;</span><br><span class="line">condition  = var(value) =~ /b/i</span><br><span class="line">color      = blue</span><br><span class="line">&lt;/rule&gt;</span><br><span class="line">&lt;/rules&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plot&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="生成自己的_text_数据文件">生成自己的 text 数据文件</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat exon-ixon.gff3 | grep <span class="string">"mRNA"</span> | \grep -v <span class="string">"scaff"</span> | cut -f <span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">9</span> | cut -f <span class="number">1</span> -d\; | sed <span class="string">"s/ID=//g"</span> | \</span><br><span class="line">sort -k1,<span class="number">1</span>V | sed <span class="string">"s/<span class="subst">\t</span>/ /g"</span> &gt; ../bin/circos<span class="number">-0.69</span><span class="number">-4</span>/xzp/Gh.cysteine_proteinase.text.txt</span><br></pre></td></tr></table></figure>
<p>更多关于这一部分的修改见：<code>/public/home/zpxu/bin/circos-0.69-4/circos-tutorials-0.67/tutorials/6/7</code> 目录；</p>
<h3 id="label_snuggle_解释"><code>label_snuggle</code> 解释</h3><p><img src="http://i.imgur.com/qsdpv6d.png" alt=""></p>
<h3 id="max_snuggle_distance_解释"><code>max_snuggle_distance</code> 解释</h3><p><img src="http://i.imgur.com/VXdqigG.png" alt=""></p>
<h2 id="8-_rules-conf_放置常用的规则配置">8. <code>rules.conf</code> 放置常用的规则配置</h2><h2 id="9-_circos-conf_主配置文件">9. <code>circos.conf</code> 主配置文件</h2><p>在主配置文件 circos.conf 中，包含以上所需要的配置文件信息，则可以画出所需要的track。此外，可以设置一些全局的设置。<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 额外信息显示与否</span><br><span class="line">show_links      = yes</span><br><span class="line">show_highlights = yes</span><br><span class="line">show_text       = yes</span><br><span class="line">show_heatmaps   = yes</span><br><span class="line">show_scatter    = yes</span><br><span class="line">show_histogram  = yes</span><br><span class="line"># 从外部引用来指定染色体组型文件</span><br><span class="line">&lt;&lt;include karyotype.and.layout.conf&gt;&gt;</span><br><span class="line"></span><br><span class="line">### 绘制 plot 图</span><br><span class="line">&lt;plots&gt;</span><br><span class="line"></span><br><span class="line">&lt;&lt;include plots_histogram.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include plots_heatmap.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include plots_text.conf&gt;&gt;</span><br><span class="line"></span><br><span class="line">&lt;/plots&gt;</span><br><span class="line"></span><br><span class="line">&lt;&lt;include highlights.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include ideogram.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include ticks.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include links.conf&gt;&gt;</span><br><span class="line"></span><br><span class="line">################################################################</span><br><span class="line"># 插入必须的并不常修改的标准参数</span><br><span class="line">&lt;image&gt;</span><br><span class="line">&lt;&lt;include etc/image.conf&gt;&gt;</span><br><span class="line">&lt;/image&gt;</span><br><span class="line">&lt;&lt;include etc/colors_fonts_patterns.conf&gt;&gt;</span><br><span class="line">&lt;&lt;include etc/housekeeping.conf&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>circos配置的单位概念</strong><br>一共有4种单位：p, r, u, b<br>p表示像素，1p表示1像素<br>r表示相对大小，0.95r表示95% ring 大小。<br>u表示相对chromosomes_unit的长度，如果chromosomes_unit = 1000，则1u就是千分之一的染色体长度。<br>b表示碱基，如果染色体长1M，那么1b就是百万分之一的长度。</p>
</blockquote>
<h2 id="特殊图形展示(带链接)">特殊图形展示(带链接)</h2><p><span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvaWRlb2dyYW1zL3NwYWNpbmdfYnJlYWtzL2ltYWdlcw==" title="http://www.circos.ca/documentation/tutorials/ideograms/spacing_breaks/images"><img src="http://i.imgur.com/nxyUHDW.png" alt=""><i class="fa fa-external-link"></i></span></p>
<h2 id="使用技巧">使用技巧</h2><ul>
<li><strong>ideogram.conf</strong> 文件下的 <code>radius</code> 可修改输出图片的整个屏幕占比（即充满整个画布或集中在中心）。</li>
<li>选取RGB颜色：<span class="exturl" data-url="aHR0cHM6Ly9yZ2IudG8vaHRtbC1jb2xvci1uYW1lcy8x" title="https://rgb.to/html-color-names/1">Html color codes<i class="fa fa-external-link"></i></span></li>
<li>选取特定数目的明显区别的颜色： <ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTUyODI1ODAvaG93LXRvLWdlbmVyYXRlLWEtbnVtYmVyLW9mLW1vc3QtZGlzdGluY3RpdmUtY29sb3JzLWluLXI=" title="https://stackoverflow.com/questions/15282580/how-to-generate-a-number-of-most-distinctive-colors-in-r">How to generate a number of most distinctive colors in R?<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3Rvb2xzLm1lZGlhbGFiLnNjaWVuY2VzLXBvLmZyL2l3YW50aHVlLw==" title="http://tools.medialab.sciences-po.fr/iwanthue/">i want hue<i class="fa fa-external-link"></i></span> (推荐：网页可视化)</li>
</ul>
</li>
</ul>
<h2 id="参考链接">参考链接</h2><ol>
<li><span class="exturl" data-url="aHR0cDovL3N0YXJzeWkuZ2l0aHViLmlvLzIwMTYvMDYvMjMvQ2lyY29zJUU2JTk1JTk5JUU3JUE4JThCJUVGJUJDJTg4JUU0JUJBJThDJUVGJUJDJTg5JUU1JTlGJUJBJUU3JUExJTgwJUU0JUJEJUJGJUU3JTk0JUE4Lw==" title="http://starsyi.github.io/2016/06/23/Circos%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/">Circos教程(二):基础使用<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5jaGVubGlhbmZ1LmNvbS8/cD0yMzQy" title="http://www.chenlianfu.com/?p=2342">陈连福：Circos的安装和简单使用<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9pcmVuZXh6d2VuLmdpdGJvb2tzLmlvL2hlbGxvLWdpdGJvb2svY29udGVudC8=" title="https://irenexzwen.gitbooks.io/hello-gitbook/content/">Circos tutorial<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;安装主页&quot;&gt;安装主页&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/XrKrXqj.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h5 id=&quot;安装主页-1&quot;&gt;&lt;a href=&quot;http://www.circos.ca/documentation/tutorials/configuration/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;安装主页&lt;/a&gt;&lt;/h5&gt;&lt;h5 id=&quot;已发表文章circos图(http://circos-ca/in_literature/scientific/)&quot;&gt;&lt;a href=&quot;http://circos.ca/images/scientific_literature/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;已发表文章circos图&lt;/a&gt;(&lt;a href=&quot;http://circos.ca/in_literature/scientific/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://circos.ca/in_literature/scientific/&lt;/a&gt;)&lt;/h5&gt;&lt;h5 id=&quot;教程和数据下载&quot;&gt;&lt;a href=&quot;http://www.circos.ca/software/download/tutorials/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;教程和数据下载&lt;/a&gt;&lt;/h5&gt;&lt;h5 id=&quot;Creating_Circos_Plots&quot;&gt;&lt;a href=&quot;http://jura.wi.mit.edu/bio/education/hot_topics/Circos/Circos.pdf&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Creating Circos Plots&lt;/a&gt;&lt;/h5&gt;&lt;h2 id=&quot;&lt;!-more-&gt;&quot;&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Circos" scheme="http://tiramisutes.github.io/tags/Circos/"/>
    
  </entry>
  
  <entry>
    <title>单细胞扩增之：LIANTI</title>
    <link href="http://tiramisutes.github.io/2017/05/28/LIANTI.html"/>
    <id>http://tiramisutes.github.io/2017/05/28/LIANTI.html</id>
    <published>2017-05-28T09:39:13.000Z</published>
    <updated>2019-03-10T03:52:49.818Z</updated>
    
    <content type="html"><![CDATA[<p>之前我们也了解过<a href="http://tiramisutes.github.io/2016/10/13/single-cell.html">Single Cell 全基因组扩增</a>过程，最近北大的<span class="exturl" data-url="aHR0cDovL3hpZWxhYi5wa3UuZWR1LmNuL3hpZS8=" title="http://xielab.pku.edu.cn/xie/">谢老师<i class="fa fa-external-link"></i></span>又重新刷新了单细胞全基因组扩增的新高度：<strong><span class="exturl" data-url="aHR0cDovL3NjaWVuY2Uuc2NpZW5jZW1hZy5vcmcvY29udGVudC8zNTYvNjMzNC8xODk=" title="http://science.sciencemag.org/content/356/6334/189">Single-cell whole-genome analyses by Linear Amplification via Transposon Insertion (LIANTI)<i class="fa fa-external-link"></i></span></strong>,下面对本文做简单的解读?<br><a id="more"></a></p>
<h2 id="转座子插入的线性扩增">转座子插入的线性扩增</h2><p>Linear Amplification via Transposon Insertion (LIANTI)<br><strong>Combines <span class="exturl" data-url="aHR0cDovL3d3dy5qYmMub3JnL2NvbnRlbnQvMjczLzEzLzczNjcubG9uZw==" title="http://www.jbc.org/content/273/13/7367.long">Tn5 transposition<i class="fa fa-external-link"></i></span> and <span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNTM1NDIvcGRmL3BuYXMwMTAzMC0wMDQzLnBkZg==" title="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC53542/pdf/pnas01030-0043.pdf">T7 in vitro transcription<i class="fa fa-external-link"></i></span> for single-cell genomic analyses;</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/transposome.png" alt=""></p>
<h2 id="指数扩增_Vs_线性扩增">指数扩增 Vs 线性扩增</h2><p><strong>线性扩增优于指数扩增，基于以下两方面考虑：</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/%E6%8C%87%E6%95%B0%E5%92%8C%E7%BA%BF%E6%80%A7%E6%89%A9%E5%A2%9E.png" alt="指数和线性扩增"></p>
<h3 id="拷贝数">拷贝数</h3><p>例如，上图中假设DNA片段A和B的扩增效率 (replication yields) 分别为100%和70%每一次，并假设原始A/B=1:1，最终的扩增系数 (amplification factor) 为片段A 大约10,000；<br>即在指数扩增 (上一次的扩增结果可以成为下一次扩增的模版) 时需要经过13次扩增过程 (213=8,192; 214=16,384)，此时B对应的最终产物量为1.713~=990，A/B~=8:1；<br>而线性扩增仅使用最初模版，扩增出的模版被分离出来不进入扩增过程，所以需要10,000次的扩增过程，此时B对应的最终产物量为0.7<em>10,000=7,000，A/B=1:0.7;<br><em>*当上述扩增用于研究拷贝数变异(CNV)时，指数扩增会引起致命性错误；</em></em></p>
<h3 id="准确性fidelity">准确性fidelity</h3><p>对于保真性达10-7的高保真聚合酶扩增一次人的基因组 (3X 109bp)理论上将随机性的引入大约300个碱基的错误，并且因为指数扩增特性这300个碱基错误的扩增产物将作为下一次扩增的模版，在300个碱基错误的基础上可能再次引入300个碱基的错误，而且上一次扩增的错误会延续在下一次扩增中，这样循环下去这种错误将会被无限次的扩大，这在检测SNVs时会产生假阳性。<br>相反，在线性扩增时，由于模版始终为最初的模版，所以这种扩增错误每次都会随机出现在不同的位置，很容易通过不同时期扩增产物间的比对而消除。</p>
<blockquote>
<p><strong>SNP Vs SNV</strong></p>
<p>单核苷酸多态性（single nucleotide polymorphism，SNP） 和单核苷酸位点变异（single nucleotide variants, SNV）。个体间基因组DNA序列同一位置单个核苷酸变异(替代、插入或缺失)所引起的多态性。不同物种、个体基因组DNA序列同一位置上的单个核苷酸存在差别的现象。有这种差别的基因座、DNA序列等可作为基因组作图的标志。人基因组上平均约每1000个核苷酸即可能出现1个单核苷酸多态性的变化，其中有些单核苷酸多态性可能与疾病有关，但可能大多数与疾病无关。单核苷酸多态性是研究人类家族和动植物品系遗传变异的重要依据。在研究癌症基因组变异时，相对于正常组织，癌症中特异的单核苷酸变异是一种体细胞突变（somatic mutation），称做SNV。</p>
<p>SNP (single nucleotide polymorphism) vs. SNV (single nucleotide variant) As their name suggests, both are concerned with aberrations at a single nucleotide. However, a SNP is when an aberration is expected at the position for any member in the species 鈥?for example, a well characterized allele. A SNV on the other hand is when there is a variation at a position that hasn鈥檛 been well characterized 鈥?for example, when it is only seen in one individual. It is really all a question of frequency of occurrence.</p>
</blockquote>
<h2 id="扩增过程原理">扩增过程原理</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/LIANTI.png" alt="LIANTI"></p>
<h4 id="1-在LIANTI扩增时来自于单细胞的基因组DNA在Tn5转座酶的作用下转座LIANTI转座子_而随机片段化（400bp左右）。">1.在LIANTI扩增时来自于单细胞的基因组DNA在Tn5转座酶的作用下转座LIANTI转座子 而随机片段化（400bp左右）。</h4><ul>
<li>LIANTI转座子 (LIANTI transposon)：包含一段19bp双链的转座酶结合位点和单链的T7启动子环；</li>
<li>LIANTI transposon DNA (5’/Phos/<em><u>CTGTCTCTTATACACATCT</u></em>GAACAGAATTTAATACGACTCACTATAGGG<em><u>AGATGTGTATAAGAGACAG</u></em>-3’, IDT oligo with PAGE purification) ;</li>
<li>等摩尔量的LIANTI 转座子和Tn5转座酶 (Tn5 transposase) 混合形成二聚体的LIANTI转座体 (LIANTI transposome).</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/LIANTI2.png" alt="LIANTI"></p>
<h4 id="2-碎片化后的基因组DNA被加上T7启动子标签，随后在体外转录线性扩增成成千上万的RNAs，紧接着3’端反向_and_合成互补的第二链形成双链LIANTI扩增用于DNA文库。">2.碎片化后的基因组DNA被加上T7启动子标签，随后在体外转录线性扩增成成千上万的RNAs，紧接着3’端反向 and 合成互补的第二链形成双链LIANTI扩增用于DNA文库。</h4><ul>
<li>来源于单细胞的基因组DNA被随机碎片化后被LIANTI转座子标记，随后DNA聚合酶作用于碎片DNA双链两端互补单链的环状T7启动子为双链的T7启动子；</li>
<li>在T7RNA聚合酶的作用下体外转录线性扩增基因组DNA为基因组RNA，其中转录出的RNA能够在3‘ 端自动环化使单链状转座酶结合位点形成双链状；</li>
<li>随后经历反转录作用，RNase消化和第二链的合成，双链的LIANTI扩增物标记上特异的分子条形码 (unique molecular barcodes) 代表原始单细胞基因组DNA 的扩增产物用于之后的DNA文库和高通量测序；</li>
</ul>
<p><strong>LIANTI扩增消除了非特异性priming和指数扩增相较于其他全基因组扩增方法，因此能够大大的降低扩增的偏好性和错误性。</strong></p>
<h2 id="相关疑问">相关疑问</h2><h3 id="1-_碎片化真的随机吗？">1. 碎片化真的随机吗？</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/insertion-site.png" alt="insertion-site"><br>上图中黑色三角表示单细胞基因组插入碎片化位点，WebLogo表明其插入位点碱基不存在明显的保守性。</p>
<blockquote>
<p><strong>WebLogo</strong>说明：以下序列对应WebLogo图如下👇</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt;1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> attcgtgatagctgtcgtaaag</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt;2</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ttttgttacctgcctctaactt</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &gt;3</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> tgccgtgattatagacactttt</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure>
<p> <strong>y axis解释</strong>the height of the y-axis is the maximum entropy for the given sequence type. (log<sup>2</sup> 4 = 2 bits for DNA/RNA, log<sup>2</sup> 20 = 4.3 bits for protein.)【<span class="exturl" data-url="aHR0cDovL3dlYmxvZ28uYmVya2VsZXkuZWR1L0Nyb29rcy0yMDA0LUdSLVdlYkxvZ28ucGRm" title="http://weblogo.berkeley.edu/Crooks-2004-GR-WebLogo.pdf">WebLogo: A Sequence Logo Generator<i class="fa fa-external-link"></i></span>】</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WebLogo.png" alt="WebLogo"></p>
</blockquote>
<h3 id="2-_碎片DNA大小？">2. 碎片DNA大小？</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Fragment-size.png" alt="Fragment-size"></p>
<p>上图表明单细胞基因组被LIANTI转座体随机碎片化后平均碎片大小约为400bp。</p>
<h3 id="3-_扩增效率？">3. 扩增效率？</h3><p>对于单个包含~ 6 pg基因组DNA的人类细胞，体外转录扩增过夜可得到~20 ng的LIANTI扩增DNA，随后进行~30测序，并与其他扩增方法比较，发现：LIANTI扩增达到97%的全基因组覆盖度和17%的allele dropout rate。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/outperforming.png" alt="outperforming"></p>
<h3 id="4-_扩增的一致性_(amplification_uniformity)_如何？">4. 扩增的一致性 (amplification uniformity) 如何？</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/%E4%B8%80%E8%87%B4%E6%80%A7.png" alt=""></p>
<p>上图表明LIANTI表现出较高的扩增一致性和较低的变异系数。</p>
<blockquote>
<p>Lorenz curve：Perfectly uniform coverage leads to the diagonal line, and deviation from the diagonal line represents amplification bias.<br>变异系数coefficient of variation (CV)：标准差与平均数的比值，无量纲，用来反映数据离散程度的绝对值。</p>
</blockquote>
<h2 id="相关参考文献">相关参考文献</h2><ol>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubmF0dXJlLmNvbS9ubWV0aC9qb3VybmFsL3YxMy9uMTEvZnVsbC9ubWV0aC40MDI4Lmh0bWw=" title="https://www.nature.com/nmeth/journal/v13/n11/full/nmeth.4028.html">Simul-seq: combined DNA and RNA sequencing for whole-genome and transcriptome profiling<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25tZXRoL2pvdXJuYWwvdjE0L24yL2Ficy9ubWV0aC40MTQwLmh0bWw=" title="http://www.nature.com/nmeth/journal/v14/n2/abs/nmeth.4140.html">Scalable whole-genome single-cell library preparation without preamplification<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前我们也了解过&lt;a href=&quot;http://tiramisutes.github.io/2016/10/13/single-cell.html&quot;&gt;Single Cell 全基因组扩增&lt;/a&gt;过程，最近北大的&lt;a href=&quot;http://xielab.pku.edu.cn/xie/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;谢老师&lt;/a&gt;又重新刷新了单细胞全基因组扩增的新高度：&lt;strong&gt;&lt;a href=&quot;http://science.sciencemag.org/content/356/6334/189&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Single-cell whole-genome analyses by Linear Amplification via Transposon Insertion (LIANTI)&lt;/a&gt;&lt;/strong&gt;,下面对本文做简单的解读?&lt;br&gt;
    
    </summary>
    
      <category term="Single-cell" scheme="http://tiramisutes.github.io/categories/Single-cell/"/>
    
    
      <category term="WGA" scheme="http://tiramisutes.github.io/tags/WGA/"/>
    
  </entry>
  
  <entry>
    <title>深入浅出的迭代器Iterator</title>
    <link href="http://tiramisutes.github.io/2017/04/03/Iterator.html"/>
    <id>http://tiramisutes.github.io/2017/04/03/Iterator.html</id>
    <published>2017-04-03T04:56:16.000Z</published>
    <updated>2018-09-28T02:37:04.878Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/iterable-vs-iterator.png" alt=""></p>
<h2 id="直接概念">直接概念</h2><p><strong>可迭代对象(Iterable)</strong>： 可以直接作用于for循环的对象；<br><strong>迭代器(Iterator)</strong>: 可以被<code>next()</code>函数调用并不断返回下一个值的对象。<br><strong>所有的Iterable均可通过内置函数<code>iter()</code>来转变为Iterator</strong>。<br><a id="more"></a></p>
<hr>
<h2 id="迭代器">迭代器</h2><p>关于迭代器我们需要注意以下几点：<br>1. 迭代器不可重复利用，迭代完就变成空了，再次调用会引发StopIteration异常；<br>    可通过<code>copy</code>包中的<code>deepcopy</code>复制迭代器从而可循环使用。<br>2. 迭代器是访问集合内元素的一种方式。迭代器对象从集合的第一个元素开始访问，直到所有的元素都被访问一遍后结束；<br>3. 迭代器不能回退，只能往前进行迭代；<br>4. 对于原生支持随机访问的数据结构（如tuple、list），迭代器和经典for循环的索引访问相比并无优势，反而丢失了索引值（可以使用内建函数<code>enumerate()</code>找回这个索引值）。但对于无法随机访问的数据结构（比如set）而言，迭代器是唯一的访问元素的方式；<br><code>enumerate()</code>能在iter函数的结果前加上索引，以元组返回:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> idx, ele <span class="keyword">in</span> enumerate(lst):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> idx, ele</span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line"><span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">1</span> <span class="number">6</span></span><br><span class="line"><span class="number">2</span> <span class="number">7</span></span><br></pre></td></tr></table></figure></p>
<p>5. 迭代器的另一个优点就是它不要求你事先准备好整个迭代过程中所有的元素。迭代器仅仅在迭代至某个元素时才计算该元素，而在这之前或之后，元素可以不存在或者被销毁。这个特点使得它特别适合用于遍历一些巨大的或是无限的集合，比如几个G的文件，或是斐波那契数列等等。这个特点被称为延迟计算或惰性求值(Lazy evaluation)；<br>6. 迭代器更大的功劳是提供了一个统一的访问集合的接口。只要是实现了<strong>iter</strong>()方法的对象，就可以使用迭代器进行访问。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/python-advanced-building-on-the-foundation-102-638.jpg" alt=""></p>
<h2 id="迭代器操作">迭代器操作</h2><p>使用内建函数<code>iter(iterable)</code>获取迭代器对象，<code>next(iterator)</code>访问下一个元素；<br>常用的几个内建数据结构tuple、list、set、dict都支持迭代器，字符串也可以使用迭代操作。</p>
<h2 id="itertools模块"><code>itertools</code>模块</h2><p>Python的内建模块<code>itertools</code>提供了非常有用的用于操作迭代对象的函数。</p>
<hr>
<p><strong>“无限”迭代器</strong><br>无限序列只有在for迭代时才会无限地迭代下去，如果只是创建了一个迭代对象，它不会事先把无限个元素生成出来;</p>
<h3 id="count">count</h3><p><code>count()</code>会创建一个无限的迭代器：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>i = <span class="number">0</span>  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.count(<span class="number">100</span>):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> i&gt;<span class="number">10</span>:  </span><br><span class="line"><span class="meta">... </span>        <span class="keyword">break</span>  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item,</span><br><span class="line"><span class="meta">... </span>    i = i+<span class="number">1</span> </span><br><span class="line"><span class="meta">... </span>     </span><br><span class="line"><span class="number">100</span> <span class="number">101</span> <span class="number">102</span> <span class="number">103</span> <span class="number">104</span> <span class="number">105</span> <span class="number">106</span> <span class="number">107</span> <span class="number">108</span> <span class="number">109</span> <span class="number">110</span></span><br></pre></td></tr></table></figure></p>
<h3 id="cycle">cycle</h3><p><code>cycle()</code>会把传入的一个序列无限重复下去：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cs = itertools.cycle(<span class="string">'ABC'</span>) <span class="comment"># 注意字符串也是序列的一种</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> c</span><br><span class="line">...</span><br><span class="line"><span class="string">'A'</span></span><br><span class="line"><span class="string">'B'</span></span><br><span class="line"><span class="string">'C'</span></span><br><span class="line"><span class="string">'A'</span></span><br><span class="line"><span class="string">'B'</span></span><br><span class="line"><span class="string">'C'</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="repeat">repeat</h3><p><code>repeat(elem [,n])</code>repeat负责把一个元素无限重复下去，不过如果提供第二个参数就可以限定重复次数：<br>附： <code>print</code>后面逗号<code>,</code>作用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listone = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.repeat(listone,<span class="number">3</span>):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item,  </span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>] [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>] [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listone = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.repeat(listone,<span class="number">3</span>):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item</span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br></pre></td></tr></table></figure></p>
<p>以上无限序列虽然可以无限迭代下去，但是通常我们会通过<code>takewhile()</code>等函数根据条件判断来截取出一个有限的序列：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>natuals = itertools.count(<span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ns = itertools.takewhile(<span class="keyword">lambda</span> x: x &lt;= <span class="number">10</span>, natuals)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> ns:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> n</span><br><span class="line">...</span><br><span class="line">打印出<span class="number">1</span>到<span class="number">10</span></span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>迭代器操作函数</strong></p>
<h3 id="chain">chain</h3><p><code>chain()</code>可以把一组迭代对象串联起来，形成一个更大的迭代器：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listone = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]  </span><br><span class="line"><span class="meta">... </span>listtwo = [<span class="string">'11'</span>,<span class="string">'22'</span>,<span class="string">'abc'</span>]  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span>  itertools.chain(listone,listtwo):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item</span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="number">22</span></span><br><span class="line">abc</span><br></pre></td></tr></table></figure></p>
<h3 id="ifilter">ifilter</h3><p><code>ifilter(fun,iterator)</code>返回一个可以让fun返回True的迭代器:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span><span class="function"><span class="keyword">def</span> <span class="title">funLargeFive</span><span class="params">(x)</span>:</span>  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> x &gt; <span class="number">5</span>:  </span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="keyword">True</span>  </span><br><span class="line"><span class="meta">... </span>      </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.ifilter(funLargeFive,range(<span class="number">-10</span>,<span class="number">10</span>)):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item,  </span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line"><span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br></pre></td></tr></table></figure></p>
<h3 id="imap">imap</h3><p><code>imap(fun,iterator)</code>返回一个迭代器，对iterator中的每个项目调用fun:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listthree = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]  </span><br><span class="line"><span class="meta">... </span><span class="function"><span class="keyword">def</span> <span class="title">funAddFive</span><span class="params">(x)</span>:</span>  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> x + <span class="number">5</span>  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.imap(funAddFive,listthree):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item,  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> type(item)</span><br><span class="line">...</span><br><span class="line"><span class="number">6</span> &lt;type <span class="string">'int'</span>&gt;</span><br><span class="line"><span class="number">7</span> &lt;type <span class="string">'int'</span>&gt;</span><br><span class="line"><span class="number">8</span> &lt;type <span class="string">'int'</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>imap()</code>和<code>map()</code>的区别在于，<code>imap()</code>可以作用于无穷序列，并且，如果两个序列的长度不一致，以短的那个为准。<br>和直接map的区别如下：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; listthree = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]  </span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="function"><span class="keyword">def</span> <span class="title">funAddFive</span><span class="params">(x)</span></span>:     </span><br><span class="line">...    <span class="keyword">return</span> x + <span class="number">5</span>  </span><br><span class="line">... </span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; map(funAddFive,listthree)</span><br><span class="line">[<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; type(map(funAddFive,listthree))</span><br><span class="line">list</span><br></pre></td></tr></table></figure></p>
<p><code>imap()</code>返回一个迭代对象，而<code>map()</code>返回list,并且当你调用<code>map()</code>时，结果已经计算完毕，而当你调用imap()时，并没有进行任何计算，必须用for循环对其进行迭代，才会在每次循环过程中计算出下一个元素，从而实现了“惰性计算”，也就是在需要获得结果的时候才计算。</p>
<h3 id="islice">islice</h3><p><code>itertools.islice(iterable, stop)</code><br><code>itertools.islice(iterable, start, stop[, step])</code><br>返回迭代器，将seq，从start开始,到stop结束，以step步长切割:<br>If start is None, then iteration starts at zero. If step is None, then the step defaults to one.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listone = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]  </span><br><span class="line"><span class="meta">... </span>listtwo = [<span class="string">'11'</span>,<span class="string">'22'</span>,<span class="string">'abc'</span>]  </span><br><span class="line"><span class="meta">... </span>listthree = listone + listtwo  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.islice(listthree,<span class="number">3</span>,<span class="number">5</span>):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item,  </span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line"><span class="number">11</span> <span class="number">22</span></span><br></pre></td></tr></table></figure></p>
<h3 id="izip">izip</h3><p><code>izip(*iterator)</code>返回迭代器，结果是元组，元组来自*iterator的组合<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> itertools  </span><br><span class="line"><span class="meta">... </span>listone = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]  </span><br><span class="line"><span class="meta">... </span>listtwo = [<span class="string">'11'</span>,<span class="string">'22'</span>,<span class="string">'abc'</span>]  </span><br><span class="line"><span class="meta">... </span>listthree = listone + listtwo  </span><br><span class="line"><span class="meta">... </span><span class="keyword">for</span> item <span class="keyword">in</span> itertools.izip(listone,listtwo):  </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> item, </span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> type(item)</span><br><span class="line"><span class="meta">... </span>    </span><br><span class="line">(<span class="string">'a'</span>, <span class="string">'11'</span>) &lt;type <span class="string">'tuple'</span>&gt;</span><br><span class="line">(<span class="string">'b'</span>, <span class="string">'22'</span>) &lt;type <span class="string">'tuple'</span>&gt;</span><br><span class="line">(<span class="string">'c'</span>, <span class="string">'abc'</span>) &lt;type <span class="string">'tuple'</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="groupby()">groupby()</h3><p><code>groupby()</code>把迭代器中相邻的重复元素挑出来放在一起：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> key, group <span class="keyword">in</span> itertools.groupby(<span class="string">'AAABBBCCAAA'</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> key, list(group) <span class="comment"># 为什么这里要用list()函数呢？</span></span><br><span class="line">...</span><br><span class="line">A [<span class="string">'A'</span>, <span class="string">'A'</span>, <span class="string">'A'</span>]</span><br><span class="line">B [<span class="string">'B'</span>, <span class="string">'B'</span>, <span class="string">'B'</span>]</span><br><span class="line">C [<span class="string">'C'</span>, <span class="string">'C'</span>]</span><br><span class="line">A [<span class="string">'A'</span>, <span class="string">'A'</span>, <span class="string">'A'</span>]</span><br></pre></td></tr></table></figure></p>
<p>实际上挑选规则是通过函数完成的，只要作用于函数的两个元素返回的值相等，这两个元素就被认为是在一组的，而函数返回值作为组的key。如果我们要忽略大小写分组，就可以让元素’A’和’a’都返回相同的key：<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; for key, <span class="keyword">group</span> <span class="keyword">in</span> itertools.groupby(<span class="string">'AaaBBbcCAAa'</span>, lambda c: c.upper()):</span><br><span class="line"><span class="params">...</span>     print key, <span class="built_in">list</span>(<span class="keyword">group</span>)</span><br><span class="line"><span class="params">...</span></span><br><span class="line">A <span class="meta">[</span><span class="string">'A'</span>, <span class="string">'a'</span>, <span class="string">'a'</span><span class="meta">]</span></span><br><span class="line">B <span class="meta">[</span><span class="string">'B'</span>, <span class="string">'B'</span>, <span class="string">'b'</span><span class="meta">]</span></span><br><span class="line">C <span class="meta">[</span><span class="string">'c'</span>, <span class="string">'C'</span><span class="meta">]</span></span><br><span class="line">A <span class="meta">[</span><span class="string">'A'</span>, <span class="string">'A'</span>, <span class="string">'a'</span><span class="meta">]</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="生成器表达式(Generator_expression)和列表解析(List_Comprehension)">生成器表达式(Generator expression)和列表解析(List Comprehension)</h2><p>1. <code>(x+1 for x in lst)</code> #生成器表达式，返回迭代器。外部的括号可在用于参数时省略。<br>2. <code>[x+1 for x in lst]</code> #列表解析，返回list<br><strong>由于返回迭代器时，并不是在一开始就计算所有的元素，这样能得到更多的灵活性并且可以避开很多不必要的计算，所以除非你明确希望返回列表，否则应该始终使用生成器表达式。</strong><br>为列表解析提供if子句进行筛选：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(x+1 <span class="keyword">for</span> x <span class="keyword">in</span> lst <span class="keyword">if</span>  x!= 0)</span><br></pre></td></tr></table></figure></p>
<p>或者提供多条for子句进行嵌套循环，嵌套次序就是for子句的顺序：<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((<span class="name">x</span>,y) for x in range(<span class="name">3</span>) for y in range(<span class="name">x</span>))</span><br></pre></td></tr></table></figure></p>
<h3 id="应用场景">应用场景</h3><p>1. <i class="fa fa-bullseye" aria-hidden="true"></i>当对元素应用的动作太复杂，不能用一个表达式写出来时？<br><i class="fa fa-thumbs-up" aria-hidden="true"></i>将动作<code>def</code>封装成函数，用于解析式；<br>2. <i class="fa fa-bullseye" aria-hidden="true"></i>因为if子句里的条件需要计算，同时结果也需要进行同样的计算，不希望计算两遍？<br><i class="fa fa-thumbs-up" aria-hidden="true"></i>组合一下列表解析式： <code>[x for x in (y+1 for y in lst) if x &gt;0]</code>，内部的列表解析变量其实也可以用x，但为清晰起见我们改成了y。</p>
<h2 id="写在最后">写在最后</h2><p>推荐一个画分满满萌萌哒的关于Iterators , Iterables and Generators 的文章: <span class="exturl" data-url="aHR0cDovL2Zpb25hLW5hdWdodG9uLmdpdGh1Yi5pby9ibG9nLzIwMTYvMDYvMDgvSG93LXRvLXRyYWluLXlvdXItUHl0aG9u" title="http://fiona-naughton.github.io/blog/2016/06/08/How-to-train-your-Python">How to train your Python<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/iter.png" alt=""></p>
<p>参考来源：</p>
<p><li><span class="exturl" data-url="aHR0cDovL3B5dGhvbi5qb2Jib2xlLmNvbS84MTkxNi8=" title="http://python.jobbole.com/81916/">http://python.jobbole.com/81916/<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9odXhpL2FyY2hpdmUvMjAxMS8wNy8wMS8yMDk1OTMxLmh0bWw=" title="http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html">AstralWind: Python函数式编程指南（三）：迭代器<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9odXhpL2FyY2hpdmUvMjAxMS8wNy8wMS8yMDk1OTMxLmh0bWw=" title="http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html">http://www.cnblogs.com/huxi/archive/2011/07/01/2095931.html<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhb2NhaWp1L2FydGljbGUvZGV0YWlscy82OTY4MTIz" title="http://blog.csdn.net/xiaocaiju/article/details/6968123">http://blog.csdn.net/xiaocaiju/article/details/6968123<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy5saWFveHVlZmVuZy5jb20vd2lraS8wMDEzNzQ3MzgxMjUwOTVjOTU1YzFlNmQ4YmI0OTMxODIxMDNmYWM5MjcwNzYyYTAwMC8wMDE0MTU2MTYwMDE5OTZmNmIzMmQ4MGI2NDU0Y2FjYTNkMzNjOTY1YTA3NjExZjAwMA==" title="http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000/001415616001996f6b32d80b6454caca3d33c965a07611f000">廖雪峰的官方网站:itertools<i class="fa fa-external-link"></i></span></li></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/iterable-vs-iterator.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;直接概念&quot;&gt;直接概念&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;可迭代对象(Iterable)&lt;/strong&gt;： 可以直接作用于for循环的对象；&lt;br&gt;&lt;strong&gt;迭代器(Iterator)&lt;/strong&gt;: 可以被&lt;code&gt;next()&lt;/code&gt;函数调用并不断返回下一个值的对象。&lt;br&gt;&lt;strong&gt;所有的Iterable均可通过内置函数&lt;code&gt;iter()&lt;/code&gt;来转变为Iterator&lt;/strong&gt;。&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="Iterator" scheme="http://tiramisutes.github.io/tags/Iterator/"/>
    
  </entry>
  
  <entry>
    <title>python读取文件的正确方式</title>
    <link href="http://tiramisutes.github.io/2017/04/02/python-read-file.html"/>
    <id>http://tiramisutes.github.io/2017/04/02/python-read-file.html</id>
    <published>2017-04-02T12:39:50.000Z</published>
    <updated>2018-09-28T02:42:23.767Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Why-Python-training-is-Essential-for-Big-Data-Jobs-002.png" alt=""><br><strong>P</strong>ython对文件的基础操作间<a href="http://tiramisutes.github.io/2015/12/03/python-basic.html#Python_文件I/O">python基础教程总结：Python 文件I/O</a>部分；以下主要总结大文件和小文件操作过程中内存有效利用方法。<br><a id="more"></a></p>
<h2 id="小文件">小文件</h2><h3 id="with函数(推荐使用)">with函数(推荐使用)</h3><p><strong>The <code>with</code> statement handles opening and closing the file, including if an exception is raised in the inner block.</strong><br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'myfile'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">line</span> <span class="keyword">in</span> f:</span><br><span class="line">        &lt;<span class="built_in">do</span> something <span class="keyword">with</span> <span class="built_in">line</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="readlines/readline">readlines/readline</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">line</span> <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">'myfile'</span>,<span class="string">'r'</span>).readlines():</span><br><span class="line">    do_something(<span class="built_in">line</span>)</span><br></pre></td></tr></table></figure>
<p><strong>二者的区别是<code>readlines</code>读进来的是列表，而<code>readline</code>是字符串；</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">... </span><span class="keyword">with</span> open(<span class="string">'zsq.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="meta">... </span>    lines = f.readlines()</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> type(lines)</span><br><span class="line">&lt;type <span class="string">'list'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">... </span><span class="keyword">with</span> open(<span class="string">'zsq.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="meta">... </span>    lines = f.readline()</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> type(lines)</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="大文件">大文件</h2><h3 id="fileinput">fileinput</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fileinput</span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span> <span class="built_in">line</span> in fileinput.input([<span class="string">'myfile'</span>]):</span><br><span class="line">    do_something(<span class="built_in">line</span>)</span><br></pre></td></tr></table></figure>
<p><strong><code>fileinput.input()</code> call reads lines sequentially, but doesn’t keep them in memory after they’ve been read or even simply so this.</strong></p>
<p><li>结合<code>with</code>处理多个文件：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> fileinput.input(<span class="built_in">files</span>=(<span class="string">'spam.txt'</span>, <span class="string">'eggs.txt'</span>)) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">line</span> <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">process</span>(<span class="built_in">line</span>)</span><br></pre></td></tr></table></figure></li></p>
<h3 id="buffer">buffer</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">filePath = <span class="string">"input.txt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">buffer</span> = <span class="string">"Read buffer:\n"</span></span><br><span class="line"><span class="keyword">file</span> = <span class="keyword">open</span>(filePath, <span class="string">'rU'</span>)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    bytes = <span class="keyword">file</span>.<span class="keyword">read</span>(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> byte<span class="variable">s:</span></span><br><span class="line">        <span class="keyword">buffer</span> += bytes</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="keyword">buffer</span></span><br></pre></td></tr></table></figure>
<p>贡献来源</p>
<p><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84MDA5ODgyL2hvdy10by1yZWFkLWxhcmdlLWZpbGUtbGluZS1ieS1saW5lLWluLXB5dGhvbj9ub3JlZGlyZWN0PTEmYW1wO2xxPTE=" title="http://stackoverflow.com/questions/8009882/how-to-read-large-file-line-by-line-in-python?noredirect=1&amp;lq=1">http://stackoverflow.com/questions/8009882/how-to-read-large-file-line-by-line-in-python?noredirect=1&amp;lq=1<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Why-Python-training-is-Essential-for-Big-Data-Jobs-002.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;strong&gt;P&lt;/strong&gt;ython对文件的基础操作间&lt;a href=&quot;http://tiramisutes.github.io/2015/12/03/python-basic.html#Python_文件I/O&quot;&gt;python基础教程总结：Python 文件I/O&lt;/a&gt;部分；以下主要总结大文件和小文件操作过程中内存有效利用方法。&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="python-read-file" scheme="http://tiramisutes.github.io/tags/python-read-file/"/>
    
  </entry>
  
  <entry>
    <title>python技巧总结（持续更新）</title>
    <link href="http://tiramisutes.github.io/2017/03/25/python-tip.html"/>
    <id>http://tiramisutes.github.io/2017/03/25/python-tip.html</id>
    <published>2017-03-25T08:17:03.000Z</published>
    <updated>2018-09-28T02:42:40.820Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Preferred-for-Web-development.png" alt=""><br><strong>以下总结是基于python2.7，在其他版本中是否可行没有验证。</strong><br><a id="more"></a></p>
<h2 id="多行字符串转换为单行">多行字符串转换为单行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">'this is \n a \t          example'</span></span><br><span class="line">string = <span class="string">' '</span>.join(string.split())</span><br></pre></td></tr></table></figure>
<p><strong>这里split不传入参数，那么这个函数会将以空白分开，空白包括：\n, \t , ‘ ‘,等，最终再用空格来连接起来，也可以指定分隔符，如string.split(‘;’)</strong><br>可以自己写个函数来处理，利用lambda表达式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">processFunc = lambda s: <span class="string">" "</span>.join(s.split())</span><br><span class="line">string = processFunc(string)</span><br></pre></td></tr></table></figure></p>
<h2 id="替换">替换</h2><p>replace(“\n”, “”),后边的串替换掉前边的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a=<span class="string">"hope"</span></span><br><span class="line">&gt;&gt;&gt; a.replace(<span class="string">"h"</span>, <span class="string">"bioh"</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="字符串转数组">字符串转数组</h2><p>str = ‘1,2,3’<br>arr = str.split(‘,’)</p>
<h2 id="数组转字符串">数组转字符串</h2><p>arr = [‘a’,’b’]<br>str = ‘,’.join(arr)</p>
<h3 id="global_vs-_local">global vs. local</h3><p>Python’s LEGB scope :<strong>Local -&gt; Enclosed -&gt; Global -&gt; Built-in</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">in_func</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> x   <span class="comment">#将local变量用于global</span></span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line">    print(<span class="string">'in_func:'</span>, x)</span><br><span class="line">    </span><br><span class="line">in_func()</span><br><span class="line">print(<span class="string">'global:'</span>, x)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">in_func: <span class="number">1</span></span><br><span class="line"><span class="keyword">global</span>: <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="local_vs-_enclosed">local vs. enclosed</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span><span class="params">()</span>:</span></span><br><span class="line">       x = <span class="number">1</span></span><br><span class="line">       print(<span class="string">'outer before:'</span>, x)</span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">           <span class="keyword">nonlocal</span> x  <span class="comment">#modify the x variable in the enclosed scope</span></span><br><span class="line">           x = <span class="number">2</span></span><br><span class="line">           print(<span class="string">"inner:"</span>, x)</span><br><span class="line">       inner()</span><br><span class="line">       print(<span class="string">"outer after:"</span>, x)</span><br><span class="line">outer()</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">outer before: <span class="number">1</span></span><br><span class="line">inner: <span class="number">2</span></span><br><span class="line">outer after: <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h2 id="List_comprehensions_vs_generators">List comprehensions vs generators</h2><p>List comprehensions are fast, but generators are faster!?<br>1. use lists if you want to use the plethora of list methods<br>2. use generators when you are dealing with huge collections to avoid memory issues<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plainlist</span><span class="params">(n=<span class="number">100000</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    my_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n)<span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">            my_list.append(i)</span><br><span class="line">    <span class="keyword">return</span> my_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listcompr</span><span class="params">(n=<span class="number">100000</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    my_list = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(n) <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> my_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generator</span><span class="params">(n=<span class="number">100000</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    my_gen = (i <span class="keyword">for</span> i <span class="keyword">in</span> range(n) <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> my_gen</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generator_yield</span><span class="params">(n=<span class="number">100000</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n)<span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">5</span> == <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">yield</span> i</span><br></pre></td></tr></table></figure></p>
<h2 id="assert">assert</h2><p>在没完善一个程序之前，我们不知道程序在哪里会出错，与其让它在运行最崩溃，不如在出现错误条件时就崩溃，这时候就需要assert断言的帮助。<br>assert断言是声明其布尔值必须为真的判定，如果发生异常就说明表达示为假。可以理解assert断言语句为raise-if-not，用来测试表示式，其返回值为假，就会触发异常。<br>See: <i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9saXVjaHVueGlhbzgzL3AvNTI5ODAxNi5odG1s" title="http://www.cnblogs.com/liuchunxiao83/p/5298016.html">python assert的作用<i class="fa fa-external-link"></i></span><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; assert <span class="number">2</span>==<span class="number">1</span>,<span class="string">'2不等于1'</span></span><br><span class="line"><span class="symbol">AssertionError:</span> <span class="number">2</span>不等于<span class="number">1</span></span><br><span class="line">AssertionErrorTraceback (most recent call last)</span><br><span class="line">&lt;ipython-input-<span class="number">30</span>-<span class="number">015</span>aa214a555&gt; <span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;()</span></span><br><span class="line">----&gt; <span class="number">1</span> assert <span class="number">2</span>==<span class="number">1</span>,<span class="string">'2不等于1'</span></span><br><span class="line"><span class="symbol">AssertionError:</span> <span class="number">2</span>不等于<span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; assert <span class="number">2</span>==<span class="number">2</span>,<span class="string">'2不等于1'</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="set数据类型">set数据类型</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9wYW53ZW5iaW4tbG9ncy9wLzU1MTk2MTcuaHRtbA==" title="http://www.cnblogs.com/panwenbin-logs/p/5519617.html">python中set和frozenset方法和区别<i class="fa fa-external-link"></i></span><br>set(可变集合)与frozenset(不可变集合)<br>set无序排序且不重复，是可变的，有add（），remove（）等方法。既然是可变的，所以它不存在哈希值。基本功能包括关系测试和消除重复元素. 集合对象还支持union(联合), intersection(交集), difference(差集)和sysmmetric difference(对称差集)等数学运算.<br>sets 支持<code>x in set, len(set)</code>,和 <code>for x in set</code>。作为一个无序的集合，sets不记录元素位置或者插入点。因此，sets不支持 indexing, 或其它类序列的操作。<br>frozenset是冻结的集合，它是不可变的，存在哈希值，好处是它可以作为字典的key，也可以作为其它集合的元素。缺点是一旦创建便不能更改，没有add，remove方法。<br><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="keyword">set</span>(<span class="string">"qiwsir"</span>)</span><br><span class="line"># <span class="keyword">set</span> <span class="comment">of integers</span></span><br><span class="line">my_set <span class="comment">= &#123;1, 2, 3&#125;</span></span><br><span class="line">print(my_set)</span><br><span class="line">my=<span class="keyword">set</span>([<span class="string">'Gh_A01G0993'</span>,<span class="string">'Gh_A03G0561'</span>,<span class="string">'Gh_A03G0561'</span>])   #返回唯一值 </span><br><span class="line">print <span class="comment">my</span></span><br><span class="line"># <span class="keyword">set</span> <span class="comment">of mixed datatypes</span></span><br><span class="line">my_set <span class="comment">= &#123;1.0,</span> <span class="comment">"Hello"</span><span class="comment">, (1, 2, 3)&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="set_Operations">set Operations</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cHM6Ly93d3cucHJvZ3JhbWl6LmNvbS9weXRob24tcHJvZ3JhbW1pbmcvc2V0" title="https://www.programiz.com/python-programming/set">Python Sets<i class="fa fa-external-link"></i></span><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; A = &#123;1, 2, 3, 4, 5&#125;</span><br><span class="line"><span class="built_in">..</span>. B = &#123;4, 5, 6, 7, 8&#125;</span><br><span class="line"><span class="built_in">..</span>. # use | operator</span><br><span class="line"><span class="built_in">..</span>. # Output: &#123;1, 2, 3, 4, 5, 6, 7, 8&#125;</span><br><span class="line"><span class="built_in">..</span>. <span class="builtin-name">print</span>(A | B)</span><br><span class="line"><span class="built_in">..</span>. A |= B  #<span class="attribute">A</span>=A|B</span><br><span class="line"><span class="built_in">..</span>. A</span><br><span class="line"><span class="built_in">..</span>. </span><br><span class="line"><span class="builtin-name">set</span>([1, 2, 3, 4, 5, 6, 7, 8])</span><br><span class="line">&#123;1, 2, 3, 4, 5, 6, 7, 8&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="_,__,___"><code>_,__,___</code></h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yNjg5NTM2Mi93aGF0LWRvZXMtaW4tcHl0aG9uLWRv" title="http://stackoverflow.com/questions/26895362/what-does-in-python-do">What does _ in Python do? [duplicate]<i class="fa fa-external-link"></i></span><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[_] (a single underscore) : stores previous output, like Python’s<span class="built_in"> default </span>interpreter.</span><br><span class="line">[__] (two underscores): next previous.</span><br><span class="line">[___] (three underscores): next-next previous.</span><br><span class="line">1+1</span><br><span class="line"><span class="builtin-name">print</span> _</span><br><span class="line">2+2</span><br><span class="line"><span class="builtin-name">print</span> _</span><br><span class="line">3+3</span><br><span class="line"><span class="builtin-name">print</span> _</span><br><span class="line"><span class="builtin-name">print</span> __</span><br><span class="line"><span class="builtin-name">print</span> ___</span><br></pre></td></tr></table></figure></p>
<p><strong>用于占位符，也可以是一个简单的变量，by convention it means that you don’t intend to use that value, just read it and ignore it.</strong><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span>=1</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(10):</span><br><span class="line">    x+=1</span><br><span class="line">    <span class="builtin-name">print</span> x</span><br></pre></td></tr></table></figure></p>
<p><strong>“单下划线” 开始的成员变量叫做保护变量，意思是只有类对象和子类对象自己能访问到这些变量；</strong><br><strong>“双下划线” 开始的是私有成员，意思是只有类对象自己能访问，连子类对象也不能访问到这个数据。</strong><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> (<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>,name)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>._name=name</span><br><span class="line">sd=Student(<span class="string">"Tom"</span>)</span><br><span class="line">sd._name</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> (<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>,name)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.__name=name</span><br><span class="line">sd.__name</span><br><span class="line">sd._Student__name</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="*args_and_**kwargs">*args and **kwargs</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL2xvdmVzb28ub3JnL3B5dGhvbi1oYW4tc2h1LWtlLWJpYW4tY2FuLXNodS1hcmdzLWppLWt3YXJncy1zaGkteWkuaHRtbA==" title="http://lovesoo.org/python-han-shu-ke-bian-can-shu-args-ji-kwargs-shi-yi.html">Python函数可变参数args及kwargs释义<i class="fa fa-external-link"></i></span><br><strong>*args表示任何多个无名参数，它是一个tuple</strong><br><strong>**kwargs表示关键字参数，它是一个dict</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(*args,**kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'args='</span>,args</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'kwargs='</span>,kwargs</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'**********************'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    foo(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">    foo(a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="number">3</span>)</span><br><span class="line">	</span><br><span class="line"><span class="comment">#结果如下：</span></span><br><span class="line">args= (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">kwargs= &#123;&#125;</span><br><span class="line">**********************</span><br><span class="line">args= ()</span><br><span class="line">kwargs= &#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'b'</span>: <span class="number">2</span>&#125;</span><br><span class="line">**********************</span><br></pre></td></tr></table></figure></p>
<p>You can pass a default value to get() for keys that are not in the dictionary:<br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDk4NTQ5L3Byb3Blci13YXktdG8tdXNlLWt3YXJncy1pbi1weXRob24=" title="http://stackoverflow.com/questions/1098549/proper-way-to-use-kwargs-in-python">Proper way to use **kwargs in Python<i class="fa fa-external-link"></i></span><br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">val2</span> = kwargs.get(<span class="string">'val2'</span>,<span class="string">"default value"</span>)</span><br><span class="line"><span class="attr">val2</span> = kwargs.get(<span class="string">'val2'</span>,None)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="除法运算">除法运算</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print <span class="number">5</span>*(<span class="number">2</span>/<span class="number">6</span>)</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>运行结果总是0，WHY?<br>查找资料发现在Python里，整数初整数，只能得出整数。也就是 2 除 6 这个结果永远是0；<br>事实上不光python这样处理，C/C++，R也都是这样的，因为整数和浮点数本来就是两回事，用来计算除法的部件也不是同一个。<br><strong>解决办法：</strong><br>1. 如果想做浮点除法，就应该把至少一个操作数转化为浮点型。最简单的方法就是在后面加上<code>.0</code>。<br>2. 用类型转换的方法：<code>(float)2/6</code>。<br>3. 代码开头加上 <code>from __future__ import division</code>，在python3.0以后的版本中不存在这种情况的。</p>
<h3 id="小数点位数">小数点位数</h3><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9oZXJiZXJ0L3AvMzQwMjI0NS5odG1s" title="http://www.cnblogs.com/herbert/p/3402245.html">谈谈关于Python里面小数点精度控制的问题<i class="fa fa-external-link"></i></span><br>至于保留小数点后位数可以通过内置函数<code>round()</code>和使用格式化,如<code>&quot;%.2f&quot; % 2.645</code>；<br>round()如果只有一个数作为参数，不指定位数的时候，返回的是一个整数，而且是最靠近的整数（这点上类似四舍五入）。但是当出现.5的时候，两边的距离都一样，round()取靠近的偶数；<br>当指定取舍的小数点位数的时候，一般情况也是使用四舍五入的规则，但是碰到.5的这样情况，如果要取舍的位数前的小树是奇数，则直接舍弃，如果偶数这向上取舍。<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; round(<span class="number">2.635</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">2.63</span></span><br><span class="line">&gt;&gt;&gt; round(<span class="number">2.645</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">2.65</span></span><br></pre></td></tr></table></figure></p>
<p>python默认的是17位小数的精度，但是这里有一个问题，就是当我们的计算需要使用更高的精度（超过17位小数）的时候可以使用<strong>高精度decimal模块，配合getcontext</strong>。</p>
<h3 id="特殊取整">特殊取整</h3><p>math模块的ceil(x) : 取大于或者等于x的最小整数；<br>math模块的floor(x) : 取小于或者等于x的最大整数。</p>
<hr>
<h2 id="列表操作">列表操作</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNzQ4MDYzL3doYXQtaXMtdGhlLXN5bnRheC10by1pbnNlcnQtb25lLWxpc3QtaW50by1hbm90aGVyLWxpc3QtaW4tcHl0aG9u" title="http://stackoverflow.com/questions/3748063/what-is-the-syntax-to-insert-one-list-into-another-list-in-python">What is the syntax to insert one list into another list in python?<i class="fa fa-external-link"></i></span></p>
<h3 id="列表加法运算merge">列表加法运算merge</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&gt;&gt;&gt; y = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">&gt;&gt;&gt; x + y</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">&gt;&gt;&gt; x.extend(y)</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>
<p><strong>To extend a list at a specific insertion point you can use list slicing</strong><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; x[<span class="number">2</span><span class="symbol">:</span><span class="number">2</span>] = [<span class="string">'a'</span>,<span class="string">'b'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure></p>
<p><em>**List slicing is quite flexible as it allows to replace a range of entries in a list with a range of entries from another list</em><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; x[<span class="number">1</span><span class="symbol">:</span><span class="number">2</span>] = [<span class="string">'a'</span>,<span class="string">'b'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; x</span><br><span class="line">[<span class="number">1</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure></p>
<h3 id="列表附加append">列表附加append</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&gt;&gt;&gt; y = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line">&gt;&gt;&gt; x.append(y)</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]</span><br></pre></td></tr></table></figure>
<h3 id="插入insert">插入insert</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; x.insert(<span class="number">2</span>, y)</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h3 id="计数count">计数count</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>]</span><br><span class="line">&gt;&gt;&gt; x.count(<span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="索引index">索引index</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; x.index(<span class="number">2</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="反转reverse">反转reverse</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; x.reverse()</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line">[<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>其他还有<code>list.remove(x)</code>移除第一个item,<code>list.pop([i])</code>删除给定位置item,<code>list.clear()</code>,<code>list.sort(key=None, reverse=False)</code>,<code>list.copy()</code>。</p>
<h3 id="List_Comprehensions">List Comprehensions</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(x,y) for x in [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] for y in [<span class="number">4</span>,<span class="number">2</span>,<span class="number">6</span>] if x !=y]</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="eval和ast-literal_eval">eval和ast.literal_eval</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNTE5NzY3My91c2luZy1weXRob25zLWV2YWwtdnMtYXN0LWxpdGVyYWwtZXZhbA==" title="http://stackoverflow.com/questions/15197673/using-pythons-eval-vs-ast-literal-eval">Using python’s eval() vs. ast.literal_eval()?<i class="fa fa-external-link"></i></span><br>eval是Python用于执行python表达式的一个内置函数，使用eval，可以很方便的将字符串动态执行,即将字符串str当成有效的表达式来求值并返回计算结果。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; <span class="built_in">eval</span>(<span class="string">"5+2"</span>)</span></span><br><span class="line">7</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; <span class="built_in">eval</span>(<span class="string">"[x for x in range(5)]"</span>)</span></span><br><span class="line">[0, 1, 2, 3, 4]</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt;a = <span class="string">"[[1,2], [9,0]]"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; b = <span class="built_in">eval</span>(a)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; <span class="built_in">print</span> b</span></span><br><span class="line">[[1, 2], [9, 0]]</span><br></pre></td></tr></table></figure></p>
<p><strong>“安全”使用eval</strong><br>Eval函数的声明为<code>eval(expression[, globals[, locals]])</code>,第二三个参数分别指定能够在eval中使用的函数等，如果不指定，默认为globals()和locals()函数中 包含的模块和函数。<br>但<code>eval</code>的使用存在安全隐患，具体See also <span class="exturl" data-url="aHR0cDovL25lZGJhdGNoZWxkZXIuY29tL2Jsb2cvMjAxMjA2L2V2YWxfcmVhbGx5X2lzX2Rhbmdlcm91cy5odG1s" title="http://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html">the dangers of <code>eval</code><i class="fa fa-external-link"></i></span>。<br>因此，<strong>Use <code>ast.literal_eval</code> whenever you need eval.<code>ast.literal_eval</code> raises an exception if the input isn’t a valid Python datatype, so the code won’t be executed if it’s not.</strong></p>
<hr>
<h2 id="zip函数">zip函数</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9CZWdpbk1hbi9hcmNoaXZlLzIwMTMvMDMvMTQvMjk1OTQ0Ny5odG1s" title="http://www.cnblogs.com/BeginMan/archive/2013/03/14/2959447.html">Python零碎知识(2):强大的zip<i class="fa fa-external-link"></i></span><br>1. 接受一系列可迭代对象作为参数，将对象中对应的元素打包成一个个tuple（元组），然后返回由这些tuples组成的list（列表）。若传入参数的长度不等，则返回list的长度和参数中长度最短的对象相同;<br>2. zip()配合*号操作符,可以将已经zip过的列表对象解压;<br>实例：找到字典中的最大值<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ages = &#123;<span class="string">'John'</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="string">'Mike'</span>: <span class="number">52</span>,</span><br><span class="line">        <span class="string">'Sarah'</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="string">'Bob'</span>: <span class="number">43</span></span><br><span class="line">       &#125;</span><br><span class="line"><span class="function"><span class="title">max</span><span class="params">(zip(ages.values()</span></span>, ages.keys()))</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="String_slices">String slices</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5ncmVlbnRlYXByZXNzLmNvbS90aGlua3B5dGhvbi9odG1sL3RoaW5rcHl0aG9uMDA5Lmh0bWwjdG9jODk=" title="http://www.greenteapress.com/thinkpython/html/thinkpython009.html#toc89">Chapter 8  Strings<i class="fa fa-external-link"></i></span><br>The operator [n:m] returns the part of the string from the “n-eth” character to the “m-eth” character, including the first but excluding the last. This behavior is counterintuitive, but it might help to imagine the indices pointing between the characters.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/String%20slices.png" alt=""></p>
<hr>
<p>贡献来源</p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5lZHVjaXR5LmNuL3dlbmRhLzM1Njc0MC5odG1s" title="http://www.educity.cn/wenda/356740.html">http://www.educity.cn/wenda/356740.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL25idmlld2VyLmp1cHl0ZXIub3JnL2dpdGh1Yi9yYXNidC9weXRob25fcmVmZXJlbmNlL2Jsb2IvbWFzdGVyL3R1dG9yaWFscy9ub3Rfc29fb2J2aW91c19weXRob25fc3R1ZmYuaXB5bmIjcG1faW5fbGlzdHM=" title="http://nbviewer.jupyter.org/github/rasbt/python_reference/blob/master/tutorials/not_so_obvious_python_stuff.ipynb#pm_in_lists">http://nbviewer.jupyter.org/github/rasbt/python_reference/blob/master/tutorials/not_so_obvious_python_stuff.ipynb#pm_in_lists<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Preferred-for-Web-development.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;strong&gt;以下总结是基于python2.7，在其他版本中是否可行没有验证。&lt;/strong&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="python-tip" scheme="http://tiramisutes.github.io/tags/python-tip/"/>
    
  </entry>
  
  <entry>
    <title>Python 命令行解析argparse 模块</title>
    <link href="http://tiramisutes.github.io/2017/03/25/argparse.html"/>
    <id>http://tiramisutes.github.io/2017/03/25/argparse.html</id>
    <published>2017-03-25T04:55:35.000Z</published>
    <updated>2018-09-28T02:29:12.571Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/python-build-your-security-toolspdf-47-638.jpg" alt=""><br>argparse是python用于解析命令行参数和选项的标准模块，用于代替已经过时的optparse模块。argparse模块的作用是用于在python解析命令行参数。<br><a id="more"></a><br>基本用法：<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import argparse</span><br><span class="line">parser=argparse.ArgumentParser()</span><br><span class="line">parser.add_argument()</span><br><span class="line">args=parser.parse_args()</span><br><span class="line">parser.print_help()</span><br></pre></td></tr></table></figure></p>
<h2 id="导入argparse模块">导入<strong>argparse</strong>模块</h2><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br></pre></td></tr></table></figure>
<h2 id="创建解析器对象ArgumentParser">创建解析器对象ArgumentParser</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">parser</span>=argparse.ArgumentParser()</span><br></pre></td></tr></table></figure>
<p><code>ArgumentParser(prog=None, usage=None,description=None, epilog=None, parents=[],formatter_class=argparse.HelpFormatter, prefix_chars=’-‘,fromfile_prefix_chars=None, argument_default=None,conflict_handler=’error’, add_help=True)</code></p>
<h3 id="可选参数">可选参数</h3><p>description： 程序描述性语句，命令行帮助的开始文字；<br>add_help：默认是True，可以设置False禁用；<br>epilog：命令行帮助的结尾文字；<br>prog： (default: sys.argv[0])程序的名字，一般不需要修改，另外，如果你需要在help中使用到程序的名字，可以使用<code>%(prog)s</code>；<br>prefix_chars： 命令的前缀，默认是-，例如-f/—file；<br>formatter_class： 自定义帮助信息的格式（description和epilog）。默认情况下会将长的帮助信息进行&lt;自动换行和消除多个连续空白&gt;。</p>
<h3 id="三个允许值">三个允许值</h3><p>class argparse.RawDescriptionHelpFormatter 直接输出description和epilog的原始形式（不进行自动换行和消除空白的操作）；<br>class argparse.RawTextHelpFormatter 直接输出description和epilog以及add_argument中的help字符串的原始形式（不进行自动换行和消除空白的操作）；<br>class argparse.ArgumentDefaultsHelpFormatter 在每个选项的帮助信息后面输出他们对应的缺省值，如果有设置的话。</p>
<h3 id="实例">实例</h3><p><code>parser = argparse.ArgumentParser(description=”This is a description of %(prog)s”, epilog=”This is a epilog of %(prog)s”, prefix_chars=”-+”, fromfile_prefix_chars=”@”, formatter_class=argparse.ArgumentDefaultsHelpFormatter) </code></p>
<h2 id="add_mutually_exclusive_group()指定互斥选项">add_mutually_exclusive_group()指定互斥选项</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">group</span>=parser.add_mutually_exclusive_group()</span><br><span class="line">group.add_argument(<span class="string">"-v"</span>,<span class="string">"--verbose"</span>,<span class="attribute">action</span>=<span class="string">"store_true"</span>)</span><br><span class="line">group.add_argument(<span class="string">"-q"</span>,<span class="string">"--quiet"</span>,<span class="attribute">action</span>=<span class="string">"store_true"</span>)</span><br></pre></td></tr></table></figure>
<p>argparse会为你强制执行互斥性，因此一次使用仅能给出该群组的选项中的一个。输出时形如<code>[-v | -q]</code>。</p>
<h2 id="add_argument()指定命令参数">add_argument()指定命令参数</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">parser</span><span class="selector-class">.add_argument</span>()</span><br></pre></td></tr></table></figure>
<p><code>add_argument(name or flags…[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])</code><br>name or flags： 指定参数的形式，一般指定一个短参数，一个长参数，或直接写参数名，如”-f”, “—file”，”file”；<br>nargs： 命令行参数的个数，一般使用通配符表示，其中，’?’表示只用一个，’*’表示0到多个，’+’表示至少一个;<br>default：默认值<br>type：参数的类型，默认是字符串string类型，还有float、int等类型;<br>dest: 如果提供dest，例如dest=”a”，那么可以通过args.a访问该参数;<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parser.add_argument('--<span class="keyword">ratio</span>',dest='<span class="keyword">ratio</span>',<span class="keyword">type</span>=float,default=None,</span><br><span class="line">                <span class="keyword">help</span>=<span class="string">"only show values where the difference between study"</span>)</span><br><span class="line">...</span><br><span class="line">min_ratio=<span class="keyword">args</span>.<span class="keyword">ratio</span></span><br></pre></td></tr></table></figure></p>
<p>action: 参数出发的动作，常见形式为<code>store_true/false, count</code>等；<br>choices：允许的参数值；<code>parser.add_argument(“-v”, “—verbosity”, type=int, choices=[0, 1, 2], help=”increase output verbosity”)</code>；<br>metavar: 参数的名字，在显示 帮助信息时才用到.<br>help： 和ArgumentParser方法中的参数作用相似，出现的场合也一致;<br>在执行程序的时候，定位参数必选，可选参数可选。在输出的帮助信息中显示为分开的“与位置相关的参数”和“可选参数”两个部分：</p>
<h3 id="定位参数Positional">定位参数Positional</h3><p><strong>不需要长/短线指示，直接输入参数</strong><br><code>parser.add_argument(“bar”, help=”test test test”) </code></p>
<h3 id="可选参数Optional">可选参数Optional</h3><p><strong>长/短线形式</strong><br><code>parser.add_argument(“-f”, “—file”, help=”test test test”)</code></p>
<h2 id="parse_args()解析命令行">parse_args()解析命令行</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">args</span>=parser.parse_args()</span><br></pre></td></tr></table></figure>
<p>定义了所有参数之后，你就可以给 parse_args() 传递一组参数字符串来解析命令行。<br>parse_args() 的返回值是一个命名空间，包含传递给命令的参数。该对象将参数保存其属性，因此如果你的参数 dest 是 “myoption”，那么你就可以args.myoption 来访问该值。</p>
<h2 id="parser-print_help()_打印帮助信息">parser.print_help() 打印帮助信息</h2><h2 id="高级用法">高级用法</h2><h3 id="文件参数">文件参数</h3><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">parser.add_argument(<span class="string">'-i'</span>, metavar=<span class="string">'in-file'</span>, <span class="keyword">type</span>=argparse.FileType(<span class="string">'rt'</span>))</span><br><span class="line">parser.add_argument(<span class="string">'-o'</span>, metavar=<span class="string">'out-file'</span>, <span class="keyword">type</span>=argparse.FileType(<span class="string">'wt'</span>))</span><br><span class="line">	 </span><br><span class="line">parser.print_help()</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">usage: __main__.py [-h] [-i <span class="keyword">in</span>-<span class="keyword">file</span>] [-o <span class="keyword">out</span>-<span class="keyword">file</span>]</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --help   show this help <span class="keyword">message</span> <span class="keyword">and</span> <span class="keyword">exit</span></span><br><span class="line">  -i <span class="keyword">in</span>-<span class="keyword">file</span></span><br><span class="line">  -o <span class="keyword">out</span>-<span class="keyword">file</span></span><br></pre></td></tr></table></figure>
<p>参考来源：<br><span class="exturl" data-url="aHR0cDovL3d3dy5zaWppdGFvLm5ldC8yMDAwLmh0bWw=" title="http://www.sijitao.net/2000.html">http://www.sijitao.net/2000.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQveXVnb25ncGVuZ19ibG9nL2FydGljbGUvZGV0YWlscy80NjY5MzQ3MQ==" title="http://blog.csdn.net/yugongpeng_blog/article/details/46693471">http://blog.csdn.net/yugongpeng_blog/article/details/46693471<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5qYjUxLm5ldC9hcnRpY2xlLzY3MTU4Lmh0bQ==" title="http://www.jb51.net/article/67158.htm">http://www.jb51.net/article/67158.htm<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/python-build-your-security-toolspdf-47-638.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;argparse是python用于解析命令行参数和选项的标准模块，用于代替已经过时的optparse模块。argparse模块的作用是用于在python解析命令行参数。&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="argparse" scheme="http://tiramisutes.github.io/tags/argparse/"/>
    
  </entry>
  
  <entry>
    <title>Direct：命令行访问NCBI</title>
    <link href="http://tiramisutes.github.io/2017/01/13/Direct.html"/>
    <id>http://tiramisutes.github.io/2017/01/13/Direct.html</id>
    <published>2017-01-13T13:13:07.000Z</published>
    <updated>2019-03-10T03:53:07.308Z</updated>
    
    <content type="html"><![CDATA[<p>命令行访问和获取NCBI数据当选<span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQksxNzkyODgv" title="https://www.ncbi.nlm.nih.gov/books/NBK179288/">Entrez Direct: E-utilities on the UNIX Command Line<i class="fa fa-external-link"></i></span>.</p>
<h2 id="工具集">工具集</h2><p><strong>esearch</strong> 搜索功能；<br><strong>elink</strong> looks up neighbors (within a database) or links (between databases).<br><strong>efilter</strong> 搜索结果过滤，搜索结果以特定格式输出.<br><strong>efetch</strong> 以指定格式下载搜索结果.<br><strong>xtract</strong> 转化XML格式为table.<br><strong>einfo</strong> obtains information on indexed fields in an Entrez database.<br><strong>epost</strong> uploads unique identifiers (UIDs) or sequence accession numbers.<br><strong>nquire</strong> sends a URL request to a web page or CGI service.<br><a id="more"></a></p>
<h2 id="数据库查询">数据库查询</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">esearch -db pubmed -query <span class="string">"lycopene cyclase"</span> | efetch -format abstract</span><br><span class="line">esearch -db protein -query <span class="string">"lycopene cyclase"</span> | efetch -format fasta</span><br></pre></td></tr></table></figure>
<p>当查询数据是蛋白或核酸时<code>-format</code>参数可以是fasta(fasta_cds_na, fasta_cds_aa, and gene_fasta),gb(GenBank), gp(GenPept),</p>
<h2 id="搜索和过滤">搜索和过滤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">esearch -db pubmed -query <span class="string">"opsin gene conversion"</span> | elink -related | </span><br><span class="line">  efilter -query <span class="string">"tetrachromacy"</span></span><br><span class="line">  efilter -days 60 -datetype PDAT   <span class="comment">#过去2个月</span></span><br><span class="line">  efilter -mindate 1990 -maxdate 1999 -datetype PDAT   <span class="comment">#1990s</span></span><br></pre></td></tr></table></figure>
<p><strong>场景需求：</strong>linux下如何完成如下检索和筛选过程？<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/NCBI22.png" alt=""><br>在第一步query时添加筛选项：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esearch -<span class="keyword">db</span> nucleotide -<span class="keyword">query</span> <span class="string">"beta-tubulin-2 AND (Fungi[filter] AND "</span>mrna<span class="string">"[Filter])"</span> | efetch -<span class="keyword">format</span> fasta</span><br></pre></td></tr></table></figure></p>
<h2 id="XML格式转换为制表符">XML格式转换为制表符</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ esearch -db protein -query <span class="string">"lycopene cyclase"</span> </span><br><span class="line">&lt;ENTREZ_DIRECT&gt;</span><br><span class="line">  &lt;Db&gt;protein&lt;/Db&gt;</span><br><span class="line">  &lt;WebEnv&gt;NCID_1_322844954_130.14.22.215_9001_1484487403_837234396_0MetA0_S_MegaStore_F_1&lt;/WebEnv&gt;</span><br><span class="line">  &lt;QueryKey&gt;1&lt;/QueryKey&gt;</span><br><span class="line">  &lt;Count&gt;12380&lt;/Count&gt;</span><br><span class="line">  &lt;Step&gt;1&lt;/Step&gt;</span><br><span class="line">&lt;/ENTREZ_DIRECT&gt;</span><br><span class="line">$ esearch -db protein -query <span class="string">"lycopene cyclase"</span> | xtract -pattern ENTREZ_DIRECT -element Count</span><br><span class="line">12380</span><br></pre></td></tr></table></figure>
<h2 id="某一领域最多产的作者">某一领域最多产的作者</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="function"><span class="title">SortUniqCountRank</span></span>() &#123;</span><br><span class="line">    sort -f |</span><br><span class="line">    uniq -i -c |</span><br><span class="line">    perl -pe <span class="string">'s/\s*(\d+)\s(.+)/$1\t$2/'</span> |</span><br><span class="line">    sort -t $<span class="string">'\t'</span> -k 1,1nr -k 2f</span><br><span class="line">$ <span class="built_in">alias</span> sort-uniq-count-rank=<span class="string">'SortUniqCountRank'</span></span><br><span class="line">$ esearch -db pubmed -query \</span><br><span class="line">    <span class="string">"crotalid venoms [MAJR] AND phospholipase [TIAB]"</span> |</span><br><span class="line">  efetch -format xml |</span><br><span class="line">  xtract -pattern PubmedArticle \</span><br><span class="line">    -block Author -sep <span class="string">" "</span> -tab <span class="string">"\n"</span> -element LastName,Initials  |</span><br><span class="line">  sort-uniq-count-rank</span><br></pre></td></tr></table></figure>
<h2 id="某一领域每年文章发表情况">某一领域每年文章发表情况</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">esearch -db pubmed -query <span class="string">"legionnaires disease [TITL]"</span> |</span><br><span class="line"> efetch -format docsum |</span><br><span class="line"> xtract -pattern DocumentSummary -element PubDate |</span><br><span class="line"> cut -c 1-4 |</span><br><span class="line"> sort-uniq-count-rank</span><br></pre></td></tr></table></figure>
<h2 id="人每条染色体上有多少基因">人每条染色体上有多少基因</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> chr <span class="keyword">in</span> &#123;1..22&#125; X Y MT</span><br><span class="line"> <span class="keyword">do</span></span><br><span class="line">   esearch -db gene -query <span class="string">"Homo sapiens [ORGN] AND <span class="variable">$chr</span> [CHR]"</span> |</span><br><span class="line">   efilter -query <span class="string">"alive [PROP] AND genetype protein coding [PROP]"</span> |</span><br><span class="line">   efetch -format docsum |</span><br><span class="line">   xtract -pattern DocumentSummary -NAME Name \</span><br><span class="line">     -block GenomicInfoType -<span class="keyword">if</span> ChrLoc -equals <span class="string">"<span class="variable">$chr</span>"</span> \</span><br><span class="line">       -tab <span class="string">"\n"</span> -element ChrLoc,<span class="string">"&amp;NAME"</span> |</span><br><span class="line">   sort | uniq | cut -f 1 | sort-uniq-count-rank</span><br><span class="line"> <span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;命令行访问和获取NCBI数据当选&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/books/NBK179288/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Entrez Direct: E-utilities on the UNIX Command Line&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;工具集&quot;&gt;工具集&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;esearch&lt;/strong&gt; 搜索功能；&lt;br&gt;&lt;strong&gt;elink&lt;/strong&gt; looks up neighbors (within a database) or links (between databases).&lt;br&gt;&lt;strong&gt;efilter&lt;/strong&gt; 搜索结果过滤，搜索结果以特定格式输出.&lt;br&gt;&lt;strong&gt;efetch&lt;/strong&gt; 以指定格式下载搜索结果.&lt;br&gt;&lt;strong&gt;xtract&lt;/strong&gt; 转化XML格式为table.&lt;br&gt;&lt;strong&gt;einfo&lt;/strong&gt; obtains information on indexed fields in an Entrez database.&lt;br&gt;&lt;strong&gt;epost&lt;/strong&gt; uploads unique identifiers (UIDs) or sequence accession numbers.&lt;br&gt;&lt;strong&gt;nquire&lt;/strong&gt; sends a URL request to a web page or CGI service.&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Direct" scheme="http://tiramisutes.github.io/tags/Direct/"/>
    
  </entry>
  
  <entry>
    <title>CRISPR-sgRNA-Designer：从来都不应该那么神秘</title>
    <link href="http://tiramisutes.github.io/2017/01/13/CRISPR-Designer.html"/>
    <id>http://tiramisutes.github.io/2017/01/13/CRISPR-Designer.html</id>
    <published>2017-01-13T03:37:05.000Z</published>
    <updated>2020-06-28T03:29:59.657Z</updated>
    
    <content type="html"><![CDATA[<p>CRISPR介绍和作用过程之前也学习总结过：<a href="http://tiramisutes.github.io/2015/09/13/CRISPR-Cas9.html">CRISPR/Cas9</a>。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crisp.png" alt=""><br><a id="more"></a></p>
<h2 id="Story">Story</h2><p><i class="fa fa-history" aria-hidden="true"></i> 陆地棉基因组2015年完成测序，之后公布基因组信息，我所在实验也在从事CRISPR的工作，得益于技术革新和谢卡斌老师PNAS文章，CRISPR在棉花中的敲除首次在我们实验室获得成功，于是更多功能基因的CRISPR工作列入许多研究生的工作计划中，CRISPR编辑第一步就是目标基因的sgRNA设计。现有的绝大部分在线sgRNA设计主要是针对模式生物的，并不能用于非模式生物。但整个sgRNA设计原理是相通的也比较好理解：<strong>在目标基因序列的cds中匹配NGG的PAM区域，往前延伸20bp碱基就是一个理论的sgRNA位点，接下来所需考虑的就是这个sgRNA的特异性(不能编辑其他基因，20bp的碱基在几百M甚至G的基因组里面特异存在)和脱靶率(有时候为了保证特异性会允许一定数量的错配情况存在，这可能引起脱靶)，所以后续会对这样的理论sgRNA位点在全基因组内比对，寻找可能的编辑位点。</strong>对于perl和python来说实现这样的功能并不是什么难事，华农动科学院谢老师用perl编写的可自行提供基因组的sgRNAcas9程序开发出来。</p>
<h2 id="sgRNAcas9流程">sgRNAcas9流程</h2><p>sgRNAcas9软件功能介绍如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sgRNAcas9.jpg" alt=""><br><strong>软件优点是可自行提供基因组文件，缺点是对酶切位点的计算较为麻烦。</strong><br>偶然也发现<span class="exturl" data-url="aHR0cDovL3d3dy5iaW9vdG9vbHMuY29tL2NuL2NvbC5qc3A/aWQ9MTY4" title="http://www.biootools.com/cn/col.jsp?id=168">软件作者<i class="fa fa-external-link"></i></span>收录了我早期一篇总结╰(￣▽￣)╮<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bio.png" alt=""><br><i class="fa fa-handshake-o" aria-hidden="true"></i>插播广告：该内容现有跟新，<a href="http://tiramisutes.github.io/2015/08/05/bio-online.html">http://tiramisutes.github.io/2015/08/05/bio-online.html</a></p>
<h3 id="软件下载">软件下载</h3><p>该软件是有perl程序编写，有windows和linux平台可供下载使用，根据相应平台自行下载：<i class="fa fa-download" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5iaW9vdG9vbHMuY29tL2NvbC5qc3A/aWQ9MTQz" title="http://www.biootools.com/col.jsp?id=143">sgRNAcas9<i class="fa fa-external-link"></i></span>。</p>
<h3 id="软件安装">软件安装</h3><p>修改可执行权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod +x sgRNAcas9_3.0.5.pl</span><br><span class="line">chmod +x -R Seqmap</span><br><span class="line">chmod +x -R Usefull_Script</span><br></pre></td></tr></table></figure></p>
<h3 id="文件准备">文件准备</h3><p><i class="fa fa-file-text" aria-hidden="true"></i>基因组文件：genome.fa<br><i class="fa fa-file-text" aria-hidden="true"></i>基因组cds文件：genome_cds.fa<br><i class="fa fa-file-text" aria-hidden="true"></i>基因组注释文件：genome.gff3 (非必须)<br><strong>将上述文件<code>mv</code>到sgRNAcas9软件所在目录,用绝对路径会报错。</strong></p>
<h3 id="代码运行">代码运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl sgRNAcas9_3.0.5.pl -i genome_cds.fa -x 20 -l 40 -m 60 -g genome.fa -o b -t s -v l -n 5</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-cog" aria-hidden="true"></i>参数解释：<br>-i:    所需设计crispr敲除序列fa文件，可为多条序列；<br>-x:    sgRNA长度，通常为20；<br>-l:    GC含量下限；<br>-m:    GC含量上限；GC含量一般为40%~60%。<br>-g:    基因组fa文件；<br>-o:    用DNA的哪条链作为crispr靶标位点搜寻，s正义链，a反义链，b双链；<br>-t:    gRNA搜索模型，s单个gRNA，p一对gRNA搜寻；<br>-v:    操作系统类型，l为linux-64位，w为windows；<br>-n:    最大错配碱基数，一般为5。<br><strong>-i参数设置全基因组cds的fa文件，-g参数设置去基因组fa文件就可得到上述提到的库文件。</strong></p>
<h3 id="结果解读">结果解读</h3><p>运行时间视所选物种基因组大小和目标基因多少相关；当基因组文件较大时windows下运行电脑易卡挂掉，最好在服务器下运行。<br>运行完后会生成report文件：sgRNAcas9.report_20.b.rhp.fa，包含以下内容：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sgRNAreport.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/How_to_use_sgRNAcas9.jpg" alt=""><br>注：OT为靶标去除NGG后的脱靶情况，即NGG前面20个碱基的脱靶；POT为种子序列的脱靶情况，种子序列即NGG前面的12个碱基；<br>sgRNAcas9_report.xls文件里有个综合了GC含量，错配和特异性后的风险等级排序，可简单选取Best对应crispr靶标位点。<br><strong>Discard &gt; High_risk &gt; moderate_risk &gt; low_risk &gt; repeat_sites_or_bad ? &gt; Best</strong><br>当0M(on-/off-)值为0时意味着脱靶，大于1则存在有靶标序列，其他数字表示所存在靶标数目；</p>
<h3 id="脱靶位点注释">脱靶位点注释</h3><p>脱靶是要尽量避免的，但若存在风险还可根据基因组注释gff3文件对可能的脱靶位点进行注释。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">perl ot2gtf.pl -i &lt;input_OT&gt; -g &lt;gtf file&gt; -o &lt;output&gt;</span><br><span class="line">perl pot2gtf.pl -i &lt;input_POT&gt; -g &lt;gtf file&gt; -o &lt;output&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="CRISPR">CRISPR</h2><p><span class="exturl" data-url="aHR0cDovL2NiaS5oemF1LmVkdS5jbi9jZ2ktYmluL0NSSVNQUiM=" title="http://cbi.hzau.edu.cn/cgi-bin/CRISPR#">CRISPR<i class="fa fa-external-link"></i></span>是华中农业大学生物信息学院陈玲玲老师团队开发的在线设计软件。输出结果可视化较好，包含有错配，靶标序列位置，酶切位点等信息。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/CRISPR.png" alt=""></p>
<h2 id="cas-designer">cas-designer</h2><p><span class="exturl" data-url="aHR0cDovL3d3dy5yZ2Vub21lLm5ldC9jYXMtZGVzaWduZXIvcG9ydGFibGU=" title="http://www.rgenome.net/cas-designer/portable">cas-designer<i class="fa fa-external-link"></i></span>也提供有在线版和命令行版，<strong>可自行提供基因组数据</strong>，官网有详细的安装教程，不再敖述。<br>比较坑的是其中一个组件Cas-OFFinder需要OpenCL-enabled device，而Centos6.0尽然不支持这种驱动,所以放弃。</p>
<h2 id="总结">总结</h2><p>最终sgRNA位点可综合多个软件结果信息，筛选靠谱的结果；</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CRISPR介绍和作用过程之前也学习总结过：&lt;a href=&quot;http://tiramisutes.github.io/2015/09/13/CRISPR-Cas9.html&quot;&gt;CRISPR/Cas9&lt;/a&gt;。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crisp.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="CRISPR/Cas9" scheme="http://tiramisutes.github.io/tags/CRISPR-Cas9/"/>
    
  </entry>
  
  <entry>
    <title>AUGUSTUS安装和非Root用户GLIBC“排雷”过程</title>
    <link href="http://tiramisutes.github.io/2017/01/06/GLIBC.html"/>
    <id>http://tiramisutes.github.io/2017/01/06/GLIBC.html</id>
    <published>2017-01-06T07:40:43.000Z</published>
    <updated>2018-09-28T02:35:37.144Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/AUGUSTUS.png" alt=""><br><span class="exturl" data-url="aHR0cDovL2Jpb2luZi51bmktZ3JlaWZzd2FsZC5kZS9hdWd1c3R1cy8=" title="http://bioinf.uni-greifswald.de/augustus/">AUGUSTUS<i class="fa fa-external-link"></i></span> is a program that predicts genes in eukaryotic genomic sequences.<br><a id="more"></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> ./augustus </span><br><span class="line">./augustus: /lib64/libc.so.6: version `GLIBC_2.14<span class="string">' not found (required by ./augustus)</span></span><br><span class="line"><span class="string">./augustus: /public/home/zpxu/bin/gcc-4.8.5/lib64/libstdc++.so.6: version `GLIBCXX_3.4.20'</span> not found (required by ./augustus)</span><br><span class="line">./augustus: /public/home/zpxu/bin/gcc-4.8.5/lib64/libstdc++.so.6: version `GLIBCXX_3.4.21<span class="string">' not found (required by ./augustus)</span></span><br></pre></td></tr></table></figure></p>
<p>查看GLIBC版本：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">strings /lib64/libc.so.6 | grep GLIBC</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">GLIBC_2.2.6</span><br><span class="line">GLIBC_2.3</span><br><span class="line">GLIBC_2.3.2</span><br><span class="line">GLIBC_2.3.3</span><br><span class="line">GLIBC_2.3.4</span><br><span class="line">GLIBC_2.4</span><br><span class="line">GLIBC_2.5</span><br><span class="line">GLIBC_2.6</span><br><span class="line">GLIBC_2.7</span><br><span class="line">GLIBC_2.8</span><br><span class="line">GLIBC_2.9</span><br><span class="line">GLIBC_2.10</span><br><span class="line">GLIBC_2.11</span><br><span class="line">GLIBC_2.12</span><br><span class="line">GLIBC_PRIVATE</span><br></pre></td></tr></table></figure></p>
<p>发现最高版本是2.12但是系统需要2.14才可以，那么就自己编译安装吧。</p>
<h2 id="1&gt;下载GLIBC">1&gt;下载GLIBC</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://ftp.gnu.org/gnu/glibc/glibc-2.14.tar.gz</span><br></pre></td></tr></table></figure>
<h2 id="2&gt;_glibc-2-14-tar-gz解压，并进入解压后目录，创建build目录，并且进入：">2&gt; glibc-2.14.tar.gz解压，并进入解压后目录，创建build目录，并且进入：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf glibc-2.14.tar.gz &amp;&amp; <span class="built_in">cd</span> glibc-2.14 &amp;&amp; mkdir build &amp;&amp; <span class="built_in">cd</span> build</span><br></pre></td></tr></table></figure>
<h2 id="3&gt;编译：">3&gt;编译：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../configure --prefix=/opt/glibc-2.14  <span class="comment">#你的安装目录</span></span><br></pre></td></tr></table></figure>
<p>此时报错如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">checking LD_LIBRARY_PATH variable... contains current directory</span><br><span class="line">configure: error:</span><br><span class="line">*** LD_LIBRARY_PATH shouldn<span class="string">'t contain the current directory when</span></span><br><span class="line"><span class="string">*** building glibc. Please change the environment variable</span></span><br><span class="line"><span class="string">*** and run configure again.</span></span><br></pre></td></tr></table></figure></p>
<p>报错意思简单明了：目录冲突；<br><strong><code>echo $LD_LIBRARY_PATH</code></strong>但是次安装目录并不在我的环境变量.bashrc文件里啊。<br>打开configure文件，查找LD_LIBRARY_PATH，找到如下内容：</p>
<p><blockquote><p></p>
<h1 id="Test_if_LD_LIBRARY_PATH_contains_the_notation_for_the_current_directory">Test if LD_LIBRARY_PATH contains the notation for the current directory</h1><h1 id="since_this_would_lead_to_problems_installing/building_glibc-">since this would lead to problems installing/building glibc.</h1><h1 id="LD_LIBRARY_PATH_contains_the_current_directory_if_one_of_the_following">LD_LIBRARY_PATH contains the current directory if one of the following</h1><h1 id="is_true:">is true:</h1><h1 id="-_one_of_the_terminals_(“:”_and_“;”)_is_the_first_or_last_sign">- one of the terminals (“:” and “;”) is the first or last sign</h1><h1 id="-_two_terminals_occur_directly_after_each_other">- two terminals occur directly after each other</h1><h1 id="-_the_path_contains_an_element_with_a_dot_in_it">- the path contains an element with a dot in it</h1><p></p></blockquote><br><strong>解释就是“LD_LIBRARY_PATH不能以终结符（”:” and “;”）作为开始和最后一个字符，且不能有2个终结符连在一起；因为在环境变量的最前和最后均有一个“:”，程序将此分隔符解释为当前目录了。</strong><br><i class="fa fa-comments" aria-hidden="true"></i><strong>解决方法：</strong><br>执行指令：vi ~/.bashrc<br>将LD_LIBRARY_PATH环境变量的开头和末尾的“:”去掉，保存。等正确编译完成后可以再次修改回原来。<br>执行指令：source ~/.bashrc</p>
<h2 id="4&gt;_make">4&gt; make</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j4 &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>make install 时报错如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/install: `include/limits.h<span class="string">' and `/glibc-2.14/include/limits.h'</span> are the same file </span><br><span class="line">make[1]: *** [/glibc-2.14/include/limits.h] Error 1</span><br><span class="line">make[1]: Leaving directory `/glibc-2.14<span class="string">'</span></span><br><span class="line"><span class="string">make: ***[install] Error 2</span></span><br></pre></td></tr></table></figure></p>
<p>Google之发现解决办法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make install -k -i</span><br></pre></td></tr></table></figure></p>
<p><a href="#" class="myButton">通过k和i参数虽然可以强制安装，但经测试并不能真正解决问题，所以这最后一步的安装过程任然卡在这，目前也没有找到有效解决办法。这里先占个坑，等后面找到方法了再补充。</a><br>其中-j，-k和-i参数解释如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-j [<span class="built_in">jobs</span>], --<span class="built_in">jobs</span>[=<span class="built_in">jobs</span>]</span><br><span class="line">Specifies the number of <span class="built_in">jobs</span> (commands) to run simultaneously. If there is more than one -j option, the last one is effective. If the -j option is given without an argument, make will not <span class="built_in">limit</span> the number of <span class="built_in">jobs</span> that can run simultaneously.</span><br><span class="line">-i, --ignore-errors</span><br><span class="line">Ignore all errors <span class="keyword">in</span> commands executed to remake files.</span><br><span class="line">-k, --keep-going</span><br><span class="line">Continue as much as possible after an error. While the target that failed, and those that depend on it, cannot be remade, the other dependencies of these targets can be processed all the same.</span><br></pre></td></tr></table></figure></p>
<h2 id="5&gt;添加环境变量">5&gt;添加环境变量</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=/opt/glibc-2.14/lib:<span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure>
<p><i class="fa fa-desktop" aria-hidden="true"></i>PATH和LD_LIBRARY_PATH区别<br>PATH:  可执行程序的查找路径；<br>LD_LIBRARY_PATH: 动态库的查找路径；</p>
<h2 id="再安装AUGUSTUS">再安装AUGUSTUS</h2><p>上述关于GLIBC安装虽已失败告终，但AUGUSTUS的安装参考<span class="exturl" data-url="aHR0cHM6Ly9pYW1waGlveHVzLm9yZy8yMDE3LzA1LzA4L2luc3RhbGxpbmctYXVndXN0dXMtd2l0aC1tYW51YWwtYmFtdG9vbHMtaW5zdGFsbGF0aW9uLw==" title="https://iamphioxus.org/2017/05/08/installing-augustus-with-manual-bamtools-installation/">Installing Augustus with manual bamtools installation<i class="fa fa-external-link"></i></span>后得到解决。<br><strong>1. 主要是无root权限下先安装依赖工具bam2hints 和 filterBam👇</strong><br>首先安装 bamtools<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone gi<span class="variable">t:</span>//github.<span class="keyword">com</span>/pezmaster31/bamtools.git</span><br><span class="line"><span class="keyword">cd</span> bamtools</span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="keyword">cd</span> build</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/your/path/<span class="keyword">to</span>/bamtools .. </span><br><span class="line"><span class="keyword">make</span></span><br></pre></td></tr></table></figure></p>
<p><strong>2.修改AUGUSTUS中部分MakeFile文件</strong><br>首先修改<code>augustus-3.2.3/auxprogs/bam2hints</code>目录下MakeFile文件内容：<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">Add:</span></span><br><span class="line">BAMTOOLS = /your/path/to/bamtools</span><br><span class="line"></span><br><span class="line"><span class="section">Replace:</span></span><br><span class="line">INCLUDES = /usr/<span class="keyword">include</span>/bamtools</span><br><span class="line"><span class="section">By:</span></span><br><span class="line">INCLUDES = <span class="variable">$(BAMTOOLS)</span>/<span class="keyword">include</span></span><br><span class="line"></span><br><span class="line"><span class="section">Replace:</span></span><br><span class="line">LIBS = -lbamtools -lz</span><br><span class="line"><span class="section">By:</span></span><br><span class="line">LIBS = <span class="variable">$(BAMTOOLS)</span>/lib/libbamtools.a -lz</span><br></pre></td></tr></table></figure></p>
<p>再修改<code>augustus-3.2.3/auxprogs/filterBam/src</code>目录下MakeFile文件内容：<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">Replace:</span></span><br><span class="line"></span><br><span class="line">BAMTOOLS = /usr/<span class="keyword">include</span>/bamtools</span><br><span class="line"><span class="section">By:</span></span><br><span class="line">BAMTOOLS = /your/path/to/bamtools</span><br><span class="line"></span><br><span class="line"><span class="section">Replace:</span></span><br><span class="line">INCLUDES = -I<span class="variable">$(BAMTOOLS)</span> -Iheaders -I./bamtools</span><br><span class="line"><span class="section">By:</span></span><br><span class="line">INCLUDES = -I<span class="variable">$(BAMTOOLS)</span>/<span class="keyword">include</span> -Iheaders -I./bamtools</span><br><span class="line"></span><br><span class="line"><span class="section">Replace:</span></span><br><span class="line">LIBS = -lbamtools -lz</span><br><span class="line"><span class="section">By:</span></span><br><span class="line">LIBS = <span class="variable">$(BAMTOOLS)</span>/lib/libbamtools.a -lz</span><br></pre></td></tr></table></figure></p>
<p><strong>3. <code>make</code>安装</strong><br>最后回到主目录<code>augustus-3.2.3</code>下<code>make</code>即可安装成功，不需要<code>make install</code>过程。</p>
<h2 id="参考来源">参考来源</h2><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmxpeWFuZy5pby8zMDEuaHRtbA==" title="https://blog.liyang.io/301.html">解决/lib64/libc.so.6: version `GLIBC_2.14′ not found问题<i class="fa fa-external-link"></i></span></li><br><li><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYW5kYTAxMDkvYXJ0aWNsZS9kZXRhaWxzLzM5MjI5NTk3" title="http://blog.csdn.net/anda0109/article/details/39229597"> [error]LD_LIBRARY_PATH shouldn’t contain the current directory<i class="fa fa-external-link"></i></span></li>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/AUGUSTUS.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;a href=&quot;http://bioinf.uni-greifswald.de/augustus/&quot; target=&quot;_blank&quot;&gt;AUGUSTUS&lt;/a&gt; is a program that predicts genes in eukaryotic genomic sequences.&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="linux-glibc" scheme="http://tiramisutes.github.io/tags/linux-glibc/"/>
    
  </entry>
  
  <entry>
    <title>非root用户interproscan的安装和使用</title>
    <link href="http://tiramisutes.github.io/2016/12/15/interproscan.html"/>
    <id>http://tiramisutes.github.io/2016/12/15/interproscan.html</id>
    <published>2016-12-15T03:10:40.000Z</published>
    <updated>2018-09-28T02:36:54.087Z</updated>
    
    <content type="html"><![CDATA[<p><a href="#" class="myButton">InterProScan</a><strong>常用于基因序列的功能注释，</strong>InterPro**是一个包含有蛋白质功能和家族等的数据库，而InterProScan的功能就是将我们的目标序列比对到这个数据库，从而了解其功能。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/InterProScan.png" alt=""><br><a id="more"></a><br>关于InterProScan的功能和安装过程以及基本的配置要求官网提供了非常详细的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ViaS1wZi10ZWFtL2ludGVycHJvc2Nhbi93aWtp" title="https://github.com/ebi-pf-team/interproscan/wiki">InterProScan wiki<i class="fa fa-external-link"></i></span>，这里就不做细述。<br>但通常我们面临的问题是权限，比如python的版本问题，我的集群python是2.6，我也在自己家目录下正确安装有python2.7，但系统默认的是2.6，首先如何修改<code>/usr/bin/python</code>目录下python使其默认为自己安装的2.7。<br>最简单的就是用alias：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> python=<span class="string">'~/bin/Python-2.7.10/Python/bin/python2.7'</span></span><br></pre></td></tr></table></figure></p>
<p>但是当所运行软件是调用系统默认python时，上面方法就失效了。<br>那么为什么非要修改系统默认版本呢？当需要python时直接指定就可以，是的，python编写的软件可以通过<code>python2.7 软件</code>这样的方式运行，但InterProScan的运行主程序 <strong>interproscan.sh</strong>并不是python写的，好在有一个专属的配置文件<strong>interproscan.properties</strong>，可设置软件和数据库路径。<br>所以,<strong>解决非root用户interproscan使用时python版本问题的方法就是添加<a href="#" class="myButton"> python.command=/path/to/python2.7</a>到配置文件。</strong></p>
<h2 id="Pre-calculated_Match_Lookup_Service">Pre-calculated Match Lookup Service</h2><p>软件会联网搜寻并匹配<span class="exturl" data-url="aHR0cDovL3d3dy5lYmkuYWMudWs=" title="http://www.ebi.ac.uk">EBI<i class="fa fa-external-link"></i></span>数据库来获得准确结果，当服务器不能联网时可选取如下解决办法：<br>1&gt;<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ViaS1wZi10ZWFtL2ludGVycHJvc2Nhbi93aWtpL0xvY2FsTG9va3VwU2VydmljZQ==" title="https://github.com/ebi-pf-team/interproscan/wiki/LocalLookupService">Download and install the InterProScan 5 lookup service<i class="fa fa-external-link"></i></span>.<br>2&gt;用<code>-dp</code>参数来关掉此功能.<br>3&gt;用#号注释掉<strong>interproscan.properties</strong>文件中的<code>precalculated.match.lookup.service.url=<span class="exturl" data-url="aHR0cDovL3d3dy5lYmkuYWMudWsvaW50ZXJwcm8vbWF0Y2gtbG9va3Vw" title="http://www.ebi.ac.uk/interpro/match-lookup">http://www.ebi.ac.uk/interpro/match-lookup<i class="fa fa-external-link"></i></span></code>行。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;#&quot; class=&quot;myButton&quot;&gt;InterProScan&lt;/a&gt;&lt;strong&gt;常用于基因序列的功能注释，&lt;/strong&gt;InterPro**是一个包含有蛋白质功能和家族等的数据库，而InterProScan的功能就是将我们的目标序列比对到这个数据库，从而了解其功能。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/InterProScan.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="InterProScan" scheme="http://tiramisutes.github.io/tags/InterProScan/"/>
    
  </entry>
  
  <entry>
    <title>Mate-pair Reads Alignment</title>
    <link href="http://tiramisutes.github.io/2016/11/25/mate-pair-reads-Aligner.html"/>
    <id>http://tiramisutes.github.io/2016/11/25/mate-pair-reads-Aligner.html</id>
    <published>2016-11-25T01:56:33.000Z</published>
    <updated>2018-09-28T02:38:10.791Z</updated>
    
    <content type="html"><![CDATA[<h2 id="文库类型">文库类型</h2><p>对于基因组文库我们一般会建小库（<1k）的**paired-end reads="" (l-=""> &lt;-R)<strong> 和大库的 </strong>mate-pair reads(&lt;-L R-&gt;)<strong>，二者最主要的区别就是reads1和reads2的方向和之间的间隔大小。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/strand_specificity.jpg" alt=""><br><a id="more"></a><br>现在绝大部分的主流软件都是支持将paired-end reads进行比对的，那么 </strong>mate-pair reads<strong>如何处理呢，即 </strong>mate-pair reads**如何做比对？</1k）的**paired-end></p>
<h2 id="reverse_complement">reverse complement</h2><p>When done standard Illumina MP preps, reverse complemented with <strong>fastx-toolkit</strong> and aligned with standard parameters using bwa/bowtie.</p>
<h3 id="fastx-toolkit_reverse_complement">fastx-toolkit reverse complement</h3><p><blockquote><p>FASTQ/A Reverse Complement</p>
<pre><code>$ <span class="atom">fastx_reverse_complement</span> -<span class="atom">h</span>
<span class="atom">usage</span>: <span class="atom">fastx_reverse_complement</span> [-<span class="atom">h</span>] [-<span class="atom">r</span>] [-<span class="atom">z</span>] [-<span class="atom">v</span>] [-<span class="atom">i</span> <span class="name">INFILE</span>] [-<span class="atom">o</span> <span class="name">OUTFILE</span>]

<span class="atom">version</span> <span class="number">0.0</span>.6
   [-<span class="atom">h</span>]         = <span class="name">This</span> <span class="atom">helpful</span> <span class="atom">help</span> <span class="atom">screen</span>.
   [-<span class="atom">z</span>]         = <span class="name">Compress</span> <span class="atom">output</span> <span class="atom">with</span> <span class="name">GZIP</span>.
   [-<span class="atom">i</span> <span class="name">INFILE</span>]  = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">input</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDIN</span>.
   [-<span class="atom">o</span> <span class="name">OUTFILE</span>] = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">output</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDOUT</span>.
</code></pre><p></p></blockquote></p>
<h2 id="bowtie2">bowtie2</h2><p>也可通过设置bowtie2的<code>—fr/—rf/—ff</code>、<code>-I</code>、<code>-X</code>参数来进行比对。</p>
<p><blockquote><p>Aligning pairs</p>
<p>A “paired-end” or “mate-pair” read consists of pair of mates, called mate 1 and mate 2. Pairs come with a prior expectation about (a) the relative orientation of the mates, and (b) the distance separating them on the original DNA molecule. Exactly what expectations hold for a given dataset depends on the lab procedures used to generate the data. For example, a common lab procedure for producing pairs is Illumina’s Paired-end Sequencing Assay, which yields pairs with a relative orientation of FR (“forward, reverse”) meaning that if mate 1 came from the Watson strand, mate 2 very likely came from the Crick strand and vice versa. Also, this protocol yields pairs where the expected genomic distance from end to end is about 200-500 base pairs.</p>
<p><strong>Paired-end options</strong></p>
<p>-I/—minins <int><br>The minimum fragment length for valid paired-end alignments. E.g. if -I 60 is specified and a paired-end alignment consists of two 20-bp alignments in the appropriate orientation with a 20-bp gap between them, that alignment is considered valid (as long as -X is also satisfied). A 19-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -I constraint is applied with respect to the untrimmed mates.<br>The larger the difference between -I and -X, the slower Bowtie 2 will run. This is because larger differences bewteen -I and -X require that Bowtie 2 scan a larger window to determine if a concordant alignment exists. For typical fragment length ranges (200 to 400 nucleotides), Bowtie 2 is very efficient.<br>Default: 0 (essentially imposing no minimum)</int></p>
<p>-X/—maxins <int><br>The maximum fragment length for valid paired-end alignments. E.g. if -X 100 is specified and a paired-end alignment consists of two 20-bp alignments in the proper orientation with a 60-bp gap between them, that alignment is considered valid (as long as -I is also satisfied). A 61-bp gap would not be valid in that case. If trimming options -3 or -5 are also used, the -X constraint is applied with respect to the untrimmed mates, not the trimmed mates.<br>The larger the difference between -I and -X, the slower Bowtie 2 will run. This is because larger differences bewteen -I and -X require that Bowtie 2 scan a larger window to determine if a concordant alignment exists. For typical fragment length ranges (200 to 400 nucleotides), Bowtie 2 is very efficient.<br>Default: 500.</int></p>
<p>—fr/—rf/—ff<br>The upstream/downstream mate orientations for a valid paired-end alignment against the forward reference strand. E.g., if —fr is specified and there is a candidate paired-end alignment where mate 1 appears upstream of the reverse complement of mate 2 and the fragment length constraints (-I and -X) are met, that alignment is valid. Also, if mate 2 appears upstream of the reverse complement of mate 1 and all other constraints are met, that too is valid. —rf likewise requires that an upstream mate1 be reverse-complemented and a downstream mate2 be forward-oriented. —ff requires both an upstream mate 1 and a downstream mate 2 to be forward-oriented. Default: —fr (appropriate for Illumina’s Paired-end Sequencing Assay).<br></p></blockquote></p>
<h2 id="Novoalign">Novoalign</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;文库类型&quot;&gt;文库类型&lt;/h2&gt;&lt;p&gt;对于基因组文库我们一般会建小库（&lt;1k）的**paired-end reads=&quot;&quot; (l-=&quot;&quot;&gt; &amp;lt;-R)&lt;strong&gt; 和大库的 &lt;/strong&gt;mate-pair reads(&amp;lt;-L R-&amp;gt;)&lt;strong&gt;，二者最主要的区别就是reads1和reads2的方向和之间的间隔大小。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/strand_specificity.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Mate-pair Reads Alignment" scheme="http://tiramisutes.github.io/tags/Mate-pair-Reads-Alignment/"/>
    
  </entry>
  
  <entry>
    <title>Genomic-Feature</title>
    <link href="http://tiramisutes.github.io/2016/11/04/Genomic-Feature.html"/>
    <id>http://tiramisutes.github.io/2016/11/04/Genomic-Feature.html</id>
    <published>2016-11-04T09:54:27.000Z</published>
    <updated>2019-03-10T03:53:28.203Z</updated>
    
    <content type="html"><![CDATA[<h2 id="问题描述">问题描述</h2><p><strong><span class="exturl" data-url="aHR0cHM6Ly9nZW5vbWV2b2x1dGlvbi5vcmcvd2lraS9pbmRleC5waHAvR2Vub21pY19GZWF0dXJl" title="https://genomevolution.org/wiki/index.php/Genomic_Feature">Genomic Feature<i class="fa fa-external-link"></i></span></strong>通常包括exon、intron、intergenic region、UpstreamToGene、UTRs等，对于有完整参考基因组物种其一般都有注释文件gff3，但其一般只有mRNA，gene和exon的坐标信息，而我们通常也需要更多的Genomic Feature信息。<br><a id="more"></a></p>
<h2 id="解决方案">解决方案</h2><h3 id="工具">工具</h3><p><strong><span class="exturl" data-url="aHR0cDovL2JlZHRvb2xzLnJlYWR0aGVkb2NzLmlvL2VuL2xhdGVzdC8=" title="http://bedtools.readthedocs.io/en/latest/">bedtools<i class="fa fa-external-link"></i></span></strong><br>bedtools具体使用讲解见我的另一篇博文：<strong><a href="http://tiramisutes.github.io/2016/03/18/bedtools.html" target="_blank">bedtools 使用小结</a>。</strong></p>
<h3 id="特征种类">特征种类</h3><p>在gff3文件第三列标注有相应的特征类型，我们可以参看每种特征类型的数量：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat XX.gff3 | grep -v <span class="string">"^#"</span> | cut -f3 | sort | uniq -c | sort -k1rn</span><br></pre></td></tr></table></figure></p>
<h3 id="Remove/merge_overlapping_exons">Remove/merge overlapping exons</h3><p>在gff3文件中我们发现存在有以下情况：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ grep -B 5 <span class="string">"89201851"</span> Gossypium_hirsutum_v1.1.gene.gff3 | grep <span class="string">"exon"</span></span><br><span class="line">A01  EVM  exon  89201570  89201851  .   -  .   ID=evm.model.Gh_A01G1441.exon1;Parent=evm.model.Gh_A01G1441</span><br><span class="line">A01  EVM  exon  89201852  89201963  .   -  .   ID=evm.model.Gh_A01G1442.exon3;Parent=evm.model.Gh_A01G1442</span><br><span class="line">A01  EVM  exon  89202063  89202216  .   -  .   ID=evm.model.Gh_A01G1442.exon2;Parent=evm.model.Gh_A01G1442</span><br></pre></td></tr></table></figure></p>
<p>仔细察看发现两个基因Gh_A01G1441和Gh_A01G1442的外显子尽然想连续（第一行终止位置89201851和第二行起始位置89201852），也就是两个连续的基因，在这种情况下有时我们在计算exon时想要将其合并为同一个exon。<strong>mergeBed ( Merges overlapping BED/GFF/VCF entries into a single interval)：bedtools merge [OPTIONS] -i <bed gff="" vcf=""></bed></strong>可实现这样的功能，但首先需要对起始位置排序（另一个组件<strong>sortBed</strong>）。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat Gossypium_hirsutum_v1.1.gene.gff3 | \</span><br><span class="line">awk <span class="string">'BEGIN&#123;OFS="\t";&#125; $3=="exon" &#123;print $1,$4-1,$5&#125;'</span> | \</span><br><span class="line">sortBed | mergeBed -i - &gt;merged-exon.gff3</span><br><span class="line"><span class="comment">#比较merge前后效果</span></span><br><span class="line">cat Gossypium_hirsutum_v1.1.gene.gff3 | \</span><br><span class="line">awk <span class="string">'BEGIN&#123;OFS="\t";&#125; $3=="exon" &#123;print $1,$4-1,$5&#125;'</span> | \</span><br><span class="line">sortBed | diff - merged-exon.gff3</span><br><span class="line">7832,7833c7832</span><br><span class="line">&lt; A01   89201569        89201851</span><br><span class="line">&lt; A01   89201851        89201963</span><br><span class="line">---</span><br><span class="line">&gt; A01   89201569        89201963</span><br></pre></td></tr></table></figure></p>
<h3 id="Get_intron_regions">Get intron regions</h3><p>gff3中的intron区就是一个mRNA/gene的exon以外的区域，可通过<strong>subtractBed (Removes the portion(s) of an interval that is overlapped by another feature(s))：bedtools subtract [OPTIONS] -a <bed gff="" vcf=""> -b <bed gff="" vcf=""></bed></bed></strong>来实现。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat Gossypium_hirsutum_v1.1.gene.gff3 | \</span><br><span class="line">awk <span class="string">'BEGIN&#123;OFS="\t";&#125; $3=="gene" &#123;print $1,$4-1,$5&#125;'</span> | \</span><br><span class="line">sortBed |subtractBed -a stdin -b merged-exon.gff3 &gt;merged-intron.gff3</span><br><span class="line"><span class="comment">#比较 merged-exon.gff3 和 merged-intron.gff3</span></span><br><span class="line">head -n 4  merged-exon.gff3 merged-intron.gff3</span><br><span class="line">A01     15704   15772</span><br><span class="line">A01     16263   16319</span><br><span class="line">A01     16883   17103</span><br><span class="line">A01     17483   17623</span><br><span class="line"></span><br><span class="line">A01     15772   16263</span><br><span class="line">A01     16319   16883</span><br><span class="line">A01     17103   17483</span><br><span class="line">A01     17623   18384</span><br></pre></td></tr></table></figure></p>
<p>另外一个软件同样可以得到intron：<strong><span class="exturl" data-url="aHR0cDovL2dlbm9tZXRvb2xzLm9yZy9pbmRleC5odG1s" title="http://genometools.org/index.html">GenomeTools: a comprehensive software library for efficient processing of structured genome annotations<i class="fa fa-external-link"></i></span></strong>，<code>gt gff3 -addintrons Gossypium_hirsutum_v1.1.gene.gff3 &gt;Gh-intron.gff3</code>。</p>
<h3 id="Get_intergenic_regions">Get intergenic regions</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Intergenic_DNA.gif" alt=""><br>基因间区，即没有基因覆盖的染色体区域。<strong>complementBed：bedtools complement [OPTIONS] -i <bed gff="" vcf=""> -g <genome></genome></bed></strong>可用来查找gff3中的这些区域。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat Gossypium_hirsutum_v1.1.gene.gff3 | \</span><br><span class="line">awk <span class="string">'BEGIN&#123;OFS="\t";&#125; $3=="gene" &#123;print $1,$4-1,$5&#125;'</span> | \</span><br><span class="line">sortBed | complementBed -i stdin -g genome.fa.length&gt; merged-intergenic.gff3</span><br><span class="line"><span class="comment">#查看 intergenic regions</span></span><br><span class="line">more Gh-intergenic.gff3</span><br><span class="line">A01     0       15704</span><br><span class="line">A01     19194   22807</span><br><span class="line">A01     24529   36427</span><br><span class="line">A01     36860   40961</span><br></pre></td></tr></table></figure></p>
<p>上述mergeBed、subtractBed、complementBed操作图解如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bedtools.png" alt=""></p>
<h2 id="参考来源">参考来源</h2><li><span class="exturl" data-url="aHR0cDovL2RhdmV0YW5nLm9yZy9tdXNlLzIwMTMvMDEvMTgvZGVmaW5pbmctZ2Vub21pYy1yZWdpb25zLw==" title="http://davetang.org/muse/2013/01/18/defining-genomic-regions/">Defining genomic regions<i class="fa fa-external-link"></i></span></li>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;问题描述&quot;&gt;问题描述&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://genomevolution.org/wiki/index.php/Genomic_Feature&quot; target=&quot;_blank&quot;&gt;Genomic Feature&lt;/a&gt;&lt;/strong&gt;通常包括exon、intron、intergenic region、UpstreamToGene、UTRs等，对于有完整参考基因组物种其一般都有注释文件gff3，但其一般只有mRNA，gene和exon的坐标信息，而我们通常也需要更多的Genomic Feature信息。&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Genomic Feature" scheme="http://tiramisutes.github.io/tags/Genomic-Feature/"/>
    
  </entry>
  
  <entry>
    <title>De Nove转录组组装质量评估</title>
    <link href="http://tiramisutes.github.io/2016/10/30/Quality-Assessment.html"/>
    <id>http://tiramisutes.github.io/2016/10/30/Quality-Assessment.html</id>
    <published>2016-10-30T15:00:17.000Z</published>
    <updated>2019-03-10T03:53:44.507Z</updated>
    
    <content type="html"><![CDATA[<p>无参De Nove组装通常用到<strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RyaW5pdHlybmFzZXEvdHJpbml0eXJuYXNlcS93aWtp" title="https://github.com/trinityrnaseq/trinityrnaseq/wiki">Trinity<i class="fa fa-external-link"></i></span></strong>软件,组装过程中最重要的两个参数就是<code>--min_kmer_cov</code> 和 <code>--min_glue</code>为组装出高质量结果我们通常需要去尝试用不同的参数，github上也有软件开发者讨论关于这两个参数<strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RyaW5pdHlybmFzZXEvdHJpbml0eXJuYXNlcS9pc3N1ZXMvOTI=" title="https://github.com/trinityrnaseq/trinityrnaseq/issues/92">Optimizing parameters<i class="fa fa-external-link"></i></span></strong>可供参考，其实问题最终也就归结为你是否关心你数据中的低丰度转录本?<br>此外作者也提供了一系列方法来评估组装质量<strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RyaW5pdHlybmFzZXEvdHJpbml0eXJuYXNlcS93aWtpL1RyYW5zY3JpcHRvbWUtQXNzZW1ibHktUXVhbGl0eS1Bc3Nlc3NtZW50" title="https://github.com/trinityrnaseq/trinityrnaseq/wiki/Transcriptome-Assembly-Quality-Assessment">Transcriptome Assembly Quality Assessment<i class="fa fa-external-link"></i></span></strong>总共列出6种方法可对不同参数的组装结果进行评估,看完后综合总结出其中4种评估方法。<br><a id="more"></a></p>
<h2 id="Assessing_the_Read_Content_of_the_Transcriptome_Assembly">Assessing the Read Content of the Transcriptome Assembly</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bowtie2-build  ../trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta ../trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta</span><br><span class="line">bowtie2 --<span class="built_in">local</span> --no-unal -p <span class="variable">$&#123;cpu&#125;</span> -x  ../trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta -q -1 <span class="variable">$&#123;left&#125;</span> -2 <span class="variable">$&#123;right&#125;</span> \</span><br><span class="line">     | samtools view -Sb - | samtools sort -no - - &gt; bowtie2.nameSorted.bam</span><br><span class="line"><span class="comment">#参看proper pairs reads数量和百分比</span></span><br><span class="line"><span class="variable">$&#123;TRINITY_DIR&#125;</span>/util/SAM_nameSorted_to_uniq_count_stats.pl  bowtie2.nameSorted.bam</span><br><span class="line">grep <span class="string">"^proper_pairs"</span> Read-Representation.out</span><br></pre></td></tr></table></figure>
<p><strong>第二步的bowtie2比对序列到组装转录本结果时可选部分数据来比对，这样可大大降低比对耗时。</strong></p>
<h2 id="Full-length_transcript_analysis_for_model_and_non-model_organisms_using_BLAST+">Full-length transcript analysis for model and non-model organisms using BLAST+</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">blastall -p blastx -i ./trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta  -d <span class="variable">$&#123;uniprot&#125;</span> -v 1 -b 1 -m 8 -e 1e-5 -a <span class="variable">$&#123;cpu&#125;</span> -F F -o uniprot_sprot.fasta_blastx.outfmt8</span><br><span class="line"><span class="variable">$&#123;TRINITY_DIR&#125;</span>/util/analyze_blastPlus_topHit_coverage.pl uniprot_sprot.fasta_blastx.outfmt8 ./trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta /public/home/cotton/public_data/SwissProt/uniprot_sprot.fasta</span><br><span class="line"><span class="variable">$&#123;TRINITY_DIR&#125;</span>/util/misc/blast_outfmt6_group_segments.pl \</span><br><span class="line">      ./uniprot_sprot.fasta_blastx.outfmt8 ./trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta uniprot_sprot.fasta &gt; ./uniprot_sprot.fasta_blastx.outfmt8.grouped</span><br><span class="line"><span class="variable">$&#123;TRINITY_DIR&#125;</span>/util/misc/blast_outfmt6_group_segments.tophit_coverage.pl ./uniprot_sprot.fasta_blastx.outfmt8.grouped</span><br></pre></td></tr></table></figure>
<h2 id="Compute_DETONATE_scores">Compute DETONATE scores</h2><p>RSEM-EVAL软件对于双端reads数据需要提供一个average fragment length值，可参考我的另一篇博文<strong><a href="http://tiramisutes.github.io/2016/09/19/Insert-Size.html" target="_blank">评估文库 Average Insert Size</a></strong>来计算得到此值。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rsem-eval-estimate-transcript-length-distribution ./trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta ./RSEM-EVAL<span class="variable">$&#123;i&#125;</span>/length_distribution_parameter.txt</span><br><span class="line">rsem-eval/rsem-eval-calculate-score -p 1 \</span><br><span class="line">              --transcript-length-parameters ./RSEM-EVAL<span class="variable">$&#123;i&#125;</span>/length_distribution_parameter.txt \</span><br><span class="line">              --paired-end  --phred33 --strand-specific ../1.clean.fq ../2.clean.fq\</span><br><span class="line">              ./trinity_out_dir<span class="variable">$&#123;i&#125;</span>/Trinity.fasta \</span><br><span class="line">              hope-trinity_out_dir<span class="variable">$&#123;i&#125;</span> 300</span><br></pre></td></tr></table></figure></p>
<p>评估结果解释见：<strong><span class="exturl" data-url="aHR0cDovL2Rld2V5bGFiLmJpb3N0YXQud2lzYy5lZHUvZGV0b25hdGUvcnNlbS1ldmFsLmh0bWw=" title="http://deweylab.biostat.wisc.edu/detonate/rsem-eval.html">RSEM-EVAL: A novel reference-free transcriptome assembly evaluation measure<i class="fa fa-external-link"></i></span></strong>。</p>
<p><li>RSEM-EVAL produces the following three score related files: ‘sample_name.score’, ‘sample_name.score.isoforms.results’ and ‘sample_name.score.genes.results’.</li></p>
<p><li><code>sample_name.score</code>： stores the evaluation score for the evaluated assembly. The first lines Score the RSEM-EVAL score.</li></p>
<p><li>Higher RSEM-EVAL scores are better than lower scores. This is true despite the fact that the scores are always negative. For example, a score of -80000 is better than a score of -200000, since -80000 &gt; -200000.</li></p>
<h2 id="BUSCO_explore_completeness_according_to_conserved_ortholog">BUSCO explore completeness according to conserved ortholog</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitlab.com/ezlab/busco.git</span><br></pre></td></tr></table></figure>
<p>点击<strong><span class="exturl" data-url="aHR0cDovL2J1c2NvLmV6bGFiLm9yZy8=" title="http://busco.ezlab.org/">BUSCO官网<i class="fa fa-external-link"></i></span></strong>相应图标下载所需数据库。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/busco.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python BUSCO.py -i SEQUENCE_FILE -o OUTPUT_NAME -l LINEAGE -m tran</span><br></pre></td></tr></table></figure></p>
<p>SEQUENCE_FILE：transcript set (DNA nucleotide sequences) file in FASTA format<br>OUTPUT_NAME：name to use for the run and temporary files (appended)<br>LINEAGE：location of the BUSCO lineage data to use (e.g. fungi_odb9)<br><strong>察看结果: 在运行结果文件夹下<code>short_summary_OUTPUT_NAME.txt</code>中有如下统计信息👇</strong><br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:<span class="number">80</span>.<span class="number">0</span>%[S:<span class="number">80</span>.<span class="number">0</span>%,D:<span class="number">0</span>.<span class="number">0</span>%],F:<span class="number">0</span>.<span class="number">0</span>%,M:<span class="number">20</span>.<span class="number">0</span>%,n:<span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span> Complete <span class="keyword">BUSCOs </span>(C)</span><br><span class="line"><span class="number">8</span> Complete <span class="keyword">and </span>single-copy <span class="keyword">BUSCOs </span>(S)</span><br><span class="line"><span class="number">0</span> Complete <span class="keyword">and </span>duplicated <span class="keyword">BUSCOs </span>(D)</span><br><span class="line"><span class="number">0</span> Fragmented <span class="keyword">BUSCOs </span>(F)</span><br><span class="line"><span class="number">2</span> Missing <span class="keyword">BUSCOs </span>(M)</span><br><span class="line"><span class="number">10</span> Total <span class="keyword">BUSCO </span>groups searched</span><br></pre></td></tr></table></figure></p>
<p>也可图像化展示结果👇：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp short_summary_OUTPUT_NAME<span class="selector-class">.txt</span> ./plot</span><br><span class="line">python2.<span class="number">7</span> BUSCO_plot<span class="selector-class">.py</span> -wd ./busco/plot/</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/busco2.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;无参De Nove组装通常用到&lt;strong&gt;&lt;a href=&quot;https://github.com/trinityrnaseq/trinityrnaseq/wiki&quot; target=&quot;_blank&quot;&gt;Trinity&lt;/a&gt;&lt;/strong&gt;软件,组装过程中最重要的两个参数就是&lt;code&gt;--min_kmer_cov&lt;/code&gt; 和 &lt;code&gt;--min_glue&lt;/code&gt;为组装出高质量结果我们通常需要去尝试用不同的参数，github上也有软件开发者讨论关于这两个参数&lt;strong&gt;&lt;a href=&quot;https://github.com/trinityrnaseq/trinityrnaseq/issues/92&quot; target=&quot;_blank&quot;&gt;Optimizing parameters&lt;/a&gt;&lt;/strong&gt;可供参考，其实问题最终也就归结为你是否关心你数据中的低丰度转录本?&lt;br&gt;此外作者也提供了一系列方法来评估组装质量&lt;strong&gt;&lt;a href=&quot;https://github.com/trinityrnaseq/trinityrnaseq/wiki/Transcriptome-Assembly-Quality-Assessment&quot; target=&quot;_blank&quot;&gt;Transcriptome Assembly Quality Assessment&lt;/a&gt;&lt;/strong&gt;总共列出6种方法可对不同参数的组装结果进行评估,看完后综合总结出其中4种评估方法。&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="De Nove" scheme="http://tiramisutes.github.io/tags/De-Nove/"/>
    
  </entry>
  
  <entry>
    <title>Population Genetics</title>
    <link href="http://tiramisutes.github.io/2016/10/28/evolution.html"/>
    <id>http://tiramisutes.github.io/2016/10/28/evolution.html</id>
    <published>2016-10-28T03:02:57.000Z</published>
    <updated>2019-03-10T03:54:07.163Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Glossary">Glossary</h2><h3 id="Gene_diversity">Gene diversity</h3><p><strong>Gene diversity</strong> is a measure of the expected heterozygosity in a sample of gene copies collected at a single locus. It is a summary statistic used to represent patterns of molecular diversity within a sample of gene copies. Typically, the gene copies are allelic states such as allozymes or fragment sizes (e.g., RFLPs, AFLPs, microsatellites). The expected heterozygosity is caluclated under the assumption that the sample of gene copies was drawn from a population at <strong>Hardy-Weinberg equilibrium (HWE).</strong><br><i class="fa fa-binoculars" aria-hidden="true"></i><span class="exturl" data-url="aHR0cHM6Ly9kZW5kcm9tZS51Y2RhdmlzLmVkdS9oZWxwL3R1dG9yaWFscy9nZGl2ZXJzaXR5LnBocA==" title="https://dendrome.ucdavis.edu/help/tutorials/gdiversity.php">https://dendrome.ucdavis.edu/help/tutorials/gdiversity.php<i class="fa fa-external-link"></i></span><br><a id="more"></a></p>
<h3 id="Heterozygosity">Heterozygosity</h3><p>Heterozygosity: An individual or population-level parameter. The proportion of loci expected to be heterozygous in an individual (ranging from 0 to 1.0).<br>HO (observed heterozygosity) is the observed proportion of heterozygotes, averaged over loci.<br>HE (expected heterozygosity) is also known as gene diversity (= D; preferred, less ambiguous term) and is calculated as 1.0 minus the sum of the squared gene frequencies. [See Weir, 1996, p. 124 for the multi-locus, multi-allele formula].<br><strong> High heterozygosity means lots of genetic variability.  Low heterozygosity means little genetic variability.Often, we will compare the observed level of heterozygosity to what we expect under Hardy-Weinberg equilibrium (HWE).  If the observed heterozygosity is lower than expected, we seek to attribute the discrepancy to forces such as inbreeding.  If heterozygosity is higher than expected, we might suspect an isolate-breaking effect (the mixing of two previously isolated populations).</strong></p>
<h3 id="Haplotype">Haplotype</h3><p>A haplotype (haploid genotype) is a group of genes in an organism that are inherited together from a single parent.</p>
<h3 id="Haplotype_diversity_(h)">Haplotype diversity (h)</h3><p>Haplotype diversity is a measure of the uniqueness of a particular haplotype in a given population. The haplotype diversity (H) is computed as.</p>
<h3 id="Nucleotide_diversity_(π)">Nucleotide diversity (π)</h3><p><b>Nucleotide diversity</b> is a concept in <a href="/wiki/Molecular_genetics" title="Molecular genetics">molecular genetics</a> which is used to measure the degree of <a href="/wiki/Polymorphism_(biology)" title="Polymorphism (biology)">polymorphism</a> within a population.<br>This measure is defined as the average number of nucleotide differences per site between any two DNA sequences chosen randomly from the sample population, and is denoted by π.<br>Nucleotide diversity is a measure of genetic variation.<br><i class="fa fa-binoculars" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3N2aXRzcnYyNS5lcGZsLmNoL1ItZG9jL2xpYnJhcnkvYXBlL2h0bWwvbnVjLmRpdi5odG1s" title="http://svitsrv25.epfl.ch/R-doc/library/ape/html/nuc.div.html">http://svitsrv25.epfl.ch/R-doc/library/ape/html/nuc.div.html<i class="fa fa-external-link"></i></span><br><strong>单倍型多样度（Hd）和核苷酸多样度（Pi）是衡量一个 mtDNA 变异程度的两个重要指标，Hd 值和 Pi 值越大，多样性程度越高，遗传多样性越丰富，反之，多样性程度越低，遗传多样性越贫乏。另外，<br>mtDNA 的单倍型多样性指数也可以衡量种内的变异程度。</strong><br>更多术语见：<i class="fa fa-binoculars" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy51d3lvLmVkdS9kYm1jZC9tb2xtYXJrL21jZGdsb3NzLmh0bWw=" title="http://www.uwyo.edu/dbmcd/molmark/mcdgloss.html">Molecular Marker Glossary<i class="fa fa-external-link"></i></span><br>深入学习间：<i class="fa fa-binoculars" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy51d3lvLmVkdS9kYm1jZC9tb2xtYXJrL2luZGV4Lmh0bWw=" title="http://www.uwyo.edu/dbmcd/molmark/index.html">Genetic Markers<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Glossary&quot;&gt;Glossary&lt;/h2&gt;&lt;h3 id=&quot;Gene_diversity&quot;&gt;Gene diversity&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Gene diversity&lt;/strong&gt; is a measure of the expected heterozygosity in a sample of gene copies collected at a single locus. It is a summary statistic used to represent patterns of molecular diversity within a sample of gene copies. Typically, the gene copies are allelic states such as allozymes or fragment sizes (e.g., RFLPs, AFLPs, microsatellites). The expected heterozygosity is caluclated under the assumption that the sample of gene copies was drawn from a population at &lt;strong&gt;Hardy-Weinberg equilibrium (HWE).&lt;/strong&gt;&lt;br&gt;&lt;i class=&quot;fa fa-binoculars&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://dendrome.ucdavis.edu/help/tutorials/gdiversity.php&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://dendrome.ucdavis.edu/help/tutorials/gdiversity.php&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="genetics" scheme="http://tiramisutes.github.io/categories/genetics/"/>
    
    
      <category term="Glossary" scheme="http://tiramisutes.github.io/tags/Glossary/"/>
    
  </entry>
  
  <entry>
    <title>程序运行报错总结</title>
    <link href="http://tiramisutes.github.io/2016/10/26/script-error.html"/>
    <id>http://tiramisutes.github.io/2016/10/26/script-error.html</id>
    <published>2016-10-26T09:04:06.000Z</published>
    <updated>2019-03-10T03:54:25.059Z</updated>
    
    <content type="html"><![CDATA[<p>跑程序难免会遇到各种各样的错误，解决办法也多种多样，自此仅总结我所遇到的问题和最优的解决方案。</p>
<h2 id="R报错">R报错</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;alphaData = read.csv(<span class="string">"data.csv"</span>)</span><br><span class="line">Error: REAL() can only be applied to a <span class="string">'numeric'</span>, not a <span class="string">'integer'</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong><span class="exturl" data-url="aHR0cHM6Ly9zdXBwb3J0LmJpb2NvbmR1Y3Rvci5vcmcvcC83NjgyOS8=" title="https://support.bioconductor.org/p/76829/">解决办法<i class="fa fa-external-link"></i></span></strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alphaData = read.csv(<span class="string">"data.csv"</span>) * 1.0</span><br></pre></td></tr></table></figure></p>
<h2 id="npm报错">npm报错</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERR! Windows_NT 6.3.9600</span><br><span class="line">Error: tunneling socket could not be established, cause=connect ECONNREFUSED</span><br></pre></td></tr></table></figure>
<p><strong><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zMzE2MjU2MC9lcnJvci10dW5uZWxpbmctc29ja2V0LWNvdWxkLW5vdC1iZS1lc3RhYmxpc2hlZC1jYXVzZS1jb25uZWN0LWVjb25ucmVmdXNlZC0xMA==" title="http://stackoverflow.com/questions/33162560/error-tunneling-socket-could-not-be-established-cause-connect-econnrefused-10">解决办法<i class="fa fa-external-link"></i></span></strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#first run</span></span><br><span class="line">npm cache clean</span><br><span class="line"><span class="comment">#If there is no proxy , remove proxy config from npm</span></span><br><span class="line">npm config <span class="built_in">set</span> proxy null</span><br><span class="line">npm config <span class="built_in">set</span> https-proxy null</span><br><span class="line">npm install -g XXXX</span><br></pre></td></tr></table></figure></p>
<h2 id="python报错">python报错</h2><h3 id="1-_re模块正则匹配时报错">1. re模块正则匹配时报错</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AttributeError: <span class="string">'NoneType'</span> <span class="selector-tag">object</span> has no attribute <span class="string">'group'</span></span><br></pre></td></tr></table></figure>
<p><strong><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS96aG91amlueWkvcC8zMTU5OTAzLmh0bWw=" title="http://www.cnblogs.com/zhoujinyi/p/3159903.html">解决办法<i class="fa fa-external-link"></i></span></strong><br>写的正则表达式匹配不到任何内容，检查正则表达式正确性。</p>
<h3 id="2-_lib库报错">2. lib库报错</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">error </span>while loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure>
<p>添加python的lib库地址到环境变量即可。</p>
<h2 id="生信软件安装报错">生信软件安装报错</h2><p>make编译过程报错<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">error: </span>‘getpid’ was not declared in this scope</span><br></pre></td></tr></table></figure></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQ4MjMzOTMvbGludXgtZ2V0cGlkLXN5c3RlbS1jYWxsLWVycm9y" title="https://stackoverflow.com/questions/34823393/linux-getpid-system-call-error">解决办法<i class="fa fa-external-link"></i></span><br>添加<code>#include &lt;unistd.h&gt;</code>在相应报错的XX.cpp文件头部</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;跑程序难免会遇到各种各样的错误，解决办法也多种多样，自此仅总结我所遇到的问题和最优的解决方案。&lt;/p&gt;
&lt;h2 id=&quot;R报错&quot;&gt;R报错&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;alphaData = read.csv(&lt;span class=&quot;string&quot;&gt;&quot;data.csv&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Error: REAL() can only be applied to a &lt;span class=&quot;string&quot;&gt;&#39;numeric&#39;&lt;/span&gt;, not a &lt;span class=&quot;string&quot;&gt;&#39;integer&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="error" scheme="http://tiramisutes.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>Single Cell全基因组扩增</title>
    <link href="http://tiramisutes.github.io/2016/10/13/single-cell.html"/>
    <id>http://tiramisutes.github.io/2016/10/13/single-cell.html</id>
    <published>2016-10-13T12:44:53.000Z</published>
    <updated>2018-09-28T02:44:16.408Z</updated>
    
    <content type="html"><![CDATA[<p>单细胞测序得以实现或者测序质量的提升得益于whole-genome amplification (WGA)，WGA方法存在较大的扩增偏好性（<strong>偏好性来源于序列本身GC含量和非线性扩增过程</strong>），导致低的基因组覆盖度；</p>
<h2 id="全基因组扩增WGA">全基因组扩增WGA</h2><p>目前主要存在有三种扩增方法：<br>简并寡核苷酸引物PCR扩增（DOP-PCR）、多重置换扩增反应（MDA）、置换预扩增和PCR扩增的组合（MALBAC）三种技术，各有优缺点。这些扩增方法可以把单细胞中pg级甚至fg级的DNA扩增至可满足测序的μg级样品量，正是这些技术的发明才使单细胞基因组测序成为可能。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wga.png" alt=""><br><a id="more"></a></p>
<h3 id="DOP-PCR">DOP-PCR</h3><p><strong>Pure PCR-based amplification(DOP-PCR)：</strong>基于PCR的WGA用随机引物进行指数扩增，这一过程对不同的扩增序列会产生较大的影响。</p>
<h3 id="MDA">MDA</h3><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Single_cell_sequencing_%EF%BC%88MDA%EF%BC%89.JPG/800px-Single_cell_sequencing_%EF%BC%88MDA%EF%BC%89.JPG" alt=""><br><strong>Isothermal amplification(MDA)：</strong>利用随机六碱基引物在多个位点与模板DNA退火，接下来在高扩增效率和保真性的Phi29DNA聚合酶在DNA的多个位点同时起始复制，它沿着DNA模板合成DNA,同时取代模板的互补链。被置换的互补链又成为新的模板来进行扩增，因此最终我们可以获得大量高分子量的DNA。<strong>MDA虽然利用随机引物和链置换的ϕ29聚合酶在等温条件下扩增，相较于基于PCR的扩增能够降低序列本身GC含量造成的偏好性，对扩增覆盖度有较大提升，但依然是非线性的扩增，所以还是有较大的偏好性。</strong></p>
<p><blockquote><p>Φ29  ：一种具有较高连续合成能力以及链置换的DNA聚合酶，它具有3’-5’外切酶(校正)活性。Φ29 DNA聚合酶不耐高温，65℃下放置10分钟方可使它失活。该酶对于模板有很强的模板结合能力，能连续扩增100Kb的DNA模板而不从模板上解离。同时这种酶具有3’—5’外切酶活性，可以保证扩增的高保真性。</p></blockquote></p>
<h3 id="MALBAC">MALBAC</h3><p><strong>Multiple annealing and looping-based amplification cycles(MALBAC)：</strong>通过拟线性的预扩增来降低非线性扩增的偏好性。</p>
<h3 id="MALBAC扩增原理">MALBAC扩增原理</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/malbac.png" alt=""></p>
<p><li>首先，单细胞双链DNA在94℃变性成单链，随后在0℃时随机引物（包含有27个碱基的共有序列和8个变异碱基）均匀的结合到单链DNA模版上；</li></p>
<p><li>65℃时链置换DNA聚合酶用来生成不同长度序列（0.5到1.5kb）的半扩增产物(semi-amplicon)，随后在94℃变性成单链从模版上脱离。</li></p>
<p><li>在随后的5个温度的循环中，对半扩增产物进行进一步的扩增来产生完整扩增产物(full-amplicons)，且完整扩增产物的5’端和3’端互补。</li></p>
<p><li>温度降到58℃进行完整扩增产物的环化，同时并防止进一步扩增和序列的杂交。</li></p>
<p><li>半扩增产物和基因组DNA则继续循环来生成完整扩增产物。</li></p>
<p><li>环化的完整扩增产物即完成拟线性的预扩增过程，随后进行PCR的指数扩增。在PCR扩增过程中与MALBAC引物27个共有序列相同的寡聚核苷酸作为引物。</li><br><span class="myCode">扩增巧妙之处</span></p>
<p><li><strong>只有以半扩增产物为模版才能产生两端互补的完整扩增产物，完成预扩增。</strong></li></p>
<h2 id="扩增效果比较">扩增效果比较</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wga2.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;单细胞测序得以实现或者测序质量的提升得益于whole-genome amplification (WGA)，WGA方法存在较大的扩增偏好性（&lt;strong&gt;偏好性来源于序列本身GC含量和非线性扩增过程&lt;/strong&gt;），导致低的基因组覆盖度；&lt;/p&gt;
&lt;h2 id=&quot;全基因组扩增WGA&quot;&gt;全基因组扩增WGA&lt;/h2&gt;&lt;p&gt;目前主要存在有三种扩增方法：&lt;br&gt;简并寡核苷酸引物PCR扩增（DOP-PCR）、多重置换扩增反应（MDA）、置换预扩增和PCR扩增的组合（MALBAC）三种技术，各有优缺点。这些扩增方法可以把单细胞中pg级甚至fg级的DNA扩增至可满足测序的μg级样品量，正是这些技术的发明才使单细胞基因组测序成为可能。&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wga.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Single-cell" scheme="http://tiramisutes.github.io/categories/Single-cell/"/>
    
    
      <category term="WGA" scheme="http://tiramisutes.github.io/tags/WGA/"/>
    
  </entry>
  
  <entry>
    <title>为期3天2016全国植物生物学大会报告有感</title>
    <link href="http://tiramisutes.github.io/2016/10/11/phytobiology.html"/>
    <id>http://tiramisutes.github.io/2016/10/11/phytobiology.html</id>
    <published>2016-10-11T13:06:56.000Z</published>
    <updated>2018-09-28T02:40:41.823Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/313110974848825138.jpg" alt=""><br>由武大主办的为期3天的2016全国植物生物学大会于2016年10月10号在欧亚达国际酒店召开，有这些大牛云集助阵，会议质量也不枉费1500￥；<br><a id="more"></a><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/member.png" alt=""><br>会议涉及到植物激素，逆境，发育，表观遗传，基因组，代谢等，有植物生物学中的研究热点，也有部分看似较冷，但很有意思，有基础研究，也有接近生活，涉及范围之广也让我见识到前所未有的一些全新内容；<br>能听/看到以前在百度看到的那些大牛讲报告，感受下他们的气场，也算是一种荣幸；<br>会议内容很精彩，ppt也很漂亮，真想要得到他们的全部ppt看看……~……<br>部分我能记得的，比较新颖的内总简单总结下。</p>
<h2 id="DNA甲基化动态平衡">DNA甲基化动态平衡</h2><p>朱健康院士的报告，内容自然很精彩了；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/jiajihua.jpg" alt=""></p>
<h2 id="水稻白金级基因组">水稻白金级基因组</h2><p>张启发院士与汕优63年的苦恋，为解析珍汕97A与明恢63杂交组合的优势所在特打造白金级基因组，为水稻的研究提供基因组指导。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/zhang.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/zhang2.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/zhang3.png" alt=""></p>
<h2 id="四倍体棉花进化">四倍体棉花进化</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cotton.png" alt=""><br>南京农业大学的张天真教授在文章<span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNDczNzA3Ni8=" title="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4737076/">Integrated mapping and characterization of the gene underlying the okra leaf trait in Gossypium hirsutum L<i class="fa fa-external-link"></i></span>中通过叶形来讲述的四倍体棉花经历多次杂交的进化过程。</p>
<h2 id="棉花纤维发育">棉花纤维发育</h2><p>华中农业大学的张献龙教授讲述了调控纤维发育的表观调控过程。<br><img src="http://nar.oxfordjournals.org/content/44/9/F1.medium.gif" alt=""></p>
<h2 id="比较代谢组学">比较代谢组学</h2><p>华中农业大学的罗杰教授无疑的目前国际上做植物代谢的大牛级人物，独创的水稻和玉米比较代谢组，利用水稻定位区间的高效应（曼哈顿图中大于阀值的显著位点）但低分辨率（一个定位区间有好几个基因）与玉米低效应但高精度（定位区间基因较少，甚至是单基因）的互补，通过比较共线性定位区间的互补来解析控制代谢物基因。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/meta.png" alt=""><br><strong>图注：Co-linear genomic regions and homologous loci (or genes) of di-C, C-pentosyl-apigenin between rice grains and maize kernels.</strong><br>详细内容见NC文章：<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25jb21tczEyNzY3" title="http://www.nature.com/articles/ncomms12767">Comparative and parallel genome-wide association studies for metabolic and agronomic traits in cereals<i class="fa fa-external-link"></i></span></p>
<h2 id="植物单细胞测序">植物单细胞测序</h2><p>华中农业大学的严建兵教授2015年NC文章Dissecting meiotic recombination based on tetrad analysis by single-microspore sequencing in maize开创了植物中单细胞测序的先河，通过分离四分体时期的单细胞并测序在玉米中研究遗传重组过程，发现<strong>在玉米中基因的3’和5’端UTR是重组热区；重组的发生存在染色体和染色单体干涉；非重组的交换(NCO)远大于重组交换(CO)</strong>。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sing%20cell.png" alt=""></p>
<h2 id="PPR蛋白">PPR蛋白</h2><p> PPR（pentatricopeptide repeat）蛋白是广泛分布于各类生物当中一大类蛋白家族，在高等植物叶绿体和线粒体当中尤其种类丰富，比如拟南芥和玉米中各有四百多种PPR蛋白。PPR蛋白对单链RNA具有序列特异性识别模式，与RNA的转录、剪切、编辑、和稳定性等过程都密切相关。<br> PPR蛋白的RNA结合模式与已知的RNA结合蛋白均不同。PPR蛋白由多个PPR重复单元组成，大多数情况下，一个经典的PPR重复单元含有35个氨基酸，每一个重复单元可以特异性地识别一个RNA碱基。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ppr.jpg" alt=""></p>
<h2 id="水稻中的重金属代谢">水稻中的重金属代谢</h2><p>南京农业大学的赵方杰教授主要从事水稻中重金属铬和砷的研究，之前听过一个华裔日本人讲过他在水稻重金属中的工作，当时听了感觉这样的研究很有意义，听到国内也有人做这方面的工作还是很欣慰的，他讲述了中国水稻与重金属一个掺不忍睹的画面，比如取样湖南，xx%超标，xx%严重超标，害怕查水表就不爆数字了。<br><strong>那么水稻中为什么会有这么多的重金属积累？除了与水污染，化肥的过度使用外也与水稻自身的特性有重要关系。水稻中含量最高的元素是si，大约占60%（如果我没记错的话），同时水稻生长在淹水的环境中，根系周围的重金属砷氧化呈三价态砷，而三价砷与si结构极为相似，水稻在对si吸收旺盛的同时也吸收了大量三价砷，旱稻则不存在这种问题；其次在土壤微生物的作用下砷可以甲基化成二甲基砷(DMA)被水稻根系吸收，引起水稻病害，赵教授的研究团队也发现了在这种土壤中同样存在另一种微生物可以将甲基化的DMA去甲基化。</strong></p>
<h2 id="Alernative_polyadenylation">Alernative polyadenylation</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DMzE5NDAwNS8=" title="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3194005/">Mechanisms and consequences of alternative polyadenylation<i class="fa fa-external-link"></i></span><br>这是我们传统教科书上关于成熟mRNA的认识，标准的5’帽子和3’ Poly(A)尾巴。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/APA2.png" alt=""><br><strong>但是，来自厦门大学环境与生态学院的<span class="exturl" data-url="aHR0cDovL3d3dy53YXRlcjg4NDguY29tL25ld3MvMjAxMzEwLzA5Lzk0MjkuaHRtbA==" title="http://www.water8848.com/news/201310/09/9429.html">李庆顺<i class="fa fa-external-link"></i></span>教授告诉我们：原来这个3’ Poly(A)尾巴也存在选择性，对于单个基因，它可以选择在转录子的不同位置加Poly(A)尾巴从而产生长短不一的转录本，对转录本的功能如编码功能、稳定性、可翻译性等都产生重要影响，在转录水平极大的提高了基因转录调控的多样性。</strong><br><strong>在mRNA中存在70%选择性Poly(A)位点，Poly(A)可以加到5’和3’端，也可以加到内含子区（这就涉及到内含子的剪切和加A，内含子被剪切后进行加A），若加到5’端则基因失去功能；</strong><br><strong>同时，如下，在一个成熟mRNA的3’UTR区存在有较多的特异位点：</strong><br><strong>推荐一篇文章：<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25ybS9qb3VybmFsL3Zhb3AvbmN1cnJlbnQvZnVsbC9ucm0uMjAxNi4xMTYuaHRtbA==" title="http://www.nature.com/nrm/journal/vaop/ncurrent/full/nrm.2016.116.html">Alternative polyadenylation of mRNA precursors<i class="fa fa-external-link"></i></span></strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/APA.png" alt=""></p>
<h2 id="解决PacBio数据分析耗时问题">解决PacBio数据分析耗时问题</h2><p>深圳农业基因所的阮珏教授正在开发的<strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3J1YW5qdWUvd3RkYmc=" title="https://github.com/ruanjue/wtdbg">wtdbg<i class="fa fa-external-link"></i></span></strong>软件，其目标在于大幅度降低现有软件对PacBio数据组装的高配置和耗时长的缺陷。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wtdbg.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wtdbg2.png" alt=""></p>
<h2 id="昆虫与植物的分子互作">昆虫与植物的分子互作</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/he.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/he2.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/he3.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/313110974848825138.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;由武大主办的为期3天的2016全国植物生物学大会于2016年10月10号在欧亚达国际酒店召开，有这些大牛云集助阵，会议质量也不枉费1500￥；&lt;br&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ggplot2 2.2.0更新简要</title>
    <link href="http://tiramisutes.github.io/2016/10/06/new-ggplot2-2-2-0.html"/>
    <id>http://tiramisutes.github.io/2016/10/06/new-ggplot2-2-2-0.html</id>
    <published>2016-10-06T05:04:09.000Z</published>
    <updated>2016-10-06T07:02:46.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ggplot2</strong>迎来更新，最新版本为2.2.0，同时也带来一些功能上是改进，详细原文见：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnJzdHVkaW8ub3JnLzIwMTYvMDkvMzAvZ2dwbG90Mi0yLTItMC1jb21pbmctc29vbi8=" title="https://blog.rstudio.org/2016/09/30/ggplot2-2-2-0-coming-soon/">ggplot2 2.2.0 coming soon!<i class="fa fa-external-link"></i></span><br><strong>最新版安装：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"devtools"</span>)</span><br><span class="line">devtools::install_github(<span class="string">"hadley/ggplot2"</span>)</span><br></pre></td></tr></table></figure></p>
<p>主要更新内容如下：</p>
<h2 id="Subtitles_and_captions（副标题和题注）">Subtitles and captions（副标题和题注）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(displ, hwy)) +</span><br><span class="line">  geom_point(aes(color = class)) +</span><br><span class="line">  geom_smooth(se = FALSE, method = <span class="string">"loess"</span>) +</span><br><span class="line">  labs(</span><br><span class="line">    title = <span class="string">"Fuel efficiency generally decreases with engine size"</span>,</span><br><span class="line">    subtitle = <span class="string">"Two seaters (sports cars) are an exception because of their light weight"</span>,</span><br><span class="line">    caption = <span class="string">"Data from fueleconomy.gov"</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<p><img src="https://rstudioblog.files.wordpress.com/2016/09/unnamed-chunk-3-1.png?w=490" alt=""><br>注：title现在默认为左对齐，想要居中，设置<span class="myCode">theme(plot.title = element_text(hjust = 0.5))</span></p>
<h2 id="Facets分面">Facets分面</h2><p>个人认为这个功能在ggplot2中效果不眨地，效果也不好，还不如坐标轴截断实际，但文章中认为坐标轴截断不科学-……—</p>
<h2 id="坐标轴修改">坐标轴修改</h2><h3 id="改变坐标轴位置">改变坐标轴位置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(displ, hwy)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  scale_x_continuous(position = <span class="string">"top"</span>) + </span><br><span class="line">  scale_y_continuous(position = <span class="string">"right"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="添加双坐标轴sec-axis">添加双坐标轴sec.axis</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(displ, hwy)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  scale_y_continuous(</span><br><span class="line">    <span class="string">"mpg (US)"</span>, </span><br><span class="line">    sec.axis = sec_axis(~ . * 1.20, name = <span class="string">"mpg (UK)"</span>)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<h2 id="主题">主题</h2><p>还记得以前画图时坐标轴间那挥之不去的空白吗，Now，他将不复存在。</p>
<h3 id="箭头坐标轴element_line()">箭头坐标轴element_line()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义箭头</span></span><br><span class="line">arrow &lt;- arrow(length = unit(0.4, <span class="string">"cm"</span>), <span class="built_in">type</span> = <span class="string">"closed"</span>)</span><br><span class="line"></span><br><span class="line">ggplot(mpg, aes(displ, hwy)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  theme_minimal() + </span><br><span class="line">  theme(</span><br><span class="line">    axis.line = element_line(arrow = arrow)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<h3 id="图例修改">图例修改</h3><p>图例可以与图形区对齐和添加外框。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(displ, hwy, shape = drv, colour = fl)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  theme(</span><br><span class="line">    legend.justification = <span class="string">"top"</span>, </span><br><span class="line">    legend.box.margin = margin(3, 3, 3, 3, <span class="string">"mm"</span>), </span><br><span class="line">    legend.box.background = element_rect(colour = <span class="string">"grey50"</span>)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p>
<p>注：panel.margin and legend.margin 重命名为 panel.spacing and legend.spacing 。</p>
<h2 id="bars型图修改">bars型图修改</h2><p>新增<code>geom_col()</code>函数，相当于<code>geom_bar(stat = “identity”)</code>。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;ggplot2&lt;/strong&gt;迎来更新，最新版本为2.2.0，同时也带来一些功能上是改进，详细原文见：&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9ibG9nLnJzdHVkaW8ub3JnLzIwMTYvMDkvMz
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="ggplot2" scheme="http://tiramisutes.github.io/tags/ggplot2/"/>
    
  </entry>
  
  <entry>
    <title>awk对table的统计计算</title>
    <link href="http://tiramisutes.github.io/2016/10/01/table-stats.html"/>
    <id>http://tiramisutes.github.io/2016/10/01/table-stats.html</id>
    <published>2016-10-01T09:28:19.000Z</published>
    <updated>2016-10-13T15:27:01.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="第三列相同时，第四列累加">第三列相同时，第四列累加</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; \</span></span><br><span class="line"><span class="string">NR&gt;1 \</span></span><br><span class="line"><span class="string">&#123;a[$3]+=$4&#125; \</span></span><br><span class="line"><span class="string">END &#123;for (i in a) &#123;print i,a[i]&#125;&#125;'</span> text.txt | sort</span><br></pre></td></tr></table></figure>
<p><strong>awk中的数组由一对字符串组成，第一个字符串是<code>‘index’</code>,第二个是index所对应的<code>value</code>，<code>a[$3]+=$4</code>中的index来自第三列，value是第四列相应值的累加。</strong><br><strong>用asorti在awk中排序</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; \</span></span><br><span class="line"><span class="string">NR&gt;1 \</span></span><br><span class="line"><span class="string">&#123;a[$3]+=$4&#125; \</span></span><br><span class="line"><span class="string">END &#123;n=asorti(a,b);for (i=1;i&lt;=n;i++) &#123;print b[i],a[b[i]]&#125;&#125;'</span> text.txt</span><br></pre></td></tr></table></figure></p>
<h2 id="依据第三列和第二列，第四列累加">依据第三列和第二列，第四列累加</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; \</span></span><br><span class="line"><span class="string">NR&gt;1 \</span></span><br><span class="line"><span class="string">&#123;a[$3$2]+=$4&#125; \</span></span><br><span class="line"><span class="string">END &#123;n=asorti(a,b);for (i=1;i&lt;=n;i++) &#123;print b[i],a[b[i]]&#125;&#125;'</span> text.txt</span><br></pre></td></tr></table></figure>
<h2 id="第三列相同时，第四列的最大值">第三列相同时，第四列的最大值</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">'&#123;if (a[$1] &lt; $2)a[$1]=$2;&#125;END&#123;for(i in a)&#123;print i,a[i];&#125;&#125;'</span> OFS=, file.txt</span><br></pre></td></tr></table></figure>
<h2 id="第三列相同值计数">第三列相同值计数</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">'&#123;a[$1]++;&#125;END&#123;for (i in a)print i, a[i];&#125;'</span> file.txt</span><br></pre></td></tr></table></figure>
<h2 id="第三列相同时，仅输出第四列第一个值">第三列相同时，仅输出第四列第一个值</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">'!a[$1]++'</span> file.txt</span><br></pre></td></tr></table></figure>
<h2 id="第三列相同时，第四列的所有值并未一行">第三列相同时，第四列的所有值并未一行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">'&#123;if(a[$1])a[$1]=a[$1]":"$2; else a[$1]=$2;&#125;END&#123;for (i in a)print i, a[i];&#125;'</span> OFS=, file.txt</span><br></pre></td></tr></table></figure>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3d3dy50aGVsaW51eHJhaW4uY29tL2FydGljbGVzL2EtcGl2b3QtdGFibGUtaW4tYXdr" title="http://www.thelinuxrain.com/articles/a-pivot-table-in-awk">A Pivot Table In AWK<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy50aGV1bml4c2Nob29sLmNvbS8yMDEyLzA2L2F3ay0xMC1leGFtcGxlcy10by1ncm91cC1kYXRhLWluLWNzdi1vci5odG1s" title="http://www.theunixschool.com/2012/06/awk-10-examples-to-group-data-in-csv-or.html">awk - 10 examples to group data in a CSV or text file<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;第三列相同时，第四列累加&quot;&gt;第三列相同时，第四列累加&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;spa
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="shell" scheme="http://tiramisutes.github.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>命令行生成数列：{}和seq</title>
    <link href="http://tiramisutes.github.io/2016/10/01/seq-num.html"/>
    <id>http://tiramisutes.github.io/2016/10/01/seq-num.html</id>
    <published>2016-10-01T08:59:45.000Z</published>
    <updated>2016-10-01T09:25:35.000Z</updated>
    
    <content type="html"><![CDATA[<p><strong>如何在命令行上产生一列数字呢？</strong></p>
<p><li><span class="myCode">{START..END..INCREMENT}</span></li></p>
<p><li><span class="myCode">{1..3}{a..c}</span></li></p>
<p><li><span class="myCode">seq -s ‘,’ START INCREMENT END</span>,使用方式<span class="myCode">$(seq -s ‘,’ START INCREMENT END)</span></li><br>在<strong>awk</strong>中的使用技巧：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"$"</span>$(seq -s <span class="string">',$'</span> 20)</span><br><span class="line"><span class="variable">$1</span>,<span class="variable">$2</span>,<span class="variable">$3</span>,<span class="variable">$4</span>,<span class="variable">$5</span>,<span class="variable">$6</span>,<span class="variable">$7</span>,<span class="variable">$8</span>,<span class="variable">$9</span>,<span class="variable">$10</span>,<span class="variable">$11</span>,<span class="variable">$12</span>,<span class="variable">$13</span>,<span class="variable">$14</span>,<span class="variable">$15</span>,<span class="variable">$16</span>,<span class="variable">$17</span>,<span class="variable">$18</span>,<span class="variable">$19</span>,<span class="variable">$20</span></span><br></pre></td></tr></table></figure></p>
<p><strong>More：</strong><span class="exturl" data-url="aHR0cDovL3d3dy50aGVsaW51eHJhaW4uY29tL2FydGljbGVzL2J1aWxkaW5nLXNlcXVlbmNlcy1vZi1udW1iZXJzLW9uLXRoZS1jb21tYW5kLWxpbmU=" title="http://www.thelinuxrain.com/articles/building-sequences-of-numbers-on-the-command-line">http://www.thelinuxrain.com/articles/building-sequences-of-numbers-on-the-command-line<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;如何在命令行上产生一列数字呢？&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;li&gt;&lt;span class=&quot;myCode&quot;&gt;{START..END..INCREMENT}&lt;/span&gt;&lt;/li&gt;&lt;/p&gt;
&lt;p&gt;&lt;li&gt;&lt;span class=&quot;myCode&quot;&gt;{1..
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="shell" scheme="http://tiramisutes.github.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>文本的转置</title>
    <link href="http://tiramisutes.github.io/2016/10/01/table-trans.html"/>
    <id>http://tiramisutes.github.io/2016/10/01/table-trans.html</id>
    <published>2016-10-01T08:23:39.000Z</published>
    <updated>2016-10-01T08:51:21.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="data:image/jpeg;base64,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"><br><strong>实现文本转置的三种方法</strong><br><a id="more"></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'&#123;for(i=1;i&lt;=NF;i++)&#123;a[FNR,i]=$i&#125;&#125;END&#123;for(i=1;i&lt;=NF;i++)&#123;for(j=1;j&lt;=FNR;j++)&#123;printf a[j,i]" "&#125;print ""&#125;&#125;'</span> test.txt</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ cat transpose.awk</span><br><span class="line"><span class="meta">#! /bin/sh</span></span><br><span class="line"><span class="built_in">exec</span> awk <span class="string">'</span></span><br><span class="line"><span class="string">NR==1 &#123;</span></span><br><span class="line"><span class="string">  n=NF</span></span><br><span class="line"><span class="string">  for (i=1;i&lt;=NF;i++)</span></span><br><span class="line"><span class="string">       row[i]=$i</span></span><br><span class="line"><span class="string">  next</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">   if (NF&gt;n)</span></span><br><span class="line"><span class="string">       n=NF</span></span><br><span class="line"><span class="string">   for (i=1;i&lt;=NF;i++)</span></span><br><span class="line"><span class="string">       row[i]=row[i] " " $i</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">END &#123;</span></span><br><span class="line"><span class="string">    for (i=1;i&lt;=n;i++)</span></span><br><span class="line"><span class="string">	     print row[i]</span></span><br><span class="line"><span class="string">&#125;'</span> <span class="variable">$&#123;1+"$@"&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cat trans.sh </span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">numc=$(($(head -n 1 <span class="string">"<span class="variable">$1</span>"</span> | grep -o <span class="string">"<span class="variable">$2</span>"</span> | wc -l)+1))</span><br><span class="line"><span class="keyword">for</span> ((i=1; i&lt;=<span class="string">"<span class="variable">$numc</span>"</span>; i++))</span><br><span class="line"><span class="keyword">do</span> cut -d <span class="string">"<span class="variable">$2</span>"</span> -f<span class="string">"<span class="variable">$i</span>"</span> <span class="string">"<span class="variable">$1</span>"</span> | paste -s -d <span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">$ trans.sh 需要转置文件 分隔符</span><br></pre></td></tr></table></figure>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3d3dy50aGVsaW51eHJhaW4uY29tL2FydGljbGVzL3RyYW5zcG9zaW5nLXJvd3MtYW5kLWNvbHVtbnMtMy1tZXRob2Rz" title="http://www.thelinuxrain.com/articles/transposing-rows-and-columns-3-methods">Transposing rows and columns: 3 methods<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;data:image/jpeg;base64,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&quot;&gt;&lt;br&gt;&lt;strong&gt;实现文本转置的三种方法&lt;/strong&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="shell" scheme="http://tiramisutes.github.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>table按条件合并</title>
    <link href="http://tiramisutes.github.io/2016/10/01/table-join.html"/>
    <id>http://tiramisutes.github.io/2016/10/01/table-join.html</id>
    <published>2016-10-01T07:10:29.000Z</published>
    <updated>2017-05-21T08:43:16.383Z</updated>
    
    <content type="html"><![CDATA[<p>a.txt的第三列按照2.txt替换<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat a.txt</span><br><span class="line">1	h	1	hhh</span><br><span class="line">2	k	3	uytfd</span><br><span class="line">3	d	2	gfsr</span><br><span class="line">4	f	3	jdgk</span><br><span class="line">cat b.txt</span><br><span class="line">1	a</span><br><span class="line">2	b</span><br><span class="line">3	c</span><br><span class="line">cat 预期结果</span><br><span class="line">1	h	a	hhh</span><br><span class="line">2	k	c	uytfd</span><br><span class="line">3	d	b	gfsr</span><br><span class="line">4	f	c	jdgk</span><br></pre></td></tr></table></figure></p>
<h2 id="join版">join版</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">join -t$<span class="string">'\t'</span> -o 1.1 1.2 2.2 1.4 -1 3 -2 1 &lt;(sort -k3 a.txt) b.txt | sort -n -k1</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-bullhorn" aria-hidden="true"></i>join命令：<br><code>join -1 &lt;file_1_field&gt; -2 &lt;file_2_field&gt; &lt;file_1&gt; &lt;file_2&gt;</code><br>-a<1或2>   除了显示原来的输出内容之外，还显示指令文件中没有相同栏位的行。<br>-i或—igore-case   比较栏位内容时，忽略大小写的差异。<br>-t&lt;字符&gt;   使用栏位的分隔字符。 </1或2></p>
<h2 id="awk版">awk版</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN&#123;FS=OFS=" "&#125; NR==FNR &#123;a[$1]=$2;next&#125;&#123;print $1,$2,a[$3],$4&#125;'</span> b.txt a.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;a.txt的第三列按照2.txt替换&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="shell" scheme="http://tiramisutes.github.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>添加系列表头的多种方法</title>
    <link href="http://tiramisutes.github.io/2016/10/01/table-add.html"/>
    <id>http://tiramisutes.github.io/2016/10/01/table-add.html</id>
    <published>2016-10-01T02:05:31.000Z</published>
    <updated>2016-10-01T07:54:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="想要在某文本开头_或/和_结尾添加一行？">想要在某文本开头 或/和 结尾添加一行？</h2><h3 id="awk版">awk版</h3><p><strong><code>BEGIN</code></strong>在开头添加，<strong><code>END</code></strong>在结尾添加；<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'BEGIN&#123;print "START"&#125;; &#123;print&#125;; END&#123;print "END"&#125;'</span></span><br></pre></td></tr></table></figure></p>
<h3 id="sed版">sed版</h3><p>sed用 <code>1</code>来匹配第一行，<code>i</code>执行插入操作，<code>$</code>匹配最后一行，<code>a</code>执行追加，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e $<span class="string">'1i\\\nSTART'</span> -e $<span class="string">'$a\\\nEND'</span></span><br></pre></td></tr></table></figure></p>
<h3 id="echo版">echo版</h3><p>在管道 <code>|</code>操作符中用<code>{命令1;命令2;命令3…}</code>来执行多个命令并告诉程序这是单个复合命令。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">content-generator |</span><br><span class="line">&#123; <span class="built_in">echo</span> START; cat; <span class="built_in">echo</span> END; &#125; |</span><br><span class="line">postprocessor</span><br></pre></td></tr></table></figure></p>
<h2 id="忽视第一行">忽视第一行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#head打印第一行，tail生成其他行来排序</span></span><br><span class="line">head -n 1 table.txt &amp;&amp; tail -n +2 table.txt | sort -nr -k1</span><br><span class="line"><span class="comment">#首先将第一行存储到一个变量中</span></span><br><span class="line">foo=$(head -n 1 table); <span class="built_in">echo</span> -e <span class="string">"<span class="variable">$foo</span>"</span>; tail -n +2 table | sort -nr -k1</span><br></pre></td></tr></table></figure>
<h2 id="忽略第一行，从第二行开始添加行号">忽略第一行，从第二行开始添加行号</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo=$(head -n 1 table); <span class="built_in">echo</span> -e <span class="string">"Record\t<span class="variable">$foo</span>"</span>; tail -n +2 table | nl | sed <span class="string">'s/^[ ]*//'</span></span><br></pre></td></tr></table></figure>
<h2 id="删除第一行">删除第一行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'NR!=1'</span></span><br><span class="line">awk <span class="string">'NR&gt;1'</span></span><br><span class="line">tail -n +2</span><br><span class="line">sed <span class="string">'1d'</span></span><br></pre></td></tr></table></figure>
<h2 id="添加系列多表头">添加系列多表头</h2><p>如需添加<span class="myCode">M1,M2….M2016</span>，一系列由字母和数字组合的表头？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> M&#123;1..2016&#125;; cat text.txt</span><br></pre></td></tr></table></figure></p>
<h2 id="在指定位置插入一列并赋值">在指定位置插入一列并赋值</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;$3=NR==1?"add" OFS $3:"hope" OFS $3&#125; 1'</span> OFS=<span class="string">"\t\t"</span> text.txt</span><br></pre></td></tr></table></figure>
<h2 id="按第一列将文件拆分并添加表头">按第一列将文件拆分并添加表头</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat mainfile.txt</span><br><span class="line">file1	abc	def	xyz</span><br><span class="line">file1	aaa	pqr	xyz</span><br><span class="line">file2	lmn	ghi	xyz</span><br><span class="line">file2	bbb	tuv	xyz</span><br><span class="line"><span class="comment">#单纯的按照第一列分隔文件</span></span><br><span class="line">awk <span class="string">'&#123;FILENAME=$1; print &gt;&gt;FILENAME&#125;'</span> mainfile.txt</span><br><span class="line">awk -F <span class="string">'\t'</span> <span class="string">'&#123;if(FILENAME!=$1)&#123;FILENAME=$1;print "Name \t State \t Country" &gt; FILENAME&#125;&#125; &#123;print $2 "\t" $3 "\t" $4 &gt; FILENAME&#125;'</span>  mainfile.txt</span><br><span class="line">cat file1</span><br><span class="line">Name	 State	Country</span><br><span class="line">abc	 def	        xyz</span><br><span class="line">aaa	 pqr 	        xyz</span><br><span class="line">cat file2</span><br><span class="line">Name	 State	Country</span><br><span class="line">lmn	 ghi	        xyz    </span><br><span class="line">bbb	 tuv	        xyz</span><br></pre></td></tr></table></figure>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3d3dy50aGVsaW51eHJhaW4uY29tL2FydGljbGVzL3RoZS1oZWFkZXItbGluZS1ob3ctdG8tYWRkLWRlbGV0ZS1hbmQtaWdub3JlLWl0" title="http://www.thelinuxrain.com/articles/the-header-line-how-to-add-delete-and-ignore-it">The header line: how to add, delete and ignore it<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy51bml4LmNvbS9zaGVsbC1wcm9ncmFtbWluZy1hbmQtc2NyaXB0aW5nLzE4MDE0Ny1hZGRpbmctaGVhZGVyLXN1Yi1maWxlcy1hZnRlci1zcGxpdHRpbmctbWFpbi1maWxlLXVzaW5nLWF3ay5odG1s" title="http://www.unix.com/shell-programming-and-scripting/180147-adding-header-sub-files-after-splitting-main-file-using-awk.html">Adding header to sub files after splitting the main file using AWK Shell Programming and Scripting<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;想要在某文本开头_或/和_结尾添加一行？&quot;&gt;想要在某文本开头 或/和 结尾添加一行？&lt;/h2&gt;&lt;h3 id=&quot;awk版&quot;&gt;awk版&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;BEGIN&lt;/code&gt;&lt;/strong&gt;在开头添加，&lt;strong&gt;&lt;code&gt;END&lt;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="shell" scheme="http://tiramisutes.github.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>R-Data-Science</title>
    <link href="http://tiramisutes.github.io/2016/09/29/R-Data-Science.html"/>
    <id>http://tiramisutes.github.io/2016/09/29/R-Data-Science.html</id>
    <published>2016-09-29T05:39:15.000Z</published>
    <updated>2018-09-28T02:42:59.130Z</updated>
    
    <content type="html"><![CDATA[<p>本内容是基于<span class="exturl" data-url="aHR0cDovL3I0ZHMuaGFkLmNvLm56Lw==" title="http://r4ds.had.co.nz/"><strong>R for Data Science</strong><i class="fa fa-external-link"></i></span>的学习总结；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cover.png" alt=""></p>
<h2 id="ggplot2的数据可视化">ggplot2的数据可视化</h2><h3 id="基本绘图">基本绘图</h3><p>ggplot2画图基本模型如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = &lt;DATA&gt;) +    <span class="comment">#生成一个空的图</span></span><br><span class="line">  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))  <span class="comment">#增加一个图层，其中涉及参数仅用于这一图层</span></span><br></pre></td></tr></table></figure></p>
<p>GEOM_FUNCTION可划分为展示单变量，两个变量和三变量，连续型或离散型变量；<br>在ggplot2 中每一个<strong>GEOM_FUNCTION</strong>函数都包含有一个<code>mapping</code>参数对应于<code>aes(x,y,size,shape,color,alpha)</code>，以上参数对应值均为DATA数据中的变量，若需要手动设置，将参数写于aes外，此时的参数对应值如下：</p>
<p><li>color=”颜色英语单词”</li></p>
<p><li>size=数字</li></p>
<p><li>shape=如下代表数字</li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-13-1.png" alt=""><br>其中shape图形中的外边界由colour指定(0到18)。内部填充由fill指定。<br><strong>ggplot()中设置的aes相当于全局参数，为简化代码可将共有变量在ggplot中设置。若某一图层指定参数与次全局指定冲突，则在该图层使用geom指定的参数。基于这样的处理过程可以在不同的图层中指定不同的数据。</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + </span><br><span class="line">  geom_point(mapping = aes(color = class)) + </span><br><span class="line">  geom_smooth(data = dplyr::filter(mpg, class == <span class="string">"subcompact"</span>), se = FALSE) <span class="comment">##se为是否展示置信区间</span></span><br></pre></td></tr></table></figure></p>
<h3 id="stat_(statistical_transformation)">stat (statistical transformation)</h3><p>每一个geom都会默认指定一个stat来对数据进行统计转换，如geom_bar()默认stat是count，即geom_bar(..,stat=”count”)。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/visualization-stat-bar.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/stat.png" alt=""></p>
<h3 id="坐标系统">坐标系统</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/visualization-coordinate-systems.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本内容是基于&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3I0ZHMuaGFkLmNvLm56Lw==&quot; title=&quot;http://r4ds.had.co.nz/&quot;&gt;&lt;strong&gt;R for Data Science&lt;/strong&gt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="function" scheme="http://tiramisutes.github.io/tags/function/"/>
    
  </entry>
  
  <entry>
    <title>vim编辑器个性化配置总结</title>
    <link href="http://tiramisutes.github.io/2016/09/21/vim.html"/>
    <id>http://tiramisutes.github.io/2016/09/21/vim.html</id>
    <published>2016-09-21T08:16:31.000Z</published>
    <updated>2016-09-21T14:34:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><span class="exturl" data-url="aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTc3NjYtMS5odG1s" title="https://linux.cn/article-7766-1.html">Vim 终于发布了一个新的大版本 8.0<i class="fa fa-external-link"></i></span></p>
<h2 id="安装">安装</h2><p>下载安装最新版本的 Vim 的最好方式是使用 Git ：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/vim/vim.git</span><br></pre></td></tr></table></figure></p>
<p>更多信息可参考：&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy52aW0ub3JnL2dpdC5waHA=" title="http://www.vim.org/git.php">http://www.vim.org/git.php<i class="fa fa-external-link"></i></span>&nbsp;。<br><strong>Windows</strong>下图形界面版：&nbsp;<span class="exturl" data-url="ZnRwOi8vZnRwLnZpbS5vcmcvcHViL3ZpbS9wYy9ndmltODAuemlwJm5ic3A7" title="ftp://ftp.vim.org/pub/vim/pc/gvim80.zip&nbsp;">ftp://ftp.vim.org/pub/vim/pc/gvim80.zip&nbsp;<i class="fa fa-external-link"></i></span><br>windows下next安装就可以。<br><strong>Vim安装完成之后，目录如下：</strong></p>
<p><li>vim80：vim运行时所需的文件，对应目录为$VIMRUNTIME变量</li></p>
<p><li>vimfiles：第三方的文件，对应目录为$VIM/vimfiles</li></p>
<p><li>_vimrc：vim全局配置信息</li></p>
<h2 id="主题">主题</h2><p>vimrc配置内容主要参考了<span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvemhlbmd6aG91ZGF4dWUyL2FydGljbGUvZGV0YWlscy80NTI0NzczMw==" title="http://blog.csdn.net/zhengzhoudaxue2/article/details/45247733">http://blog.csdn.net/zhengzhoudaxue2/article/details/45247733<i class="fa fa-external-link"></i></span></p>
<p><strong>注：</strong>_vimrc主题中参数解释见 <span class="exturl" data-url="aHR0cDovL2VkeWZveC5jb2RlY2FydmVyLm9yZy9odG1sL192aW1yY19mb3JfYmVnaW5uZXJzLmh0bWw=" title="http://edyfox.codecarver.org/html/_vimrc_for_beginners.html">http://edyfox.codecarver.org/html/_vimrc_for_beginners.html<i class="fa fa-external-link"></i></span></p>
<h2 id="配置Vundle">配置<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dtYXJpay9WdW5kbGUudmlt" title="https://github.com/gmarik/Vundle.vim">Vundle<i class="fa fa-external-link"></i></span></h2><p><a href="#" class="myButton">vim插件Vundle能够轻松的管理插件；</a> </p>
<h3 id="下载Vundle">下载Vundle</h3><p>在Vim/vimfiles路径下新建文件夹bundle，然后在此文件夹下克隆github上的vundel项目：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#以管理员权限运行cmd，进入bundle文件夹下</span></span><br><span class="line"><span class="built_in">cd</span> Vim/vimfiles/bundle</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/VundleVim/Vundle.vim.git Vundle.vim</span><br></pre></td></tr></table></figure></p>
<h3 id="配置Vundle-1">配置Vundle</h3><p><strong>在_vimrc文件中添加如下代码：</strong><br><strong>以下英语输入法状态下的”符号是_vimrc中的注释符；</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">filetype off</span><br><span class="line"></span><br><span class="line"><span class="string">" Vundle的路径</span></span><br><span class="line"><span class="string">set rtp+=<span class="variable">$VIM</span>/vimfiles/bundle/Vundle.vim</span></span><br><span class="line"><span class="string">"</span> 插件的安装路径</span><br><span class="line">call vundle<span class="comment">#begin('$VIM/vimfiles/bundle/')</span></span><br><span class="line"><span class="string">" 需要安装的插件</span></span><br><span class="line"><span class="string">Plugin 'gmarik/Vundle.vim'</span></span><br><span class="line"><span class="string">Plugin 'L9'</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">call vundle#end()</span></span><br><span class="line"><span class="string">filetype plugin indent on</span></span><br></pre></td></tr></table></figure></p>
<p><strong>注：</strong>若不指定call vundle#begin()中的路径参数，默认保存路径为C:\Users***.vim；</p>
<h2 id="vim中安装/卸载插件">vim中安装/卸载插件</h2><p>vundle主要是利用git，来处理自动安装，更新和卸载插件，所以首先需要安装git。</p>
<h3 id="vim插件安装方式">vim插件安装方式</h3><p>_vimrc指定的vim插件安装有4种方式：</p>
<p><li>1. 代码库放在github上</li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘tpope/vim-fugitive’<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘Lokaltog/vim-easymotion’</p>
<p><li>2. 代码库在vim script上</li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘L9’<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘FuzzyFinder’</p>
<p><li>3. 代码库在其他git库上</li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘git://git.wincent.com/command-t.git’</p>
<p><li>4. 当你自己写了个定制的插件，放在本地的时候</li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bundle ‘file:///Users/gmarik/path/to/plugin’</p>
<h3 id="常用的命令">常用的命令</h3><p>启动vim，键入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">:BundleInstall    安装插件</span><br><span class="line">:PluginInstall    安装插件</span><br><span class="line">:BundleInstall!   更新插件</span><br><span class="line">:BundleClean(!)   卸载不在.vimrc配置列表中的插件</span><br><span class="line">:BundleSearch(!)  搜索插件</span><br><span class="line">:BundleList       显示已安装插件列表</span><br></pre></td></tr></table></figure></p>
<p><strong>如果想安装插件，首先在_vimrc中添加相应插件的Bundle，一般为Bundle ‘username/pluginname’的形式，如Bundle ‘gmarik/vundle’,然后打开Vim，输入一下命令，并等待Done即可，如果安装过程中出错，可以输入小写字母”l”查看日志;</strong><br><strong>如果想卸载插件，只需在_vimrc中删除（或注释）相应的Bundle，然后打开Vim，输入相应命令。</strong></p>
<h2 id="遇到的问题">遇到的问题</h2><p><li>安装ctags遇到”Taglist: Exuberant ctags (<span class="exturl" data-url="aHR0cDovL2N0YWdzLnNmLm5ldA==" title="http://ctags.sf.net">http://ctags.sf.net<i class="fa fa-external-link"></i></span>) not found in PATH.Plugin is not loaded.”</li><br>解决办法：ctags 目录下的 ctags.exe 复制到gvim.exe 所在的目录；</p>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3d3dy50dWljb29sLmNvbS9hcnRpY2xlcy95cUFyeXFS" title="http://www.tuicool.com/articles/yqAryqR">Gvim各种插件配置（windows环境下） - vitah<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9waWd6aHUvcC8zMzIwNzU1Lmh0bWw=" title="http://www.cnblogs.com/pigzhu/p/3320755.html">VIM插件管理—vundle<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9wcGJveV9keGgvcC8zMjI2OTM4Lmh0bWw=" title="http://www.cnblogs.com/ppboy_dxh/p/3226938.html">Vim Skills——Windows利用Vundle和Github进行Vim配置和插件的同步<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2VkeWZveC5jb2RlY2FydmVyLm9yZy9odG1sL192aW1yY19mb3JfYmVnaW5uZXJzLmh0bWw=" title="http://edyfox.codecarver.org/html/_vimrc_for_beginners.html">_vimrc for beginners<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2x1Y2t5Ymlucy5ibG9nLjUxY3RvLmNvbS83ODYxNjQvNjgxMzI1" title="http://luckybins.blog.51cto.com/786164/681325">_gvim与插件的安装（ctag、taglist、cscope等）<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9saW51eC5jbi9hcnRpY2xlLTc3NjYtMS5odG1s&quot; title=&quot;https://linux.cn/article-7766-1.html&quot;&gt;Vim 终于发布了一个
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="vim" scheme="http://tiramisutes.github.io/tags/vim/"/>
    
  </entry>
  
  <entry>
    <title>评估文库 Average Insert Size</title>
    <link href="http://tiramisutes.github.io/2016/09/19/Insert-Size.html"/>
    <id>http://tiramisutes.github.io/2016/09/19/Insert-Size.html</id>
    <published>2016-09-19T14:07:39.000Z</published>
    <updated>2018-09-28T02:36:47.397Z</updated>
    
    <content type="html"><![CDATA[<p>用SOAPdenovo对Illumina paired-end进行基因组组装时需要配置文件，其中要填写每个文库的average insert size，那么如何进行average insert size大小的评估呢？</p>
<h2 id="文库类型">文库类型</h2><p>对于基因组文库我们一般会建小库（&lt;1K）的<strong>paired-end reads</strong>和大库的<strong>mate-pair reads</strong>，二者最主要的区别就是reads1和reads2的方向和之间的间隔大小。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/strand_specificity.jpg" width="800" height="100"><br><a id="more"></a><br>现在绝大部分的主流软件都是支持将paired-end reads进行比对的，那么 <strong>mate-pair reads</strong>如何处理呢，即 <strong>mate-pair reads</strong>如何做比对？请参考我的另一篇博文 <strong><a href="http://tiramisutes.github.io/2016/11/25/mate-pair-reads-Aligner.html" target="_blank">Mate-pair Reads Alignment</a></strong></p>
<h2 id="Insert_Size">Insert Size</h2><p>首先，什么是Insert Size呢？<br><strong>对于paired-end reads来说</strong><br><img src="http://www.frontiersin.org/files/Articles/77572/fgene-05-00005-HTML/image_m/fgene-05-00005-g001.jpg" alt=""><br><strong>对于mate-pair reads来说</strong>其reads1和reads2方向指向外面，其插入大小统计需要格外注意。</p>
<h2 id="基于bwa比对log文件统计插入大小">基于bwa比对log文件统计插入大小</h2><p>通过观察bwa软件的输出log文件发现其对每一个pair-end reads分4次读入（[M::main_mem] read 2613712 sequences (200000105 bp)…），对于每一次的读入会对reads进行统计如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bwa.png" alt=""><br>由红框标出发现占主要比例的是RF reads，进一步往下寻找analyzing insert size distribution for orientation RF…就可得到其平均插入大小。</p>
<h2 id="基于比对的sam文件统计插入大小">基于比对的sam文件统计插入大小</h2><h3 id="R计算">R计算</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cat sample.sam | cut -f9 &gt; initial.insertsizes.txt</span><br><span class="line">R</span><br><span class="line">a = read.table(<span class="string">"initial.insertsizes.txt"</span>)</span><br><span class="line">a.v = a[a[,1]&gt;0,1]                     <span class="comment"># 筛选大于0的值</span></span><br><span class="line">mn = quantile(a.v, seq(0,1,0.05))[4]   <span class="comment">#分位数计算，[4]表示取第四个分位值,15%</span></span><br><span class="line">mx = quantile(a.v, seq(0,1,0.05))[18]  <span class="comment">#85%</span></span><br><span class="line">mean(a.v[a.v &gt;= mn &amp; a.v &lt;= mx])       <span class="comment"># mean</span></span><br><span class="line">sd(a.v[a.v &gt;= mn &amp; a.v &lt;= mx])         <span class="comment"># sd</span></span><br></pre></td></tr></table></figure>
<p>可见R计算过程选择过滤掉小于等于15%和大于等于85%的值来计算平均插入大小；</p>
<h3 id="awk计算">awk计算</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123; if ($9 &gt; 0) &#123; N+=1; S+=$9; S2+=$9*$9 &#125;&#125; END &#123; M=S/N; print "n="N", mean="M", stdev="sqrt ((S2-M*M*N)/(N-1))&#125;'</span> sample.sam</span><br></pre></td></tr></table></figure>
<p>awk选择全部大于0的值计算平均插入大小；</p>
<h2 id="基于sorted-bam文件">基于sorted.bam文件</h2><h3 id="qualimap">qualimap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qualimap bamqc -bam sample.sorted.bam --java-mem-size=300G  -c -nw 400 -hm 3 -outdir /resulted</span><br></pre></td></tr></table></figure>
<h3 id="CollectInsertSizeMetrics"><span class="exturl" data-url="aHR0cHM6Ly9icm9hZGluc3RpdHV0ZS5naXRodWIuaW8vcGljYXJkL2NvbW1hbmQtbGluZS1vdmVydmlldy5odG1sI0NvbGxlY3RJbnNlcnRTaXplTWV0cmljcw==" title="https://broadinstitute.github.io/picard/command-line-overview.html#CollectInsertSizeMetrics">CollectInsertSizeMetrics<i class="fa fa-external-link"></i></span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java -jar CollectInsertSizeMetrics.jar \</span><br><span class="line">      I=sample.sorted.bam \</span><br><span class="line">      O=insert_size_metrics.txt \</span><br><span class="line">      H=insert_size_histogram.pdf \</span><br><span class="line">      M=0.5</span><br></pre></td></tr></table></figure>
<h2 id="问题">问题</h2><p>现对同一个比对产生的sam/bam文件用上述4种方法计算得出结果如下：<br><strong>R</strong> ：mean insert size = 260.577232343453”，”standard deviation = 27.4153198790634”；<br><strong>awk</strong>： mean=250.826, stdev=51.7005；<br><strong>qualimap</strong>：mean insert size = 250.8258，std insert size = 51.7005；<br><strong>CollectInsertSizeMetrics</strong>：MEAN_INSERT_SIZE=260.963523，STANDARD_DEVIATION=42.809159。<br>qualimap 和 CollectInsertSizeMetrics 都是java封装的软件，看不到其具体计算方法，根据以上计算结果可以看出CollectInsertSizeMetrics的计算原理应该和R的一样需要过滤掉数据，qualimap和awk中发一样，所以问题最后就归结为<strong>是否需要首先过滤数值再计算平均插入大小？</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/insert.png" alt=""><br>在R中计算时对数据<strong>a.v</strong>做正态性检验<code>lillie.test(a.v)</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(<span class="string">"nortest"</span>)</span><br><span class="line">&gt; lillie.test(a.v)</span><br><span class="line"></span><br><span class="line">        Lilliefors (Kolmogorov-Smirnov) normality <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">data:  a.v</span><br><span class="line">D = 0.1541, p-value &lt; 2.2e-16</span><br></pre></td></tr></table></figure></p>
<p><strong>可以看出其插入大小分布不是呈正态分布，综合考虑后还是按照R的计算结果为准。</strong></p>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMTY1NTYv" title="https://www.biostars.org/p/16556/">Question: Estimate Insert Size In Paired-End/Mate-Pair<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMTA2MjkxLw==" title="https://www.biostars.org/p/106291/">Question: What is the difference between a Read and a Fragment in RNA-seq?<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3RoZWdlbm9tZWZhY3RvcnkuYmxvZ3Nwb3QuY29tLzIwMTMvMDgvcGFpcmVkLWVuZC1yZWFkLWNvbmZ1c2lvbi1saWJyYXJ5Lmh0bWw=" title="http://thegenomefactory.blogspot.com/2013/08/paired-end-read-confusion-library.html">Paired-end read confusion - library, fragment or insert size?<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;用SOAPdenovo对Illumina paired-end进行基因组组装时需要配置文件，其中要填写每个文库的average insert size，那么如何进行average insert size大小的评估呢？&lt;/p&gt;
&lt;h2 id=&quot;文库类型&quot;&gt;文库类型&lt;/h2&gt;&lt;p&gt;对于基因组文库我们一般会建小库（&amp;lt;1K）的&lt;strong&gt;paired-end reads&lt;/strong&gt;和大库的&lt;strong&gt;mate-pair reads&lt;/strong&gt;，二者最主要的区别就是reads1和reads2的方向和之间的间隔大小。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/strand_specificity.jpg&quot; width=&quot;800&quot; height=&quot;100&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Average Insert Size" scheme="http://tiramisutes.github.io/tags/Average-Insert-Size/"/>
    
  </entry>
  
  <entry>
    <title>学习WGCNA总结</title>
    <link href="http://tiramisutes.github.io/2016/09/14/WGCNA.html"/>
    <id>http://tiramisutes.github.io/2016/09/14/WGCNA.html</id>
    <published>2016-09-14T08:59:41.000Z</published>
    <updated>2018-10-29T09:09:50.556Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA2.png" alt=""><br>在转录组数据处理过程中我们经常会用到差异表达分析这一概念，通过比较不同处理或不同组织间基因表达量(FPKM)差异来寻找特异基因，但这前提是你的不同处理或不同组织样本较少，当不同处理或组织有较多样本，如40个，此时的两两比较有780组比较^_^,这根本不是我们想要的结果；<br><a id="more"></a><br>此时就需要<strong><span class="exturl" data-url="aHR0cHM6Ly9ob3J2YXRoLmdlbmV0aWNzLnVjbGEuZWR1L2h0bWwvQ29leHByZXNzaW9uTmV0d29yay9ScGFja2FnZXMvV0dDTkEvVHV0b3JpYWxzLw==" title="https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/Tutorials/">WGCNA(weighted gene co-expression network analysis)<i class="fa fa-external-link"></i></span>将复杂的数据进行归纳整理</strong>。除了这种最常见的比较差异表达，我们还想知道在不同处理或不同组织间是否有些基因的表达存在内在的联系或相关性？WGCNA同样可以帮助我们预测基因间的相互作用关系。</p>
<blockquote>
<p>WGCNA is based on correlation and not differential expression comparisons.</p>
</blockquote>
<h2 id="WGCNA术语">WGCNA术语</h2><h3 id="权重(weghted)">权重(weghted)</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA3.png" alt=""></p>
<h3 id="Module">Module</h3><p><strong>模块(module)：</strong>表达模式相似的基因分为一类，这样的一类基因成为模块；</p>
<h3 id="Eigengene">Eigengene</h3><p><strong>Eigengene（eigen- +‎ gene）：</strong>基因和样本构成的矩阵，<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWt0aW9uYXJ5Lm9yZy93aWtpL2VpZ2VuZ2VuZe+8mw==" title="https://en.wiktionary.org/wiki/eigengene；">https://en.wiktionary.org/wiki/eigengene；<i class="fa fa-external-link"></i></span></p>
<h3 id="Adjacency_Matrix">Adjacency Matrix</h3><p><strong>邻近矩阵：</strong>是图的一种存储形式，用一个一维数组存放图中所有顶点数据；用一个二维数组存放顶点间关系（边或弧）的数据，这个二维数组称为邻接矩阵；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA4.png" alt=""></p>
<h3 id="Topological_Overlap_Matrix(TOM)">Topological Overlap Matrix(TOM)</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA5.png" alt=""></p>
<h2 id="整体思路">整体思路</h2><p><a href="#" class="myButton">先对数据进行处理→分层聚类→表达模式相似的基因组成模块→研究某一个模块中相关基因的功能富集(GO,KEGG)，各个模块与样本表型数据间的相关性，各个模块与样本本身间的相关性(没有表型数据的情况，如不同组织)→具体到特定模块后分析其所包含基因间的相互作用网络关系，并找出其中的关键基因。</a></p>
<h3 id="分析构建的网络寻找以下有用信息">分析构建的网络寻找以下有用信息</h3><p><li>这类处于调控网络中心的基因称为核心基因（hub gene），这类基因通常是转录因子等关键的调控因子，是值得我们优先深入分析和挖掘的对象。</li></p>
<p><li>在网络中，被调控线连接的基因，其表达模式是相似的。那么它们潜在有相似的功能。所以，在这个网络中，如果线条一端的基因功能是已知的，那么就可以预测线条另一端的功能未知的基因也有相似的功能。</li></p>
<h2 id="R脚本">R脚本</h2><p><strong>输入数据为RNA-seq不同处理或组织所有样本的FPKM值组成的矩阵，切记含有 0 的要去掉；</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br></pre></td><td class="code"><pre><span class="line">setwd(<span class="string">"F:/WGCNA"</span>)</span><br><span class="line">library(WGCNA)</span><br><span class="line">options(stringsAsFactors = FALSE)</span><br><span class="line">enableWGCNAThreads()</span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="comment">####################### 一、 数据读入，处理和保存 ##############################</span></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line">fpkm&lt;- read.csv(<span class="string">"trans_counts.counts.matrix.TMM_normalized.FPKM.nozero.csv"</span>)</span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">head(fpkm)</span><br><span class="line">   GeneID PN_1_TPM PN_1_07_TPM PN_1_08_TPM PN_2_TPM PN_2_09_TPM PN_2_10_TPM</span><br><span class="line">1 MSTRG.1 0.000000    1.456143    1.093308 0.204315    0.000000    0.000000</span><br><span class="line">2 MSTRG.2 1.516181    0.849313    2.010783 1.567867    2.045446    2.246402</span><br><span class="line">3 MSTRG.3 1.305084    1.207246    0.889166 1.470162    0.340003    0.421222</span><br><span class="line">4 MSTRG.4 2.744250    2.791988    2.500786 2.719017    1.954149    2.468110</span><br><span class="line">5 MSTRG.5 1.946825    1.470012    1.263171 0.205806    1.644505    1.638583</span><br><span class="line">6 MSTRG.6 1.325277    0.793530    1.932236 1.210156    1.834274    2.153466</span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">dim(fpkm)</span><br><span class="line">names(fpkm)</span><br><span class="line">datExpr0=as.data.frame(t(fpkm[,-c(1)]));</span><br><span class="line">names(datExpr0)=fpkm<span class="variable">$trans</span>;</span><br><span class="line">rownames(datExpr0)=names(fpkm)[-c(1)];</span><br><span class="line"><span class="comment">#data&lt;-log10(date[,-1]+0.01)</span></span><br><span class="line"><span class="comment"># *************************************************************</span></span><br><span class="line"><span class="comment"># 检测输入基因是否含有缺失值,并处理 ******************************</span></span><br><span class="line"><span class="comment"># *************************************************************</span></span><br><span class="line">gsg = goodSamplesGenes(datExpr0, verbose = 3);</span><br><span class="line">gsg<span class="variable">$allOK</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment"># 如果上一步返回TRUE则跳过此步，如果返回FALSE则执行如下if语句去掉存在较多缺失值的基因所在行</span></span><br><span class="line"><span class="keyword">if</span> (!gsg<span class="variable">$allOK</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment"># Optionally, print the gene and sample names that were removed:</span></span><br><span class="line">  <span class="keyword">if</span> (sum(!gsg<span class="variable">$goodGenes</span>)&gt;0)</span><br><span class="line">    printFlush(paste(<span class="string">"Removing genes:"</span>, paste(names(datExpr0)[!gsg<span class="variable">$goodGenes</span>], collapse = <span class="string">", "</span>)));</span><br><span class="line">  <span class="keyword">if</span> (sum(!gsg<span class="variable">$goodSamples</span>)&gt;0)</span><br><span class="line">    printFlush(paste(<span class="string">"Removing samples:"</span>, paste(rownames(datExpr0)[!gsg<span class="variable">$goodSamples</span>], collapse = <span class="string">", "</span>)));</span><br><span class="line"><span class="comment"># Remove the offending genes and samples from the data:</span></span><br><span class="line">datExpr0 = datExpr0[gsg<span class="variable">$goodSamples</span>, gsg<span class="variable">$goodGenes</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 再次检测</span></span><br><span class="line">dim(datExpr0)</span><br><span class="line">gsg = goodSamplesGenes(datExpr0, verbose = 3);</span><br><span class="line">gsg<span class="variable">$allOK</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment"># ***************************************************************</span></span><br><span class="line"><span class="comment"># 聚类检测输入样本是否含有异常值（obvious outliers）,并处理 ********</span></span><br><span class="line"><span class="comment"># ***************************************************************</span></span><br><span class="line">sampleTree = hclust(dist(datExpr0), method = <span class="string">"average"</span>)</span><br><span class="line"><span class="comment">#sizeGrWindow(12,9)</span></span><br><span class="line">par(cex = 0.6)</span><br><span class="line">par(mar = c(0,4,2,0))</span><br><span class="line">plot(sampleTree, main = <span class="string">"Sample clustering to detect outliers"</span>, sub=<span class="string">""</span>, xlab=<span class="string">""</span>, cex.lab = 1.5,</span><br><span class="line">     cex.axis = 1.5, cex.main = 2)</span><br><span class="line">abline(h = 80000, col = <span class="string">"red"</span>);</span><br><span class="line">clust = cutreeStatic(sampleTree, cutHeight = 80000, minSize = 10)</span><br><span class="line">table(clust)</span><br><span class="line">keepSamples = (clust==1)</span><br><span class="line">datExpr = datExpr0[keepSamples, ]</span><br><span class="line">nGenes = ncol(datExpr)</span><br><span class="line">nSamples = nrow(datExpr)</span><br><span class="line">save(datExpr, file = <span class="string">"AS-green-FPKM-01-dataInput.RData"</span>)</span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="comment">############################ 二、 选择合适的阀值 ##############################</span></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line">powers = c(c(1:10), seq(from = 12, to=20, by=2))</span><br><span class="line"><span class="comment"># Call the network topology analysis function</span></span><br><span class="line">sft = pickSoftThreshold(datExpr, powerVector = powers, verbose = 5)</span><br><span class="line"><span class="comment"># Plot the results:</span></span><br><span class="line"><span class="comment">##sizeGrWindow(9, 5)</span></span><br><span class="line">par(mfrow = c(1,2));</span><br><span class="line">cex1 = 0.9;</span><br><span class="line"><span class="comment"># Scale-free topology fit index as a function of the soft-thresholding power</span></span><br><span class="line">plot(sft<span class="variable">$fitIndices</span>[,1], -sign(sft<span class="variable">$fitIndices</span>[,3])*sft<span class="variable">$fitIndices</span>[,2],</span><br><span class="line">     xlab=<span class="string">"Soft Threshold (power)"</span>,ylab=<span class="string">"Scale Free Topology Model Fit,signed R^2"</span>,<span class="built_in">type</span>=<span class="string">"n"</span>,</span><br><span class="line">     main = paste(<span class="string">"Scale independence"</span>));</span><br><span class="line">text(sft<span class="variable">$fitIndices</span>[,1], -sign(sft<span class="variable">$fitIndices</span>[,3])*sft<span class="variable">$fitIndices</span>[,2],</span><br><span class="line">     labels=powers,cex=cex1,col=<span class="string">"red"</span>);</span><br><span class="line"><span class="comment"># this line corresponds to using an R^2 cut-off of h</span></span><br><span class="line">abline(h=0.90,col=<span class="string">"red"</span>)</span><br><span class="line"><span class="comment"># Mean connectivity as a function of the soft-thresholding power</span></span><br><span class="line">plot(sft<span class="variable">$fitIndices</span>[,1], sft<span class="variable">$fitIndices</span>[,5],</span><br><span class="line">     xlab=<span class="string">"Soft Threshold (power)"</span>,ylab=<span class="string">"Mean Connectivity"</span>, <span class="built_in">type</span>=<span class="string">"n"</span>,</span><br><span class="line">     main = paste(<span class="string">"Mean connectivity"</span>))</span><br><span class="line">text(sft<span class="variable">$fitIndices</span>[,1], sft<span class="variable">$fitIndices</span>[,5], labels=powers, cex=cex1,col=<span class="string">"red"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="comment">############################ 三、 网络构建和可视化 #############################</span></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment"># 网络构建有两种方法，One-step和Step-by-step；</span></span><br><span class="line"><span class="comment"># 第一种：一步法进行网络构建</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">################################################################################</span></span><br><span class="line"><span class="comment">### 3.1 一步法网络构建：One-step network construction and module detection ######</span></span><br><span class="line"><span class="comment">#3.1.1. 网络构建 ###############################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line">dim(datExpr)</span><br><span class="line">net = blockwiseModules(datExpr, power = 6, maxBlockSize = 6000,</span><br><span class="line">                       TOMType = <span class="string">"unsigned"</span>, minModuleSize = 30,</span><br><span class="line">                       reassignThreshold = 0, mergeCutHeight = 0.25,</span><br><span class="line">                       numericLabels = TRUE, pamRespectsDendro = FALSE,</span><br><span class="line">                       saveTOMs = TRUE,</span><br><span class="line">                       saveTOMFileBase = <span class="string">"AS-green-FPKM-TOM"</span>,</span><br><span class="line">                       verbose = 3)</span><br><span class="line">table(net<span class="variable">$colors</span>)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.1.2. 绘画结果展示 ###########################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># open a graphics window</span></span><br><span class="line"><span class="comment">#sizeGrWindow(12, 9)</span></span><br><span class="line"><span class="comment"># Convert labels to colors for plotting</span></span><br><span class="line">mergedColors = labels2colors(net<span class="variable">$colors</span>)</span><br><span class="line"><span class="comment"># Plot the dendrogram and the module colors underneath</span></span><br><span class="line">plotDendroAndColors(net<span class="variable">$dendrograms</span>[[1]], mergedColors[net<span class="variable">$blockGenes</span>[[1]]],</span><br><span class="line">                    <span class="string">"Module colors"</span>,</span><br><span class="line">                    dendroLabels = FALSE, hang = 0.03,</span><br><span class="line">                    addGuide = TRUE, guideHang = 0.05)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.1.3. 结果保存 ###############################################################</span></span><br><span class="line"><span class="comment">###############################################################################                  </span></span><br><span class="line">moduleLabels = net<span class="variable">$colors</span></span><br><span class="line">moduleColors = labels2colors(net<span class="variable">$colors</span>)</span><br><span class="line">table(moduleColors)</span><br><span class="line">MEs = net<span class="variable">$MEs</span>;</span><br><span class="line">geneTree = net<span class="variable">$dendrograms</span>[[1]];</span><br><span class="line">save(MEs, moduleLabels, moduleColors, geneTree,</span><br><span class="line">     file = <span class="string">"AS-green-FPKM-02-networkConstruction-auto.RData"</span>)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.1.4. 导出网络到 Cytoscape ###################################################</span></span><br><span class="line"><span class="comment">###############################################################################  </span></span><br><span class="line"><span class="comment"># Recalculate topological overlap if needed</span></span><br><span class="line">TOM = TOMsimilarityFromExpr(datExpr, power = 6);</span><br><span class="line"><span class="comment"># Read in the annotation file</span></span><br><span class="line"><span class="comment"># annot = read.csv(file = "GeneAnnotation.csv");</span></span><br><span class="line"><span class="comment"># Select modules需要修改，根据table(moduleColors)的结果选择需要导出的模块颜色</span></span><br><span class="line">modules = c(<span class="string">"turquoise"</span>, <span class="string">"blue"</span>);</span><br><span class="line"><span class="comment"># Select module probes选择模块探测</span></span><br><span class="line">probes = names(datExpr)</span><br><span class="line">inModule = is.finite(match(moduleColors, modules));</span><br><span class="line">modProbes = probes[inModule];</span><br><span class="line"><span class="comment">#modGenes = annot$gene_symbol[match(modProbes, annot$substanceBXH)];</span></span><br><span class="line"><span class="comment"># Select the corresponding Topological Overlap</span></span><br><span class="line">modTOM = TOM[inModule, inModule];</span><br><span class="line">dimnames(modTOM) = list(modProbes, modProbes)</span><br><span class="line"><span class="comment"># Export the network into edge and node list files Cytoscape can read</span></span><br><span class="line">cyt = exportNetworkToCytoscape(modTOM,</span><br><span class="line">                               edgeFile = paste(<span class="string">"AS-green-FPKM-One-step-CytoscapeInput-edges-"</span>, paste(modules, collapse=<span class="string">"-"</span>), <span class="string">".txt"</span>, sep=<span class="string">""</span>),</span><br><span class="line">                               nodeFile = paste(<span class="string">"AS-green-FPKM-One-step-CytoscapeInput-nodes-"</span>, paste(modules, collapse=<span class="string">"-"</span>), <span class="string">".txt"</span>, sep=<span class="string">""</span>),</span><br><span class="line">                               weighted = TRUE,</span><br><span class="line">                               threshold = 0.02,</span><br><span class="line">                               nodeNames = modProbes,</span><br><span class="line">                               <span class="comment">#altNodeNames = modGenes,</span></span><br><span class="line">                               nodeAttr = moduleColors[inModule]);</span><br><span class="line"><span class="comment">#################################################################################################</span></span><br><span class="line"><span class="comment">#3.1.5. 分析网络可视化，用heatmap可视化权重网络，heatmap每一行或列对应一个基因，颜色越深表示有较高的邻近</span></span><br><span class="line"><span class="comment">#################################################################################################</span></span><br><span class="line">options(stringsAsFactors = FALSE);</span><br><span class="line">lnames = load(file = <span class="string">"AS-green-FPKM-01-dataInput.RData"</span>);</span><br><span class="line">lnames</span><br><span class="line">lnames = load(file = <span class="string">"AS-green-FPKM-02-networkConstruction-auto.RData"</span>);</span><br><span class="line">lnames</span><br><span class="line">nGenes = ncol(datExpr)</span><br><span class="line">nSamples = nrow(datExpr)</span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment">#3.1.5.1. 可视化全部基因网络 ==========</span></span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment"># Calculate topological overlap anew: this could be done more efficiently by saving the TOM</span></span><br><span class="line"><span class="comment"># calculated during module detection, but let us do it again here.</span></span><br><span class="line">dissTOM = 1-TOMsimilarityFromExpr(datExpr, power = 6);</span><br><span class="line"><span class="comment"># Transform dissTOM with a power to make moderately strong connections more visible in the heatmap</span></span><br><span class="line">plotTOM = dissTOM^7;</span><br><span class="line"><span class="comment"># Set diagonal to NA for a nicer plot</span></span><br><span class="line">diag(plotTOM) = NA;</span><br><span class="line"><span class="comment"># Call the plot function</span></span><br><span class="line"><span class="comment">#sizeGrWindow(9,9)</span></span><br><span class="line">TOMplot(plotTOM, geneTree, moduleColors, main = <span class="string">"Network heatmap plot, all genes"</span>)</span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment">#3.1.5.2. 随便选取1000个基因来可视化 ==</span></span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line">nSelect = 1000</span><br><span class="line"><span class="comment"># For reproducibility, we set the random seed</span></span><br><span class="line">set.seed(10);</span><br><span class="line">select = sample(nGenes, size = nSelect);</span><br><span class="line">selectTOM = dissTOM[select, select];</span><br><span class="line"><span class="comment"># There's no simple way of restricting a clustering tree to a subset of genes, so we must re-cluster.</span></span><br><span class="line">selectTree = hclust(as.dist(selectTOM), method = <span class="string">"average"</span>)</span><br><span class="line">selectColors = moduleColors[select];</span><br><span class="line"><span class="comment"># Open a graphical window</span></span><br><span class="line"><span class="comment">#sizeGrWindow(9,9)</span></span><br><span class="line"><span class="comment"># Taking the dissimilarity to a power, say 10, makes the plot more informative by effectively changing</span></span><br><span class="line"><span class="comment"># the color palette; setting the diagonal to NA also improves the clarity of the plot</span></span><br><span class="line">plotDiss = selectTOM^7;</span><br><span class="line">diag(plotDiss) = NA;</span><br><span class="line">TOMplot(plotDiss, selectTree, selectColors, main = <span class="string">"Network heatmap plot, selected genes"</span>)</span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment">#  第二种：一步步的进行网络构建</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"><span class="comment">#=====================================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">### 3.2 Step-by-step network construction and module detection ################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#2.选择合适的阀值，同上</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.2.1. 网络构建 ###############################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment"># (1) Co-expression similarity and adjacency ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">softPower = 6;</span><br><span class="line">adjacency = adjacency(datExpr, power = softPower);</span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#(2) 邻近矩阵到拓扑矩阵的转换，Turn adjacency into topological overlap ~~~~~</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">TOM = TOMsimilarity(adjacency);</span><br><span class="line">dissTOM = 1-TOM</span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment"># (3) 聚类拓扑矩阵  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#Call the hierarchical clustering function</span></span><br><span class="line">geneTree = hclust(as.dist(dissTOM), method = <span class="string">"average"</span>);</span><br><span class="line"><span class="comment"># Plot the resulting clustering tree (dendrogram)</span></span><br><span class="line"><span class="comment">#sizeGrWindow(12,9)</span></span><br><span class="line">plot(geneTree, xlab=<span class="string">""</span>, sub=<span class="string">""</span>, main = <span class="string">"Gene clustering on TOM-based dissimilarity"</span>,</span><br><span class="line">     labels = FALSE, hang = 0.04);</span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#(4) 聚类分支的休整dynamicTreeCut ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line"><span class="comment"># We like large modules, so we set the minimum module size relatively high:</span></span><br><span class="line">minModuleSize = 30;</span><br><span class="line"><span class="comment"># Module identification using dynamic tree cut:</span></span><br><span class="line">dynamicMods = cutreeDynamic(dendro = geneTree, distM = dissTOM,</span><br><span class="line">                            deepSplit = 2, pamRespectsDendro = FALSE,</span><br><span class="line">                            minClusterSize = minModuleSize);</span><br><span class="line">table(dynamicMods)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.2.2. 绘画结果展示 ###########################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># Convert numeric lables into colors</span></span><br><span class="line">dynamicColors = labels2colors(dynamicMods)</span><br><span class="line">table(dynamicColors)</span><br><span class="line"><span class="comment"># Plot the dendrogram and colors underneath</span></span><br><span class="line"><span class="comment">#sizeGrWindow(8,6)</span></span><br><span class="line">plotDendroAndColors(geneTree, dynamicColors, <span class="string">"Dynamic Tree Cut"</span>,</span><br><span class="line">                    dendroLabels = FALSE, hang = 0.03,</span><br><span class="line">                    addGuide = TRUE, guideHang = 0.05,</span><br><span class="line">                    main = <span class="string">"Gene dendrogram and module colors"</span>)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.2.3. 聚类结果相似模块的融合，Merging of modules whose expression profiles are very similar</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#在聚类树中每一leaf是一个短线，代表一个基因，</span></span><br><span class="line"><span class="comment">#不同分之间靠的越近表示有高的共表达基因，将共表达极其相似的modules进行融合</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># Calculate eigengenes</span></span><br><span class="line">MEList = moduleEigengenes(datExpr, colors = dynamicColors)</span><br><span class="line">MEs = MEList<span class="variable">$eigengenes</span></span><br><span class="line"><span class="comment"># Calculate dissimilarity of module eigengenes</span></span><br><span class="line">MEDiss = 1-cor(MEs);</span><br><span class="line"><span class="comment"># Cluster module eigengenes</span></span><br><span class="line">METree = hclust(as.dist(MEDiss), method = <span class="string">"average"</span>);</span><br><span class="line"><span class="comment"># Plot the result</span></span><br><span class="line"><span class="comment">#sizeGrWindow(7, 6)</span></span><br><span class="line">plot(METree, main = <span class="string">"Clustering of module eigengenes"</span>,</span><br><span class="line">     xlab = <span class="string">""</span>, sub = <span class="string">""</span>)</span><br><span class="line"><span class="comment">#选择有75%相关性的进行融合</span></span><br><span class="line">MEDissThres = 0.25</span><br><span class="line"><span class="comment"># Plot the cut line into the dendrogram</span></span><br><span class="line">abline(h=MEDissThres, col = <span class="string">"red"</span>)</span><br><span class="line"><span class="comment"># Call an automatic merging function</span></span><br><span class="line">merge = mergeCloseModules(datExpr, dynamicColors, cutHeight = MEDissThres, verbose = 3)</span><br><span class="line"><span class="comment"># The merged module colors</span></span><br><span class="line">mergedColors = merge<span class="variable">$colors</span>;</span><br><span class="line"><span class="comment"># Eigengenes of the new merged modules:</span></span><br><span class="line">mergedMEs = merge<span class="variable">$newMEs</span>;</span><br><span class="line"><span class="comment">#绘制融合前(Dynamic Tree Cut)和融合后(Merged dynamic)的聚类图</span></span><br><span class="line"><span class="comment">#sizeGrWindow(12, 9)</span></span><br><span class="line"><span class="comment">#pdf(file = "Plots/geneDendro-3.pdf", wi = 9, he = 6)</span></span><br><span class="line">plotDendroAndColors(geneTree, cbind(dynamicColors, mergedColors),</span><br><span class="line">                    c(<span class="string">"Dynamic Tree Cut"</span>, <span class="string">"Merged dynamic"</span>),</span><br><span class="line">                    dendroLabels = FALSE, hang = 0.03,</span><br><span class="line">                    addGuide = TRUE, guideHang = 0.05)</span><br><span class="line"><span class="comment">#dev.off()</span></span><br><span class="line"><span class="comment"># 只是绘制融合后聚类图</span></span><br><span class="line">plotDendroAndColors(geneTree,mergedColors,<span class="string">"Merged dynamic"</span>,</span><br><span class="line">                    dendroLabels = FALSE, hang = 0.03,</span><br><span class="line">                    addGuide = TRUE, guideHang = 0.05)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.2.4. 结果保存 ###############################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># Rename to moduleColors</span></span><br><span class="line">moduleColors = mergedColors</span><br><span class="line"><span class="comment"># Construct numerical labels corresponding to the colors</span></span><br><span class="line">colorOrder = c(<span class="string">"grey"</span>, standardColors(50));</span><br><span class="line">moduleLabels = match(moduleColors, colorOrder)-1;</span><br><span class="line">MEs = mergedMEs;</span><br><span class="line"><span class="comment"># Save module colors and labels for use in subsequent parts</span></span><br><span class="line">save(MEs, moduleLabels, moduleColors, geneTree, file = <span class="string">"AS-green-FPKM-02-networkConstruction-stepByStep.RData"</span>)</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment">#3.2.5. 导出网络到Cytoscape ####################################################</span></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># Recalculate topological overlap if needed</span></span><br><span class="line">TOM = TOMsimilarityFromExpr(datExpr, power = 6);</span><br><span class="line"><span class="comment"># Read in the annotation file</span></span><br><span class="line"><span class="comment"># annot = read.csv(file = "GeneAnnotation.csv");</span></span><br><span class="line"><span class="comment"># Select modules需要修改</span></span><br><span class="line">modules = c(<span class="string">"brown"</span>, <span class="string">"red"</span>);</span><br><span class="line"><span class="comment"># Select module probes</span></span><br><span class="line">probes = names(datExpr)</span><br><span class="line">inModule = is.finite(match(moduleColors, modules));</span><br><span class="line">modProbes = probes[inModule];</span><br><span class="line"><span class="comment">#modGenes = annot$gene_symbol[match(modProbes, annot$substanceBXH)];</span></span><br><span class="line"><span class="comment"># Select the corresponding Topological Overlap</span></span><br><span class="line">modTOM = TOM[inModule, inModule];</span><br><span class="line">dimnames(modTOM) = list(modProbes, modProbes)</span><br><span class="line"><span class="comment"># Export the network into edge and node list files Cytoscape can read</span></span><br><span class="line">cyt = exportNetworkToCytoscape(modTOM,</span><br><span class="line">                               edgeFile = paste(<span class="string">"AS-green-FPKM-Step-by-step-CytoscapeInput-edges-"</span>, paste(modules, collapse=<span class="string">"-"</span>), <span class="string">".txt"</span>, sep=<span class="string">""</span>),</span><br><span class="line">                               nodeFile = paste(<span class="string">"AS-green-FPKM-Step-by-step-CytoscapeInput-nodes-"</span>, paste(modules, collapse=<span class="string">"-"</span>), <span class="string">".txt"</span>, sep=<span class="string">""</span>),</span><br><span class="line">                               weighted = TRUE,</span><br><span class="line">                               threshold = 0.02,</span><br><span class="line">                               nodeNames = modProbes,</span><br><span class="line">                               <span class="comment">#altNodeNames = modGenes,</span></span><br><span class="line">                               nodeAttr = moduleColors[inModule]);</span><br><span class="line"><span class="comment">#################################################################################################</span></span><br><span class="line"><span class="comment">#3.2.6. 分析网络可视化，用heatmap可视化权重网络，heatmap每一行或列对应一个基因，颜色越深表示有较高的邻近</span></span><br><span class="line"><span class="comment">#################################################################################################</span></span><br><span class="line">options(stringsAsFactors = FALSE);</span><br><span class="line">lnames = load(file = <span class="string">"AS-green-FPKM-01-dataInput.RData"</span>);</span><br><span class="line">lnames</span><br><span class="line">lnames = load(file = <span class="string">"AS-green-FPKM-02-networkConstruction-stepByStep.RData"</span>);</span><br><span class="line">lnames</span><br><span class="line">nGenes = ncol(datExpr)</span><br><span class="line">nSamples = nrow(datExpr)</span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment">#3.2.6.1. 可视化全部基因网络 ==========</span></span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment"># Calculate topological overlap anew: this could be done more efficiently by saving the TOM</span></span><br><span class="line"><span class="comment"># calculated during module detection, but let us do it again here.</span></span><br><span class="line">dissTOM = 1-TOMsimilarityFromExpr(datExpr, power = 6);</span><br><span class="line"><span class="comment"># Transform dissTOM with a power to make moderately strong connections more visible in the heatmap</span></span><br><span class="line">plotTOM = dissTOM^7;</span><br><span class="line"><span class="comment"># Set diagonal to NA for a nicer plot</span></span><br><span class="line">diag(plotTOM) = NA;</span><br><span class="line"><span class="comment"># Call the plot function</span></span><br><span class="line"><span class="comment">#sizeGrWindow(9,9)</span></span><br><span class="line">TOMplot(plotTOM, geneTree, moduleColors, main = <span class="string">"Network heatmap plot, all genes"</span>)</span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line"><span class="comment">#3.2.6.2. 随便选取1000个基因来可视化 ==</span></span><br><span class="line"><span class="comment">#====================================</span></span><br><span class="line">nSelect = 1000</span><br><span class="line"><span class="comment"># For reproducibility, we set the random seed</span></span><br><span class="line">set.seed(10);</span><br><span class="line">select = sample(nGenes, size = nSelect);</span><br><span class="line">selectTOM = dissTOM[select, select];</span><br><span class="line"><span class="comment"># There's no simple way of restricting a clustering tree to a subset of genes, so we must re-cluster.</span></span><br><span class="line">selectTree = hclust(as.dist(selectTOM), method = <span class="string">"average"</span>)</span><br><span class="line">selectColors = moduleColors[select];</span><br><span class="line"><span class="comment"># Open a graphical window</span></span><br><span class="line"><span class="comment">#sizeGrWindow(9,9)</span></span><br><span class="line"><span class="comment"># Taking the dissimilarity to a power, say 10, makes the plot more informative by effectively changing</span></span><br><span class="line"><span class="comment"># the color palette; setting the diagonal to NA also improves the clarity of the plot</span></span><br><span class="line">plotDiss = selectTOM^7;</span><br><span class="line">diag(plotDiss) = NA;</span><br><span class="line">TOMplot(plotDiss, selectTree, selectColors, main = <span class="string">"Network heatmap plot, selected genes"</span>)</span><br><span class="line"><span class="comment">#此处画的是根据基因间表达量进行聚类所得到的各模块间的相关性图</span></span><br><span class="line">MEs = moduleEigengenes(datExpr, moduleColors)<span class="variable">$eigengenes</span></span><br><span class="line">MET = orderMEs(MEs)</span><br><span class="line">sizeGrWindow(7, 6) </span><br><span class="line">plotEigengeneNetworks(MET, <span class="string">"Eigengene adjacency heatmap"</span>, marHeatmap = c(3,4,2,2), plotDendrograms = FALSE, xLabelsAngle = 90)</span><br></pre></td></tr></table></figure></p>
<h3 id="部分结果图简单解释">部分结果图简单解释</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA6.png" alt=""></p>
<h2 id="Cytoscape生成网络图">Cytoscape生成网络图</h2><p>只需要第二个edges文件就能构建网络图。导入该文件后，在软件的导入设置中，将第一列设置为fromNode，第二列设置为toNode，最后把第三列设为网络关系属性，完成设置，便可生成网络图了。 </p>
<h2 id="WGCNA样本要求">WGCNA样本要求</h2><p>由于WGCNA是基于相关系数的表达调控网络分析方法。当样本数过低的时候，相关系数的计算是不可靠的，得到的调控网络价值不大。所以，我们推荐的样本数如下：</p>
<p><li>当独立样本数≥8（非重复样本）时，可以考虑基于Pearson相关系数的WGCNA共表达网络的方法（效果看实际情况而定）；</li></p>
<p><li>当样本数≥15（可以包含生物学重复）时，WGCNA方法会有更好的效果。</li></p>
<p><li>当样品数＜8时，不建议进行该项分析。</li></p>
<p><li><strong>该方法对于不同材料或不同组织进行分析更有意义，对于不同时间点处理相同样品意义不大。</strong></li></p>
<h2 id="报错暨解决办法">报错暨解决办法</h2><h3 id="错误1">错误1</h3><p>运行 <code>pickSoftThreshold</code> 函数报错如下<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; sft = pickSoftThreshold(datExpr, powerVector = powers, verbose = 5)</span><br><span class="line">pickSoftThreshold: will use block size 773.</span><br><span class="line"> pickSoftThreshold: calculating connectivity for given powers...</span><br><span class="line">   ..working on genes 1 through 773 of 57862</span><br><span class="line"><span class="keyword">Error </span>in &#123; : task 1 failed - "'x' has a zero dimension."</span><br></pre></td></tr></table></figure></p>
<p>检查 datExpr 变量<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(datExpr)</span><br><span class="line">[<span class="number">1</span>]     <span class="number">0</span> <span class="number">50057</span></span><br></pre></td></tr></table></figure></p>
<p>重新dim检查之前的datExpr变量，绝对不是0行，而 datExpr变量的最近一次处理是 <code>keepSamples = (clust==1)</code><br>察看<code>keepSamples = (clust==1)</code>之后的keepSamples变量<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; keepSamples</span><br><span class="line"> [<span class="number">1</span>] <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></span><br></pre></td></tr></table></figure></p>
<p>都是FALSE？？？，所以引起后续<code>datExpr = datExpr0[keepSamples, ]</code>的错误;<br>继续往上查找变量clust，即<code>clust = cutreeStatic(sampleTree, cutHeight = 80000, minSize = 10)</code>，<span class="exturl" data-url="aHR0cHM6Ly93d3cucmRvY3VtZW50YXRpb24ub3JnL3BhY2thZ2VzL1dHQ05BL3ZlcnNpb25zLzEuNjQtMS90b3BpY3MvY3V0cmVlU3RhdGlj" title="https://www.rdocumentation.org/packages/WGCNA/versions/1.64-1/topics/cutreeStatic">cutreeStatic<i class="fa fa-external-link"></i></span> 函数会通过<code>cutHeight</code> 和 <code>minSize</code> 的设定对聚类树进行cut去掉异常的样本，</p>
<blockquote>
<p><strong>cutHeight</strong> ：height at which branches are to be cut.<br><strong>minSize</strong> ：minimum number of object on a branch to be considered a cluster.</p>
</blockquote>
<p>所以调整相应的<code>cutHeight</code> 和 <code>minSize</code> 参数，察看 <code>clust</code>变量的值，保留可行的样本；<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; clust</span><br><span class="line"> [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">&gt; keepSamples = (clust==<span class="number">1</span>)</span><br><span class="line">&gt; keepSamples</span><br><span class="line"> [<span class="number">1</span>]  <span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></span><br><span class="line">&gt; clust2</span><br><span class="line"> [<span class="number">1</span>] <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">&gt; keepSamples = (clust2==<span class="number">0</span>)</span><br><span class="line">&gt; keepSamples</span><br><span class="line"> [<span class="number">1</span>] <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span> <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure></p>
<p>或者简单暴力手动去除刚开始输入数据中异常样本，不做 <strong>聚类检测输入样本是否含有异常值（obvious outliers）</strong>这一过程；</p>
<h3 id="错误2">错误2</h3><p>按照WGCNA手册第五步Network visualization using WGCNA functions时报错如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; TOMplot(plotTOM, geneTree, moduleColors, main = <span class="string">"Network heatmap plot, all genes"</span>)</span><br><span class="line"></span><br><span class="line">Error <span class="keyword">in</span> .heatmap(as.matrix(dissim), Rowv = as.dendrogram(dendro, hang = 0.1),  :</span><br><span class="line">row dendrogram ordering gave index of wrong length</span><br></pre></td></tr></table></figure></p>
<p>看到<em>row dendrogram ordering gave index of wrong length</em>这句报错内容，分别察看plotTOM, geneTree, moduleColors这三个变量length;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim(plotTOM)</span><br><span class="line">&gt; geneTree</span><br><span class="line">&gt; moduleColors</span><br></pre></td></tr></table></figure></p>
<p>果然，三者的length不同，发现geneTree少了一些，往回找geneTree来源 <strong>geneTree = net$dendrograms[[1]]</strong>，net来源于网络构建过程：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">net = blockwiseModules(datExpr, power = 6,</span><br><span class="line">TOMType = <span class="string">"unsigned"</span>, minModuleSize = 30,</span><br><span class="line">reassignThreshold = 0, mergeCutHeight = 0.25,</span><br><span class="line">numericLabels = TRUE, pamRespectsDendro = FALSE,</span><br><span class="line">saveTOMs = TRUE,</span><br><span class="line">saveTOMFileBase = <span class="string">"femaleMouseTOM"</span>,</span><br><span class="line">verbose = 3)</span><br></pre></td></tr></table></figure></p>
<p>所以，这是问题所在，继续察看文档发现基于内存等因素blockwiseModules函数默认最大maxBlockSize=5000（即最大5000个基因数目），而我们的数据超过了这个值，所以函数自动将输入datExpr数据做了拆分处理，<strong>而解决办法也很简单，设置maxBlockSize参数大于我们的值(<code>dim(datExpr)</code>所显示的数据行数) 即可。</strong></p>
<h2 id="相关讨论">相关讨论</h2><h3 id="signed_vs_unsigned_network">signed vs unsigned network</h3><blockquote>
<p>I think the “sign” represents the sign of weight on the edges. If you care about the sign, for example sign represents positive or negative regulation between two nodes, then you need to choose “signed”. On the other hand, if the weight just represent the strength of relatedness between two nodes, you might don’t care positive or negative, so you need to choose “unsigned”. That really depends on your needs. 【<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMjg4MTUzLw==" title="https://www.biostars.org/p/288153/">WGCNA signed vs unsigned network<i class="fa fa-external-link"></i></span>】</p>
<p>Should you use a signed or unsigned network? By and large, I recommend using one of the signed varieties, for two main reasons. First, more often than not, direction does matter: it is important to know where node profiles go up and where they go down, and mixing negatively correlated nodes together necessarily mixes the two directions together. Second, negatively correlated nodes often belong to different categories. For example, in gene expression data, negatively correlated genes tend to come from biologically very different categories. It is true that some pathways or processes involve pairs of genes that are negatively correlated; if there are enough negatively correlated genes, they will form a module on their own and the two modules can then be analyzed together. (For the advanced practitioner, another option is to use the fuzzy module membership measure based on the module eigengene to attach a few strongly negatively correlated genes to a module after the modules have been identified). 【<span class="exturl" data-url="aHR0cDovL3d3dy5wZXRlcmxhbmdmZWxkZXIuY29tL3NpZ25lZC1vci11bnNpZ25lZC13aGljaC1uZXR3b3JrLXR5cGUtaXMtcHJlZmVyYWJsZS8=" title="http://www.peterlangfelder.com/signed-or-unsigned-which-network-type-is-preferable/">Signed or unsigned: which network type is preferable?<i class="fa fa-external-link"></i></span>】</p>
</blockquote>
<h3 id="Should_I_filter_probesets_or_genes">Should I filter probesets or genes</h3><blockquote>
<p>Probesets or genes may be filtered by mean expression or variance (or their robust analogs such as median and median absolute deviation, MAD) since low-expressed or non-varying genes usually represent noise. Whether it is better to filter by mean expression or variance is a matter of debate; both have advantages and disadvantages, but more importantly, they tend to filter out similar sets of genes since mean and variance are usually related.</p>
<p>We <strong>do not recommend filtering genes by differential expression</strong>. WGCNA is designed to be an unsupervised analysis method that clusters genes based on their expression profiles. Filtering genes by differential expression will lead to a set of correlated genes that will essentially form a single (or a few highly correlated) modules. It also completely invalidates the scale-free topology assumption, so choosing soft thresholding power by scale-free topology fit will fail. 【<span class="exturl" data-url="aHR0cHM6Ly9ob3J2YXRoLmdlbmV0aWNzLnVjbGEuZWR1L2h0bWwvQ29leHByZXNzaW9uTmV0d29yay9ScGFja2FnZXMvV0dDTkEvZmFxLmh0bWw=" title="https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/faq.html">Data analysis questions<i class="fa fa-external-link"></i></span>】</p>
</blockquote>
<h3 id="power_must_be_between_1_and_30">power must be between 1 and 30</h3><blockquote>
<p>First, the user should ensure that variables (probesets, genes etc.) have not been filtered by differential expression with respect to a sample trait. See item 2 above for details about beneficial and detrimental filtering genes or probesets.</p>
<p>If the scale-free topology fit index fails to reach values above 0.8 for reasonable powers (less than 15 for unsigned or signed hybrid networks, and less than 30 for signed networks) and the mean connectivity remains relatively high (in the hundreds or above), chances are that the data exhibit a strong driver that makes a subset of the samples globally different from the rest. The difference causes high correlation among large groups of genes which invalidates the assumption of the scale-free topology approximation.</p>
<p>Lack of scale-free topology fit by itself does not invalidate the data, but should be looked into carefully. It always helps to plot the sample clustering tree and any technical or biological sample information below it as in Figure 2 of Tutorial I, section 1; strong clusters in the clustering tree indicate globally different groups of samples. It could be the result a technical effect such as a batch effect, biological heterogeneity (e.g., a data set consisting of samples from 2 different tissues), or strong changes between conditions (say in a time series). One should investigate carefully whether there is sample heterogeneity, what drives the heterogeneity, and whether the data should be adjusted (see previous point).</p>
<p>If the lack of scale-free topology fit turns out to be caused by an interesting biological variable that one does not want to remove (i.e., adjust the data for), the appropriate soft-thresholding power can be chosen based on the number of samples as in the table below. This table has been updated in December 2017 to make the resulting networks conservative.</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>Number of samples</strong></th>
<th style="text-align:center"><strong>Unsigned and signed hybrid networks</strong></th>
<th style="text-align:center"><strong>Signed networks</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Less than 20</td>
<td style="text-align:center">9</td>
<td style="text-align:center">18</td>
</tr>
<tr>
<td style="text-align:center">20-30</td>
<td style="text-align:center">8</td>
<td style="text-align:center">16</td>
</tr>
<tr>
<td style="text-align:center">30-40</td>
<td style="text-align:center">7</td>
<td style="text-align:center">14</td>
</tr>
<tr>
<td style="text-align:center">more than 40</td>
<td style="text-align:center">6</td>
<td style="text-align:center">12</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/WGCNA2.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;在转录组数据处理过程中我们经常会用到差异表达分析这一概念，通过比较不同处理或不同组织间基因表达量(FPKM)差异来寻找特异基因，但这前提是你的不同处理或不同组织样本较少，当不同处理或组织有较多样本，如40个，此时的两两比较有780组比较^_^,这根本不是我们想要的结果；&lt;br&gt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="WGCNA" scheme="http://tiramisutes.github.io/tags/WGCNA/"/>
    
  </entry>
  
  <entry>
    <title>Congratulations For My First Paper</title>
    <link href="http://tiramisutes.github.io/2016/09/13/paper.html"/>
    <id>http://tiramisutes.github.io/2016/09/13/paper.html</id>
    <published>2016-09-13T11:57:28.000Z</published>
    <updated>2018-09-28T02:39:41.299Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/purdue.png" alt=""><br><a href="#" class="myButton">Congratulations!</a> <strong>My first SCI paper is published in scientific reports. A nice story about cottonseed and welcome reading.</strong><br><a id="more"></a></p>
<h2 id="Conclusions_for_this_paper：">Conclusions for this paper：</h2><p><blockquote><p>This is the first report of artificially improved oil content via RNAi strategy and the analysis of its metabolic mechanism in Upland cotton. Decreased GhPEPC1 expression in transgenic cotton led to the increased expression of TAG biosynthesis related genes and elevated cottonseed oil content, which demonstrated the feasibility of improving cottonseed oil yield by regulating the carbon flux.</p></blockquote><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/srep33342-f8.jpg" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/srep33342-f10.jpg" alt=""></p>
<p><blockquote><p>GhPEPC1 works as a core enzyme not only involved in photosynthesis but also regulated the inflowing of carbon turnover to fatty acid biosynthesis and finally contributed to the increase of cottonseed oil content. In this report, the carboxylation pathway of PEP to OAA was blocked through RNAi of GhPEPC1 and resulted in a decline in OAA concentration. Under this background, more proteins would be converted to aspartate involved in anaplerotic reactions to offset the OAA deficiency in mitochondrial and this hypothesis has been confirmed by our RNA-seq data. Among the DEGs, the glutamine-dependent asparagine synthase 1 was found to be down-regulated in the RNAi lines. Simultaneously, more pyruvate will be transported into mitochondria due to the acceleration of glycolysis, through mitochondrial pyruvate carrier (MPC) located in the mitochondrial inner membrane. The pyruvate located in mitochondria was then involved into two metabolism branches: conversion into acetyl-CoA through pyruvate decarboxylation with pyruvate dehydrogenase complex (PDC) and other irreversible carboxylation to form OAA by pyruvate carboxylase (PC) ligase to serves as an anaplerotic reaction for TCA. The excessive acetyl CoA and relative lack of OAA forced chloroplasts to the heighten light-dependent reactions based on photosynthetic electron transport chains and which produced the ATP and NADPH by using Calvin cycle, where the fixed CO2 was converted as sucrose to provide substrate for glycolysis. However, the RNAi cotton plant was in a state of ‘starvation’ because of the down-regulation of GhPEPC and the TCA were confined. Moreover, the expression levels of ACC in transgenic lines were significantly increased, which indicates that superfluous acetyl-CoA could combine with OAA and form citrate and then transported to cytoplasm via citrate transport protein (CTP). These citrates have participated into biosynthesis of fatty acids and finally stored in cottonseed in the form of TAG. The red marker region indicated that relevant genes exhibiting rising trend in RNA-seq data. The blue marker indicated down-regulated genes.<br></p></blockquote><br><i class="fa fa-newspaper-o" aria-hidden="true"></i><strong>全文见：</strong><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL3NyZXAzMzM0Mg==" title="http://www.nature.com/articles/srep33342">Metabolic engineering of cottonseed oil biosynthesis pathway via RNA interference<i class="fa fa-external-link"></i></span></p>
<h2 id="How_to_cite_this_article:">How to cite this article:</h2><p><blockquote><p>Xu, Z. et al. Metabolic engineering of cottonseed oil biosynthesis pathway via RNA interference. Sci. Rep. 6, 33342; doi: 10.1038/srep33342 (2016).</p></blockquote></p>
<h2 id="Acknowledgements">Acknowledgements</h2><p>首先需要感谢的就是实验室提供的良好的科研平台和优势，这是必不可少的；其次就是支持科研的导师<span class="exturl" data-url="aHR0cDovL3dhcGJhaWtlLmJhaWR1LmNvbS9pdGVtL+mHkeWPjOS+oD9mcj1hbGFkZGluJnJlZj13aXNlJnNzaWQ9MCZmcm9tPTEwMTUwNjlhJnVpZD0wJnB1PXVzbSU0MDElMkNzeiU0MDEzMjBfMjAwMSUyQ3RhJTQwaXBob25lXzFfNy4xXzNfNTM3JmJkX3BhZ2VfdHlwZT0xJmJhaWR1aWQ9NDA3MDJGNkVBMEQzQzdGNEM0ODM2RkNFQ0MyRDk5QUQmdGo9WHZfMV8wXzEwX3RpdGxl" title="http://wapbaike.baidu.com/item/金双侠?fr=aladdin&ref=wise&ssid=0&from=1015069a&uid=0&pu=usm%401%2Csz%401320_2001%2Cta%40iphone_1_7.1_3_537&bd_page_type=1&baiduid=40702F6EA0D3C7F4C4836FCECC2D99AD&tj=Xv_1_0_10_title">金老师<i class="fa fa-external-link"></i></span>和郭老师；还有已毕业的师兄李敬文，没有他就没有这篇文章, Also thanks for hakim help me review my manuscript in limited time and his modify is more important for improve the grammar and flow of the manuscript, especially in the introduction and discussion；当然还有实验室每位同窗室友。</p><p>Next, I’s a time for a big party！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/purdue.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;a href=&quot;#&quot; class=&quot;myButton&quot;&gt;Congratulations!&lt;/a&gt; &lt;strong&gt;My first SCI paper is published in scientific reports. A nice story about cottonseed and welcome reading.&lt;/strong&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Paper" scheme="http://tiramisutes.github.io/categories/Paper/"/>
    
    
      <category term="SCI" scheme="http://tiramisutes.github.io/tags/SCI/"/>
    
  </entry>
  
  <entry>
    <title>Awk Regular Expressions</title>
    <link href="http://tiramisutes.github.io/2016/08/31/Awk-Regular-Expressions.html"/>
    <id>http://tiramisutes.github.io/2016/08/31/Awk-Regular-Expressions.html</id>
    <published>2016-08-31T15:25:51.000Z</published>
    <updated>2016-09-02T13:59:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="—re-interval">—re-interval</h2><p>在标准的正则表达式中{m}表示匹配字符m次，即<code>[A-Z]{m}表示匹配A到Z的任意一个字符m次。</code>，所以我们在awk中通常如下匹配：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat test.txt</span><br><span class="line">12  AT  CG</span><br><span class="line">7555  AAA       AT</span><br><span class="line">878 GGGG        CTG</span><br><span class="line">cat test.txt | awk <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; &#123;for(i=1;i&lt;=NF;i++) if ($i~/^[ATCG]&#123;2&#125;$/) print $i&#125;'</span></span><br></pre></td></tr></table></figure></p>
<p><strong>空</strong>，什么也没有输出？<br>首先{m}属于基本的正则表达式，而awk只支持扩展的正则表达式；<br>awk要想使用{m,n}类型的正则表达式，必须向awk提供参数：<code>—re-interval </code>。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat test.txt | awk --re-interval <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; &#123;for(i=1;i&lt;=NF;i++) if ($i~/^[ATCG]&#123;2&#125;$/) print $i&#125;'</span></span><br><span class="line">AT</span><br><span class="line">CG</span><br><span class="line">AT</span><br></pre></td></tr></table></figure></p>
<h2 id="-v_var=value_or_—asign_var=value_赋值一个用户定义变量；"><strong>-v var=value or —asign var=value</strong>    赋值一个用户定义变量；</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ awk -va=1 <span class="string">'&#123;print $1,$1+a&#125;'</span> log.txt</span><br><span class="line"> ---------------------------------------------</span><br><span class="line"> 2 3</span><br><span class="line"> 3 4</span><br><span class="line"> This<span class="string">'s 1</span></span><br><span class="line"><span class="string"> 10 11</span></span><br><span class="line"><span class="string"> $ awk -va=1 -vb=s '</span>&#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$1</span>+a,<span class="variable">$1b</span>&#125;<span class="string">' log.txt</span></span><br><span class="line"><span class="string"> ---------------------------------------------</span></span><br><span class="line"><span class="string"> 2 3 2s</span></span><br><span class="line"><span class="string"> 3 4 3s</span></span><br><span class="line"><span class="string"> This'</span>s 1 This<span class="string">'ss</span></span><br><span class="line"><span class="string"> 10 11 10s</span></span><br></pre></td></tr></table></figure>
<h2 id="gensub()替换">gensub()替换</h2> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">echo</span> <span class="string">"123356"</span> | awk <span class="string">'&#123;print gensub("3","d",2)&#125;'</span></span><br><span class="line">123d56</span><br></pre></td></tr></table></figure>
<p>gensub(a,b,c,d) a:匹配的字符，b替换的字符,c为指定替换目标是第几次匹配（如1，2，g），d为指定替换目标是哪个域如$1,$2，若无d指$0，返回值为target替换后内容(未替换还是返回 target原内容)。</p>
<h2 id="两个文本按条件合并">两个文本按条件合并</h2> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$  cat 2.txt 1.txt </span><br><span class="line">I0011  11111    hhh</span><br><span class="line">I0012  22222    kkk</span><br><span class="line">I0014  55555    ppp</span><br><span class="line">I0017  66666    ttt</span><br><span class="line">0011AAA 200.00 20050321</span><br><span class="line">0012BBB 300.00 20050621</span><br><span class="line">0013DDD 400.00 20050622</span><br><span class="line">0014FFF 500.00 20050401</span><br><span class="line"><span class="comment">#比较 1.txt的1-4字符 和 2.txt的2-5 字符，如果相同，将2.txt 的全部列 与 1.txt 合并</span></span><br><span class="line">[zpxu@node102 ~]$ awk  <span class="string">'NR==FNR&#123;a[substr($1,2,5)]=$0&#125;NR&gt;FNR&amp;&amp;a[b=substr($1,1,4)]&#123;print $0, a[b]&#125;'</span> 2.txt 1.txt </span><br><span class="line">0011AAA 200.00 20050321 I0011  11111    hhh</span><br><span class="line">0012BBB 300.00 20050621 I0012  22222    kkk</span><br><span class="line">0014FFF 500.00 20050401 I0014  55555    ppp</span><br><span class="line"><span class="comment">#NR==FNR处理的是2.txt文件,NR&gt;FNR处理的是1.txt文件</span></span><br><span class="line"><span class="comment">#awk 'NR==FNR&#123;a[$1]=$2&#125;NR&gt;FNR&amp;&amp;a[$1] &#123;print $1,a[$1]&#125;' 2.txt 1.txt</span></span><br></pre></td></tr></table></figure>
<p><strong>命令解释：</strong>首先处理2.txt文件，a[$1]=$0相当与将$1为键，整个行$0为值的hash；当处理1.txt文件时，直接在键的数组a中匹配1.txt中的$1列，若匹配则输出1.txt的$1和其在对应2.txt中匹配到的值；</p>
<h2 id="next与getline">next与getline</h2><p>awk code: ‘BEGIN{…}{Main Input}END{..}’<br>next 读入下一输入行并从(Main Input中的)第一个规则开始执行脚本。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$  cat data </span><br><span class="line">name naughty</span><br><span class="line">25 shandong</span><br><span class="line">age 14  </span><br><span class="line">ah,here is <span class="built_in">test</span></span><br><span class="line">[zpxu@node102 ~]$ awk <span class="string">'&#123;if(NR==1)&#123;next&#125; print $1,$2&#125;'</span> data   </span><br><span class="line">25 shandong</span><br><span class="line">age 14</span><br><span class="line">ah,here is</span><br></pre></td></tr></table></figure></p>
<p>当记录行号等于1，就跳过当前行，其后面的print $1,$2也不会执行,读入下一行重新开始；<br><strong>next合并多行为一行</strong><br>可首先将两个或多个文件处理：cat a.txt b.txt | sort -n -k1 ，然后用next合并多行为一行来进行两个文本的按条件合并；<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cat data</span><br><span class="line">web01[192.168.2.100]</span><br><span class="line">httpd            ok</span><br><span class="line">tomcat               ok</span><br><span class="line">sendmail               ok</span><br><span class="line">web02[192.168.2.101]</span><br><span class="line">httpd            ok</span><br><span class="line">postfix               ok</span><br><span class="line">web03[192.168.2.102]</span><br><span class="line">mysqld            ok</span><br><span class="line">httpd               ok</span><br><span class="line">awk <span class="string">'/^web/&#123;T=$0;next;&#125; &#123;print T":\t"$0;&#125;'</span> data</span><br><span class="line">web01[192.168.2.100]:   httpd            ok</span><br><span class="line">web01[192.168.2.100]:   tomcat               ok</span><br><span class="line">web01[192.168.2.100]:   sendmail               ok</span><br><span class="line">web02[192.168.2.101]:   httpd            ok</span><br><span class="line">web02[192.168.2.101]:   postfix               ok</span><br><span class="line">web03[192.168.2.102]:   mysqld            ok</span><br><span class="line">web03[192.168.2.102]:   httpd               ok</span><br><span class="line"><span class="comment">#行首匹配到web时将这一整行赋值给T存储起来，并读入下一行，最后将T和下一行一起print；</span></span><br></pre></td></tr></table></figure></p>
<p>与next相似，getline也是读取下一行数据。但是与next不同的是，next读取下一行之后，把控制权交给了awk脚本的顶部。但是getline却没有改变脚本的控制，读取下一行之后，继续运行当前的awk脚本。getline执行之后，会覆盖$0的内容。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$ cat d  </span><br><span class="line"><span class="variable">$1</span>==<span class="string">"name"</span>&#123;<span class="built_in">print</span> <span class="variable">$0</span>;getline;<span class="built_in">print</span> <span class="variable">$0</span>;&#125;  </span><br><span class="line"><span class="variable">$1</span>==<span class="string">"age"</span>&#123;<span class="built_in">print</span> <span class="variable">$0</span>&#125;  </span><br><span class="line">[zpxu@node102 ~]$ awk -f d data   </span><br><span class="line">name naughty  </span><br><span class="line">25 shandong  </span><br><span class="line">age 14</span><br></pre></td></tr></table></figure></p>
<p><strong>getline从整体上来说，应这么理解它的用法：</strong></p>
<p><li>当其左右无重定向符 | 或 &lt; 时，getline作用于当前文件，读入当前文件的第一行给其后跟的变量var 或$0（无变量）；应该注意到，由于awk在处理getline之前已经读入一行，所以getline得到<br>的返回结果是隔行的。</li></p>
<p><li>当其左右有重定向符 | 或 &lt; 时，getline则作用于定向输入文件，由于该文件是刚打开，并没有被awk读入一行，只是getline读入，那么getline返回的是该文件的第一行，而不是隔行。</li></p>
<h2 id="多行或多列的删除">多行或多列的删除</h2><h3 id="多行">多行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$  cat 1.txt </span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">[zpxu@node102 ~]$ awk -vD=<span class="string">"1,3,5,8,11"</span> <span class="string">'BEGIN&#123;split(D,a,",");c=1&#125;NR==a[c]&#123;c++;next&#125;1'</span> 1.txt </span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">12</span><br></pre></td></tr></table></figure>
<h3 id="多列">多列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$  cat data </span><br><span class="line">1,2,3,4,5,6,7,8,9,10,11,12</span><br><span class="line">[zpxu@node102 ~]$ awk --re-interval -vD=<span class="string">'1,3,5,11'</span> <span class="string">'BEGIN&#123;l=split(D,a,",")&#125;&#123;for(i=1;i&lt;=l;i++)&#123;$0=gensub("(([^,]*,?)&#123;"a[i]-i"&#125;)([^,]+,?)(.*)","\\1\\4","1")&#125;&#125;1'</span> data </span><br><span class="line">2,4,6,7,8,9,10,12</span><br></pre></td></tr></table></figure>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2xpbnV4L2xpbnV4LWNvbW0tYXdrLmh0bWw=" title="http://www.runoob.com/linux/linux-comm-awk.html">Linux awk 命令<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9iZWxpZC9hcmNoaXZlLzIwMTMvMDUvMjIvMzA5MzI2NC5odG1s" title="http://www.cnblogs.com/belid/archive/2013/05/22/3093264.html">awk函数+数组+多文件处理<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;—re-interval&quot;&gt;—re-interval&lt;/h2&gt;&lt;p&gt;在标准的正则表达式中{m}表示匹配字符m次，即&lt;code&gt;[A-Z]{m}表示匹配A到Z的任意一个字符m次。&lt;/code&gt;，所以我们在awk中通常如下匹配：&lt;br&gt;&lt;figure class=&quot;h
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>测序数据上传NCBI总结</title>
    <link href="http://tiramisutes.github.io/2016/08/30/NCBI-submission.html"/>
    <id>http://tiramisutes.github.io/2016/08/30/NCBI-submission.html</id>
    <published>2016-08-30T05:50:01.000Z</published>
    <updated>2019-12-08T13:50:13.193Z</updated>
    
    <content type="html"><![CDATA[<p><strong>测序数据上传到NCBI的SRA数据库；</strong><br>上传首页：<i class="fa fa-cloud" aria-hidden="true"></i><span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi8=" title="https://submit.ncbi.nlm.nih.gov/">https://submit.ncbi.nlm.nih.gov/<i class="fa fa-external-link"></i></span><br>上传整体顺序为：<a href="#" class="myButton">BioProject，BioSample，SRA</a><br><img src="/images/SubNCBI.png" alt=""><br><strong>需要注意的是，上传的过程中很多地方一旦保存或提交就不可以修改，尤其是各处的Alias，所以想清楚后再保存，可先看下别人的数据提交形式；确实需要修改的可以发邮件联系NCBI的工作人员修改内容。</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/NCBI.png" alt=""><br><a id="more"></a></p>
<h2 id="1-_BioProject">1. BioProject</h2><p>1&gt; 点击进入<span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi9zdWJzL2Jpb3Byb2plY3Qv" title="https://submit.ncbi.nlm.nih.gov/subs/bioproject/">BioProject主页<i class="fa fa-external-link"></i></span>；<br>2&gt; 点击<strong>New submission</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/BioProject.png" alt=""><br>3&gt;依次填写信息,最后保存即可。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/BioProjec2t.png" alt=""></p>
<h2 id="2-_BioSample">2. BioSample</h2><p>1&gt; 点击进入<span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi9zdWJzL2Jpb3NhbXBsZS8=" title="https://submit.ncbi.nlm.nih.gov/subs/biosample/">BioSample主页<i class="fa fa-external-link"></i></span>；<br>2&gt; 点击<strong>New submission</strong><br>3&gt;依次填写信息,最后保存即可。<br><i class="fa fa-commenting-o" aria-hidden="true"></i>根据实际情况选择合适的批处理，若为植物样本，选择下载Plant.1.0.txt文件，填写相应信息；<br>若现有sample1 and sample2两个实验处理，其各为3次生物学重复的双端RNA-seq数据，即sample1-1,sample1-2,sample1-3,sample2-1,sample2-2,sample2-3，此时的Plant.1.0.txt文件内容如下（文件中其他内容根据实际情况选择填写）,即<a href="#" class="myButton">生物学重复划分在同一个SAMPLE的不同RUN下</a>；</p>
<table>
<thead>
<tr>
<th>sample_name</th>
<th style="text-align:center">bioproject_accession</th>
</tr>
</thead>
<tbody>
<tr>
<td>sample1</td>
<td style="text-align:center">PRJNAxxxxxx</td>
</tr>
<tr>
<td>sample2</td>
<td style="text-align:center">PRJNAxxxxxx</td>
</tr>
</tbody>
</table>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Biosample3.png" alt=""></p>
<h2 id="3-_SRA">3. SRA</h2><p>1&gt; 点击进入<span class="exturl" data-url="aHR0cHM6Ly9zdWJtaXQubmNiaS5ubG0ubmloLmdvdi9zdWJzL3NyYS8=" title="https://submit.ncbi.nlm.nih.gov/subs/sra/">SRA主页<i class="fa fa-external-link"></i></span>；<br>2&gt; 点击<strong>Create new submission</strong><br>3&gt;依次填写信息,最后保存即可。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/BioSample2.png" alt=""></p>
<h2 id="4-_数据上传">4. 数据上传</h2><p>Linux下建议用Aspera上传；首先给sra工作人员发邮件要private SSH key文件；<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/software/.aspera/connect/bin/ascp -i sra-8.ssh.priv -QT -l100m -k1 sample1_1.fastq.gz asp-sra@upload.ncbi.nlm.nih.gov:incoming</span><br></pre></td></tr></table></figure></p>
<p>注：命令只能在登录节点上联网运行；<br>详细参数解释和其他上传方法见：<span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9zcmEvZG9jcy9zdWJtaXRmaWxlcy8=" title="https://www.ncbi.nlm.nih.gov/sra/docs/submitfiles/">https://www.ncbi.nlm.nih.gov/sra/docs/submitfiles/<i class="fa fa-external-link"></i></span></p>
<h2 id="5-_开始一个新的提交">5. 开始一个新的提交</h2><p>如果有数据需要提交NCBI，但是不知道你的数据类型应该如何提交，那么点击<span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ob21lL3N1Ym1pdC13aXphcmQv" title="https://www.ncbi.nlm.nih.gov/home/submit-wizard/">Submission Wizard<i class="fa fa-external-link"></i></span>会提供各种类型数据的提交接口。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;测序数据上传到NCBI的SRA数据库；&lt;/strong&gt;&lt;br&gt;上传首页：&lt;i class=&quot;fa fa-cloud&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://submit.ncbi.nlm.nih.gov/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://submit.ncbi.nlm.nih.gov/&lt;/a&gt;&lt;br&gt;上传整体顺序为：&lt;a href=&quot;#&quot; class=&quot;myButton&quot;&gt;BioProject，BioSample，SRA&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/images/SubNCBI.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;strong&gt;需要注意的是，上传的过程中很多地方一旦保存或提交就不可以修改，尤其是各处的Alias，所以想清楚后再保存，可先看下别人的数据提交形式；确实需要修改的可以发邮件联系NCBI的工作人员修改内容。&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/NCBI.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="NCBI_submission" scheme="http://tiramisutes.github.io/tags/NCBI-submission/"/>
    
  </entry>
  
  <entry>
    <title>Metagenome：宏基因组介绍</title>
    <link href="http://tiramisutes.github.io/2016/08/28/Metagenome.html"/>
    <id>http://tiramisutes.github.io/2016/08/28/Metagenome.html</id>
    <published>2016-08-28T05:32:00.000Z</published>
    <updated>2018-09-28T02:38:19.575Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Metagenomics4.jpg.bmp" alt=""></p>
<h2 id="概念">概念</h2><p><strong>宏基因组( Metagenome)</strong>(也称微生物环境基因组 Microbial Environmental Genome, 或元基因组) 。定义为”the genomes of the total microbiota found in nature” , 即生境中全部微小生物遗传物质的总和。它包含了可培养的和未可培养的微生物的基因, 目前主要指环境样品中的细菌和真菌的基因组总和。<br><strong>宏基因组学(或元基因组学, metagenomics)</strong>就是一种以环境样品中的微生物群体基因组为研究对象, 以功能基因筛选和/或测序分析为研究手段, 以微生物多样性、 种群结构、 进化关系、 功能活性、 相互协作关系及与环境之间的关系为研究目的的新的微生物研究方法。<br><a id="more"></a><br><strong>物种丰富度(species richness)：</strong>用来描述和量化微生物群落，反映特定区域物种的数量。<br><strong>均匀度(evenness)：</strong>用来量化一个群体中（少数的优势物种和绝大多数的稀有物种）的不同代表物种，反映各物种个体数目分配的均匀程度。假设存在另外一个群体其含由同之前群体所含物种总数相同的物种，唯一不同的是这些物种均较为常见，即这两个群体拥有相同的物种丰富度，但其某一物种的丰度不同，如何评价这两个群体的多样性？<br>为更好的描述和比较不同群体的多样性，提出适应宏基因组的新度量，<strong>α多样性，β多样性和γ多样性</strong>，其相互关系为<strong>β = γ/α</strong>。</p>
<p><li>α多样性就是一个样本（环境）中的物种数目;</li></p>
<p><li><strong>β多样性度量在地区尺度上物种组成沿着某个梯度方向从一个群落到另一个群落的变化率。</strong></li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Metagenomics2.jpg" alt=""></p>
<p><li>γ描述一片区域或者是大陆尺度内的物种多样性;</li></p>
<h2 id="宏基因组发展历程">宏基因组发展历程</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Metagenomics.jpg" alt=""><br>微生物群落研究始于1676年Leeuwenhoek发现第一个微生物，在70年代末 Carl Woese提出<strong>16S rRNA基因可用于物种分类</strong>，随后几十年分子技术如PCR、FISH、DGGE等的发展促使微生态学研究进入”new uncultured world”，近十年来随着下一代测序技术（NGS）的出现微生物群落研究已经从简单的物种发现发展为宏基因组学研究，即基于NGS技术研究环境样品所包含的全部微生物的遗传组成及其群落功能。<br>目前，根据测序数据类型的不同，宏基因组测序被分为两类：<strong>全基因组测序（full shutgun metagenomics）</strong>和<strong>扩增子测序（marker gene amplification metagenomics）</strong>。</p>
<p><li>全基因组测序即，直接从环境样品中提取全部微生物的DNA，构建宏基因组文库并测序。</li><br>这种策略可以回答以下问题：<br>1）环境中包含哪些微生物？<br>2）微生物群落具有哪些功能？<br>3）微生物间如何相互作用以维持生态平衡？</p>
<p><li>扩增子测序即，对微生物基因组上的特定基因如16S rRNA基因进行PCR扩增并测序。这种策略可以便捷、快速地分析各种复杂样品中的微生物群落结构。</li></p>
<h2 id="宏基因组分析流程">宏基因组分析流程</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Metagenomics3.jpg" alt=""></p>
<h2 id="估计宏基因组样本中的物种组成及丰度">估计宏基因组样本中的物种组成及丰度</h2><p>宏基因组中的物种分类，一般用OTU (operational taxonomic unit), 即可操作物种单元来表示。在典型情况下，<strong>原核生物的OUT使用16S rDNA来衡量，真核生物的OUT使用18s rDNA来衡量</strong>。<br>但选择16S/18S rDNA鉴定物种，存在以下几个问题：1）rDNA之间的平行转移来干扰rDNA鉴定的可靠性。2）在单个细菌中，16r DNA可能存在序列不同的几个拷贝，干扰估计OTU数目的准确性。所以，其他备选的标记基因，比如单拷贝的看家基因被推荐用来作为菌种鉴定的标记。</p>
<h2 id="研究成果">研究成果</h2><p><li><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25tL2pvdXJuYWwvdjIxL244L2Z1bGwvbm0uMzkxNC5odG1s" title="http://www.nature.com/nm/journal/v21/n8/full/nm.3914.html">The oral and gut microbiomes are perturbed in rheumatoid arthritis and partly normalized after treatment<i class="fa fa-external-link"></i></span><br>通过宏基因组shotgun测序和宏基因组关联分析来自类风湿性关节炎(RA)患者和健康人体的fecal, dental and salivary样本，观察到中肠和口腔中微生物组的一致性，同时观察到RA患者中肠和口腔中的微生物组失调，经过RA治疗后部分恢复正常；与健康人群相比，RA患者中gut, dental or saliva微生物组显著变化的个体与临床诊断结果密切相关；尤其是嗜血杆菌数量在RA患者的gut, dental and saliva中均下降，与血清自身抗体水平呈负相关；相反唾液乳杆菌在RA患者的gut, dental and saliva中超量存在，并随RA程度增加；功能上，RA患者个体微生物群落在氧化还原环境、铁硫锌离子和精氨酸的转运和代谢上发生变化。</li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Oral-MLGs-enriched.jpg" alt=""></p>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL2V1cm9wZXBtYy5vcmcvYXJ0aWNsZXMvUE1DNDY4MTgzMi8=" title="http://europepmc.org/articles/PMC4681832/">The Road to Metagenomics: From Microbiology to DNA Sequencing Technologies and Bioinformatics<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2V1cm9wZXBtYy5vcmcvYXJ0aWNsZXMvUE1DNDQyNjk0MQ==" title="http://europepmc.org/articles/PMC4426941">Metagenomics: tools and insights for analyzing next-generation sequencing data derived from biodiversity studies<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Metagenomics4.jpg.bmp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;概念&quot;&gt;概念&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;宏基因组( Metagenome)&lt;/strong&gt;(也称微生物环境基因组 Microbial Environmental Genome, 或元基因组) 。定义为”the genomes of the total microbiota found in nature” , 即生境中全部微小生物遗传物质的总和。它包含了可培养的和未可培养的微生物的基因, 目前主要指环境样品中的细菌和真菌的基因组总和。&lt;br&gt;&lt;strong&gt;宏基因组学(或元基因组学, metagenomics)&lt;/strong&gt;就是一种以环境样品中的微生物群体基因组为研究对象, 以功能基因筛选和/或测序分析为研究手段, 以微生物多样性、 种群结构、 进化关系、 功能活性、 相互协作关系及与环境之间的关系为研究目的的新的微生物研究方法。&lt;br&gt;
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="Metagenome" scheme="http://tiramisutes.github.io/tags/Metagenome/"/>
    
  </entry>
  
  <entry>
    <title>Post-Translational Modifications (PTMs)：Phosphorylation</title>
    <link href="http://tiramisutes.github.io/2016/08/27/Phosphorylation.html"/>
    <id>http://tiramisutes.github.io/2016/08/27/Phosphorylation.html</id>
    <published>2016-08-27T15:14:32.000Z</published>
    <updated>2018-09-28T02:40:33.193Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><h3 id="PTM">PTM</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/1437671615999.jpg" alt=""><br>Post-translational modification (PTM) serves as molecular switch mechanism, modulating diverse protein functions including enzymatic activity, protein turnover, interactions, conformation, localization, and crosstalk with other PTMs, which in turn regulate broad cellular biological functions.<br>These modifications include phosphorylation, glycosylation, ubiquitination, nitrosylation, methylation, acetylation, lipidation and proteolysis.<br><a id="more"></a></p>
<h3 id="Phosphorylation">Phosphorylation</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Phosphorylation.jpg" alt=""><br>Phosphorylation is the most common mechanism of regulating protein function and transmitting signals throughout the cell.<br>Reversible Protein Phosphorylation Is a Molecular Switch Mechanism. Reversible protein phosphorylation is characterized by the addition of phosphate donated from ATP and the removal of phosphate from a phosphorylated protein substrate, catalyzed by protein kinase and phosphatase (PP) enzymes respectively.<br>蛋白质磷酸化主要发生在两种氨基酸上，一种是丝氨酸<code>Ser S</code>(包括苏氨酸<code>Thr T</code>)，另一种是酪氨酸<code>Tyr Y</code>。这两类酸磷酸化的酶不一样，功能也不一样，但也有少数双功能的酶可以同时作用于这两类氨基酸，如MEK(促丝裂原活化蛋白激酶激酶mitogen-activated proteinkinase kinase ,MAPKK)。大于90%的蛋白质磷酸化组由丝氨酸磷酸化(pS)和苏氨酸磷酸化(pT)组成，三种氨基酸的磷酸化在同一个细胞中相对丰度比例为 pS:pT:pY = 1800:200:1，大约占84%, 15%, and &lt;1%。尽管pY所占比例最少，但酪氨酸激酶受体(RTKs)在人类疾病中的异常调控，使其研究一直处于pS和pT前面。</p>
<p><li>丝氨酸磷酸化的主要作用是变构蛋白质以激活蛋白质的活力，主要是指酶活力。</li></p>
<p><li>酪氨酸磷酸化除了在变构以及激活该蛋白的活力之外，更重要的功能是结合蛋白提供一个结构基因，以促进其和其他蛋白质相互作用而形成多蛋白复合体。蛋白复合体的形成再进一步促进蛋白质的磷酸化。周而复始，由最初蛋白质磷酸化所产生的信号就一步步如此转下去。如果最初产生的是一个刺激细胞生长的信号，此信号便最终转入细胞核，导致DNA复制和细胞分裂。</li></p>
<h2 id="Signal_Transduction_Cascades">Signal Transduction Cascades</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Phosphorylation2.jpg" alt=""><br>细胞通过其表面的受体，离子通道和转运蛋白实时监控胞内微环境,且细胞面表受体和转运蛋白具有细胞特异性，使得其能够对胞内或胞外刺激做出快速反应。细胞表面的受体在感知到刺激后激活下游激酶，使发生磷酸化和激活下游同类型底物传递信号。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cascades.jpg" alt=""></p>
<p><li>Signal transduction cascades can be linear, in which kinase A activates kinase B, which activates kinase C and so forth. Signaling pathways have also been discovered that amplify the initial signal; </li></p>
<p><li>kinase A activates multiple kinases, which in turn activate additional kinases. With this type of signaling, a single molecule, such as a growth factor, can activate global cellular programs such as proliferation.</li><br>依赖于蛋白质磷酸化的信号传递的强度和持续时间由3方面决定：</p>
<p><li><strong>激活配体的移除；</strong></li></p>
<p><li><strong>激活或底物的水解；</strong></li></p>
<p><li><strong>依赖于磷酸化的去磷酸化；</strong></li></p>
<h2 id="Protein_phosphorylation_sites">Protein phosphorylation sites</h2><p>在一个给定的细胞中拥有成千上万的磷酸化位点：</p>
<p><li><strong>在任何一个特定细胞中有成千上万不同种类的蛋白质；</strong></li></p>
<p><li><strong>大约1/10到1/2的蛋白质是处于磷酸化状态；</strong></li></p>
<p><li><strong>在人类基因组中有30%的蛋白质能够被磷酸化，磷酸化的异常常引起疾病的发生；</strong></li></p>
<p><li><strong>在一个给定蛋白质中磷酸化可发生在多个不同位点；</strong></li></p>
<h2 id="Dephosphorylation">Dephosphorylation</h2><p>Dephosphorylation is the end goal of these two groups of phosphatases, they do it through separate mechanisms.<br>Serine/threonine phosphatases mediate the direct hydrolysis of the phosphorus atom of the phosphate group using a bimetallic (Fe/Zn) center, while tyrosine phosphatases form a covalent thiophosphoryl intermediate that facilitates removal of the tyrosine residue.</p>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cHM6Ly93d3cudGhlcm1vZmlzaGVyLmNvbS9jbi96aC9ob21lL2xpZmUtc2NpZW5jZS9wcm90ZWluLWJpb2xvZ3kvcHJvdGVpbi1iaW9sb2d5LWxlYXJuaW5nLWNlbnRlci9wcm90ZWluLWJpb2xvZ3ktcmVzb3VyY2UtbGlicmFyeS9waWVyY2UtcHJvdGVpbi1tZXRob2RzL3Bob3NwaG9yeWxhdGlvbi5odG1s" title="https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-biology-learning-center/protein-biology-resource-library/pierce-protein-methods/phosphorylation.html">Phosphorylation<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MxMDQzMjc2MDE1MDAxOTY0P25wPXk=" title="http://www.sciencedirect.com/science/article/pii/S1043276015001964?np=y">Protein Phosphorylation: A Major Switch Mechanism for Metabolic Regulation<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Introduction&quot;&gt;Introduction&lt;/h2&gt;&lt;h3 id=&quot;PTM&quot;&gt;PTM&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/1437671615999.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;Post-translational modification (PTM) serves as molecular switch mechanism, modulating diverse protein functions including enzymatic activity, protein turnover, interactions, conformation, localization, and crosstalk with other PTMs, which in turn regulate broad cellular biological functions.&lt;br&gt;These modifications include phosphorylation, glycosylation, ubiquitination, nitrosylation, methylation, acetylation, lipidation and proteolysis.&lt;br&gt;
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="Phosphorylation" scheme="http://tiramisutes.github.io/tags/Phosphorylation/"/>
    
  </entry>
  
  <entry>
    <title>PacBio sequence error correction amd assemble via pacBioToCA</title>
    <link href="http://tiramisutes.github.io/2016/08/27/PBcR.html"/>
    <id>http://tiramisutes.github.io/2016/08/27/PBcR.html</id>
    <published>2016-08-27T11:57:48.000Z</published>
    <updated>2018-09-28T02:39:48.680Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Illumina</strong>二代测序有个致命缺陷，说到底还是基于PCR扩增的,所以存在偏向性和对于高GC含量区无法扩增等<a href="#" class="myButton">系统误差</a>，测序错误是不可避免的，其次就是测序长度短；但其价格便宜，通量非常高，准确性达99%，综合性价比也受到青睐。短序列的reads在做基因组装的时候，遇到大的重复片段就会很吃力。</p>
<h2 id="10X_Genomics">10X Genomics</h2><p>2015年备受瞩目的测序黑马：<strong>10X Genomics</strong>，是常规Illumina二代测序的升级版，由于开发出了一套巧妙的Barcoding建库方案，使得Illumina这种短读长二代测序能够得到跨度在30-100Kb的linked reads信息，与二代测序数据相结合，在Scaffold的组装上能够得到媲美三代测序的组装结果；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/10xgenome.png" alt=""><br><a id="more"></a><br><strong>基本原理:</strong> 首先将每一条长片段的DNA分配至不同的油滴微粒中，通过专利的GEM建库技术，长片段DNA被<code>切碎</code>成适合测序的大小，并且来源于相同油滴(同一条长片段DNA)的DNA片段，会带上相同的一段DNA序列标记(Barcode)，之后在Illumina系统上测序完成后，可以理论上再将来源相同的DNA序列独立拼接，得到原先的长片段DNA序列。<br>对于不同GC含量区其效果如何呢？2015年10月Nat Review Genetics文章<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25yZy9qb3VybmFsL3YxNi9uMTEvZnVsbC9ucmczOTMzLmh0bWw=" title="http://www.nature.com/nrg/journal/v16/n11/full/nrg3933.html">Genetic variation and the de novo assembly of human genomes<i class="fa fa-external-link"></i></span>中总结的PacBio、10X Genomics以及Illumina技术在不同GC含量DNA区域的覆盖度分布：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/10Xgenome2.png" alt=""><br>10X Genomics技术相对于Illumina来说，有改进，但依旧是个拱形，而PacBio则是无偏倚的均一分布，10X的技术，其Coverage一样是受GC含量影响较大的，那么如果真要应用10X技术，那么必须注意目标DNA的GC含量分布最好能控制在30～70%。<br>但10Xgenome毕竟是升级版，其也存在一些特有的优势：</p>
<p><li>(1) 微量样本：仅需<a href="#" class="myButton">1ng</a>基因组DNA即可进行长片段建库；</li></p>
<p><li>(2) 精确分区：由于拥有众多的barcode和Partions，可对DNA进行精确分区；</li></p>
<p><li>(3) 长片段信息：该技术可与Illumina测序仪进行无缝对接，利用短Reads可获得长达100Kb的片段；</li></p>
<p><li>(4) 基因组组装质量提升：利用长片段信息结合Illumina组装数据组装的ScaffoldN50长度比单纯用Illumina方法提高十几倍。</li></p>
<h2 id="PacBio">PacBio</h2><p><embed src="http://player.youku.com/player.php/sid/XNjAwODQwOTky/v.swf" allowfullscreen="true" quality="high" width="620" height="450" align="middle" allowscriptaccess="always" type="application/x-shockwave-flash"><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PacBio.png" alt=""><br>第三代测序中的<a href="#" class="myButton">PacBio单分子实时</a>（Single Molecule Real-Time, SMRT）DNA测序可以实现超过99.999%（QV50）的高度精确测序，且不受DNA序列中GC和AT含量的影响，平均读长可达20kb（最长&gt;60kb）。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/reads-error.png" alt=""><br>PacBio三代测序最大的死穴是：通量不足和单次(1X)测序错误率高(85%)；但三代的错误是<a href="#" class="myButton">完全随机发生的，属于随机误差</a>，可以靠覆盖度来自我纠错，如果通量不是限制因素，那么PacBio是目前最准确的测序方式：错误率可以无限接近罕见突变的发生率（即无法分辨是测序错误还是罕见突变）。2012年冷泉港实验室的Michael Schatz开发了一种纠错算法，用二代测序的短读长高精确数据对三代长读长数据进行纠错，这种称为”混合纠错拼接” (<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3YzMC9uNy9hYnMvbmJ0LjIyODAuaHRtbA==" title="http://www.nature.com/nbt/journal/v30/n7/abs/nbt.2280.html">Hybrid error correction and de novo assembly of single-molecule sequencing reads<i class="fa fa-external-link"></i></span>)可以进一步提升PacBio测序精确度。</p>
<h3 id="PBcR:_混合纠错拼接">PBcR: 混合纠错拼接</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PBcR.png" alt=""><br><i class="fa fa-chrome" aria-hidden="true"></i><a href="#" class="myButton">PBcR: 混合纠错拼接</a> 粉色长方形：单个PacBio RS reads；黑色竖线：测序错误；(a)由于测序错误碱基的存在使得两条reads就难确定是否在末端重叠；(b)高质量的短reads比对到存在错误的长reads；短reads中的黑色竖线表示 ‘mapping errors’ ，是长reads和短reads中测序错误的组合，此外双拷贝的重复序列的存在（灰色轮廓）导致在每一个拷贝中出现短reads的堆挤，为避免reads map到错误的重复区，仅保留最高比对值的短reads；(c)剩余的比对形成一致性序列（紫色长方形），长reads和短reads中共有的部分错误未能得到纠正；(d)overlap纠正后的长reads；(e) 最后的组装能够跨越重复区域。</p>
<h3 id="Illumina_reads纠错覆盖度">Illumina reads纠错覆盖度</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/correct1.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/correct2.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/correct3.png" alt=""><br>纠错的准确性和组装一致性在Illumina高质量reads达<a href="#" class="myButton">50X</a>后开始收益递减，因此50X Illumina reads足够，纠错后PacBio长reads准确性将由85%提升至&gt;99.9%，此时嵌合体和错误剪切reads分别为&lt;2.5% 和 &lt;1%。<br>目前在P6C4试剂下，大约每SMRT Cell平均可以做到 600M～1G数据量。<br>PacBio的长读长、无GC偏向性和无PCR扩增偏向性等独特优势有助于克服复杂的重复区域，从而跨越整个基因转录区，显著提升基因组和转录组的De Nove组装质量；</p>
<h2 id="Illumina二代+PacBio三代数据分析">Illumina二代+PacBio三代数据分析</h2><p><span class="exturl" data-url="aHR0cDovL3d3dy5jYmNiLnVtZC5lZHUvc29mdHdhcmUvUEJjUi8=" title="http://www.cbcb.umd.edu/software/PBcR/">PBcR<i class="fa fa-external-link"></i></span>首先通过纠错来提升PacBio reads准确性，然后进行组装。PBcR的纠错和组装分为self-correction (using only PacBio RS data，自动运行fastqToCA) or correction with high-identity sequences（二代数据）。</p>
<h3 id="self-correction">self-correction</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PBcR -length 500 -partitions 200 -l lambda -s pacbio.spec -fastq pacbio.filtered_subreads.fastq genomeSize=50000 &gt; run.out 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<h3 id="高质量Illumina_reads">高质量Illumina reads</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#short read准备</span></span><br><span class="line">fastqToCA -libraryname illumina -technology illumina -reads illumina.fastq &gt; illumina.frg</span><br><span class="line"><span class="comment">#纠正</span></span><br><span class="line">pacBioToCA -length 500 -partitions 200 -l ec_pacbio -t 16 -s pacbio.spec \</span><br><span class="line">    -fastq pacbio.filtered_subreads.fastq illumina.frg &gt; run.out 2&gt;&amp;1</span><br><span class="line"><span class="comment">#组装</span></span><br><span class="line">runCA -p asm -d asm -s asm.spec ec_pacbio.frg &gt; asm.out 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-chrome" aria-hidden="true"></i>： 第一步short reads准备阶段请确认二代数据第四行质量编码值，一般是33，否则用-type参数指定，要不然会报错QV问题；<br>纠正时PBcR需要安装AMOS和blasr依赖软件，输入文件short reads (illumina.frg)和long reads (pacbio.filtered_subreads.fastq)；<br>fastqToCA和PBcR两个中的libraryname需不同；<br>fastqToCA生成的frg文件后面没有序列信息 ，是正确的；</p>
<h3 id="Spec_files参数解释">Spec files参数解释</h3><p>PBcR混合组装需要指定两个Spec配置文件： pacbio.spec(纠错)和asm.spec(组装)。这两个文件都包含特定的算法参数和计算机硬件参数，通常情况下算法参数可以忽略（此时将用软件默认值），但是计算机硬件参数需要根据实际情况调整。<br>所有参数均为<code>option = value</code>形式，其中的value为布尔型(boolean),即true=1，false=0。<br><i class="fa fa-book" aria-hidden="true"></i>具体关于specfile参数解释见<a href="http://tiramisutes.github.io/2016/08/26/pacbio-spec.html" target="_blank">PBcR：SpecFiles Options</a></p>
<h3 id="Spec_files实例">Spec files实例</h3><h4 id="集群下参考pacbio-spec">集群下参考pacbio.spec</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#以下为grid计算</span></span><br><span class="line">stopAfter=overlapper</span><br><span class="line"></span><br><span class="line"><span class="comment"># original asm settings</span></span><br><span class="line">utgErrorRate = 0.25</span><br><span class="line">utgErrorLimit = 4.5</span><br><span class="line"></span><br><span class="line">cnsErrorRate = 0.25</span><br><span class="line">cgwErrorRate = 0.25</span><br><span class="line">ovlErrorRate = 0.25</span><br><span class="line"></span><br><span class="line">merSize=14</span><br><span class="line"></span><br><span class="line">merylMemory = 128000</span><br><span class="line">merylThreads = 16</span><br><span class="line"></span><br><span class="line">ovlStoreMemory = 8192</span><br><span class="line"></span><br><span class="line"><span class="comment"># grid info</span></span><br><span class="line">useGrid = 1</span><br><span class="line">scriptOnGrid = 1</span><br><span class="line">frgCorrOnGrid = 1</span><br><span class="line">ovlCorrOnGrid = 1</span><br><span class="line"></span><br><span class="line">sge = -V -S /bin/sh</span><br><span class="line"><span class="comment">#sge = -V -A assembly</span></span><br><span class="line">sgeScript = -pe smp 16</span><br><span class="line">sgeConsensus = -pe smp 1</span><br><span class="line">sgeOverlap = -pe smp 4</span><br><span class="line">sgeFragmentCorrection = -pe smp 2</span><br><span class="line">sgeOverlapCorrection = -pe smp 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#ovlMemory=8GB --hashload 0.7</span></span><br><span class="line">ovlHashBits = 25</span><br><span class="line">ovlThreads = 4</span><br><span class="line">ovlHashBlockLength = 20000000</span><br><span class="line">ovlRefBlockSize =  50000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># for mer overlapper</span></span><br><span class="line">merCompression = 1</span><br><span class="line">merOverlapperSeedBatchSize = 500000</span><br><span class="line">merOverlapperExtendBatchSize = 250000</span><br><span class="line"></span><br><span class="line">frgCorrThreads = 2</span><br><span class="line">frgCorrBatchSize = 100000</span><br><span class="line"></span><br><span class="line">ovlCorrBatchSize = 100000</span><br><span class="line"></span><br><span class="line"><span class="comment">######################以下为非gird计算，useGrid = 0 ####################</span></span><br><span class="line"><span class="comment"># non-Grid settings, if you set useGrid to 0 above these will be used</span></span><br><span class="line">merylMemory = 128000</span><br><span class="line">merylThreads = 4</span><br><span class="line"></span><br><span class="line">ovlStoreMemory = 8192</span><br><span class="line"></span><br><span class="line">ovlConcurrency = 6</span><br><span class="line"></span><br><span class="line">cnsConcurrency = 16</span><br><span class="line"></span><br><span class="line">merOverlapperThreads = 2</span><br><span class="line">merOverlapperSeedConcurrency = 6</span><br><span class="line">merOverlapperExtendConcurrency = 6</span><br><span class="line"></span><br><span class="line">frgCorrConcurrency = 8</span><br><span class="line">ovlCorrConcurrency = 16</span><br><span class="line">cnsConcurrency = 16</span><br></pre></td></tr></table></figure>
<h4 id="集群下参考asm-spec">集群下参考asm.spec</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">######################以下为gird计算，useGrid = 1 ####################</span></span><br><span class="line">cnsErrorRate = 0.10</span><br><span class="line">ovlErrorRate = 0.10</span><br><span class="line"></span><br><span class="line">overlapper = ovl</span><br><span class="line">unitigger = bogart</span><br><span class="line">utgBubblePopping = 1</span><br><span class="line"></span><br><span class="line">merSize = 14</span><br><span class="line"></span><br><span class="line">merylMemory = 128000</span><br><span class="line">merylThreads = 16</span><br><span class="line"></span><br><span class="line">ovlStoreMemory = 8192</span><br><span class="line"></span><br><span class="line"><span class="comment"># grid info</span></span><br><span class="line">useGrid = 1</span><br><span class="line">scriptOnGrid = 1</span><br><span class="line">frgCorrOnGrid = 1</span><br><span class="line">ovlCorrOnGrid = 1</span><br><span class="line"></span><br><span class="line">sge = -V -S /bin/sh</span><br><span class="line">sgeScript = -pe smp 16</span><br><span class="line">sgeConsensus = -pe smp 1</span><br><span class="line">sgeOverlap = -pe smp 4</span><br><span class="line">sgeFragmentCorrection = -pe smp 2</span><br><span class="line">sgeOverlapCorrection = -pe smp 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#ovlMemory=8GB --hashload 0.7</span></span><br><span class="line">ovlHashBits = 25</span><br><span class="line">ovlThreads = 6</span><br><span class="line">ovlHashBlockLength = 20000000</span><br><span class="line">ovlRefBlockSize =  5000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># for mer overlapper</span></span><br><span class="line">merCompression = 1</span><br><span class="line">merOverlapperSeedBatchSize = 500000</span><br><span class="line">merOverlapperExtendBatchSize = 250000</span><br><span class="line"></span><br><span class="line">frgCorrThreads = 2</span><br><span class="line">frgCorrBatchSize = 100000</span><br><span class="line"></span><br><span class="line">ovlCorrBatchSize = 100000</span><br><span class="line"></span><br><span class="line"><span class="comment">######################以下为非gird计算，useGrid = 0 ####################</span></span><br><span class="line"><span class="comment"># non-Grid settings, if you set useGrid to 0 above these will be used</span></span><br><span class="line">merylMemory = 128000</span><br><span class="line">merylThreads = 12</span><br><span class="line"></span><br><span class="line">ovlStoreMemory = 8192</span><br><span class="line"></span><br><span class="line">ovlConcurrency = 8</span><br><span class="line"></span><br><span class="line">merOverlapperThreads = 6</span><br><span class="line">merOverlapperSeedConcurrency = 2</span><br><span class="line">merOverlapperExtendConcurrency = 2</span><br><span class="line"></span><br><span class="line">frgCorrConcurrency = 8</span><br><span class="line"></span><br><span class="line">ovlCorrConcurrency = 16</span><br><span class="line">cnsConcurrency = 16</span><br><span class="line"></span><br><span class="line">doToggle=0</span><br><span class="line">toggleNumInstances = 0</span><br><span class="line">toggleUnitigLength = 2000</span><br><span class="line"></span><br><span class="line">doOverlapBasedTrimming = 1</span><br><span class="line">doExtendClearRanges = 2</span><br></pre></td></tr></table></figure>
<h2 id="输出结果">输出结果</h2><p><li>最后组装结果文件夹<code>9-terminator</code>;</li></p>
<p><li>主要输出文件是<strong>prefix.asm</strong>,以分层的数据结构提供组装结果的精确描述，包含生成的contig 和 scaffold 序列；</li></p>
<p><li><strong>prefix.qc</strong>，关于组装结果的统计信息；</li></p>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yMDcyMzkzND9yZWZlcj10YW5nYm95dW4=" title="https://zhuanlan.zhihu.com/p/20723934?refer=tangboyun">当10X Genomics遇上PacBio——烫金开始剥落了<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy56aGlodS5jb20vcXVlc3Rpb24vMjU0MDk4ODIvYW5zd2VyLzQyODkxMjEzP3V0bV9jYW1wYWlnbj1yc3MmdXRtX21lZGl1bT1yc3MmdXRtX3NvdXJjZT1yc3MmdXRtX2NvbnRlbnQ9dGl0bGU=" title="http://www.zhihu.com/question/25409882/answer/42891213?utm_campaign=rss&utm_medium=rss&utm_source=rss&utm_content=title">第三代测序成本偏高是什么原因导致的？<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3dpa2kucmFjLm1hbmNoZXN0ZXIuYWMudWsvY29tbXVuaXR5L1NHRV9Kb2JfQXJyYXlz" title="http://wiki.rac.manchester.ac.uk/community/SGE_Job_Arrays">Computational Science Community Wiki： Sun Grid Engine: Job Arrays<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;Illumina&lt;/strong&gt;二代测序有个致命缺陷，说到底还是基于PCR扩增的,所以存在偏向性和对于高GC含量区无法扩增等&lt;a href=&quot;#&quot; class=&quot;myButton&quot;&gt;系统误差&lt;/a&gt;，测序错误是不可避免的，其次就是测序长度短；但其价格便宜，通量非常高，准确性达99%，综合性价比也受到青睐。短序列的reads在做基因组装的时候，遇到大的重复片段就会很吃力。&lt;/p&gt;
&lt;h2 id=&quot;10X_Genomics&quot;&gt;10X Genomics&lt;/h2&gt;&lt;p&gt;2015年备受瞩目的测序黑马：&lt;strong&gt;10X Genomics&lt;/strong&gt;，是常规Illumina二代测序的升级版，由于开发出了一套巧妙的Barcoding建库方案，使得Illumina这种短读长二代测序能够得到跨度在30-100Kb的linked reads信息，与二代测序数据相结合，在Scaffold的组装上能够得到媲美三代测序的组装结果；&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/10xgenome.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="PacBio" scheme="http://tiramisutes.github.io/tags/PacBio/"/>
    
  </entry>
  
  <entry>
    <title>PBcR：SpecFiles Options</title>
    <link href="http://tiramisutes.github.io/2016/08/26/pacbio-spec.html"/>
    <id>http://tiramisutes.github.io/2016/08/26/pacbio-spec.html</id>
    <published>2016-08-26T06:33:11.000Z</published>
    <updated>2018-09-28T02:39:34.670Z</updated>
    
    <content type="html"><![CDATA[<p>The spec file is an optional input to the runCA executive that launches the Celera Assembler pipeline. The spec files provides a convenient way to generate assemblies while documenting their parameters faithfully. The use of spec files is STRONGLY recommended.</p>
<h2 id="Spec_files参数解释">Spec files参数解释</h2><p>PBcR混合组装需要指定两个Spec配置文件： pacbio.spec(纠错)和asm.spec(组装)。这两个文件都包含特定的算法参数和计算机硬件参数，通常情况下算法参数可以忽略（此时将用软件默认值），但是计算机硬件参数需要根据实际情况调整。<br>所有参数均为<code>option = value</code>形式，其中的value为布尔型(boolean),即true=1，false=0。<br><a id="more"></a><br><a href="#" class="myButton">全局参数</a></p>
<p><li><strong>showNext=boolean (default=0)</strong>： 如果设定，下一步主要命令将输出到屏幕而不执行；</li></p>
<p><li><strong>pathMap=filename (default=empty-string)</strong>： filename包含主机到软件工作目录的映射，这个参数通常不需要指定；</li></p>
<p><li><strong>shell=string (default=/bin/sh)</strong>： 指定运行脚本的命令解释器；</li></p>
<h4 id="错误率(Error_Rates)">错误率(Error Rates)</h4><p>共有5个可配制的错误率，’error rate’在overlap中是小数，取值范围为0.0到0.4，而’error limit’是绝对值，取值范围没有限制。overlap取值只要低于’error rate’ 或 ‘error limit’阈值中的任意一个就将被取用。<strong>例如，100个碱基中overlap错误率为2%，假如 utgErrorRate=0.015并且utgErrorLimit=2.5，那么2%的overlap值将用于unitigging中。</strong><br><code>错误率必须是utg ≤ ovl ≤ cns ≤ cgw. 通常情况下, ovl = cns</code></p>
<p><li><strong>ovlErrorRate=float (default=0.06)</strong>： overlap的误差界限，运用在trim和assembly过程中，超过这一界限值的overlap将不会被检测到。</li></p>
<p><li><strong>cnsErrorRate=float (default=0.06)</strong>： 一致性的错误率；</li></p>
<p><li><strong>cgwErrorRate=float (default=0.10)</strong>： scaffolder的错误率，低于此值的scaffolder将融合成unitigs和contigs；</li></p>
<p><li><strong>obtErrorLimit=float (default=see below)</strong>： 控制overlap碱基整理过程中的overlap质量，仅影响trim过程；</li><br>Unitigger的错误率较为复杂，Overlaps中的错误率不能用在unitig构建中，每一个unitig比对使用一个不同的错误率设定值；<br>1&gt;utg uses utgErrorRate.<br>2&gt;bog uses utgErrorRate and utgErrorLimit.<br>3&gt;bogart uses utgGraphErrorRate, utgGraphErrorLimit, utgMergeErrorRate and utgMergeErrorLimit.</p>
<p><li><strong>utgErrorRate=float (default=0.015 for utg and 0.030 for bog)</strong>： 低于设定值的overlap将用于utg 和 bog的unitiggers中；</li></p>
<p><li><strong>utgErrorLimit=float (default=2.5)</strong>： 低于设定值的overlap将用于utg 和 bog的unitiggers中；</li></p>
<p><li><strong>utgGraphErrorRate=float (default=0.030)</strong>： 低于设定值的overlap将用于 bogart unitigger中最好的重叠图谱构建； bogart unitigger被开发用来处理高覆盖度数据；</li></p>
<p><li><strong>utgGraphErrorLimit=float (default=3.25)</strong>： 同上；</li></p>
<p><li><strong>utgMergeErrorRate=float (default=0.045)</strong>： 低于设定值的overlap将用于bogart unitigger中bubble popping和重复区检测；</li></p>
<p><li><strong>utgMergeErrorLimit=float (default=5.25)</strong>： 同上；</li></p>
<h4 id="最小片段长度和最小overlap长度(Minimum_Fragment_Length_and_Minimum_Overlap_Length)">最小片段长度和最小overlap长度(Minimum Fragment Length and Minimum Overlap Length)</h4><p>低于最小长度发片段在gatekeeper中将丢弃，低于最小长度的overlap将不被计算。</p>
<p><li><strong>frgMinLen=integer (default=64)</strong>： 低于设定值的片段将不被用在组装过程中；</li></p>
<p><li><strong>ovlMinLen=integer (default=40)</strong>： 低于最小长度的overlap将不被计算；</li></p>
<h4 id="提前停止renCA运行(Stopping_runCA_Early)">提前停止renCA运行(Stopping runCA Early)</h4><p>runCA可在某一阶段运行完后停止。</p>
<p><li><strong>stopBefore=string (default=empty-string)</strong></li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>meryl</b>： Stop before computing mer histograms.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initialTrim</b>： Stop before the OBT initial quality trim.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>deDuplication</b>： Stop before the OBT de-duplication.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>finalTrimming</b>： Stop before the OBT trim point merge.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>chimeraDetection</b>： Stop before the OBT chimera detection.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>classifyMates</b>： Stop before de-novo classification.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>unitigger</b>： Stop before unitigger.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>scaffolder</b>： Stop before the scaffolding stage starts.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>CGW</b>： Stop before the CGW program starts.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>eCR</b>： Stop before the extend clear ranges program starts.  <b>extendClearRanges</b> is an alias for this.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>eCRPartition</b>： Stop before partitioning for extend clear ranges.  <b>extendClearRangesPartition</b> is an alias &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for this.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>terminator</b>： Stop before terminator.</p>
<p><li><strong>stopAfter=string (default=empty-string)</strong></li><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>initialStoreBuilding</b>： Stop after the fragment and gatekeeper stores are created.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>meryl</b>： Stop after mer counts are generates.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>overlapBasedTrimming</b>： Stop after the Overlap Based Trimming algorithm has updated the clear ranges.  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>OBT</b> is an alias for this.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>overlapper</b>： Stop after the overlapper finishes, and the overlap store is created.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>classifyMates</b>： Stop after de-novo classification.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>unitigger</b>： Stop after unitigs are constructed, but before consensus starts.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>utgcns</b>： Stop after unitig consensus finishes; <b>consensusAfterUnitigger</b> is an alias for this.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>scaffolder</b>： Stop after all stages of scaffolding are finished.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>ctgcns</b>： Stop after contig consensus finishes; <b>consensusAfterScaffolder</b> is an alias for this.</p>
<h4 id="网格计算(Grid_Engine_Options)">网格计算(Grid Engine Options)</h4><p>grid计算，useGrid = 1，需要集群的特殊支持，如果运行报错”qsub: script file ‘smp’ cannot be loaded - No such file or directory”，则说明你的当前集群环境不支持gird；详细见：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9NdXlvdVNvbWUvYXJjaGl2ZS8yMDEzLzA1LzMxLzMxMDk0ODcuaHRtbA==" title="http://www.cnblogs.com/MuyouSome/archive/2013/05/31/3109487.html">并行计算、分布式计算、集群计算和云计算<i class="fa fa-external-link"></i></span>。</p>
<p><li><strong>gridEngine=string (default=SGE)</strong>： 选择SGE或LSF做为gird引擎；</li></p>
<p><li><strong>useGrid=integer (default=0)</strong>： 0表示不使用grid；</li></p>
<p><li><strong>scriptOnGrid=integer (default=0)</strong>: 0表示只在grid上进行并行计算；</li></p>
<p><li><strong>mbtOnGrid=integer (default=1)</strong>： 0表示不在grid上进行mer-based trim；useGrid=0时此参数失效；</li></p>
<p><li><strong>ovlOnGrid=integer (default=1)</strong>： 0表示不用grid进行overlap；</li></p>
<p><li><strong>frgCorrOnGrid=integer (default=0)</strong>： frg文件纠错；</li></p>
<p><li><strong>ovlCorrOnGrid=integer (default=0)</strong>： overlap纠错；</li></p>
<p><li><strong>cnsOnGrid=integer (default=1)</strong>： 一致性；</li></p>
<p><li><strong>-pe thread N -l memory=Mg -p  400</strong>： 指定单个host下用N个cpu进行计算，并且每个cpu使用内存为Mg；所以每一个任务需要的总内存数等于NMg；例如，sgeConsensus= -pe thread 3 -l memory=2g -p -600表示仅是进行一致性计算需要3个cpu，每个cpu 2g内存，共需3X2=6g内存；</li><br><a href="#" class="myButton">局部参数</a></p>
<h4 id="Gatekeeper">Gatekeeper</h4><p><li><strong>gkpFixInsertSizes=integer (default=1)</strong>： 1表示gatekeeper将修正预估的插入大小当标准差太大或太小时，可接受的插入大小估计是<code>0.1 <em> mean &lt; std.dev. &lt; 1/3 </em> mean</code>,如果标准差超出这一范围，则重设为0.1 * mean；</li></p>
<p><li><strong>gkpAllowInefficientStorage=integer (default=1)</strong>： 1表示允许将long-reads存储在计算机内存中，对内存损耗就大，一般设置为0；</li></p>
<h4 id="Fragment_Trimming">Fragment Trimming</h4><p><li><strong>doOverlapBasedTrimming=integer (default=1) (aliasdoOBT)</strong>： 1表示做trim；</li></p>
<p><li><strong>doDeDuplication=integer (default=1)</strong>： 1表示搜寻重复reads或454数据中的mate-pairs reads；当doOBT=0时失效；</li></p>
<p><li><strong>doChimeraDetection=off or normal or aggressive (default=normal)</strong>： 通过与其他reads的比较检测嵌合体，当doOBT=0时失效；</li></p>
<p><li><strong>mbtBatchSize=integer (default=1000000)</strong>： 每次trim批处理的片段数；</li></p>
<p><li><strong>mbtThreads=integer (default=4)</strong>： 每次trim的线程数；</li></p>
<p><li><strong>mbtConcurrency=integer (default=1)</strong>： 同时运行多少个trim；</li></p>
<p><li><strong>mbtIlluminaAdapter=integer (default=1)</strong>： 在merTrim过程中移除Illumina接头序列； </li></p>
<p><li><strong>mbt454Adapter=integer (default=1)</strong>： 在merTrim过程中移除454接头序列；</li></p>
<h4 id="Overlapper">Overlapper</h4><p>每一对fragments互相比对确定是否重叠；<br>对于较小的组装，可通过期望并行计算的数量来划分fragments数，例对于16个jobs，可划分fragments为4；<br>对于较大的组装，建议用较大的ovlRefBlockSize和ovlHashBlockLength控制jobs数量；</p>
<p><li><strong>overlapper=ovl or mer (default=ovl)</strong>： 选择overlap阶段；</li></p>
<p><li><strong>obtOverlapper=ovl or mer (default=ovl)</strong>： 选择OBT (overlap-based trimming)的overlap阶段；</li></p>
<p><li><strong>ovlOverlapper=ovl or mer (default=ovl)</strong>： unitig构建过程中的overlap阶段；</li></p>
<p><li><strong>ovlStoreMemory=integer (default=1024M)</strong>： 构建overlap存储的内存量；</li></p>
<p><li><strong>saveOverlaps=integer (default = 0)</strong>： 0表示overlap store生成后清除中间文件；中间文件较大，一般选择清除；</li></p>
<p><li><strong>merSize=integer (default=22)</strong>： K-mer长度，设置这一参数相当于同时设置了obtMerSize和 ovlMerSize；</li></p>
<p><li><strong>obtMerSize=integer (default=22)</strong>： 仅的OBT过程的k-mer长度；</li></p>
<p><li><strong>ovlMerSize=integer (default=22)</strong>： unitig和组装过程的k-mer长度；</li></p>
<p><li><strong>obtMerThreshold=integer (default=auto)</strong>： 检查k-mer直方图挑选合适的k值；</li></p>
<p><li><strong>ovlMerThreshold=integer (default=auto)</strong>： 检查k-mer直方图挑选合适的k值；</li></p>
<p><li><strong>merThreshold=integer (default=auto)</strong>： 分配线程数给 obtMerThreshold 和 ovlMerThreshold；</li></p>
<h4 id="OVL_Overlapper">OVL Overlapper</h4><p><li><strong>ovlThreads=integer (default=2)</strong>： overlap计算线程数；</li></p>
<p><li><strong>ovlConcurrency=integer (default=1)</strong>： 不使用SGE时，同时进行一致性overlap的数目；</li></p>
<p><li><strong>ovlHashLoad=float (default 0.75)</strong>: 最多载入Table Size的75%；例如，22对应的Table Size为88,080,384，实际载入大小为88,080,384X75%=66060288；</li></p>
<p><li><strong>ovlHashBits=integer (default 22)</strong>： hash表大小，固定尺寸，不随 ovlHashBlockLength 或 ovlRefBlockSize变化；</li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/hash.png" alt=""></p>
<p><li><strong>ovlHashBlockLength=integer (default=100000000)</strong>： 载入hash表的序列碱基数，每一个碱基占10 bytes内存。</li></p>
<p><li><strong>ovlRefBlockSize=integer (default=2000000)</strong>: 控制overlap的jobs数目和每一个的运行时间，较小的值将需要较多的jobs，但每一个jobs完成所需时间少；</li><br><strong>ovlHashBits</strong>和<strong>ovlHashBlockLength</strong>如何综合选择呢？根据我们实际使用的计算机硬件情况决定，假如我们的计算机有8G内存，<br>1&gt;设置<code><strong>ovlHashBits=25</strong></code> 根据上面表格得知载入这个hash表将需要消耗接近7G的内存，如果是1/2 GB操作系统，那么我们500 MB内存载入序列数据，也就是ovlHashBlockLength最多为50,000,000，而25对应的hash表可以载入704,643,072 k-mers，但是我们仅能载入50,000,000 k-mer（one k-mer per base of sequence），这样是设定造成内存的浪费；<br>2&gt;设置<code><strong>ovlHashBits=24</strong></code>消耗305G内存，剩余3G载入序列，ovlHashBlockLength多达300,000,000，352,24对应的hash表能够载入321,536 k-mers，此时的配置较为合理。<br>overlap job log file (0-overlaptrim-overlap/#######.out and 1-overlapper/######.out)有助于我们筛选合适的配置值，其包含如下内容；<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HASH LOADING STOPPED: strings         38020 out of        38020 max.</span><br><span class="line">HASH LOADING STOPPED: length       15487424 out of     15487424 max.</span><br><span class="line">HASH LOADING STOPPED: entries       4435417 out of     66060288 max (load 5.04).</span><br></pre></td></tr></table></figure></p>
<p>在这里，载入15,487,424碱基序列，仅用了hash表可载入66,060,288大小的4,435,417，意味着可以增加ovlHashBlockLength (to load more sequence)或降低ovlHashBits (to use less memory)。</p>
<h4 id="MER_Overlapper">MER Overlapper</h4><p>mer overlapper 也使用 Classic Overlapper参数 obtMerSize and ovlMerSize.</p>
<p><li><strong>merCompression=integer (default=1)</strong>： ACTTTAAC with merCompression=1 would be ACTAC</li></p>
<h4 id="Meryl">Meryl</h4><p><li><strong>merylMemory=integer (default=800M)</strong></li></p>
<p><li><strong>merylThreads=integer (default=1)</strong></li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">merylMemory   = -segments 4 -threads 4</span><br><span class="line">merylThreads  = 4</span><br></pre></td></tr></table></figure></p>
<h4 id="Fragment_Error_Correction">Fragment Error Correction</h4><p><li><strong>frgCorrBatchSize=integer (default=200000)</strong>： 一次性载入的reads数；</li></p>
<p><li><strong>doFragmentCorrection=integer (default=1)</strong></li></p>
<p><li><strong>frgCorrThreads=integer (default=2)</strong></li></p>
<p><li><strong>frgCorrConcurrency=integer (default=1)</strong></li></p>
<h4 id="Unitigger">Unitigger</h4><p><li><strong>unitigger=utg or bog or bogart (default=utg)</strong>： utg（Sanger数据），bog（只有454数据或结合Sanger数据），bogart（仅有 Illumina数据或结合其他数据）;</li></p>
<p><li><strong>utgGenomeSize=integer (default=not-set)</strong>:确定其是否输入或计算 grep -i genome /4-unitigger/unitigger.err</li></p>
<h4 id="Scaffolder">Scaffolder</h4><p>Scaffold module is called CGW (chunk graph walker),It builds contigs and scaffolds from unitigs and mate pairs.</p>
<h4 id="Consensus">Consensus</h4><p>unitigger和scaffolder后的一致性</p>
<h4 id="Terminator">Terminator</h4><p><li><strong>cleanup=none or light or heavy or aggressive (default=none)</strong>： 最后组装完清除临时文件和中间文件，有效值是’none’ (no cleanup), ‘light’ (temporary files), ‘heavy’ (currently, same as light), ‘aggressive’ (everything except the output is removed)；</li></p>
<h4 id="Unitig_Repeat/Unique_Toggling">Unitig Repeat/Unique Toggling</h4><p>Celera Assembler利用泊松分布将unitigs分类为unique和重复的，由于覆盖偏向性和截断的影响，这种分类偶尔也将unique unitigs划分为重复；为避免错误组装，重复的unitigs在组装过程中是不可信的，Unitig Repeat/Unique Toggling允许Celera Assembler纠错这些”重复“unitigs，然后重新组装；这一过程将生成一个10-toggledAsm目录，最后的组装结果在10-toggledAsm/9-terminator目录下。</p>
<p><li><strong>doToggle=integer (default=0)</strong>： 1表示运行 Toggling过程；</li></p>
<h2 id="Spec_files实例">Spec files实例</h2><h3 id="pacbio-spec">pacbio.spec</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">merSize=16</span><br><span class="line">mhap=-k 16 --num-hashes 512 --num-min-matches 3 --threshold 0.04 --weighted</span><br><span class="line"></span><br><span class="line">useGrid=0</span><br><span class="line">scriptOnGrid=0</span><br><span class="line"></span><br><span class="line">ovlMemory=32</span><br><span class="line">ovlStoreMemory=32000</span><br><span class="line">threads=32</span><br><span class="line">ovlConcurrency=1</span><br><span class="line">cnsConcurrency=8</span><br><span class="line">merylThreads=32</span><br><span class="line">merylMemory=32000</span><br><span class="line">ovlRefBlockSize=20000</span><br><span class="line">frgCorrThreads = 16</span><br><span class="line">frgCorrBatchSize = 100000</span><br><span class="line">ovlCorrBatchSize = 100000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sgeScript = -pe threads 1</span><br><span class="line">sgeConsensus = -pe threads 8</span><br><span class="line">sgeOverlap = -pe threads 15 –l mem=2GB</span><br><span class="line">sgeCorrection = -pe threads 15 –l mem=2GB</span><br><span class="line">sgeFragmentCorrection = -pe threads 16 –l mem=2GB</span><br><span class="line">sgeOverlapCorrection = -pe threads 1 –l mem=16GB</span><br></pre></td></tr></table></figure>
<h3 id="asm-spec">asm.spec</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ovlStoreMemory 		=	60000</span><br><span class="line">ovlThreads 		= 	16</span><br><span class="line">ovlConcurrency 		= 	1</span><br><span class="line">cnsConcurrency 		= 	16</span><br><span class="line">merylMemory           	=	-segments 16 -threads 16</span><br><span class="line">merylThreads          	= 	16</span><br><span class="line"></span><br><span class="line">frgCorrThreads 		= 	16</span><br><span class="line">ovlCorrConcurrency	=	16</span><br><span class="line">frgCorrBatchSize 	= 	100000</span><br><span class="line">ovlCorrBatchSize 	= 	100000</span><br><span class="line"></span><br><span class="line">ovlHashBlockLength		=	300000000</span><br><span class="line">ovlRefBlockLength		=	0</span><br><span class="line">ovlRefBlockSize			=	2000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># assembly settings, designed for eukaryotic genomes (1GB+)</span></span><br><span class="line">ovlErrorRate			=	0.1</span><br><span class="line">utgErrorRate			=	0.06</span><br><span class="line">cnsErrorRate			=	0.1</span><br><span class="line">cgwErrorRate			=	0.1</span><br><span class="line">cnsErrorRate			=	0.1</span><br><span class="line">doOBT				=	1</span><br><span class="line">obtErrorRate			=	0.08</span><br><span class="line">obtErrorLimit			=	4.5</span><br><span class="line"></span><br><span class="line">batOptions			=	-RS -NS -CS</span><br><span class="line">utgGraphErrorRate		=	0.05</span><br><span class="line">utgMergeErrorRate		=	0.05</span><br><span class="line">unitigger			=	bogart</span><br><span class="line">consensus			=	pbutgcns</span><br><span class="line"></span><br><span class="line">frgMinLen			=	3000</span><br><span class="line">ovlMinLen			=	100</span><br><span class="line"></span><br><span class="line">ovlHashBits			=	24</span><br><span class="line">ovlHashLoad			=	0.80</span><br></pre></td></tr></table></figure>
<p></p><h5>参考资料</h5><br><span class="exturl" data-url="aHR0cDovL3dncy1hc3NlbWJsZXIuc291cmNlZm9yZ2UubmV0L3dpa2kvaW5kZXgucGhwL1NwZWNGaWxlcw==" title="http://wgs-assembler.sourceforge.net/wiki/index.php/SpecFiles">SpecFiles<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3dncy1hc3NlbWJsZXIuc291cmNlZm9yZ2UubmV0L3dpa2kvaW5kZXgucGhwL1J1bkNBI0dsb2JhbF9PcHRpb25z" title="http://wgs-assembler.sourceforge.net/wiki/index.php/RunCA#Global_Options">RunCA#Global_Options<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;The spec file is an optional input to the runCA executive that launches the Celera Assembler pipeline. The spec files provides a convenient way to generate assemblies while documenting their parameters faithfully. The use of spec files is STRONGLY recommended.&lt;/p&gt;
&lt;h2 id=&quot;Spec_files参数解释&quot;&gt;Spec files参数解释&lt;/h2&gt;&lt;p&gt;PBcR混合组装需要指定两个Spec配置文件： pacbio.spec(纠错)和asm.spec(组装)。这两个文件都包含特定的算法参数和计算机硬件参数，通常情况下算法参数可以忽略（此时将用软件默认值），但是计算机硬件参数需要根据实际情况调整。&lt;br&gt;所有参数均为&lt;code&gt;option = value&lt;/code&gt;形式，其中的value为布尔型(boolean),即true=1，false=0。&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="PacBio" scheme="http://tiramisutes.github.io/tags/PacBio/"/>
    
  </entry>
  
  <entry>
    <title>Perl,awk,sed One-Liners Explained, Part III： Selective Printing and Deleting of Certain Lines</title>
    <link href="http://tiramisutes.github.io/2016/08/18/perl-one-lines-III.html"/>
    <id>http://tiramisutes.github.io/2016/08/18/perl-one-lines-III.html</id>
    <published>2016-08-18T08:08:20.000Z</published>
    <updated>2016-10-01T08:24:26.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="sed_-i_备份">sed -i 备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i.bak <span class="string">'s/:/;/'</span> users</span><br></pre></td></tr></table></figure>
<p><strong>sed -i</strong>将会在原文件上执行sed命令，-i.bak将创建一个users.bak文件备份原users文件。</p>
<h3 id="只在第N行进行替换">只在第N行进行替换</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'Ns/foo/bar/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出第N行">输出第N行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'$.==N &amp;&amp; print &amp;&amp; exit'</span> test.txt</span><br><span class="line">awk <span class="string">'NR==N'</span> test.txt</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="参数解释："><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong><code>$.</code></strong>为专用变量，表示当前行编号；</p>
<h3 id="输出第N、M行">输出第N、M行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print if $.==N || $.==M'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出第N到M行">输出第N到M行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print if $.&gt;=N &amp;&amp; $.&lt;=M'</span> test.txt</span><br><span class="line">perl -ne <span class="string">'print if N .. M'</span> test.txt</span><br><span class="line">awk <span class="string">'NR==N,NR==M'</span> test.txt</span><br><span class="line">sed -n <span class="string">'N,Mp'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出最长行">输出最长行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'$1=$_ if length($_)&gt;length($1);END &#123;print $1&#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出奇数行">输出奇数行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print if $. % 2'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出偶数行">输出偶数行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print if $. % 2==0'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="重复行只输出一次，非重复行不输出">重复行只输出一次，非重复行不输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print if ++$a&#123;$_&#125; ==2'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出匹配到模式的下一行">输出匹配到模式的下一行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/模式/ &#123;getline; print&#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h4 id="参数解释：-1"><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>getline</strong>读取下一行数据,继续运行当前的awk脚本;next也的读取下一行，然后把控制权交给了awk脚本的顶部，如<code>awk ‘{if(NR==1){next} print $1,$2}’ data</code>；</p>
<h3 id="输出匹配到模式的行到最后一行">输出匹配到模式的行到最后一行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/模式/,0'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出匹配到模式1到模式2_的行">输出匹配到模式1到模式2 的行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/模式1/,/模式2/'</span> test.txt  <span class="comment">#包括模式1和2</span></span><br><span class="line">awk <span class="string">'/模式1/,/模式2/&#123;if (!/模式1/&amp;&amp;!/模式2/)print&#125;'</span> test.txt <span class="comment">#不包括模式1和2自身</span></span><br></pre></td></tr></table></figure>
<h3 id="删除所有空行">删除所有空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk NF test.txt</span><br></pre></td></tr></table></figure>
<p><strong>空行时NF是零</strong></p>
<h3 id="文件1和文件2根据某一列对应值合并">文件1和文件2根据某一列对应值合并</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$ cat datafile </span><br><span class="line">20081010 1123 xxx</span><br><span class="line">20081011 1234 def</span><br><span class="line">20081012 0933 xyz</span><br><span class="line">20081013 0512 abc</span><br><span class="line">20081013 0717 def</span><br><span class="line">[zpxu@node102 ~]$ cat <span class="built_in">mapfile</span> </span><br><span class="line">abc withdrawal</span><br><span class="line">def payment</span><br><span class="line">xyz deposit</span><br><span class="line">xxx balance</span><br><span class="line">[zpxu@node102 ~]$ awk <span class="string">'NR==FNR&#123;a[$1]=$2;next&#125; &#123;$3=a[$3]&#125;1'</span> <span class="built_in">mapfile</span> datafile</span><br><span class="line">20081010 1123 balance</span><br><span class="line">20081011 1234 payment</span><br><span class="line">20081012 0933 deposit</span><br><span class="line">20081013 0512 withdrawal</span><br><span class="line">20081013 0717 payment</span><br></pre></td></tr></table></figure>
<h3 id="空白单元格">空白单元格</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.txt </span><br><span class="line">a       4       5       6</span><br><span class="line">b               5</span><br><span class="line">d       1</span><br><span class="line">s       5       3       5</span><br><span class="line">$ <span class="comment">#想要效果，替换空白单元格为NA</span></span><br><span class="line">$ awk <span class="string">'BEGIN&#123;FS=OFS="\t"&#125; &#123;for(i=1;i&lt;=NF;i++) if ($i~/^$/) $i="NA"&#125;;1'</span> test.txt </span><br><span class="line">a       4       5       6</span><br><span class="line">b       NA      5       NA</span><br><span class="line">d       1       NA      NA</span><br><span class="line">s       5       3       5</span><br></pre></td></tr></table></figure>
<h4 id="参数解释：-2"><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>awk中最后的数字1是<code>{ print $0 }</code>的简写。</strong><br>另一种效果：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ cat myfile.csv </span><br><span class="line">1,2,3,4,5,6,7</span><br><span class="line">,,,,,,</span><br><span class="line">1,,,4,5,,</span><br><span class="line">,2,3,4,5,,</span><br><span class="line">$ cat fill-empty-values.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $( seq 1 2); <span class="keyword">do</span></span><br><span class="line">  sed -e <span class="string">"s/^,/<span class="variable">$2</span>,/"</span> -e <span class="string">"s/,,/,<span class="variable">$2</span>,/g"</span> -e <span class="string">"s/,$/,<span class="variable">$2</span>/"</span> -i <span class="variable">$1</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">$ bash fill-empty-values.sh myfile.csv 0</span><br><span class="line">$ cat myfile.csv </span><br><span class="line">1,2,3,4,5,6,7</span><br><span class="line">0,0,0,0,0,0,0</span><br><span class="line">1,0,0,4,5,0,0</span><br><span class="line">0,2,3,4,5,0,0</span><br></pre></td></tr></table></figure></p>
<p>more：<i class="fa fa-link" aria-hidden="true"></i> <span class="exturl" data-url="aHR0cDovL3d3dy5jYXRvbm1hdC5uZXQvYmxvZy90ZW4tYXdrLXRpcHMtdHJpY2tzLWFuZC1waXRmYWxscy8jYXdrX3Jhbmdlcw==" title="http://www.catonmat.net/blog/ten-awk-tips-tricks-and-pitfalls/#awk_ranges">http://www.catonmat.net/blog/ten-awk-tips-tricks-and-pitfalls/#awk_ranges<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;sed_-i_备份&quot;&gt;sed -i 备份&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sed -i.bak &lt;span class=&quot;string&quot;&gt;&#39;s/:/;/&#39;&lt;/span&gt; users&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;sed -i&lt;/strong&gt;将会在原文件上执行sed命令，-i.bak将创建一个users.bak文件备份原users文件。&lt;/p&gt;
&lt;h3 id=&quot;只在第N行进行替换&quot;&gt;只在第N行进行替换&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sed &lt;span class=&quot;string&quot;&gt;&#39;Ns/foo/bar/&#39;&lt;/span&gt; test.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;输出第N行&quot;&gt;输出第N行&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;perl -ne &lt;span class=&quot;string&quot;&gt;&#39;$.==N &amp;amp;&amp;amp; print &amp;amp;&amp;amp; exit&#39;&lt;/span&gt; test.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;awk &lt;span class=&quot;string&quot;&gt;&#39;NR==N&#39;&lt;/span&gt; test.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Perl" scheme="http://tiramisutes.github.io/categories/Perl/"/>
    
    
      <category term="One-Liners" scheme="http://tiramisutes.github.io/tags/One-Liners/"/>
    
  </entry>
  
  <entry>
    <title>Perl,awk,sed One-Liners Explained, Part II： Text Conversion and Substitution</title>
    <link href="http://tiramisutes.github.io/2016/08/18/perl-one-lines-II.html"/>
    <id>http://tiramisutes.github.io/2016/08/18/perl-one-lines-II.html</id>
    <published>2016-08-18T03:02:20.000Z</published>
    <updated>2016-08-18T08:09:52.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="所有字符大写">所有字符大写</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -nle <span class="string">'print uc'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="所有字符小写">所有字符小写</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -nle <span class="string">'print lc'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="行首字母大写">行首字母大写</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl -nle <span class="string">'print ucfirst lc'</span> test.txt</span><br><span class="line">等同于</span><br><span class="line">perl -nle <span class="string">'print "\u\L$_"'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="去掉每行行首空格">去掉每行行首空格</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">perl -ple <span class="string">'s^[ \t]+//'</span> test.txt</span><br><span class="line">awk <span class="string">'&#123; sub(/^[ \t]+/, ""); print &#125;'</span> test.txt</span><br><span class="line">sed <span class="string">'s/^[ \t]*//'</span> test.txt</span><br><span class="line">等同于</span><br><span class="line">perl- ple <span class="string">'s/^\s+//'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="去掉从开头到结尾的空格">去掉从开头到结尾的空格</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">perl -ple <span class="string">'s/^[ \t]+|[ \t]+$//g'</span> test.txt</span><br><span class="line">awk <span class="string">'&#123; gsub(/^[ \t]+|[ \t]+$/, ""); print &#125;'</span> test.txt</span><br><span class="line">awk <span class="string">'&#123;$1=$1; print&#125;'</span> test.txt</span><br><span class="line">sed <span class="string">'s/^[ \t]*//;s/[ \t]*$//'</span> test.txt</span><br></pre></td></tr></table></figure>
<p><strong>sub和gsub区别：sub替换遇到的第一个字符，而gsub相当于全局替换；</strong></p>
<h3 id="转换DOS/Windows换行符为UNIX换行符">转换DOS/Windows换行符为UNIX换行符</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'s|\r\n|\n|'</span> test.txt</span><br><span class="line">awk <span class="string">'&#123; sub(/\r$/,""); print &#125;'</span> test.txt</span><br><span class="line">sed <span class="string">'s/.$//'</span> test.txt</span><br><span class="line">sed <span class="string">'s/^M$//'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="替换A为S">替换A为S</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'s/A/S/g'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="仅替换最后一个A为S">仅替换最后一个A为S</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'s/\(.*\)A/\1S/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="在C行替换A为S">在C行替换A为S</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'/C/ &amp;&amp; s/A/S/g'</span> test.txt</span><br><span class="line">awk <span class="string">'/C/ &#123; gsub(/A/, "S") &#125;; &#123; print &#125;'</span> test.txt</span><br><span class="line">sed <span class="string">'/C/s/A/S/g'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="awk_中sort排序">awk 中sort排序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">":"</span> <span class="string">'&#123;print $1 | "sort"&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="删除第二列">删除第二列</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;$2=""; print&#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="每一列倒序输出">每一列倒序输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;for (i=NF;i&gt;0;i--) printf("%s ",$i); printf ("\n")&#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="sed实现tac功能">sed实现tac功能</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'1!G;h;$!d'</span> test.txt</span><br></pre></td></tr></table></figure>
<h4 id="参数解释："><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>1!G</strong>表示第一行不执行G命令；<br><strong>$!d</strong>表示最后一行不执行d命令；</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;所有字符大写&quot;&gt;所有字符大写&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c
    
    </summary>
    
      <category term="Perl" scheme="http://tiramisutes.github.io/categories/Perl/"/>
    
    
      <category term="One-Liners" scheme="http://tiramisutes.github.io/tags/One-Liners/"/>
    
  </entry>
  
  <entry>
    <title>Perl, awk, sed One-Liners Explained, Part I： File Spacing, Numbering and Calculations</title>
    <link href="http://tiramisutes.github.io/2016/08/13/perl-one-lines-I.html"/>
    <id>http://tiramisutes.github.io/2016/08/13/perl-one-lines-I.html</id>
    <published>2016-08-13T11:06:55.000Z</published>
    <updated>2016-08-24T06:49:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="文件间距">文件间距</h2><h3 id="两倍行距">两倍行距</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cat test.txt</span><br><span class="line">Marrys 2143     78       84       77      239</span><br><span class="line">Jacks  2321     78       78       45      189</span><br><span class="line">Toms   2122     48       77       71      196</span><br><span class="line">Mikes  2537     87       97       95      279</span><br><span class="line">Bobs   2415     40       57       62      159</span><br><span class="line">perl -pe <span class="string">'$\="\n"'</span> test.txt</span><br><span class="line">Marrys 2143     78       84       77      239</span><br><span class="line"></span><br><span class="line">Jacks  2321     78       78       45      189</span><br><span class="line"></span><br><span class="line">Toms   2122     48       77       71      196</span><br><span class="line"></span><br><span class="line">Mikes  2537     87       97       95      279</span><br><span class="line"></span><br><span class="line">Bobs   2415     40       57       62      159</span><br><span class="line"></span><br><span class="line"><span class="comment">#最终one line perl命令行相当于如下循环</span></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">    $\ = <span class="string">"\n"</span>;</span><br><span class="line">&#125; <span class="built_in">continue</span> &#123;</span><br><span class="line">    <span class="built_in">print</span> or die <span class="string">"-p failed: $!\n"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="参数解释："><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>-e</strong>：命令行进入执行perl程序，而不需要编写perl脚本文件；<br><strong>-p</strong>：相当于perl语言的while循环，遍历所有输入内容(input或&lt;&gt;)，执行后面的命令并将结果传递给<strong>$_</strong>，最后print;<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">    <span class="comment"># your program goes here</span></span><br><span class="line">&#125; <span class="built_in">continue</span> &#123;</span><br><span class="line">    <span class="built_in">print</span> or die <span class="string">"-p failed: $!\n"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>$\</strong>：相当于awk中的ORS，每次print时执行一次。<br>相同效果<code>perl -pe ‘s/$/\n/‘ test.txt</code>和<code>perl -pe ‘$_ .= “\n”‘ test.txt</code></p>
<p></p><p></p><br><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘1; { print “” }’ test.txt</code> = <code>awk ‘{ print } { print “” }’ test.txt</code></strong><br><strong><i class="fa fa-sign-language" aria-hidden="true"></i>简单粗暴sed版<code>sed G test.txt</code>两个换行符一个由G从保持空间传入交换到模式空间，另一个是sed流编辑器本身输出；</strong><br><strong>更多关于sed高级命令见<a href="http://tiramisutes.github.io/2015/12/25/advanced-sed.html" target="_blank">Advanced-sed：n，N，d，D，p，P，b, T,t,h，H，g，G，x,y</a></strong><p></p>
<h3 id="两倍行距，除了空行">两倍行距，除了空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_.="\n" unless /^$/'</span> test.txt</span><br><span class="line"><span class="comment">#等同于</span></span><br><span class="line">perl -pe <span class="string">'$_ .= "\n" if /\S/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h4 id="参数解释：-1"><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>^$</strong>：表示空行；<br><strong>\S</strong>：大写S，\S相对于\s，if /\S/结果就是匹配这一行包含至少一个非空（tab, vertical tab, space, etc）字符。</p>
<p></p><p></p><br><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘NF { print $0 “\n” }’ test.txt</code>,空行时NF为0，可有效过滤掉空行。</strong><br><strong><i class="fa fa-sign-language" aria-hidden="true"></i>简单粗暴sed版<code>sed ‘/^$/d;G’ test.txt</code>  /^$/表示匹配空行，d表示删除，即首先将匹配到的空行全部删除，然后在执行G；</strong><br><strong>去掉两倍行距：<code>sed ‘n;d’ test.txt</code>，n表示读入下一行，即模式空间里同时每次存在两行内容；</strong><br>注意：sed中-n和n的区别，例如<code>sed -n ‘n;p’ test.txt</code>,在一般 sed 的用法中，所有来自 STDIN的资料一般都会被列出到屏幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来,而单引号中的n表示读取下一行到pattern space，由于pattern space中有按照正常流程读取的内容，使用n命令后，pattern space中又有了一行，此时，pattern space中有2行内容，但是先读取的那一行不会被取代、覆盖或删除；当n命令后，还有其他命令p的时候，此时打印出的结果是n命令读取的那一行的内容，即第二时间读入的，也就是n命令后的其他命令只能作用于第二时间入读发行，首次读入的不做任何n后面命令的处理；另为一个是N命令（将下一行添加到pattern space中，但将当前读入行和用N命令添加的下一行看成”一行”，一起被N后面的命令处理）。**<p></p>
<h3 id="三倍行距">三倍行距</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$\="\n\n"'</span> test.txt</span><br></pre></td></tr></table></figure>
<p><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘1; { print “\n” }’ test.txt</code> = <code>awk ‘{ print; print “\n” }’ test.txt</code></strong><br>**<i class="fa fa-sign-language" aria-hidden="true"></i>简单粗暴sed版<code>sed ‘G;G’ test.txt</code></p>
<h3 id="N倍行距">N倍行距</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_.="\n"x7'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="移除所以空行">移除所以空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print unless /^$/'</span> test.txt</span><br><span class="line"><span class="comment">#最终one line perl命令行相当于如下循环</span></span><br><span class="line">LINE:</span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">    <span class="built_in">print</span> unless /^$/</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#进一步可解释为</span></span><br><span class="line">LINE:</span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="variable">$_</span> unless <span class="variable">$_</span> =~ /^$/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>-n</strong>：相当于如下while循环，while通过&lt;&gt;读入每一行，然后传递给<strong>$_</strong>；<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LINE:</span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">    <span class="comment"># your program goes here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>相同效果<code>perl -lne ‘print if length’ test.txt</code>,<strong>-l</strong>参数相当于chomps，去掉每一行结尾的换行符，然后检查这一行的长度，如果存在任何字符则检查结果为true，并输出这一行；</p>
<h3 id="当有多行空行时仅留下一行">当有多行空行时仅留下一行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl -00 -pe <span class="string">''</span> test.txt</span><br><span class="line"><span class="comment">#相同效果</span></span><br><span class="line">perl -00pe0 test.txt</span><br></pre></td></tr></table></figure>
<h3 id="将所有空行压缩或展开成N个连续的">将所有空行压缩或展开成N个连续的</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -00 -pe <span class="string">'$_.="\n"x4'</span> test.txt</span><br></pre></td></tr></table></figure>
<h2 id="行编号">行编号</h2><h3 id="所有行编号">所有行编号</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_="$.$_"'</span> test.txt</span><br></pre></td></tr></table></figure>
<h4 id="参数解释：-2"><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>$.</strong>：包含输入内容的当前行数；<br><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘{print FNR “\t” $0}’ test.txt</code>和<code>awk ‘{ print NR “\t” $0 }’ test.txt</code>,当同时读入两个文件时前者awk中第二个文件开始编号为1，而后者的第二个文件开始编号继续第一个文件后</strong></p>
<h3 id="仅非空行编号，空行依然输出">仅非空行编号，空行依然输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_=++$a."$_" if /./'</span> test.txt</span><br></pre></td></tr></table></figure>
<h4 id="参数解释：-3"><i class="fa fa-chrome" aria-hidden="true"></i>参数解释：</h4><p><strong>/./</strong>：匹配除了换行符外的任何字符，即非空行；<br><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘NF {$0=++a “:” $0}; {print}’ test.txt</code>其中”:”表示编号和原内容间分隔符。</strong></p>
<h3 id="仅非空行编号，空行不输出">仅非空行编号，空行不输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print ++$a. "$_" if /./'</span> test.txt</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-paperclip" aria-hidden="true"></i>几点区别：<br><strong>$.与++$a.</strong>：前者计数input的所有行，后者仅计数非空行；<br><strong>-p与-n</strong>：前者while循环自带print函数，后者没有，需要指定print；</p>
<h3 id="所有行编号，但是仅输出非空行">所有行编号，但是仅输出非空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_ = "$. $_" if /./'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="仅编号匹配指定模式的行，但其他行也无编号输出">仅编号匹配指定模式的行，但其他行也无编号输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_=++$a. "$_" if /模式/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="仅编号和输出匹配指定模式的行">仅编号和输出匹配指定模式的行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'print ++$a. "$_" if /模式/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="所有行编号，但仅输出匹配指定行的行编号">所有行编号，但仅输出匹配指定行的行编号</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -pe <span class="string">'$_ = "$. $_" if /模式/'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="所有行编号，并自定义输出形式">所有行编号，并自定义输出形式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -ne <span class="string">'printf "%-5d %s", $.,$_'</span> test.txt</span><br></pre></td></tr></table></figure>
<p><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘printf(“%5d : %s\n”, NR, $0)’ test.txt</code></strong></p>
<h2 id="运算">运算</h2><h3 id="统计所有行数,包括空行">统计所有行数,包括空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -lne <span class="string">'END &#123; print $. &#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<p><strong><i class="fa fa-slideshare" aria-hidden="true"></i>awk版<code>awk ‘END {print NR}’ test.txt</code></strong></p>
<h3 id="统计非空行">统计非空行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">perl -le <span class="string">'print scalar (grep &#123;/./&#125;&lt;&gt;)'</span> test.txt</span><br><span class="line">perl -le <span class="string">'print ~~grep&#123;/./&#125;&lt;&gt;'</span> test.txt</span><br><span class="line">perl -le <span class="string">'print~~grep/./,&lt;&gt;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="统计空行数">统计空行数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">perl -lne <span class="string">'$a++ if /^$/; END &#123;print $a+0&#125;'</span> test.txt <span class="comment">#一行一行读入，较高效</span></span><br><span class="line">perl -le <span class="string">'print ~~grep&#123;/^$/&#125;&lt;&gt;'</span> test.txt  <span class="comment">#在内存中读入文件全部内容</span></span><br></pre></td></tr></table></figure>
<h3 id="grep_-c功能">grep -c功能</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">perl -lne <span class="string">'$a++ if /regex/; END &#123;print $a+0&#125;'</span> test.txt</span><br><span class="line">awk <span class="string">'/Beth/ &#123; n++ &#125;; END &#123; print n+0 &#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="统计每一行数字总数">统计每一行数字总数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;s=0; for (i=1;i&lt;=NF;i++) s=s+$i&#125; print s&#125;'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="取绝对值">取绝对值</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;for (i=1;i&lt;=NF;i++) if ($i&lt;0) $i=-$i; print&#125;'</span> test.txt</span><br><span class="line">perl -alne <span class="string">'print "@&#123;[map &#123; abs&#125; @F]&#125;"'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="计算所有文件每行总和">计算所有文件每行总和</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -MList::Util=sum -alne <span class="string">'print sum @F'</span> test.txt test2.txt</span><br></pre></td></tr></table></figure>
<h3 id="输出每行最小值">输出每行最小值</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -MList::Util=min -alne <span class="string">'priint min @F'</span> test.txt</span><br></pre></td></tr></table></figure>
<h3 id="统计匹配某一模式的行数">统计匹配某一模式的行数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -lne <span class="string">'/模式/'</span> &amp;&amp; <span class="variable">$t</span>++; END &#123;<span class="built_in">print</span> <span class="variable">$t</span>&#125; test.txt</span><br></pre></td></tr></table></figure>
<p>英语原文：<span class="exturl" data-url="aHR0cDovL3d3dy5jYXRvbm1hdC5uZXQvYmxvZy9wZXJsLW9uZS1saW5lcnMtZXhwbGFpbmVkLXBhcnQtb25lLw==" title="http://www.catonmat.net/blog/perl-one-liners-explained-part-one/">http://www.catonmat.net/blog/perl-one-liners-explained-part-one/<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;文件间距&quot;&gt;文件间距&lt;/h2&gt;&lt;h3 id=&quot;两倍行距&quot;&gt;两倍行距&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;
    
    </summary>
    
      <category term="Perl" scheme="http://tiramisutes.github.io/categories/Perl/"/>
    
    
      <category term="One-Liners" scheme="http://tiramisutes.github.io/tags/One-Liners/"/>
    
  </entry>
  
  <entry>
    <title>awk 匹配与取反，命令行传递参数</title>
    <link href="http://tiramisutes.github.io/2016/08/11/awk-forward.html"/>
    <id>http://tiramisutes.github.io/2016/08/11/awk-forward.html</id>
    <published>2016-08-11T10:40:40.000Z</published>
    <updated>2016-09-01T03:15:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="匹配">匹配</h2><p><strong>/FIN|TIME/</strong> 匹配FIN或者TIME；</p>
<h2 id="取反">取反</h2><p><strong>!~</strong></p>
<h4 id="取出第一列以外的其他列">取出第一列以外的其他列</h4><p><cord>awk ‘{$1=””;print }’ file.txt</cord></p>
<h4 id="第N列和M列外的其他列">第N列和M列外的其他列</h4><p><cord>awk ‘{\$1=\$3=”” ;print }’ file.txt</cord></p>
<h2 id="拆分文件">拆分文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ cat netstat.txt</span><br><span class="line">Proto Recv-Q Send-Q Local-Address          Foreign-Address             State</span><br><span class="line">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</span><br><span class="line">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</span><br><span class="line">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</span><br><span class="line">tcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT</span><br><span class="line">tcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2</span><br><span class="line">tcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT</span><br><span class="line">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</span><br><span class="line">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</span><br><span class="line">tcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT</span><br><span class="line">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2</span><br></pre></td></tr></table></figure>
<p>按第6列分隔文件，<strong>其中的NR！=1表示不处理表头。</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'NR!=1&#123;print &gt; $6&#125;'</span> netstat.txt</span><br><span class="line"> </span><br><span class="line">$ ls</span><br><span class="line">ESTABLISHED  FIN_WAIT1  FIN_WAIT2  LAST_ACK  LISTEN  netstat.txt  TIME_WAIT</span><br><span class="line"> </span><br><span class="line">$ cat ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED</span><br><span class="line">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED</span><br><span class="line">tcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED</span><br><span class="line"> </span><br><span class="line">$ cat FIN_WAIT1</span><br><span class="line">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</span><br><span class="line"> </span><br><span class="line">$ cat FIN_WAIT2</span><br><span class="line">tcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2</span><br><span class="line">tcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2</span><br><span class="line">tcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2</span><br><span class="line"> </span><br><span class="line">$ cat LAST_ACK</span><br><span class="line">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</span><br><span class="line"> </span><br><span class="line">$ cat LISTEN</span><br><span class="line">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</span><br><span class="line">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</span><br><span class="line">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</span><br><span class="line"> </span><br><span class="line">$ cat TIME_WAIT</span><br><span class="line">tcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT</span><br><span class="line">tcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT</span><br><span class="line">tcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT</span><br></pre></td></tr></table></figure></p>
<h2 id="if-else-if">if-else-if</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'NR!=1&#123;if($6 ~ /TIME|ESTABLISHED/) print &gt; "1.txt";</span></span><br><span class="line"><span class="string">else if($6 ~ /LISTEN/) print &gt; "2.txt";</span></span><br><span class="line"><span class="string">else print &gt; "3.txt" &#125;'</span> netstat.txt</span><br></pre></td></tr></table></figure>
<h2 id="统计">统计</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;sum+=$5&#125; END &#123;print sum&#125;'</span> file.txt</span><br><span class="line">awk <span class="string">'NR!=1&#123;a[$6]++;&#125; END &#123;for (i in a) print i ", " a[i];&#125;'</span> file.txt <span class="comment">#输出非重复的第六列并计数</span></span><br><span class="line">awk <span class="string">'NR!=1&#123;a[$6]+=$7;&#125; END &#123; for(i in a) print i ", " a[i]"KB";&#125;'</span> file.txt <span class="comment">#输出非重复的第六列，其第七列对应值累加</span></span><br></pre></td></tr></table></figure>
<h2 id="shell脚本中传入参数">shell脚本中传入参数</h2><p>接收来自命令行传入的参数，第一个参数用<cord>\$1</cord>表示，第二个参数用<cord>\$2</cord>表示，以此类推；注意：\$0表示脚本文件名。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat test.sh</span><br><span class="line">cat <span class="variable">$@</span> | awk -F, <span class="string">'NR!=1 $79!~/\[M\+[0-9]\]+|\[M\][0-9]+/'</span> &gt; te.<span class="variable">$@</span></span><br></pre></td></tr></table></figure></p>
<p>$@表示所有的命令行参数；详细见<span class="exturl" data-url="aHR0cDovL3d3dy5ydW5vb2IuY29tL2xpbnV4L2xpbnV4LXNoZWxsLXBhc3NpbmctYXJndW1lbnRzLmh0bWw=" title="http://www.runoob.com/linux/linux-shell-passing-arguments.html">http://www.runoob.com/linux/linux-shell-passing-arguments.html<i class="fa fa-external-link"></i></span></p>
<h2 id="awk_-v参数">awk -v参数</h2><p>-v var=var_value<br>在awk程序执行前，把awk变量var的值设置为var_value，这个var变量在BEGIN块中也有效，经常用来把shell变量引入awk程序。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=1</span><br><span class="line">$ awk -v var=<span class="variable">$a</span> <span class="string">'BEGIN&#123;print var&#125;'</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure></p>
<p>读入csv文件<br><strong>awk -F, -v OFS=, ‘{print $1,$3}’ old.csv</strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;匹配&quot;&gt;匹配&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;/FIN|TIME/&lt;/strong&gt; 匹配FIN或者TIME；&lt;/p&gt;
&lt;h2 id=&quot;取反&quot;&gt;取反&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;!~&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&quot;取出第一列以外的其他列&quot;&gt;取出第一列以
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>Linux下XML::Simple无root权限安装</title>
    <link href="http://tiramisutes.github.io/2016/08/11/XML-Simple.html"/>
    <id>http://tiramisutes.github.io/2016/08/11/XML-Simple.html</id>
    <published>2016-08-11T06:32:51.000Z</published>
    <updated>2016-08-11T10:27:21.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="XML::Simple简介">XML::Simple简介</h2><p>XML::Simple 基本上有两个功能；它将 XML 文本文档转换为 Perl 数据结构（匿名散列和数组的组合），以及将这种数据结构转换回 XML 文本文档。提供了两个函数：XMLin() 和 XMLout()。第一个子函数读取 XML 文件，返回一个引用。给出适当数据结构的引用，第二个子函数将它转换为 XML 文档，根据参数的不同，产生的 XML 文档采用字符串格式或文件形式。</p>
<p>XML::Simple 有两个主要限制。首先，在输入方面，它将完整的 XML 文件读入内存，所以如果文件非常大或者需要处理 XML 数据流，就不能使用这个模块。第二，它无法处理 XML 混合内容，也就是在一个元素体中同时存在文本和子元素的情况.</p>
<h2 id="为何需要XML::Simple">为何需要XML::Simple</h2><p>在用<span class="exturl" data-url="aHR0cHM6Ly90cmlub3RhdGUuZ2l0aHViLmlvLw==" title="https://trinotate.github.io/">Trinotate: Transcriptome Functional Annotation and Analysis<i class="fa fa-external-link"></i></span>对De Novo转录组数据进行注释时，需要运行RNAMMER来识别rRNA转录本，同时将XML输出文件解析为gff结果；这一过程就需要XML::Simple这一模块；<br>否则将报错<cord>../rnammer  error converting xml into gff</cord></p>
<h2 id="安装XML::Simple">安装XML::Simple</h2><p>XML::Simple模块的安装需要至少以下两个依赖包：<strong>XML::Parser和XML::SAX::Expat</strong><br>注意：<strong>一定按照 XML::Parser、XML::SAX::Expat、XML::Simple的顺序依次安装；</strong><br>XML::Parser一般可以在cpan下顺利安装，但是XML::SAX::Expat在正常的cpan安装将因为权限问题而中断：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ perl -MCPAN -e shell</span><br><span class="line">cpan&gt; install XML::Simple</span><br><span class="line">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><br><span class="line">ERROR: Can<span class="string">'t create '</span>/usr/<span class="built_in">local</span>/share/man/man3<span class="string">'</span></span><br><span class="line"><span class="string">Do not have write permissions on '</span>/usr/<span class="built_in">local</span>/share/man/man3<span class="string">'</span></span><br><span class="line"><span class="string">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br></pre></td></tr></table></figure></p>
<p>所以就涉及到在Linux下如何无root权限安装perl模块？<br>这里推荐更加好用,更加人性的cpanm，**在没有 Root 权限时会自动安装到当前用户家目录的perl/lib文件夹下。</p>
<h3 id="cpanm安装">cpanm安装</h3><p>下载cpanm到自己的目录下，并修改可执行权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget  http://xrl.us/cpanm  --no-check-certificate -O cpanm </span><br><span class="line">$ chmod +x cpanm</span><br></pre></td></tr></table></figure></p>
<p>将路径写到bashrc文件中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=~/software/perl/:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></p>
<h3 id="perl模块安装">perl模块安装</h3><h4 id="XML::SAX::Expat">XML::SAX::Expat</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cpanm XML::SAX::Expat</span><br></pre></td></tr></table></figure>
<p>注意：第一次安装时，cpanm会创建一个~/perl5目录，而perl模块的安装位置为~/perl5/lib/perl5，将这个变量写入bashrc文件的PERL5LIB变量中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PERL5LIB=~/perl5/lib/perl5</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></p>
<p>验证安装<br>perldoc XML::SAX::Expat<br>输出正常帮助文档则表明安装成功；<br>cpanm还有更多用法，参见扶凯 blog<span class="exturl" data-url="aHR0cDovL3d3dy5waHAtb2EuY29tLzIwMTAvMDUvMDUvcGVybC1jcGFubWludXMtY3Bhbi5odG1s" title="http://www.php-oa.com/2010/05/05/perl-cpanminus-cpan.html">使用 CPANMinus 来安装 Perl 模块和其它技巧<i class="fa fa-external-link"></i></span></p>
<h4 id="XML::Simple">XML::Simple</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cpanm XML::Simple</span><br></pre></td></tr></table></figure>
<p>报错：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">t/0_Config.t ............ ok</span><br><span class="line">t/1_XMLin.t ............. </span><br><span class="line">Failed 84/132 subtests </span><br><span class="line">t/2_XMLout.t ............ ok</span><br><span class="line">t/3_Storable.t .......... </span><br><span class="line">Failed 21/23 subtests </span><br><span class="line">t/4_MemShare.t .......... </span><br><span class="line">Failed 7/8 subtests </span><br><span class="line">t/5_MemCopy.t ........... </span><br><span class="line">Failed 6/7 subtests </span><br><span class="line">t/6_ObjIntf.t ........... ok</span><br><span class="line">t/7_SaxStuff.t .......... </span><br><span class="line">Failed 12/14 subtests </span><br><span class="line">t/8_Namespaces.t ........ ok</span><br><span class="line">t/9_Strict.t ............ ok</span><br><span class="line">t/A_XMLParser.t ......... ok</span><br><span class="line">t/B_Hooks.t ............. </span><br><span class="line">Failed 4/12 subtests </span><br><span class="line">	(less 3 skipped subtests: 5 okay)</span><br><span class="line">t/release-pod-syntax.t .. skipped: these tests are <span class="keyword">for</span> release candidate testing</span><br><span class="line"></span><br><span class="line">Test Summary Report</span><br><span class="line">-------------------</span><br><span class="line">t/1_XMLin.t           (Wstat: 139 Tests: 48 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 132 tests but ran 48.</span><br><span class="line">t/3_Storable.t        (Wstat: 139 Tests: 2 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 23 tests but ran 2.</span><br><span class="line">t/4_MemShare.t        (Wstat: 139 Tests: 1 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 8 tests but ran 1.</span><br><span class="line">t/5_MemCopy.t         (Wstat: 139 Tests: 1 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 7 tests but ran 1.</span><br><span class="line">t/7_SaxStuff.t        (Wstat: 139 Tests: 2 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 14 tests but ran 2.</span><br><span class="line">t/B_Hooks.t           (Wstat: 139 Tests: 8 Failed: 0)</span><br><span class="line">  Non-zero <span class="built_in">wait</span> status: 139</span><br><span class="line">  Parse errors: Bad plan.  You planned 12 tests but ran 8.</span><br><span class="line">Files=13, Tests=367,  3 wallclock secs ( 0.11 usr  0.05 sys +  1.61 cusr  0.35 csys =  2.12 CPU)</span><br><span class="line">Result: FAIL</span><br><span class="line">Failed 6/13 <span class="built_in">test</span> programs. 0/367 subtests failed.</span><br><span class="line">make: *** [test_dynamic] Error 255</span><br><span class="line">-&gt; FAIL Installing XML::Simple failed.</span><br></pre></td></tr></table></figure></p>
<p>可以看出是text时存在其他依赖包的缺失，解决办法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ cpanm XML::LibXML::SAX::Parser </span><br><span class="line">$ cpanm XML::LibXML::SAX </span><br><span class="line">$ cpanm XML::SAX::PurePerl</span><br><span class="line">$ cpanm XML::Simple</span><br><span class="line">--&gt; Working on XML::Simple</span><br><span class="line">Fetching http://www.cpan.org/authors/id/G/GR/GRANTM/XML-Simple-2.22.tar.gz ... OK</span><br><span class="line">Configuring XML-Simple-2.22 ... OK</span><br><span class="line">Building and testing XML-Simple-2.22 ... OK</span><br><span class="line">Successfully installed XML-Simple-2.22</span><br><span class="line">1 distribution installed</span><br></pre></td></tr></table></figure></p>
<p>more：<span class="exturl" data-url="aHR0cHM6Ly9idWd6aWxsYS5yZWRoYXQuY29tL3Nob3dfYnVnLmNnaT9pZD0yMzMwMDM=" title="https://bugzilla.redhat.com/show_bug.cgi?id=233003">https://bugzilla.redhat.com/show_bug.cgi?id=233003<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;XML::Simple简介&quot;&gt;XML::Simple简介&lt;/h2&gt;&lt;p&gt;XML::Simple 基本上有两个功能；它将 XML 文本文档转换为 Perl 数据结构（匿名散列和数组的组合），以及将这种数据结构转换回 XML 文本文档。提供了两个函数：XMLin() 
    
    </summary>
    
      <category term="Perl" scheme="http://tiramisutes.github.io/categories/Perl/"/>
    
    
      <category term="XML::Simple" scheme="http://tiramisutes.github.io/tags/XML-Simple/"/>
    
  </entry>
  
  <entry>
    <title>Piwi-interacting RNA (piRNA)</title>
    <link href="http://tiramisutes.github.io/2016/06/08/piRNA.html"/>
    <id>http://tiramisutes.github.io/2016/06/08/piRNA.html</id>
    <published>2016-06-08T13:58:48.000Z</published>
    <updated>2018-09-28T02:40:49.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PiRNA">PiRNA</h2><p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pirc.png" width="580" height="200"></p><br><strong>Piwi-interacting RNA (piRNA)</strong>是一大类主要在动物体内表达的small non-coding RNA，piRNA通过与Piwi蛋白互作形成RNA-protein复合体。该piRNA复合体在生殖细胞中参与表观遗传和逆转录转座子(retrotransposons)的转录后基因沉默。piRNA与miRNA和siRNA在长度、序列结构和生物起源上均存在差异；<p></p>
<h3 id="PiRNA特点">PiRNA特点</h3><p>1）26~31nt<br>2）无明显二级结构<br>3）5’端第一个碱基为U<br>4）5’端单磷酸盐(monophosphate)和3’端修饰(2’-O-methylation modification)阻止2’ or 3’氧化，增加PiRNA稳定性。<br>5）种类较多，不具一定的保守性，老鼠体内 50,000 unique piRNA，果蝇中&gt;13,000。<br>6）产生存在显著的链偏好性；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/piRNA23.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/piRNA2.png" alt=""></p>
<h3 id="位置">位置</h3><p>成簇贯穿基因组中，其每一个簇中包含PiRNA小于10个或达到成千上万，且大小差异极大。<br>在果蝇和脊椎动物中定位于非编码基因间，在线虫蛋白编码基因间也鉴定到PiRNA。<br>在无脊椎动物和哺乳动物生殖细胞中较多。<br>细胞核和细胞质中均存在。</p>
<h3 id="生物起源">生物起源</h3><p>PiRNA的产生存在显著的链特异性，可能仅仅是来源于双链DNA的某一条链，这表明转录的长的单链前体经过一次初加工形成 pachytene PiRNA，这过程中PiRNA前体的转录趋向于起始于5’端第一个碱基U。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/piRNA1.png" alt=""></p>
<p></p><p></p><br>‘Ping Pong’机制：初级PiRNA(Primary piRNAs)第一个碱基位置偏向为U，第10个无偏向性；次级PiRNA(Secondary piRNAs)(产生于初级PiRNA指导的剪切)第一个碱基无偏向，第10个偏向A；<code>二者从5’端开始有10个碱基的互补</code>。<br>More：<i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MxMDk3Mjc2NTA4MDA2MTk5" title="http://www.sciencedirect.com/science/article/pii/S1097276508006199">A piRNA Pathway Primed by Individual Transposons Is Linked to De Novo DNA Methylation in Mice<i class="fa fa-external-link"></i></span><br>初级PiRNA识别其互补靶标并招募Piwi蛋白，然后从距离初级PiRNA 5’端10个碱基处劈开(识别的互补靶标)形成次级PiRNA，次级PiRNA靶向到第10个碱基是 <strong>A</strong> 。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pingpong.jpg" alt=""><br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MwMDkyODY3NDA3MDAyNTc3" title="http://www.sciencedirect.com/science/article/pii/S0092867407002577">Discrete Small RNA-Generating Loci as Master Regulators of Transposon Activity in Drosophila<i class="fa fa-external-link"></i></span><p></p>
<h3 id="生物功能">生物功能</h3><h4 id="沉默转座子">沉默转座子</h4><p>见More：<i class="fa fa-link" aria-hidden="true"></i><a href="http://tiramisutes.github.io/2016/06/08/piRNA/#RNAi中作用" target="_blank">Piwi蛋白:RNAi中作用</a><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PiRNA-function.png" alt=""></p>
<h4 id="后生效应(Epigenetic_effects)">后生效应(Epigenetic effects)</h4><p>动植物中，小RNA通过特定的胞嘧啶甲基化来间接调控表观遗传，并且小RNA自身承担着表观遗传信息的载体。存在某些特殊转座子差异的果蝇品系间杂交能引起后代不育，这称之为杂种不育。当这一转座子是父系遗传时不育表型表现为显性，而母系遗传能够维持育性。在P- and I-element-mediated杂种不育中，依赖于父母本不同，其作用于每一个靶标元件(element)的PiRNA数量在后代表现出明显差异，这种差异来源于受精作用。综上表明母本生殖细胞内的PiRNA对上述特殊转座子的沉默响应起到重要作用，此沉默效应的缺失将引起杂种不育。<br>More：<i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3NjaWVuY2Uuc2NpZW5jZW1hZy5vcmcvY29udGVudC8zMjIvNTkwNi8xMzg3Lmxvbmc=" title="http://science.sciencemag.org/content/322/5906/1387.long">An epigenetic role for maternally inherited piRNAs in transposon silencing<i class="fa fa-external-link"></i></span></p>
<h3 id="PiRNA鉴定">PiRNA鉴定</h3><p>PiRNA的鉴定目前主要通过识别’ping pong‘标签，相关软件如下：<br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3Bpcm5hYmFuay5pYmFiLmFjLmluL2luZGV4LnNodG1s" title="http://pirnabank.ibab.ac.in/index.shtml">piRNABank: a web resource on classified and clustered Piwi-interacting RNAs<i class="fa fa-external-link"></i></span><br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvcGluZ3Bvbmdwcm8vZmlsZXMvdjEuMC8=" title="https://sourceforge.net/projects/pingpongpro/files/v1.0/">PingPongPro：a software for finding ping-pong signatures and ping-pong cycle activity<i class="fa fa-external-link"></i></span><br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL2JtY2Jpb2luZm9ybWF0aWNzLmJpb21lZGNlbnRyYWwuY29tL2FydGljbGVzLzEwLjExODYvMTQ3MS0yMTA1LTEzLTU=" title="http://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-13-5">proTRAC: a software for probabilistic piRNA cluster detection, visualization and analysis<i class="fa fa-external-link"></i></span><br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5zbWFsbHJuYWdyb3VwLW1haW56LmRlL3BpUk5BY2x1c3RlckRCLmh0bWw=" title="http://www.smallrnagroup-mainz.de/piRNAclusterDB.html">piRNA cluster: database<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pir_bio.png" alt=""></p>
<h3 id="PiRNA起源">PiRNA起源</h3><p>基因组重复区域，例如逆转录转座子区；<br>异染色质区，双链RNA的反义链；</p>
<h2 id="Argonaute蛋白家族">Argonaute蛋白家族</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/piwi.png" alt=""><br>Argonaute蛋白包含有N-terminal, PAZ (Piwi-Argonaute-Zwille), middle and the C-terminal PIWI (P-element-induced wimpy testis) domains (Tolia et al., 2007)。<br>在果蝇中存在5种类型的Argonaute蛋白：AGO1, AGO2, Aubergine (Aub), Piwi and AGO3 (Gunawardane et al., 2007)；<br>AGO1和AGO2属于Argonaute (AGO)亚家族，Aub, Piwi and AGO3多存在于生殖细胞系中，且属于PIWI亚家族；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ago.png" alt=""></p>
<h2 id="Piwi蛋白">Piwi蛋白</h2><p>Piwi蛋白(最初在果蝇中的P-element induced wimpy testis)，维持干细胞的不完全分化和生殖细胞细胞分裂比率的稳定性。Piwi蛋白高度保守，广泛存在于动植物体内。</p>
<h3 id="RNAi中作用">RNAi中作用</h3><p>Piwi蛋白存在有PAZ domain，该domain在Argonaute蛋白家族中参与双链RNA导向的单链RNA的水解作用。Argonaute是广泛研究的核酸结合蛋白(nucleic-acid binding)家族，其本质上是一种RNase H-like酶，完成RNA-induced silencing complex (RISC)的催化功能。在细胞RNAi反应中，RISC复合体中的Argonaute蛋白能够绑定(bind)到由ribonuclease Dicer切割（Dicer-2）外源双链RNA的正义链和反义链产生的siRNA(small interfering RNA)和切割（Dicer-1）内源非编码RNA（non-coding RNA）产生的miRNA(microRNA)上，从而形成RNA-RISC complex。该RNA-RISC complex绑定和切开与RNA（siRNA或miRNA）碱基互补的mRNA，破坏并且阻止其翻译过程。<br><strong>补充</strong>RNAi中的RdRP机制：在线虫的研究中发现, siRNA 是合成 dsRNA 的特殊引物, 在RNA 依赖RNA 聚合酶(RdRP)作用下, 以靶mRNA 为模板合成dsRNA 。新生成的dsRNA 在Dicer 酶的作用下, 裂解产生新的siRNA , 新生成的siRNA 又可进入上述循环。大量集中的siRNA 可以形成RISC复合物, 这样可以提高mRNA 降解的效率。在这种RNAi过程中, 对靶mRNA 的特异性扩增有助于增强RNAi的特异性基因监视功能, 每个细胞只需少量的dsRNA就能完全关闭相应基因的表达，该模型称为RdRP。</p>
<h3 id="Piwi蛋白和转座子沉默">Piwi蛋白和转座子沉默</h3><p>Piwi蛋白通过与PiRNA形成内源系统来沉默内源自私基因(endogenous selfish genetic elements)表达，例如逆转录转座子和重复序列，防止该自私基因产物干扰生殖细胞的形成。<br>selfish genetic elements明显特征：通过形成额外拷贝数在基因组中传播（转座子）和对宿主的成功繁殖没有特殊贡献。</p>
<h2 id="RasiRNA">RasiRNA</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/%E5%B9%BB%E7%81%AF%E7%89%872.PNG" alt=""><br>RasiRNAs(Repeat associated small interfering RNA)是piRNA的亚种，与Piwi蛋白（Argonaute蛋白家族分枝）互作参与RNAi反应。在生殖细胞中建立和维持异染色质结构，控制重复序列的转录，沉默转座子和逆转录转座子。主要产生自反义链（antisense strand），缺乏动物siRNA and miRNA所特有的2’,3’羟基末端。<br>More：<i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3NjaWVuY2Uuc2NpZW5jZW1hZy5vcmcvY29udGVudC8zMTMvNTc4NS8zMjAuZnVsbA==" title="http://science.sciencemag.org/content/313/5785/320.full">A Distinct Small RNA Pathway Silences Selfish Genetic Elements in the Germline<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/%E5%B9%BB%E7%81%AF%E7%89%878.PNG" alt=""></p>
<h2 id="RNA_百科">RNA 百科</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL21jbWFudXNsYWIudWNzZi5lZHUvcm5hcw==" title="http://mcmanuslab.ucsf.edu/rnas">RNA wiki<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;PiRNA&quot;&gt;PiRNA&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pirc.png&quot; width=&quot;580&quot; height=&quot;200
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="piRNA" scheme="http://tiramisutes.github.io/tags/piRNA/"/>
    
  </entry>
  
  <entry>
    <title>非Root用户编译安装GCC</title>
    <link href="http://tiramisutes.github.io/2016/06/04/GCC.html"/>
    <id>http://tiramisutes.github.io/2016/06/04/GCC.html</id>
    <published>2016-06-04T01:08:22.000Z</published>
    <updated>2016-06-04T07:22:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>Linux下源码安装软件三部曲都需要GCC编译，所以Linux下都会有预安装的GCC，但处于稳定性和兼容性考虑，其版本均为较低的稳定版，而最新软件的安装编译时需要较高版本才可以，对于非Root普通用户解决办法就是自己目录下安装所需版本GCC。<br>如何证明你的GCC版本需要升级呢？<br>当你安装软件make编译时看到如下报错，就说明该升级了：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ -std=c++11 -pedantic -Wall -Wextra    -c CCSSequence.cpp -o CCSSequence.o </span><br><span class="line">cc1plus: error: unrecognized <span class="built_in">command</span> line option <span class="string">"-std=c++11"</span></span><br></pre></td></tr></table></figure></p>
<p><code>-std=c++0x</code>是g++-4.4支持的，而<code>-std=c++11</code>是g++-4.7及其后续版本。<br><code>gcc -v</code>察看当前系统GCC版本，确认是否为GCC版本问题引起报错。</p>
<h2 id="GCC安装">GCC安装</h2><p>安装gcc之前依赖gmp、mpc、mpfr这三个包，所以先安装这个三个包，这三个包可以在下面的<span class="exturl" data-url="ZnRwOi8vZ2QudHV3aWVuLmFjLmF0L2dudS9nY2MvaW5mcmFzdHJ1Y3R1cmUv" title="ftp://gd.tuwien.ac.at/gnu/gcc/infrastructure/">infrastructure<i class="fa fa-external-link"></i></span>目录下下载，gcc源码包在<span class="exturl" data-url="ZnRwOi8vZ2QudHV3aWVuLmFjLmF0L2dudS9nY2MvcmVsZWFzZXMv" title="ftp://gd.tuwien.ac.at/gnu/gcc/releases/">releases<i class="fa fa-external-link"></i></span>中下载，这里gcc下载的版本为gcc-4.8.5。<br>因为这三个包之间有依赖关系，所以一定按如下顺序依次安装。</p>
<h3 id="gmp安装">gmp安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tar</span> -jxvf gmp-4.3.2.tar.bz2</span><br><span class="line"></span><br><span class="line"><span class="variable">$cd</span> gmp-4.3.2</span><br><span class="line"></span><br><span class="line">$./configure --prefix=/home/software/opt/gmp-4.3.2/ <span class="comment">#gmp安装路径</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> check <span class="comment">#这一步可以不要</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> install</span><br></pre></td></tr></table></figure>
<h3 id="mpfr安装">mpfr安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tar -jxvf mpfr-2.4.2.tar.bz2</span><br><span class="line"></span><br><span class="line"><span class="variable">$cd</span> mpfr-2.4.2</span><br><span class="line"></span><br><span class="line">$./configure --prefix=/home/software/opt/mpfr-2.4.2/ --with-gmp=/home/software/opt/gmp-4.3.2/ <span class="comment">#congfigure后面是mpfr安装路径及依赖的gmp路径</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> check <span class="comment">#这一步可以不要</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> install</span><br></pre></td></tr></table></figure>
<h3 id="mpc安装">mpc安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tar</span> -zxvf mpc-0.8.1.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="variable">$cd</span> mpc-0.8.</span><br><span class="line"></span><br><span class="line">$ ./configure --prefix=/home/software/opt/mpc-0.8.1/ --with-gmp=/home/software/opt/gmp-4.3.2/ --with-mpfr=/home/software/opt/mpfr-2.4.2/</span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> check <span class="comment">#这一步可以不要</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$make</span> install</span><br></pre></td></tr></table></figure>
<h3 id="更改~/-bashrc文件">更改~/.bashrc文件</h3><p>安装完上述三个依赖包后设置环境变量 $LD_LIBRARY_PATH，即在bashrc文件添加如下内容：<br>因为系统的LD_LIBRARY_PATH中有两个相邻的冒号，编译gcc的导致通不过，所以先把这个变量自己重新定义一下，然后将上面装的三个包添加到该变量中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=/public/software/mpi/openmpi/1.6.5/intel/lib:/opt/gridview/pbs/dispatcher/lib:/public/software/compiler/intel/composer_xe_2013_sp1.0.080/compiler/lib/intel64:/public/software/compiler/intel/composer_xe_2013_sp1.0.080/mkl/lib/intel64:/usr/<span class="built_in">local</span>/lib64:/usr/<span class="built_in">local</span>/lib:/usr/<span class="built_in">local</span>/otpserver/dependson_libs_x64</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=~/opt/gmp-4.3.2/lib/:~/opt/mpfr-2.4.2/lib/:~/opt/mpc-0.8.1/lib/:<span class="variable">$LD_LIBRARY_PATH</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure></p>
<p>不然会碰到错误 configure: error: cannot compute suffix of object files: cannot compile</p>
<h3 id="gcc安装">gcc安装</h3><p>完成依赖包的安装和环境设置后就可以开始GCC的安装了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tar</span> -jxvf gcc-4.8.5.tar.bz2</span><br><span class="line"></span><br><span class="line"><span class="variable">$cd</span> gcc-4.8.5</span><br><span class="line"></span><br><span class="line">$./configure --prefix=/home/software/opt/gcc-4.8.5/ --<span class="built_in">enable</span>-threads=posix --<span class="built_in">disable</span>-checking --<span class="built_in">disable</span>-multilib --with-mpc=/home/software/opt/mpc-0.8.1/ --with-gmp=/home/software/opt/gmp-4.3.2/ --with-mpfr=/home/software/opt/mpfr-2.4.2/ </span><br><span class="line"></span><br><span class="line">make -j 10 <span class="comment">#类似于使用10个线程编译，速度要快很多,此过程需要较长时间，中间不要间断。</span></span><br><span class="line"></span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p>
<h3 id="更改~/-bashrc文件-1">更改~/.bashrc文件</h3><p>在文件中加入一下两句将gcc加入到环境变量中。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/home/software/opt/gcc-4.8.5/bin/:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=/home/software/opt/gcc-4.8.5/lib/:~/opt/gcc-4.8.5/lib64/:<span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure></p>
<h2 id="安装过程报错暨解决办法">安装过程报错暨解决办法</h2><p>Linux安装任何软件切记   <strong>路劲</strong>　 <strong>路劲</strong> 　<strong>路劲</strong>　　要的事说3编！<br>路劲报错主要类型如下：<br>1）路劲缺失<br>解决：export PATH=”$PATH:/home/bin/amos-3.1.0/bin”相应缺失路径到<code>.bashrc</code>文件。<br>2）当前软件安装路径存在，如下面报错[configure-stage2-gcc] Error 1 。<br>3）意外路径存在于环境变量中，如下面blasr安装编译报错。</p>
<h3 id="报错[configure-stage2-gcc]_Error_1">报错[configure-stage2-gcc] Error 1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contains current directory </span><br><span class="line">configure: error:  </span><br><span class="line">*** LIBRARY_PATH shouldn<span class="string">'t contain the current directory when </span></span><br><span class="line"><span class="string">*** building gcc. Please change the environment variable </span></span><br><span class="line"><span class="string">*** and run configure again.</span></span><br><span class="line"><span class="string">make[2]: *** [configure-stage2-gcc] Error 1</span></span><br></pre></td></tr></table></figure>
<p>1)根据提示看出是LIBRARY_PATH环境变量不应该包含有当前安装GCC的路径，即我想要安装gcc路径为<code>/honm/software/gcc-4.8.5/</code>，那个<code>echo $LIBRARY_PATH</code>就不应该包含此路径。<br>2)若<code>echo $LIBRARY_PATH</code>输出结果为<code>/usr/lib/x86_64-linux-gnu/:</code>（注意结尾冒号）,则同样会报错，解决办法就是去掉冒号<code>/usr/lib/x86_64-linux-gnu/</code>。<br>3）解决办法<code>unset LIBRARY_PATH; ./configure -v</code>。来源于<span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84NTY1Njk1L2Vycm9yLWNvbXBpbGluZy1nY2MtNC02LTItdW5kZXItdWJ1bnR1LTExLTEw" title="http://stackoverflow.com/questions/8565695/error-compiling-gcc-4-6-2-under-ubuntu-11-10">http://stackoverflow.com/questions/8565695/error-compiling-gcc-4-6-2-under-ubuntu-11-10<i class="fa fa-external-link"></i></span></p>
<h3 id="报错[stage1-bubble]_Error_2">报错[stage1-bubble] Error 2</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make[1]: *** [stage1-bubble] Error 2</span><br><span class="line">make[1]: Leaving directory `/np/linac/belloni/programs/gcc/gcc-build<span class="string">'</span></span><br><span class="line"><span class="string">make: *** [all] Error 2</span></span><br></pre></td></tr></table></figure>
<p>解决：主要由Error 1 报错引起的，在第一个报错解决后此错误消失。</p>
<h3 id="后续编译其他软件报错">后续编译其他软件报错</h3><h4 id="安装blasr报错如下：">安装<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BhY2lmaWNCaW9zY2llbmNlcy9ibGFzci93aWtpL1N0ZXAtYnktc3RlcC1ibGFzci1pbnN0YWxsYXRpb24tZXhhbXBsZQ==" title="https://github.com/PacificBiosciences/blasr/wiki/Step-by-step-blasr-installation-example">blasr<i class="fa fa-external-link"></i></span>报错如下：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">g++ -std=c++11 -pedantic -Wall -Wextra    -c CCSSequence.cpp -o CCSSequence.o</span><br><span class="line">/public/home/zpxu/bin/gcc-4.8.5/libexec/gcc/x86_64-unknown-linux-gnu/4.8.5/cc1plus: error <span class="keyword">while</span> loading shared libraries: libmpc.so.2: cannot open shared object file: No such file or directory</span><br><span class="line">make[3]: *** [CCSSequence.o] Error 1</span><br><span class="line">make[3]: Leaving directory `/public/home/zpxu/bin/blasr_install/blasr/libcpp/pbdata<span class="string">'</span></span><br><span class="line"><span class="string">make[2]: *** [libpbdata] Error 2</span></span><br><span class="line"><span class="string">make[2]: Leaving directory `/public/home/zpxu/bin/blasr_install/blasr/libcpp'</span></span><br><span class="line">make[1]: *** [all] Error 2</span><br><span class="line">make[1]: Leaving directory `/public/home/zpxu/bin/blasr_install/blasr/libcpp<span class="string">'</span></span><br></pre></td></tr></table></figure>
<p>报错原因在于blasr安装相关路径已经存在于系统环境变量中，注释掉<code>.bashrc</code>中相应路径。</p>
<h4 id="make_install后报错">make install后报错</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/llvm-tblgen: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.15<span class="string">' not found (required by /bin/llvm-tblgen)</span></span><br></pre></td></tr></table></figure>
<p>解决办法：<br>I found the libstdc++.so.6.0.18 at the place where I complied gcc 4.8.1</p>
<p>Then I do like this<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cp ~/objdir/x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.18 /usr/lib64/</span><br><span class="line"></span><br><span class="line">rm /usr/lib64/libstdc++.so.6</span><br><span class="line"></span><br><span class="line">ln -s libstdc++.so.6.0.18 libstdc++.so.6</span><br></pre></td></tr></table></figure></p>
<p>problem solved.</p>
<h2 id="GCC延伸阅读">GCC延伸阅读</h2><p><span class="exturl" data-url="aHR0cDovL2Jsb2cuNWliYy5uZXQvcC83ODczMy5odG1s" title="http://blog.5ibc.net/p/78733.html">Linux下gcc生成和使用静态库和动态库详解<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9pbWFnZS1leWUvYXJjaGl2ZS8yMDExLzA4LzIwLzIxNDcxMzMuaHRtbA==" title="http://www.cnblogs.com/image-eye/archive/2011/08/20/2147133.html">Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量<i class="fa fa-external-link"></i></span></p>
<p></p><p></p><br>贡献来源：<br><span class="exturl" data-url="aHR0cDovL2Zhdm9vcnIuZ2l0aHViLmlvL2NlbnRvczYuNi1idWlsZC1nY2M1LjItZnJvbS1zb3VyY2Uv" title="http://favoorr.github.io/centos6.6-build-gcc5.2-from-source/">http://favoorr.github.io/centos6.6-build-gcc5.2-from-source/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81MjE2Mzk5L3Vzci1saWItbGlic3RkYy1zby02LXZlcnNpb24tZ2xpYmN4eC0zLTQtMTUtbm90LWZvdW5k" title="http://stackoverflow.com/questions/5216399/usr-lib-libstdc-so-6-version-glibcxx-3-4-15-not-found">http://stackoverflow.com/questions/5216399/usr-lib-libstdc-so-6-version-glibcxx-3-4-15-not-found<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Linux下源码安装软件三部曲都需要GCC编译，所以Linux下都会有预安装的GCC，但处于稳定性和兼容性考虑，其版本均为较低的稳定版，而最新软件的安装编译时需要较高版本才可以，对于非Root普通用户解决办法就是自己目录下安装所需版本GCC。&lt;br&gt;如何证明你的GCC版本需
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="linux-gcc" scheme="http://tiramisutes.github.io/tags/linux-gcc/"/>
    
  </entry>
  
  <entry>
    <title>linux下java安装和运行报错</title>
    <link href="http://tiramisutes.github.io/2016/05/31/linux-java-error.html"/>
    <id>http://tiramisutes.github.io/2016/05/31/linux-java-error.html</id>
    <published>2016-05-31T11:08:12.000Z</published>
    <updated>2016-05-31T11:28:16.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux下安装java">Linux下安装java</h2><p><span class="exturl" data-url="aHR0cDovL3d3dy5vcmFjbGUuY29tL3RlY2huZXR3b3JrL2phdmEvamF2YXNlL2Rvd25sb2Fkcy9qZGs4LWRvd25sb2Fkcy0yMTMzMTUxLmh0bWw=" title="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">java官网<i class="fa fa-external-link"></i></span>下载最新版本jdk：<span class="exturl" data-url="aHR0cDovL3d3dy5vcmFjbGUuY29tL3RlY2huZXR3b3JrL2phdmEvamF2YXNlL2Rvd25sb2Fkcy9qZGs4LWRvd25sb2Fkcy0yMTMzMTUxLmh0bWw=" title="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">jdk-8u91-linux-x64.tar.gz<i class="fa fa-external-link"></i></span>。<br>按照官网说明安装：<span class="exturl" data-url="aHR0cDovL2RvY3Mub3JhY2xlLmNvbS9qYXZhc2UvOC9kb2NzL3RlY2hub3Rlcy9ndWlkZXMvaW5zdGFsbC9saW51eF9qZGsuaHRtbCNCSkZKSkVGRw==" title="http://docs.oracle.com/javase/8/docs/technotes/guides/install/linux_jdk.html#BJFJJEFG">JDK Installation for Linux Platforms<i class="fa fa-external-link"></i></span><br>最后配置环境变量：编辑<code>.bashrc</code>文件。</p>
<h2 id="Linux服务器上java运行报错">Linux服务器上java运行报错</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error occurred during initialization of VM</span><br><span class="line">Could not reserve enough space <span class="keyword">for</span> object heap</span><br><span class="line">Could not create the Java virtual machine.</span><br></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error occurred during initialization of VM </span><br><span class="line">Could not reserve enough space <span class="keyword">for</span> code cache</span><br></pre></td></tr></table></figure></p>
<p>根据报错提示主要是运行内存不足造成，解决办法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> JAVA_OPTS=-Xms512m -Xmx512m -XX:MaxPermSize=256m</span><br></pre></td></tr></table></figure></p>
<p>more：<span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80NDAxMzk2L2NvdWxkLW5vdC1yZXNlcnZlLWVub3VnaC1zcGFjZS1mb3Itb2JqZWN0LWhlYXA=" title="http://stackoverflow.com/questions/4401396/could-not-reserve-enough-space-for-object-heap">http://stackoverflow.com/questions/4401396/could-not-reserve-enough-space-for-object-heap<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Linux下安装java&quot;&gt;Linux下安装java&lt;/h2&gt;&lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5vcmFjbGUuY29tL3RlY2huZXR3b3JrL2phdmEvamF2YXNlL2Rvd25
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="linux-java" scheme="http://tiramisutes.github.io/tags/linux-java/"/>
    
  </entry>
  
  <entry>
    <title>Circular RNAs</title>
    <link href="http://tiramisutes.github.io/2016/04/12/Circular-RNAs.html"/>
    <id>http://tiramisutes.github.io/2016/04/12/Circular-RNAs.html</id>
    <published>2016-04-12T06:50:29.000Z</published>
    <updated>2018-09-28T02:31:32.335Z</updated>
    
    <content type="html"><![CDATA[<h2 id="环形RNA研究历史">环形RNA研究历史</h2><p>1&gt;最早的环形RNA分子在20世纪70年代于RNA病毒中发现。（<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM0MzEyMzkvcGRmL3BuYXMwMDA0MS0wMDc0LnBkZg==" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC431239/pdf/pnas00041-0074.pdf">Viroids are single-stranded covalently closed circular RNA molecules existing as highly base-paired rod-like structures<i class="fa fa-external-link"></i></span>）</p>
<p></p><p></p><br>2&gt;2012年，斯坦福大学和霍华德休斯医学研究所的科学家们发表在<span class="exturl" data-url="aHR0cDovL3d3dy5wbG9zb25lLm9yZy9hcnRpY2xlL2luZm8lM0Fkb2klMkYxMC4xMzcxJTJGam91cm5hbC5wb25lLjAwMzA3MzM=" title="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0030733">《Plos One》的一项研究<i class="fa fa-external-link"></i></span>首次证实在人体细胞的基因表达程序中，环形RNA分子而非线性RNA分子是一个更普遍的特征。<br><p></p><p><br>3&gt;2013年2月，<span class="exturl" data-url="aHR0cDovL3d3dy5lYmlvdHJhZGUuY29tL25ld3NmLzIwMTMtMi8yMDEzMjI4MTYwMzI5MTAwLmh0bQ==" title="http://www.ebiotrade.com/newsf/2013-2/2013228160329100.htm">Nature头条：震惊遗传界的环状RNA<i class="fa fa-external-link"></i></span>,揭示出环状RNA（circRNA）是一类特殊的非编码RNA分子，与传统的线性RNA（linear RNA，含5’和3’末端）不同，circRNA分子呈封闭环状结构，不受RNA外切酶影响，表达更稳定，不易降解。在功能上，circRNA分子富含microRNA（miRNA）结合位点，在细胞中起到miRNA海绵（ miRNA sponge）的作用，进而解除miRNA对其靶基因的抑制作用，升高靶基因的表达水平（近期研究显示，一个环状RNA-CDR1as (也称为ciRS-7) ，在其序列上有超过60个保守的miR-7结合位点，因此ciRS-7像海绵那样，将miR-7吸附到身上，进而影响miR-7靶标基因活性）；这一作用机制被称为竞争性内源RNA（ceRNA）机制。通过与疾病关联的miRNA相互作用， circRNA在疾病中发挥着重要的调控作用。<br><strong>Circular RNAs are a large class of animal RNAs with regulatory potency.Nature.Year published:(2013)DOI:doi:10.1038/nature11928：证实，在斑马鱼中表达这一环状RNA或敲除miR-7可以改变大脑发育。</strong><br><strong>Natural RNA circles function as efficient microRNA sponges.NatureYear published:(2013)DOI:doi:10.1038/nature11993：发现这一环状RNA的表达阻断了miR-7。它使得miR-7活性受到抑制，miR-7靶基因表达增高，研究人员推测这是因为这一RNA环捕获和失活了miR-7。</strong></p>
<p></p><p></p><br>早期认为环形RNA通过”外显子反向剪接成环（back splice circularization）”形成，定位于细胞浆中；2013年9月，中科院生物化学与细胞生物学研究所陈玲玲组发现来源于内含子序列的ciRNAs，其生成依赖特定的成环关键核酸序列；成熟的ciRNAs定位在细胞核内并调控其本位基因的转录速度。<br><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MxMDk3Mjc2NTEzMDA1OTBY" title="http://www.sciencedirect.com/science/article/pii/S109727651300590X">Circular Intronic Long Noncoding RNAs<i class="fa fa-external-link"></i></span><p></p>
<p></p><p></p><br>4&gt;2014年9月，中科院上海生命科学研究院的研究人员在新研究中证实，是内含子的互补序列介导了外显子环化。<br><span class="exturl" data-url="aHR0cDovL2xpbmtpbmdodWIuZWxzZXZpZXIuY29tL3JldHJpZXZlL3BpaS9TMDA5Mi04Njc0KDE0KTAxMTExLTg=" title="http://linkinghub.elsevier.com/retrieve/pii/S0092-8674(14)01111-8">Complementary Sequence-Mediated Exon Circularization<i class="fa fa-external-link"></i></span><p></p>
<p></p><p></p><br>5&gt;2016年2月，中科院上海生命科学研究院生物化学与细胞生物学研究所的研究员陈玲玲全面探讨了环状RNA（circRNA）的生物合成和新功能。真核细胞的环状RNA来自于mRNA前体（pre-mRNA）的反向剪接。虽然环状RNA通常表达水平较低，但它们的表达存在细胞和组织特异性。<br><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25ybS9qb3VybmFsL3YxNy9uNC9mdWxsL25ybS4yMDE1LjMyLmh0bWw=" title="http://www.nature.com/nrm/journal/v17/n4/full/nrm.2015.32.html">The biogenesis and emerging roles of circular RNAs<i class="fa fa-external-link"></i></span><br><i class="fa fa-folder" aria-hidden="true"></i>延伸阅读<br>剪接体<br>内含子经常存在于真核生物的蛋白质编码基因(coding gene)中。在内含子里，需要有 5’ 供体剪接位点(5’ donor splice site)、3’ 受体剪接位点(3’ acceptor splice site)及剪接分枝位点(branch point)来进行剪接。剪接是由剪接体（Spliceosome）来催化，它是以五个不同的小核核糖核酸(snRNs) 以及不下于一百个蛋白质所组成的大型核糖核酸蛋白质复合物，称为小核核糖蛋白(snRNP)。snRNP 的 RNA 会与内含子行杂交反应(hybridization)，并且参与剪接的催化反应。<br>snRNAs(small nuclear ribonucleoproteins)的作用<br>真核细胞有细胞核和细胞浆中都含有许多小RNA，它们约有100到300个碱基，每个细胞中可含有105-106个这种RNA分子。它们是由RNA聚合酶Ⅱ或Ⅲ所合成的，其中某些像mRNA一样可被加帽。在细胞核中的小RNA称为snRNA，而在细胞浆中的称为scRNA。但在天然状态下它们均与蛋白质相结合，故分别称为snRNP和scRNP。某些snRNPs和剪接作用有密切关系。有些snRNPs分别和供体及受体剪接位点以及分支顺序相互补。<p></p>
<h2 id="环形RNA要点">环形RNA要点</h2><p><li>具有闭合环状结构，没有PolyA “尾巴”。</li></p>
<p><li>不受RNA外切酶影响，表达更稳定，不易降解。</li></p>
<p><li>序列高度保守，具有一定的组织、时序和疾病特异性。</li></p>
<p><li></li></p>
<p><li></li></p>
<h2 id="生物起源(Biogenesis)">生物起源(Biogenesis)</h2><p>剪切体(spliceosome): 剪切体抑制降低circRNA和线性RNA水平；circRNA表达受管控，剪切体能够区分正向剪切(linear RNA)和backsplicing(circRNA)。具体如何区分还不清楚，但3种环化机制已经识别，其共同点核心是相关剪切位点毗邻（ juxtaposition），区别在于这种临近是如何实现的。more：<span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MxODc0OTM5OTE1MDAxNDU1" title="http://www.sciencedirect.com/science/article/pii/S1874939915001455">http://www.sciencedirect.com/science/article/pii/S1874939915001455<i class="fa fa-external-link"></i></span></p>
<h2 id="功能">功能</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/1-s2.0-S1874939915001455-gr1.jpg" alt=""><br>图注：1. 靠近环化外显子侧面的内含子存在互补序列motifs，直接的motifs区域碱基配对将环化的剪切位点拉进；</p>
<ol>
<li>RBPs(RNA bind protein)互作捆绑环化外显子侧面的内含子序列motifs区域，促进head-to-tail end-joining。</li>
<li>外显子跳跃导致包含外显子1和4的mRNA和包含外显子2和3的套索结构一样，这诱导外显子3的剪切供体和外显子2的剪切受体临近，随后的剪切形成EIciRNA(exon–intron ciRNAs)和circRNA，并伴随有外显子1和4组成的lines RNA。</li>
<li>CircRNA包含miRNA结合位点时吸附AGO-miRNA complexes；</li>
<li>调控RBPs；</li>
<li>exon–intron ciRNAs存在于核内，通过其保留的内含子的5‘剪切位点与U1 snRNP (U1)直接互作促进宿主基因的转录，exon–intron ciRNA-U1 complex招募RNA聚合酶 II(RNA pol II)刺激宿主基因转录起始。<br><i class="fa fa-folder" aria-hidden="true"></i>延伸阅读<br>Specialised spliceosomes splice the introns out of pre-mRNA and seal the exon ends together, using the splicing consensus sequences at the intron/exon boundaries to identify the correct positions to splice.  Sometimes a regulatory protein will mask a splicing sequence, resulting in alternative splicing.  The spliceosomes consist primarily of RNA-protein complexes called small nuclear ribonucleoproteins (snRNPs).  The snRNPs are composed of small nuclear RNAs (snRNAs) - U1, U2, U4, U5 and U6 - as well as a group of seven proteins known as Sm ribonucleoproteins that collectively make up the extremely stable Sm core of the snRNP.  The snRNPs bind to the pre-mRNA in a specific order to align the splice sites for cleavage, which involves RNA-RNA pairing between the snRNA and the pre-mRNA with the help of the Sm proteins.  The U1 snRNP binds to the 5’ end of the intron and the U2 snRNP binds close to the 3’ end of the intron (at the branch point), followed by the binding of the U4/U6 snRNPs that play an important role close to the reaction centre, and finally the U5 snRNP that helps hold the two exons together.  After the intron is spliced out it is rapidly degraded, and the two exons are ligated together. More：<span class="exturl" data-url="aHR0cDovL3d3dy5lYmkuYWMudWsvaW50ZXJwcm8vcG90bS8yMDA1XzUvUGFnZTEuaHRt" title="http://www.ebi.ac.uk/interpro/potm/2005_5/Page1.htm">http://www.ebi.ac.uk/interpro/potm/2005_5/Page1.htm<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/image005.gif" alt=""><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/image006.gif" alt=""></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;环形RNA研究历史&quot;&gt;环形RNA研究历史&lt;/h2&gt;&lt;p&gt;1&amp;gt;最早的环形RNA分子在20世纪70年代于RNA病毒中发现。（&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="circRNA" scheme="http://tiramisutes.github.io/tags/circRNA/"/>
    
  </entry>
  
  <entry>
    <title>Analyzing Data</title>
    <link href="http://tiramisutes.github.io/2016/04/01/Summary-Statistics.html"/>
    <id>http://tiramisutes.github.io/2016/04/01/Summary-Statistics.html</id>
    <published>2016-04-01T06:17:34.000Z</published>
    <updated>2016-10-26T09:49:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Summary_Statistics">Summary Statistics</h2><h3 id="mean(),max(),min(),range()，sd()">mean(),max(),min(),range()，sd()</h3><p>以上函数运算中，若存在NA，则返回结果为NA，设置na.rm=TRUE忽略NA值。<br>mean()中移除异常值：trim（<code>mean(x, trim = 0.1)</code>：先把x的最大的10%的数和最小的10%的数去掉，然后剩下的数算平均）<br>range():同时返回最大/最小值。<br>sd()：标准差。</p>
<h3 id="quantile(),fivenum()，IQR()">quantile(),fivenum()，IQR()</h3><p><code>quantile(dow30$Open, probs=c(0,0.25,0.5,0.75,1.0))</code><br>返回不同的百分位数值，probs指定百分位。<br>fivenum()：返回(minimum, 25th percentile, median, 75th percentile, and maximum)。<br>IQR()：返回25%与75%的差值<br>以上函数既可用于单独数组，也可用于apply, tapply对数据框的操作。</p>
<h3 id="summary()">summary()</h3><p>对于数值变量计算了五个分位点和均值，对于分类变量则计算了频数。</p>
<h2 id="Statistical_Tests">Statistical Tests</h2><p>基于<strong>正态分布</strong>的检验；自然群体大都为正态分布。</p>
<h3 id="Comparing_means">Comparing <blod>means</blod></h3><p>Specifically, suppose that you have a set of observations<br>x1, x2, …, xn with experimental mean μ and want to know if the experimental<br>mean is different from the null hypothesis mean μ0. Furthermore, assume that the<br>observations are normally distributed. To test the validity of the hypothesis, you can<br>use a t-test. In R, you would use the function <code>t.test</code>;</p>
<h3 id="Comparing_paired_data(means)">Comparing paired data(<blod>means</blod>)</h3><p>For example, you might have two observations per subject: one before an experiment and one after the experiment.<br>In this case, you would use a paired t-test. You can use the t.test function, specifying<br><code>paired=TRUE</code>, to perform this test.</p>
<h3 id="Comparing_variances_of_two_populations">Comparing <blod>variances</blod> of two populations</h3><p>To compare the variances of two samples from normal populations, R includes the<br><code>var.test</code> function which performs an <em>F-test</em>;</p>
<h3 id="Comparing_means_across_more_than_two_groups">Comparing means across more than two groups</h3><p>ANOVA单因素方差分析与R实现：<a href="http://tiramisutes.github.io/2015/10/08/ANOVA.html">http://tiramisutes.github.io/2015/10/08/ANOVA.html</a></p>
<h3 id="Correlation_tests"><strong>Correlation</strong> tests</h3><p>If you’d like to check whether there is a statistically significant<br>correlation between two vectors, you can use the <code>cor.test</code> function；</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Summary_Statistics&quot;&gt;Summary Statistics&lt;/h2&gt;&lt;h3 id=&quot;mean(),max(),min(),range()，sd()&quot;&gt;mean(),max(),min(),range()，sd()&lt;/h3&gt;&lt;p&gt;以上函数运算中，若
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="Statistics" scheme="http://tiramisutes.github.io/tags/Statistics/"/>
    
  </entry>
  
  <entry>
    <title>SQLite数据库简单操作</title>
    <link href="http://tiramisutes.github.io/2016/03/22/SQLite.html"/>
    <id>http://tiramisutes.github.io/2016/03/22/SQLite.html</id>
    <published>2016-03-22T05:43:04.000Z</published>
    <updated>2016-03-23T06:00:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SQLite数据库整体查询命令">SQLite数据库整体查询命令</h2><h3 id="dot-commands">dot-commands</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sqlite3</span> </span><br><span class="line">sqlite&gt; .<span class="built_in">help</span></span><br><span class="line">.backup ?DB? FILE      Backup DB (default <span class="string">"main"</span>) to FILE</span><br><span class="line">.bail ON|OFF           Stop after hitting an error.  Default OFF</span><br><span class="line">.databases             List names and files of attached databases</span><br><span class="line">.dump ?TABLE? ...      Dump the database <span class="keyword">in</span> an SQL text format</span><br><span class="line">                         If TABLE specified, only dump tables matching</span><br><span class="line">                         LIKE pattern TABLE.</span><br><span class="line">.<span class="built_in">echo</span> ON|OFF           Turn <span class="built_in">command</span> <span class="built_in">echo</span> on or off</span><br><span class="line">.<span class="built_in">exit</span>                  Exit this program</span><br><span class="line">.explain ON|OFF        Turn output mode suitable <span class="keyword">for</span> EXPLAIN on or off.</span><br><span class="line">.genfkey ?OPTIONS?     Options are:</span><br><span class="line">                         --no-drop: Do not drop old fkey triggers.</span><br><span class="line">                         --ignore-errors: Ignore tables with fkey errors</span><br><span class="line">                         --<span class="built_in">exec</span>: Execute generated SQL immediately</span><br><span class="line">                       See file tool/genfkey.README <span class="keyword">in</span> the <span class="built_in">source</span> </span><br><span class="line">                       distribution <span class="keyword">for</span> further information.</span><br><span class="line">.header(s) ON|OFF      Turn display of headers on or off</span><br><span class="line">.<span class="built_in">help</span>                  Show this message</span><br><span class="line">.import FILE TABLE     Import data from FILE into TABLE</span><br><span class="line">.indices ?TABLE?       Show names of all indices</span><br><span class="line">                         If TABLE specified, only show indices <span class="keyword">for</span> tables</span><br><span class="line">                         matching LIKE pattern TABLE.</span><br><span class="line">.load FILE ?ENTRY?     Load an extension library</span><br><span class="line">.mode MODE ?TABLE?     Set output mode <span class="built_in">where</span> MODE is one of:</span><br><span class="line">                         csv      Comma-separated values</span><br><span class="line">                         column   Left-aligned columns.  (See .width)</span><br><span class="line">                         html     HTML &lt;table&gt; code</span><br><span class="line">                         insert   SQL insert statements <span class="keyword">for</span> TABLE</span><br><span class="line">                         line     One value per line</span><br><span class="line">                         list     Values delimited by .separator string</span><br><span class="line">                         tabs     Tab-separated values</span><br><span class="line">                         tcl      TCL list elements</span><br><span class="line">.nullvalue STRING      Print STRING <span class="keyword">in</span> place of NULL values</span><br><span class="line">.output FILENAME       Send output to FILENAME</span><br><span class="line">.output stdout         Send output to the screen</span><br><span class="line">.prompt MAIN CONTINUE  Replace the standard prompts</span><br><span class="line">.quit                  Exit this program</span><br><span class="line">.<span class="built_in">read</span> FILENAME         Execute SQL <span class="keyword">in</span> FILENAME</span><br><span class="line">.restore ?DB? FILE     Restore content of DB (default <span class="string">"main"</span>) from FILE</span><br><span class="line">.schema ?TABLE?        Show the CREATE statements</span><br><span class="line">                         If TABLE specified, only show tables matching</span><br><span class="line">                         LIKE pattern TABLE.</span><br><span class="line">.separator STRING      Change separator used by output mode and .import</span><br><span class="line">.show                  Show the current values <span class="keyword">for</span> various settings</span><br><span class="line">.tables ?TABLE?        List names of tables</span><br><span class="line">                         If TABLE specified, only list tables matching</span><br><span class="line">                         LIKE pattern TABLE.</span><br><span class="line">.timeout MS            Try opening locked tables <span class="keyword">for</span> MS milliseconds</span><br><span class="line">.width NUM NUM ...     Set column widths <span class="keyword">for</span> <span class="string">"column"</span> mode</span><br><span class="line">.timer ON|OFF          Turn the CPU timer measurement on or off</span><br></pre></td></tr></table></figure>
<h2 id="SQLite数据类型">SQLite数据类型</h2><p><li>text</li></p>
<p><li>integer </li></p>
<p><li>real </li></p>
<p><li>NULL, used for missing data, or no value </li></p>
<p><li>BLOB, which stands for binary large object, and stores any type of object as bytes </li><br>注：SQLite并没有强制同列必须使用相同类型的数据，每个表的每一列都有优先类型（type affinity），但为了下游分析方便，最好同一列保持相同数据类型。<br>当某一列是混合数据类型时，排序原则为：NULL values, integer and real values (sorted numerically), text values, and finally blob values。</p>
<h2 id="数据库内容查询">数据库内容查询</h2><h3 id="万能的SELECT命令">万能的SELECT命令</h3><p>语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &lt;columns&gt; FROM &lt;tablename&gt;;</span><br></pre></td></tr></table></figure></p>
<p>基本形式：SELECT选择指令从一个table中抓取所有列的所有行（columns设定为<code>*</code>）。<br>选取特定列：不同列之间逗号分隔（SELECT trait, chrom, position, strongest_risk_snp, pvalue FROM gwascat LIMIT 5;）<br>SELECT语句除了在sqlite中交互查询外，还可在命令行中直接查询<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#交互</span></span><br><span class="line">sqlite&gt; SELECT * FROM gwascat;</span><br><span class="line"><span class="comment">#命令行</span></span><br><span class="line">sqlite3 gwascat.db <span class="string">"SELECT * FROM gwascat"</span> &gt; results.txt</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-commenting-o"></i>SQLite默认输出不规则，可做以下设置输出排列整齐易读输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT trait, chrom, position, strongest_risk_snp, pvalue</span><br><span class="line">   ...&gt; FROM gwascat LIMIT 5;</span><br><span class="line">trait|chrom|position|strongest_risk_snp|pvalue</span><br><span class="line">Asthma and hay fever|6|32658824|rs9273373|4.0e-14</span><br><span class="line">Asthma and hay fever|4|38798089|rs4833095|5.0e-12</span><br><span class="line">Asthma and hay fever|5|111131801|rs1438673|3.0e-11</span><br><span class="line">Asthma and hay fever|2|102350089|rs10197862|4.0e-11</span><br><span class="line">Asthma and hay fever|17|39966427|rs7212938|4.0e-10</span><br><span class="line">sqlite&gt; .header on</span><br><span class="line">sqlite&gt; .mode column</span><br><span class="line">sqlite&gt; SELECT trait, chrom, position, strongest_risk_snp, pvalue</span><br><span class="line">   ...&gt; FROM gwascat LIMIT 5;</span><br><span class="line">trait                 chrom       position    strongest_risk_snp  pvalue</span><br><span class="line">--------------------  ----------  ----------  ------------------  ----------</span><br><span class="line">Asthma and hay fever  6           32658824    rs9273373           4.0e-14</span><br><span class="line">Asthma and hay fever  4           38798089    rs4833095           5.0e-12</span><br><span class="line">Asthma and hay fever  5           111131801   rs1438673           3.0e-11</span><br><span class="line">Asthma and hay fever  2           102350089   rs10197862          4.0e-11</span><br><span class="line">Asthma and hay fever  17          39966427    rs7212938           4.0e-10</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-cog fa-spin"></i>SELECT可选参数：<br>LIMIT    输出查询行数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT * FROM gwascat LIMIT 2;</span><br></pre></td></tr></table></figure></p>
<p>ORDER BY     输出结果排序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT author, trait, journal FROM &lt;tablename&gt; ORDER BY author DESC LIMIT 5; </span><br><span class="line"><span class="comment">#（按author降序排序），排序有助于异常值检测。</span></span><br><span class="line"><span class="comment">#若所指定排序列含由NULL值，可通过 IS NOT NULL 排除NULL值</span></span><br><span class="line">SELECT chrom, position, trait, strongest_risk_snp, pvalue FROM  &lt;tablename&gt; WHERE pvalue IS NOT NULL ORDER BY pvalue LIMIT 5;</span><br></pre></td></tr></table></figure></p>
<p>WHERE    数据筛选<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT chrom, position, trait, strongest_risk_snp, pvalue FROM &lt;tablename&gt; WHERE lower(strongest_risk_snp) = <span class="string">"rs429358"</span>;</span><br><span class="line"><span class="comment">#SQLite大小写敏感，所以匹配时最好用lower() 转换。</span></span><br></pre></td></tr></table></figure></p>
<p>多条件筛选：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT chrom, position, strongest_risk_snp, pvalue FROM gwascat</span><br><span class="line">   ...&gt; WHERE chrom IN (<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>) AND pvalue &lt; 10e-11</span><br><span class="line">   ...&gt; ORDER BY pvalue LIMIT 5;</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">sqlite&gt; SELECT chrom, position, strongest_risk_snp, pvalue</span><br><span class="line">   ...&gt; FROM gwascat WHERE chrom = <span class="string">"22"</span></span><br><span class="line">   ...&gt; AND position BETWEEN 24000000 AND 25000000</span><br><span class="line">   ...&gt; AND pvalue IS NOT NULL ORDER BY pvalue LIMIT 5;</span><br></pre></td></tr></table></figure></p>
<p>AS    对原始数据的修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT lower(trait) AS trait,</span><br><span class="line">   ...&gt; <span class="string">"chr"</span> || chrom || <span class="string">":"</span> || position AS region FROM gwascat LIMIT 5;</span><br><span class="line"><span class="comment">#||为连接运算符，用来连接两个字符串</span></span><br><span class="line"><span class="comment">#NULL的替换，ifnull()函数</span></span><br><span class="line">sqlite&gt; SELECT ifnull(chrom, <span class="string">"NA"</span>) AS chrom, ifnull(position, <span class="string">"NA"</span>) AS position,</span><br><span class="line">   ...&gt; strongest_risk_snp, ifnull(pvalue, <span class="string">"NA"</span>) AS pvalue FROM gwascat</span><br><span class="line">   ...&gt; WHERE strongest_risk_snp = <span class="string">"rs429358"</span>;</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-cutlery"></i>更多SQLite内置函数<br>Function    Description<br>ifnull(x, val)    If x is NULL, return with val, otherwise return x; shorthand for coalesce() with two arguments<br>min(a, b, c, …)    Return minimum in a, b, c, …<br>max(a, b, c, …)    Return maximum in a, b, c, …<br>abs(x)    Absolute value<br>coalesce(a, b, c, …)    Return first non-NULL value in a, b, c, … or NULL if all values are NULL<br>length(x)    Returns number of characters in x<br>lower(x)    Return x in lowercase<br>upper(x)    Return x in uppercase<br>replace(x, str, repl)    Return x with all occurrences of str replaced with repl<br>round(x, digits)    Round x to digits (default 0)<br>trim(x, chars), ltrim(x, chars), rtrim(x, chars)    Trim off chars (spaces if chars is not specified) from both sides, left side, and right side of x, respectively.<br>substr(x, start, length)    Extract a substring from x starting from character start and is length characters long</p>
<h3 id="集合函数（Aggregate）">集合函数（Aggregate）</h3><p>count(colname)函数：<br>返回总行数（无视NULL的存在）：sqlite&gt; SELECT count(*) FROM gwascat;<br>若colname是具体某列则返回出去NULL值的总行数.<br>其他相似函数：avg(x),max(x),min(x),sum(x),total(x)<br><i class="fa fa-modx"></i>计算列非重复值(unique)个数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT count(DISTINCT 列) AS unique_rs FROM gwascat;</span><br></pre></td></tr></table></figure></p>
<h3 id="行分组(GROUP_BY)">行分组(GROUP BY)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; SELECT chrom, count(*) FROM gwascat GROUP BY chrom;</span><br><span class="line">chrom       count(*)</span><br><span class="line">----------  ----------</span><br><span class="line">            70</span><br><span class="line">1           1458</span><br><span class="line">10          930</span><br><span class="line">11          988</span><br><span class="line">12          858</span><br><span class="line">13          432</span><br><span class="line">[...]</span><br><span class="line"><span class="comment">#列重命名，降序，分组计算</span></span><br><span class="line">sqlite&gt; SELECT chrom, count(*) as nhits FROM gwascat GROUP BY chrom</span><br><span class="line">   ...&gt; ORDER BY nhits DESC;</span><br><span class="line">chrom       nhits</span><br><span class="line">----------  ----------</span><br><span class="line">6           1658</span><br><span class="line">1           1458</span><br><span class="line">2           1432</span><br><span class="line">3           1033</span><br><span class="line">11          988</span><br><span class="line">10          930</span><br><span class="line">[...]</span><br><span class="line"><span class="comment">#多列分组，不同列之间逗号分隔</span></span><br><span class="line">sqlite&gt; select strongest_risk_snp, strongest_risk_allele, count(*) AS count</span><br><span class="line">   ...&gt; FROM gwascat GROUP BY strongest_risk_snp, strongest_risk_allele</span><br><span class="line">   ...&gt; ORDER BY count DESC LIMIT 10;</span><br><span class="line">strongest_risk_snp  strongest_risk_allele  count</span><br><span class="line">------------------  ---------------------  ----------</span><br><span class="line">rs1260326           T                      22</span><br><span class="line">rs2186369           G                      22</span><br><span class="line">rs1800562           A                      20</span><br><span class="line">rs909674            C                      20</span><br><span class="line">rs11710456          G                      19</span><br></pre></td></tr></table></figure>
<h2 id="自己动手写数据库">自己动手写数据库</h2><p>we’ll use the basic SQL syntax to create tables and insert records into tables. Then load data into SQLite using Python’s sqlite3 module.</p>
<h3 id="创建tables">创建tables</h3><p>基本语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tablename(</span><br><span class="line">  id <span class="built_in">integer</span> primary key,</span><br><span class="line">  column1 column1_type,</span><br><span class="line">  column2 column2_type,</span><br><span class="line">  ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>注意到所有SQLite数据库第一列总是id integer primary key，primary key是非重复整数来识别table中每一条记录。<br>创建table：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sqlite3 practice.dbsqlite&gt; CREATE TABLE variants(</span><br><span class="line">   ...&gt;   id <span class="built_in">integer</span> primary key,</span><br><span class="line">   ...&gt;   chrom text,</span><br><span class="line">   ...&gt;   start <span class="built_in">integer</span>,</span><br><span class="line">   ...&gt;   end <span class="built_in">integer</span>,</span><br><span class="line">   ...&gt;   strand text,</span><br><span class="line">   ...&gt;   name text);</span><br></pre></td></tr></table></figure></p>
<h3 id="数据写入table">数据写入table</h3><p>基本语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO tablename(column1, column2)</span><br><span class="line">VALUES (value1, value2);</span><br></pre></td></tr></table></figure></p>
<h3 id="建立索引">建立索引</h3><p>基本语法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlite&gt; CREATE INDEX &lt;columns-name_idx&gt; ON &lt;tablename&gt;(&lt;columns-name&gt;);</span><br><span class="line"><span class="comment">#察看索引</span></span><br><span class="line">sqlite&gt; .indices</span><br><span class="line">columns-name_idx</span><br><span class="line"><span class="comment">#删除索引</span></span><br><span class="line">sqlite&gt; DROP INDEX columns-name_idx;</span><br></pre></td></tr></table></figure></p>
<h3 id="修改/删除table">修改/删除table</h3><p>删除：DROP TABLE<br>修改：ALTER TABLE</p>
<h2 id="python中交互操作SQLite">python中交互操作SQLite</h2><h3 id="连接SQLite数据库并创建table">连接SQLite数据库并创建table</h3><p>create_table.py<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import sqlite3</span><br><span class="line"></span><br><span class="line"><span class="comment"># the filename of this SQLite database</span></span><br><span class="line">db_filename = <span class="string">"variants.db"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize database connection</span></span><br><span class="line">conn = sqlite3.connect(db_filename) <span class="comment">#connect() 连接数据库</span></span><br><span class="line"></span><br><span class="line">c = conn.cursor() <span class="comment">#在python中用cursor()与SQLite数据库交互</span></span><br><span class="line"></span><br><span class="line">table_def = <span class="string">""</span><span class="string">"\ </span></span><br><span class="line"><span class="string">CREATE TABLE variants(</span></span><br><span class="line"><span class="string">  id integer primary key,</span></span><br><span class="line"><span class="string">  chrom test,</span></span><br><span class="line"><span class="string">  start integer,</span></span><br><span class="line"><span class="string">  end integer,</span></span><br><span class="line"><span class="string">  strand text,</span></span><br><span class="line"><span class="string">  rsid text);</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line"></span><br><span class="line">c.execute(table_def)  <span class="comment">#SQL语法，相当于确认</span></span><br><span class="line">conn.commit()  <span class="comment">#提交跟新内容到SQLite数据库</span></span><br><span class="line">conn.close()   <span class="comment">#关闭与数据库的连接</span></span><br></pre></td></tr></table></figure></p>
<h3 id="数据载入table">数据载入table</h3><p>load_variants.py<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##load_variants.py data.txt</span></span><br><span class="line">import sys</span><br><span class="line">import sqlite3</span><br><span class="line">from collections import OrderedDict</span><br><span class="line"></span><br><span class="line"><span class="comment"># the filename of this SQLite database</span></span><br><span class="line">db_filename = <span class="string">"variants.db"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize database connection</span></span><br><span class="line">conn = sqlite3.connect(db_filename)</span><br><span class="line">c = conn.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment">## Load Data</span></span><br><span class="line"><span class="comment"># columns (other than id, which is automatically incremented</span></span><br><span class="line">tbl_cols = OrderedDict([(<span class="string">"chrom"</span>, str), (<span class="string">"start"</span>, int), </span><br><span class="line">                        (<span class="string">"end"</span>, int), (<span class="string">"strand"</span>, str),</span><br><span class="line">                        (<span class="string">"rsid"</span>, str)])</span><br><span class="line"></span><br><span class="line">with open(sys.argv[1]) as input_file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> input_file:</span><br><span class="line">        <span class="comment"># split a tab-delimited line</span></span><br><span class="line">        values = line.strip().split(<span class="string">"\t"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pair each value with its column name</span></span><br><span class="line">        cols_values = zip(tbl_cols.keys(), values)</span><br><span class="line">		<span class="comment"># use the column name to lookup an appropriate function to coerce each</span></span><br><span class="line">        <span class="comment"># value to the appropriate type</span></span><br><span class="line">        coerced_values = [tbl_cols[col](value) <span class="keyword">for</span> col, value <span class="keyword">in</span> cols_values]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># create an empty list of placeholders</span></span><br><span class="line">        placeholders = [<span class="string">"?"</span>] * len(tbl_cols)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># create the query by joining column names and placeholders quotation</span></span><br><span class="line">        <span class="comment"># marks into comma-separated strings</span></span><br><span class="line">        colnames = <span class="string">", "</span>.join(tbl_cols.keys())</span><br><span class="line">        placeholders = <span class="string">", "</span>.join(placeholders)</span><br><span class="line">        query = <span class="string">"INSERT INTO variants(%s) VALUES (%s);"</span>%(colnames, placeholders)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># execute query</span></span><br><span class="line">        c.execute(query, coerced_values)</span><br><span class="line"></span><br><span class="line">conn.commit() <span class="comment"># commit these inserts</span></span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;SQLite数据库整体查询命令&quot;&gt;SQLite数据库整体查询命令&lt;/h2&gt;&lt;h3 id=&quot;dot-commands&quot;&gt;dot-commands&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="SQLite" scheme="http://tiramisutes.github.io/tags/SQLite/"/>
    
  </entry>
  
  <entry>
    <title>Linux中如何正确删除：find-rm</title>
    <link href="http://tiramisutes.github.io/2016/03/21/find-rm.html"/>
    <id>http://tiramisutes.github.io/2016/03/21/find-rm.html</id>
    <published>2016-03-21T04:18:46.000Z</published>
    <updated>2016-03-21T05:05:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>假如当前目录下有诸多fastq文件想要删除，通常我们选择这样：</p>
<h2 id="直接删除">直接删除</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm *-temp.fastq</span><br></pre></td></tr></table></figure>
<p>但是如果一时疏忽输入<code>rm <em> -temp.fastq</em></code>（号和-号之间多了空格），那结果就惨了…..<br>而如果结合<a href="http://tiramisutes.github.io/2015/11/29/find/" target="_blank">Linux常用命令之find</a>命令那么一切就简单多了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find . -name <span class="string">"*-temp.fastq"</span> -<span class="built_in">exec</span> rm -i &#123;&#125; \;</span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">find . -name <span class="string">"*-temp.fastq"</span> | xargs rm</span><br></pre></td></tr></table></figure></p>
<p>-exec 表示由find找到的匹配项会作为”-exec后面设定的命令”的参数（｛｝中输入值）<br>-i    交互删除<br>若想要删除文件夹，则<code>-delete</code> 代替<code>-exec -rm {}</code> </p>
<h2 id="打印删除rm命令并检查">打印删除rm命令并检查</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">find . -name <span class="string">"*-temp.fastq"</span> | xargs -n 1 <span class="built_in">echo</span> <span class="string">"rm -i"</span> &gt; delete-temp.sh</span><br><span class="line">cat delete-temp.sh</span><br><span class="line">rm -i ./zmaysA_R1-temp.fastq</span><br><span class="line">rm -i ./zmaysA_R2-temp.fastq</span><br><span class="line">rm -i ./zmaysC_R1-temp.fastq</span><br><span class="line">rm -i ./zmaysC_R2-temp.fastq</span><br><span class="line">bash delete-temp.sh</span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">find . -name <span class="string">"*.fastq"</span> | xargs -n 1 -P 4 bash script.sh</span><br></pre></td></tr></table></figure>
<p>-n 1    表示find擦找到的参数每次只有一个输入到xargs中<br>-P    并行运算</p>
<h2 id="将删除文件放入临时文件夹（tmp）">将删除文件放入临时文件夹（tmp）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">myrm</span></span>()&#123; D=/tmp/$(date +%Y%m%d%H%M%S); mkdir -p <span class="variable">$D</span>; mv <span class="string">"<span class="variable">$@</span>"</span> <span class="variable">$D</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"moved to <span class="variable">$D</span> ok"</span>; &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;假如当前目录下有诸多fastq文件想要删除，通常我们选择这样：&lt;/p&gt;
&lt;h2 id=&quot;直接删除&quot;&gt;直接删除&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="find-rm" scheme="http://tiramisutes.github.io/tags/find-rm/"/>
    
  </entry>
  
  <entry>
    <title>被忽视的Samtools参数</title>
    <link href="http://tiramisutes.github.io/2016/03/20/Samtools.html"/>
    <id>http://tiramisutes.github.io/2016/03/20/Samtools.html</id>
    <published>2016-03-20T14:54:42.000Z</published>
    <updated>2018-09-28T02:43:51.275Z</updated>
    
    <content type="html"><![CDATA[<p><span class="exturl" data-url="aHR0cDovL3d3dy5wbG9iLm9yZy90YWcvc2FtdG9vbHM=" title="View all posts in samtools">Samtools<i class="fa fa-external-link"></i></span>是一个用于操作序列比对结果sam和bam文件的工具合集。</p>
<h2 id="sam文件格式">sam文件格式</h2><p>SAM格式由两部分组成：头部区和比对区，都以tab分列。<br><strong>头部区:</strong>以’@’开始，体现了比对的一些总体信息。比对的SAM格式版本，比对的参考序列，比对使用的软件等。<br><strong>比对区:</strong> 比对结果，每一个比对结果是一行，有11个主列和1个可选列。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@HD VN:1.0 SO:unsorted  </span><br><span class="line">头部区第一行：VN是格式版本；SO表示比对排序的类型，有unkown(default),unsorted,</span><br><span class="line">queryname和coordinate几种。samtools软件在进行排序后不能自动更新bam文件的SO值。</span><br><span class="line">picard却可以。</span><br><span class="line">@SQ SN:A.auricula_all_contig_1 LN:9401</span><br><span class="line">参考序列名。这些参考序列决定了比对结果sort的顺序。SN是参考序列名；LN是参考序列</span><br><span class="line">长度;</span><br><span class="line">@RG ID:sample01</span><br><span class="line">Read Group. 1个sample的测序结果为1个Read Group；该sample可以有多个library</span><br><span class="line">的测序结果。</span><br><span class="line">@PG ID:bowtie2 PN:bowtie2 VN:2.0.0-beta7</span><br><span class="line">比对所使用的软件。</span><br><span class="line"></span><br><span class="line">比对区11个列和可选列的解释</span><br><span class="line">1  QNAME  比对的序列名,即单端或双端fa/fq 中的reads编号, ‘*’ indicates the information is unavailable.</span><br><span class="line">2  FLAG   Bwise FLAG(表明比对类型：pairing，strand，mate strand等)</span><br><span class="line">3  RNAME  比对上的参考序列名,An unmapped segment without coordinate has a ‘*’ at this field. </span><br><span class="line">4  POS    1-Based的比对上的最左边的定位,POS is <span class="built_in">set</span> as 0 <span class="keyword">for</span> an unmapped <span class="built_in">read</span> without coordinate. If POS is 0, no assumptions can be made about RNAME and CIGAR.</span><br><span class="line">5  MAPQ   比对质量，255表示没有map</span><br><span class="line">6  CIGAR  Extended CIGAR string (操作符：MIDNSHP) 比对结果信息：匹配碱基数，可变剪接等，*表示不可用。</span><br><span class="line">7  RNEXT   相匹配的另外一条序列，比对上的参考序列名,‘*’ when the information is unavailable, and <span class="built_in">set</span> as ‘=’ <span class="keyword">if</span> RNEXT is identical RNAME</span><br><span class="line">8  PNEXT   1-Based leftmost Mate POsition,0 when the information is unavailable.</span><br><span class="line">9  TLEN  插入片段长度,<span class="built_in">set</span> as 0 <span class="keyword">for</span> single-segment template or when the information is unavailable</span><br><span class="line">10 SEQ    和参考序列在同一个琏上的比对序列(若比对结果在负意链上，则序列是其反向重复序列), ‘*’ when the sequence is not stored</span><br><span class="line">11 QUAL   比对序列的质量(ASCII-33=Phred base quality),‘*’ when quality is not stored</span><br><span class="line">12 可选的行，以TAG：TYPE：VALUE的形式提供额外的信息</span><br></pre></td></tr></table></figure></p>
<h3 id="比对区解释">比对区解释</h3><p><strong>sam/bam比对区包含有此次比对的结果信息，</strong>其中主要信息解释如下：</p>
<p><li><strong>FLAG部分</strong></li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/flag.png" alt=""><br><strong>0x800</strong> 表明相应位置的比对属于嵌合体比对；<br><strong>0x4</strong> 没有map上的reads；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sam_output2.png" alt=""></p>
<p><li><strong>CIGAR部分</strong></li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cigar.png" alt=""><br>对于mRNA到基因组的比对，N表示内含子。<br>More: <span class="exturl" data-url="aHR0cDovL3NhbXRvb2xzLmdpdGh1Yi5pby9odHMtc3BlY3MvU0FNdjEucGRm" title="http://samtools.github.io/hts-specs/SAMv1.pdf">http://samtools.github.io/hts-specs/SAMv1.pdf<i class="fa fa-external-link"></i></span></p>
<h2 id="sam文件的几个特例解释">sam文件的几个特例解释</h2><h3 id="Unmapped_reads_统计">Unmapped reads 统计</h3><p>Each alignment is one line of the SAM file, but not all lines are successful alignments. <strong>Unmapped reads在sam文件中的标记：<code>FLAG</code>列为4而且<code>RNAME</code>列为星号*；</strong><br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#统计包含星号的比对行数</span></span><br><span class="line">cut -f3 smallRNA-<span class="built_in">seq</span>.sam | grep -c \*</span><br><span class="line"><span class="comment">#总的比对行数</span></span><br><span class="line">grep -c -v <span class="string">"^@"</span> smallRNA-<span class="built_in">seq</span>.sam</span><br></pre></td></tr></table></figure></p>
<h3 id="How_many_different_read_IDs_are_in_the_file?">How many different read IDs are in the file?</h3><p>The query (read) ID is in field 1. Some reads may have multiple alignments, so the number of lines is not necessarily the number of reads.<br><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep -v <span class="string">"@"</span> HR<span class="number">-1</span>B.fq.gz.sam | <span class="type">cut</span> -f1 | <span class="type">sort</span> | <span class="type">uniq</span> | <span class="type">wc</span> -l </span><br><span class="line">#同时统计此次比对的单端/双端 fa/fq文件发现两者结果不同，说明确实有些reads未能比对上去。</span><br><span class="line">zcat pepper/RNA-seq/sgs-clean-reads/HR<span class="number">-1</span>B.fq.gz | <span class="type">wc</span> -l</span><br></pre></td></tr></table></figure></p>
<h3 id="How_many_different_read_sequences_are_in_the_file?">How many different read sequences are in the file?</h3><p>第一列的reads ID仅能表示测序过程中的不同reads，但他们的序列可能因为PCR扩增原因或文库偏好而完全相同，所以统计第10列的uniq序列数能够准确的表示reads总数。<br><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -f10 smallRNAseq.sam | <span class="type">sort</span> | <span class="type">uniq</span> | <span class="type">wc</span> -l</span><br></pre></td></tr></table></figure></p>
<h3 id="How_many_reads_are_uniquely_mapped?">How many reads are <strong>uniquely mapped</strong>?</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -f10 smallRNAseq.sam | <span class="type">sort</span> | <span class="type">uniq</span> -u | <span class="type">wc</span> -l</span><br></pre></td></tr></table></figure>
<p>对于 BWA比对结果也可用<code>grep -c XT:A:U smallRNA-seq.sam</code>来准确统计。</p>
<h3 id="How_many_reads_are_multi-hits?">How many reads are <strong>multi-hits</strong>?</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -f1 smallRNA-seq.sam | <span class="type">sort</span> | <span class="type">uniq</span> -d | <span class="type">wc</span> -l</span><br></pre></td></tr></table></figure>
<p>对于 BWA比对结果也可用<code>grep -c XT:A:R smallRNAseq.sam</code>来准确统计。</p>
<h3 id="How_many_alignments_are_reported_for_each_read?">How many alignments are reported for each read?</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -v <span class="string">"^@"</span> smallRNA-seq.sam | <span class="type">cut</span> -f1 | <span class="type">sort</span> | <span class="type">uniq</span> -c | <span class="type">sort</span> -nr &gt; sortedreadcount.txt</span><br><span class="line">grep -v <span class="string">"^@"</span> smallRNA-seq.sam | <span class="type">cut</span> -f1 |<span class="type">sort</span> | <span class="type">uniq</span> -c | <span class="type">sort</span> -nr | <span class="type">cut</span> -c1<span class="number">-8</span> | <span class="type">sort</span> | <span class="type">uniq</span> -c</span><br></pre></td></tr></table></figure>
<h3 id="How_many_different_reference_sequences_are_represented_in_the_file?">How many different reference sequences are represented in the file?</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -v <span class="string">"^@"</span> smallRNA-seq.sam | <span class="type">cut</span> –f3 | <span class="type">sort</span> | <span class="type">uniq</span> | <span class="type">wc</span> -l</span><br></pre></td></tr></table></figure>
<h2 id="view">view</h2><p>-c    计数<br>-f    返回指定区间/flags比对结果<br>-q    返回比对质量大于等于指定值的比对数目<br><strong>-F 4：</strong>统计map 上的 reads总数；<br><strong>-f 4：</strong>统计没有map 上的 reads总数；<br>To get the <strong>unmapped</strong> reads from a <span class="exturl" data-url="aHR0cDovL3NhbXRvb2xzLnNvdXJjZWZvcmdlLm5ldC9TQU0xLnBkZg==" title="http://samtools.sourceforge.net/SAM1.pdf">bam<i class="fa fa-external-link"></i></span> file use :<br><code>samtools view -f 4 file.bam &gt; unmapped.sam</code>, the output will be in <span class="exturl" data-url="aHR0cDovL3NhbXRvb2xzLnNvdXJjZWZvcmdlLm5ldC9TQU0xLnBkZg==" title="http://samtools.sourceforge.net/SAM1.pdf">sam<i class="fa fa-external-link"></i></span><br>to get the output in <span class="exturl" data-url="aHR0cDovL3NhbXRvb2xzLnNvdXJjZWZvcmdlLm5ldC9TQU0xLnBkZg==" title="http://samtools.sourceforge.net/SAM1.pdf">bam<i class="fa fa-external-link"></i></span> use : <code>samtools view -b -f 4 file.bam &gt; unmapped.bam</code><br>To get only the <strong>mapped</strong> reads use the parameter ‘F’, which works like <code>-v</code> of grep and skips the alignments for a specific flag.<br><code>samtools view -b -F 4 file.bam &gt; mapped.bam</code><br>samtools view -b -F 4 -f 8 file.bam &gt; onlyThisEndMapped.bam<br>samtools view -b -F 8 -f 4 file.bam &gt; onlyThatEndMapped.bam<br>samtools view -b -F12 file.bam &gt; bothEndsMapped.bam<br>samtools merge merged.bam onlyThisEndMapped.bam onlyThatEndMapped.bam bothEndsMapped.bam<br><strong>对于tophat比对结果：</strong><br><code><span style="background-color: rgb(249, 242, 244);">samtools view -b -f 2  accepted_hits.bam &gt; mappedPairs.bam</span></code><br>Better with:<br><code><span style="background-color: rgb(249, 242, 244);">samtools view -b -f 0x2 accepted_hits.bam &gt; mappedPairs.bam</span></code></p>
<h2 id="sort">sort</h2><p>-m    指定运算内存，支持K，M，G等缩写<br>-@    并行运算核数</p>
<h2 id="index">index</h2><p>必须对bam文件进行默认情况下的排序后，才能进行index。否则会报错。</p>
<p>建立索引后将产生后缀为.bai的文件，用于快速的随机处理。很多情况下需要有bai文件的存在，特别是显示序列比对情况下。比如samtool的tview命令就需要；gbrowse2显示reads的比对图形的时候也需要。</p>
<h2 id="faidx">faidx</h2><p>对fasta文件建立索引,生成的索引文件以.fai后缀结尾。该命令也能依据索引文件快速提取fasta文件中的某一条（子）序列。<br>See more： <a href="http://tiramisutes.github.io/2016/03/18/bedtools.html" target="_blank">bedtools 使用小结</a></p>
<h2 id="flagstat">flagstat</h2><p>给出BAM文件的比对结果<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ samtools flagstat example.bam</span><br><span class="line">11945742 + 0 <span class="keyword">in</span> total (QC-passed reads + QC-failed reads)</span><br><span class="line"><span class="comment">#总共的reads数</span></span><br><span class="line">0 + 0 duplicates</span><br><span class="line">7536364 + 0 mapped (63.09%:-nan%)</span><br><span class="line"><span class="comment">#总体上reads的匹配率</span></span><br><span class="line">11945742 + 0 paired <span class="keyword">in</span> sequencing</span><br><span class="line"><span class="comment">#有多少reads是属于paired reads</span></span><br><span class="line">5972871 + 0 read1</span><br><span class="line"><span class="comment">#reads1中的reads数</span></span><br><span class="line">5972871 + 0 read2</span><br><span class="line"><span class="comment">#reads2中的reads数</span></span><br><span class="line">6412042 + 0 properly paired (53.68%:-nan%)</span><br><span class="line"><span class="comment">#完美匹配的reads数：比对到同一条参考序列，并且两条reads之间的距离符合设置的阈值</span></span><br><span class="line">6899708 + 0 with itself and mate mapped</span><br><span class="line"><span class="comment">#paired reads中两条都比对到参考序列上的reads数</span></span><br><span class="line">636656 + 0 singletons (5.33%:-nan%)</span><br><span class="line"><span class="comment">#单独一条匹配到参考序列上的reads数，和上一个相加，则是总的匹配上的reads数。</span></span><br><span class="line">469868 + 0 with mate mapped to a different chr</span><br><span class="line"><span class="comment">#paired reads中两条分别比对到两条不同的参考序列的reads数</span></span><br><span class="line">243047 + 0 with mate mapped to a different chr (mapQ&gt;=5)</span><br></pre></td></tr></table></figure></p>
<h2 id="mpileup">mpileup</h2><p>samtools还有个非常重要的命令mpileup，以前为pileup。该命令用于生成bcf文件，再使用bcftools进行SNP和Indel的分析。bcftools是samtool中附带的软件，在samtools的安装文件夹中可以找到。<br>-f 来输入有索引文件的fasta参考序列；<br>-g 输出到bcf格式。</p>
<h2 id="depth">depth</h2><p>计算每一个位点或者区域的测序深度；<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools depth sorted<span class="selector-class">.bam</span> &gt; sorted<span class="selector-class">.bam</span><span class="selector-class">.txt</span></span><br></pre></td></tr></table></figure></p>
<p>一共得到3列以指标分隔符分隔的数据，第一列为染色体名称，第二列为位点，第三列为覆盖深度。</p>
<p></p><p></p><br>贡献来源<br><span class="exturl" data-url="aHR0cDovL3d3dy5wbG9iLm9yZy8yMDE0LzAxLzI2LzcxMTIuaHRtbA==" title="http://www.plob.org/2014/01/26/7112.html">http://www.plob.org/2014/01/26/7112.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzY3MDQ0NTI0MDEwMWwzMGsuaHRtbA==" title="http://blog.sina.com.cn/s/blog_670445240101l30k.html">http://blog.sina.com.cn/s/blog_670445240101l30k.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvNTYyNDYv" title="https://www.biostars.org/p/56246/">https://www.biostars.org/p/56246/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMTEwMDM5Lw==" title="https://www.biostars.org/p/110039/">https://www.biostars.org/p/110039/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvOTU5Mjkv" title="https://www.biostars.org/p/95929/">https://www.biostars.org/p/95929/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvMTEwMTU3Lw==" title="https://www.biostars.org/p/110157/">https://www.biostars.org/p/110157/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9ncm91cHMuZ29vZ2xlLmNvbS9mb3J1bS8jIWZvcnVtL2JlZHRvb2xzLWRpc2N1c3M=" title="https://groups.google.com/forum/#!forum/bedtools-discuss">https://groups.google.com/forum/#!forum/bedtools-discuss<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9oeWRyYS1zdi8=" title="https://code.google.com/p/hydra-sv/">https://code.google.com/p/hydra-sv/<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3d3dy5wbG9iLm9yZy90YWcvc2FtdG9vbHM=&quot; title=&quot;View all posts in samtools&quot;&gt;Samtools&lt;i class=&quot;fa fa-e
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Samtools" scheme="http://tiramisutes.github.io/tags/Samtools/"/>
    
  </entry>
  
  <entry>
    <title>bedtools 使用小结</title>
    <link href="http://tiramisutes.github.io/2016/03/18/bedtools.html"/>
    <id>http://tiramisutes.github.io/2016/03/18/bedtools.html</id>
    <published>2016-03-18T08:29:32.000Z</published>
    <updated>2018-09-28T02:30:34.862Z</updated>
    
    <content type="html"><![CDATA[<h2 id="概述">概述</h2><p>BEDTools是可用于genomic features的比较，相关操作及进行注释的工具。而genomic features通常使用Browser Extensible Data (BED) 或者 General Feature Format (GFF)文件表示，用UCSC Genome Browser进行可视化比较。</p>
<h2 id="与BEDTools使用相关的基本概念">与BEDTools使用相关的基本概念</h2><p>已有的一些genome features信息一般由BED格式或者GFF格式进行存储。<br>genome features: 功能元素（gene）， 遗传多态性 (SNPs, INDELs, or structural variants), 已经由测序或者其他方法得到的注释信息，也可以是自定义的一些特征信息。<br>Overlapping/intersecting features: 两个genome features的区域至少有一个bp的共同片段。</p>
<h2 id="BED和GFF文件的一个差异">BED和GFF文件的一个差异</h2><p><strong>BED文件中起始坐标为0，结束坐标至少是1,； GFF中起始坐标是1而结束坐标至少是1。</strong></p>
<h2 id="相关格式">相关格式</h2><h3 id="BED_format">BED format</h3><p>BEDTools主要使用BED格式的前三列，BED可以最多有12列。BED格式的常用列描述如下：<br>chrom: 染色体信息， 如chr1, III, myCHrom, contig1112.23, 必须有<br>start: genome feature的起始位点，从0开始， 必须有<br>end: genome feature的终止位点，至少为1， 必须有<br>score: 可以是p值等等一些可以刻量化的数值信息<br>strands: 正反链信息</p>
<h3 id="GFF_format">GFF format</h3><p><strong>seqname</strong> - name of the chromosome or scaffold; chromosome names can be given with or without the ‘chr’ prefix. <b>Important note</b>: the seqname must be one used within Ensembl, i.e. a standard chromosome name or an Ensembl identifier such as a scaffold ID, without any additional content such as species or assembly. See the example GFF output below.<br><strong>source</strong> - name of the program that generated this feature, or the data source (database or project name)<br><strong>feature</strong> - feature type name, e.g. Gene, Variation, Similarity<br><strong>start</strong> - Start position of the feature, with sequence numbering starting at 1.end - End position of the feature, with sequence numbering starting at 1.<br><strong>score</strong> - A floating point value.strand - defined as + (forward) or - (reverse).<br><strong>frame</strong> - One of ‘0’, ‘1’ or ‘2’. ‘0’ indicates that the first base of the feature is the first base of a codon, ‘1’ that the second base is the first base of a codon, and so on..<br><strong>attribute</strong> - A semicolon-separated list of tag-value pairs, providing additional information about each feature.<br>See more from <i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5lbnNlbWJsLm9yZy9pbmZvL3dlYnNpdGUvdXBsb2FkL2dmZi5odG1s" title="http://www.ensembl.org/info/website/upload/gff.html">http://www.ensembl.org/info/website/upload/gff.html<i class="fa fa-external-link"></i></span></p>
<h3 id="genome_files">genome files</h3><p>BEDTools中的一些工具（genomeCoverageBed, complementBed, slopBed）需要物种的染色体大小的信息，genome file一般就是每行都是tab隔开，两列，一列为染色体的名字，第二列为这个染色体的大小。<strong>一般常用物种的genome file在BEDTools安装目录的/genome里面</strong>。<br>自定义基因组genome files文件生成方法见我的另一篇博文：<strong><a href="http://tiramisutes.github.io/2015/11/08/fa-length.html" target="_blank">批量求fasta格式序列长度</a>。</strong></p>
<h2 id="BEDTools使用总结">BEDTools使用总结</h2><h3 id="intersect/intersectBed：计算_Overlaps">intersect/intersectBed：计算 Overlaps</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bedtools intersect -a A.bed -b B.bed -wa -wb</span><br></pre></td></tr></table></figure>
<p>用来求两个BED或者BAM文件中的overlap，overlap可以进行自定义是整个genome features的overlap还是局部。<br>默认的结果描述如下图：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bed1.jpg" alt=""><br>加-wa参数可以报告出原始的在A文件中的feature， 如下图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bed2.jpg" alt=""><br>加-wb参数可以报告出原始的在B文件中的feature, 加-c参数可以报告出两个文件中的overlap的feature的数量。<br><i class="fa fa-bolt"></i>当用bedtools intersect 处理大文件时比较耗内存，有效的方法是对A和B文件按照染色体名字(chromosome)和位置(position)排序(<code>sort -k1,1 -k2,2n</code>),然后用<code>-sorted</code>参数重新intersect。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bedtools intersect -a A-sorted.bed -b B-sorted.bed --sorted</span><br></pre></td></tr></table></figure></p>
<p>其他参数：<br>-wo 返回overlap碱基数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$bedtools</span>  intersect -a A.bed -b B.bed -wo</span><br><span class="line">chr1    0       15      a       chr1    0       4       x       4</span><br><span class="line">chr1    0       15      a       chr1    9       15      z       6</span><br><span class="line">chr1    25      29      b       chr1    18      28      y       3</span><br><span class="line">chr1    18      18      c       chr1    18      28      y       1</span><br><span class="line">chr1    10      14      d       chr1    9       15      z       4</span><br><span class="line">chr1    20      23      e       chr1    18      28      y       3</span><br></pre></td></tr></table></figure></p>
<p>-v 返回非overlap区间<br>-s 相同链上的feature<br>-c 两个文件中的overlap的feature的数量</p>
<h3 id="complement：返回基因组非覆盖区">complement：返回基因组非覆盖区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bedtools complement -i &lt;BED/GFF/VCF&gt; -g &lt;genome files&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Slop：增加特征区间大小">Slop：增加特征区间大小</h3><p>要求：单个输入bed文件（-i指定）和genome files<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat ranges-qry.bed </span><br><span class="line">chr1    0       15      a</span><br><span class="line">chr1    25      29      b</span><br><span class="line">chr1    18      18      c</span><br><span class="line">chr1    10      14      d</span><br><span class="line">chr1    20      23      e</span><br><span class="line">chr1    6       7       f</span><br><span class="line">bedtools slop -i ranges-qry.bed -g genome.txt -b 4</span><br><span class="line">chr1    0       19      a</span><br><span class="line">chr1    21      33      b</span><br><span class="line">chr1    14      22      c</span><br><span class="line">chr1    6       18      d</span><br><span class="line">chr1    16      27      e</span><br><span class="line">chr1    2       11      f</span><br><span class="line"><span class="comment">#-b 4	:两端同时缩短4个碱基</span></span><br></pre></td></tr></table></figure></p>
<p>-l 3 -r 5:增加左3右5</p>
<h3 id="flank：提取特定区域(启动子区)">flank：提取特定区域(启动子区)</h3><p>要求：基因组GTF文件（-i指定）和genome files<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bedtools flank -i mm_GRCm38.75_protein_coding_genes.gtf \</span><br><span class="line">                 -g Mus_musculus.GRCm38_genome.txt \</span><br><span class="line">                 -l 3000 -r 0 &gt; mm_GRCm38_3kb_promoters.gtf</span><br><span class="line">cut -f1,4,5,7 mm_GRCm38_3kb_promoters.gtf | head -n 3</span><br><span class="line">1       3671499 3674498 -</span><br><span class="line">1       4360315 4363314 -</span><br><span class="line">1       4496414 4499413 -</span><br></pre></td></tr></table></figure></p>
<h3 id="getfasta：提取序列">getfasta：提取序列</h3><p>要求：基因组fasta文件（-fi指定）和提取区间GTF文件(-bed指定)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bedtools getfasta -<span class="keyword">fi</span> Mus_musculus.GRCm38.75.dna_rm.toplevel_chr1.fa \</span><br><span class="line">   -bed mm_GRCm38_3kb_promoters.gtf -fo mm_GRCm38_3kb_promoters.fasta</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-bell"></i>-tab    Report extract sequences in a tab-delimited format instead of in FASTA format.</p>
<p></p><p></p><br><i class="fa fa-commenting-o"></i>提取序列之<code>samtools</code>（速度较快<i class="fa fa-plane"></i>）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#首先建立fai索引文件（第一列为染色体名字，第二列为序列碱基数）</span></span><br><span class="line">samtools faidx Mus_musculus.GRCm38.75.dna.chromosome.8.fa</span><br><span class="line"><span class="comment">#序列提取，多提取区间空格隔开</span></span><br><span class="line">samtools faidx Mus_musculus.GRCm38.75.dna.chromosome.8.fa \</span><br><span class="line">     8:123407082-123410744 8:123518835-123536649</span><br><span class="line">&gt;8:123407082-123410744</span><br><span class="line">GAGAAAAGCTCCCTTCTTCTCCAGAGTCCCGTCTACCCTGGCTTGGCGAGGGAAAGGAAC</span><br><span class="line">CAGACATATATCAGAGGCAAGTAACCAAGAAGTCTGGAGGTGTTGAGTTTAGGCATGTCT</span><br><span class="line">[...]</span><br><span class="line">&gt;8:123518835-123536649</span><br><span class="line">TCTCGCGAGGATTTGAGAACCAGCACGGGATCTAGTCGGAGTTGCCAGGAGACCGCGCAG</span><br><span class="line">CCTCCTCTGACCAGCGCCCATCCCGGATTAGTGGAAGTGCTGGACTGCTGGCACCATGGT</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure><p></p>
<h3 id="nuc:_计算GC含量即各碱基数">nuc: 计算GC含量即各碱基数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bedtools nuc -<span class="keyword">fi</span> hg19.fa -bed CDS.bed</span><br></pre></td></tr></table></figure>
<p>输出结果解释：在原bed文件每行结尾增加以下几列<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Output format: </span><br><span class="line">The following information will be reported after each BED entry:</span><br><span class="line">    1) %AT content</span><br><span class="line">    2) %GC content</span><br><span class="line">    3) Number of As observed</span><br><span class="line">    4) Number of Cs observed</span><br><span class="line">    5) Number of Gs observed</span><br><span class="line">    6) Number of Ts observed</span><br><span class="line">    7) Number of Ns observed</span><br><span class="line">    8) Number of other bases observed</span><br><span class="line">    9) The length of the explored sequence/interval.</span><br><span class="line">    10) The seq. extracted from the FASTA file. (opt., <span class="keyword">if</span> -seq is used)</span><br><span class="line">    11) The number of <span class="built_in">times</span> a user<span class="string">'s pattern was observed.</span></span><br><span class="line"><span class="string">        (opt., if -pattern is used.)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="genomecov：染色体和全基因组覆盖度计算">genomecov：染色体和全基因组覆盖度计算</h3><p>要求：单个输入bed文件（-i指定）和genome files；如果输入为bam(-ibam指定)文件，则不需要genome files。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cat ranges-cov-sorted.bed</span><br><span class="line">chr1    4       9</span><br><span class="line">chr1    1       6</span><br><span class="line">chr1    8       19</span><br><span class="line">chr1    25      30</span><br><span class="line">chr2    0       20</span><br><span class="line">$ cat cov.txt</span><br><span class="line">chr1    30</span><br><span class="line">chr2    20</span><br><span class="line">bedtools genomecov -i ranges-cov-sorted.bed -g cov.txt</span><br><span class="line">chr1    0       7       30      0.233333 1</span><br><span class="line">chr1    1       20      30      0.666667</span><br><span class="line">chr1    2       3       30      0.1</span><br><span class="line">chr2    1       20      20      1 2</span><br><span class="line">genome  0       7       50      0.14 3</span><br><span class="line">genome  1       40      50      0.8</span><br><span class="line">genome  2       3       50      0.06</span><br><span class="line"><span class="comment">#name 覆盖次数 覆盖碱基数 总碱基数   覆盖度</span></span><br><span class="line"><span class="comment">#同时计算单染色体和全基因组覆盖度</span></span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-cogs"></i><li>ranges-cov.bed文件需提前排序sort -k1,1 ranges-cov.bed &gt; ranges-cov-sorted.bed</li></p>
<p><li>-bg参数可得到每个碱基的覆盖度。</li></p>
<h3 id="coverage：计算染色体给定区间覆盖度">coverage：计算染色体给定区间覆盖度</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ cat A.bed</span><br><span class="line">chr1  0   100</span><br><span class="line">chr1  100 200</span><br><span class="line">chr2  0   100</span><br><span class="line"></span><br><span class="line">$ cat B.bed</span><br><span class="line">chr1  10  20</span><br><span class="line">chr1  20  30</span><br><span class="line">chr1  30  40</span><br><span class="line">chr1  100 200</span><br><span class="line"></span><br><span class="line">$ bedtools coverage -a A.bed -b B.bed</span><br><span class="line">chr1  0   100  3  30  100 0.3000000</span><br><span class="line">chr1  100 200  1  100 100 1.0000000</span><br><span class="line">chr2  0   100  0  0   100 0.0000000</span><br></pre></td></tr></table></figure>
<p></p><p></p><br>贡献来源<br><span class="exturl" data-url="aHR0cDovL3d3dy5wbG9iLm9yZy8yMDEyLzA5LzI2LzM3NDguaHRtbA==" title="http://www.plob.org/2012/09/26/3748.html">http://www.plob.org/2012/09/26/3748.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2JlZHRvb2xzLnJlYWR0aGVkb2NzLm9yZy9lbi9sYXRlc3QvY29udGVudC9iZWR0b29scy1zdWl0ZS5odG1s" title="http://bedtools.readthedocs.org/en/latest/content/bedtools-suite.html">http://bedtools.readthedocs.org/en/latest/content/bedtools-suite.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vYXJjaGl2ZS9wL2JlZHRvb2xzL3dpa2lzL1VzYWdlLndpa2k=" title="https://code.google.com/archive/p/bedtools/wikis/Usage.wiki">https://code.google.com/archive/p/bedtools/wikis/Usage.wiki<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vYXJjaGl2ZS9wL2JlZHRvb2xzL3dpa2lzL1VzYWdlQWR2YW5jZWQud2lraQ==" title="https://code.google.com/archive/p/bedtools/wikis/UsageAdvanced.wiki">https://code.google.com/archive/p/bedtools/wikis/UsageAdvanced.wiki<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;概述&quot;&gt;概述&lt;/h2&gt;&lt;p&gt;BEDTools是可用于genomic features的比较，相关操作及进行注释的工具。而genomic features通常使用Browser Extensible Data (BED) 或者 General Feature For
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="BEDTools" scheme="http://tiramisutes.github.io/tags/BEDTools/"/>
    
  </entry>
  
  <entry>
    <title>R数据整形术之 dplyr</title>
    <link href="http://tiramisutes.github.io/2016/03/15/dplyr.html"/>
    <id>http://tiramisutes.github.io/2016/03/15/dplyr.html</id>
    <published>2016-03-15T13:10:33.000Z</published>
    <updated>2017-07-14T02:04:34.004Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数据集类型">数据集类型</h2><p>将过长过大的数据集转换为显示更友好的 tbl_df 类型:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hflights_df &lt;- tbl_df(hflights)</span><br></pre></td></tr></table></figure></p>
<p>可以 hflights_df 感受一下不再被刷屏的感觉.</p>
<h2 id="基本操作">基本操作</h2><p><i class="fa fa-book"></i>常用的数据操作行为归纳为以下五种:</p>
<h3 id="筛选:_filter()">筛选: filter()</h3><p>按给定的逻辑判断筛选出符合要求的子数据集, 类似于 base::subset() 函数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">filter(hflights_df, Month == 1, DayofMonth == 1)</span><br><span class="line"><span class="comment">#对同一对象的任意个条件组合</span></span><br><span class="line">filter(hflights_df, Month == 1 | Month == 2)</span><br></pre></td></tr></table></figure></p>
<h3 id="排列:_arrange()">排列: arrange()</h3><p>按给定的列名依次对行进行排序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arrange(hflights_df, DayofMonth, Month, Year)</span><br><span class="line"><span class="comment">#对列名加 desc() 进行倒序:</span></span><br><span class="line">arrange(hflights_df, desc(ArrDelay))</span><br><span class="line"><span class="comment">#这个函数和 plyr::arrange() 是一样的, 类似于 order()</span></span><br></pre></td></tr></table></figure></p>
<h3 id="选择:_select()">选择: select()</h3><p>用列名作参数来选择子数据集:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select(hflights_df, Year, Month, DayOfWeek)</span><br><span class="line"><span class="comment">#还可以用 : 来连接列名, 没错, 就是把列名当作数字一样使用</span></span><br><span class="line">select(hflights_df, Year:DayOfWeek)</span><br><span class="line">用 - 来排除列名:</span><br><span class="line">select(hflights_df, -DrayOfWeek)</span><br></pre></td></tr></table></figure></p>
<h3 id="变形:_mutate()">变形: mutate()</h3><p>对已有列进行数据运算并添加为新列:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mutate(hflights_df,   gain = ArrDelay - DepDelay,   speed = Distance / AirTime * 60)</span><br></pre></td></tr></table></figure></p>
<h3 id="汇总:_summarise()">汇总: summarise()</h3><p>对数据框调用其它函数进行汇总操作, 返回一维的结果:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summarise(hflights_df, delay = mean(DepDelay, na.rm = TRUE))</span><br></pre></td></tr></table></figure></p>
<h2 id="分组动作_group_by()">分组动作 group_by()</h2><p>以上5个动词函数已经很方便了, 但是当它们跟分组操作这个概念结合起来时, 那才叫真正的强大! 当对数据集通过 group_by() 添加了分组信息后,mutate(), arrange() 和 summarise() 函数会自动对这些 tbl 类数据执行分组操作 (R语言泛型函数的优势).<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mtfs_df %&gt;%</span><br><span class="line">     group_by(chr) %&gt;%</span><br><span class="line">     summarize(max_recom = max(recom), mean_recom = mean(recom), num=n())</span><br><span class="line"></span><br><span class="line">Source: <span class="built_in">local</span> data frame [23 x 4]</span><br><span class="line">     chr max_recom mean_recom  num</span><br><span class="line">1   chr1   41.5648   2.217759 2095</span><br><span class="line">2  chr10   42.4129   2.162635 1029</span><br><span class="line">3  chr11   36.1703   2.774918  560</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-book"></i>summarise中用到的函数<br><i class="fa fa-fort-awesome"></i><br>n(): 计算个数 n_distinct(): 计算 x 中唯一值的个数. (原文为 count_distinct(x))<br>first(x), last(x) 和 nth(x, n): 返回对应秩的值, 类似于自带函数 x[1], x[length(x)], 和 x[n]</p>
<h2 id="连接符_%&gt;%">连接符 %&gt;%</h2><p>使用时把数据名作为开头, 然后依次对此数据进行多步操作.</p>
<h2 id="join功能">join功能</h2><p>两数据集取交，并集等。</p>
<ul>
<li>inner_join(x,y)  交集</li>
<li>semi_join(x,y) </li>
<li>left_join(x,y)</li>
<li>anti_join(x,y)</li>
<li>inner_join(y,x)</li>
<li>semi_join(y,x)</li>
<li>left_join(y,x)</li>
<li>anti_join(y,x)</li>
<li>full_join(x,y)  并集<br>【<span class="exturl" data-url="aHR0cDovL3N0YXQ1NDUuY29tL2JpdDAwMV9kcGx5ci1jaGVhdHNoZWV0Lmh0bWw=" title="http://stat545.com/bit001_dplyr-cheatsheet.html">Cheatsheet for dplyr join functions<i class="fa fa-external-link"></i></span>】<h2 id="深入学习">深入学习</h2>dplyr 包自带的60页<span class="exturl" data-url="aHR0cDovL2NyYW4ucnN0dWRpby5jb20vd2ViL3BhY2thZ2VzL2RwbHlyL2RwbHlyLnBkZg==" title="http://cran.rstudio.com/web/packages/dplyr/dplyr.pdf">详细文档<i class="fa fa-external-link"></i></span>.<br>其余几个vignettes (<span class="exturl" data-url="aHR0cDovL2NyYW4ucnN0dWRpby5jb20vd2ViL3BhY2thZ2VzL2RwbHlyL3ZpZ25ldHRlcy8=" title="http://cran.rstudio.com/web/packages/dplyr/vignettes/">网页<i class="fa fa-external-link"></i></span>) 或 vignette(package = “dplyr”),包含了数据库相关, 混合编程, 运算性能比较, 以及新的 window-functions 等内容.<br>简单看了下<span class="exturl" data-url="aHR0cDovL2NyYW4ucnN0dWRpby5jb20vd2ViL3BhY2thZ2VzL2RwbHlyL3ZpZ25ldHRlcy93aW5kb3ctZnVuY3Rpb25zLmh0bWw=" title="http://cran.rstudio.com/web/packages/dplyr/vignettes/window-functions.html">vignette(“window-functions”, package = “dplyr”)<i class="fa fa-external-link"></i></span>, 提供了一系列函数, 扩展了原来只能返回一个数值的聚焦类函数(如sum(), mean())至返回等长度的值, 变成 cumsum()和 cummean(), 以及 n(), lead() 和 lag()等便捷功能.<br>plyr 包的相关文档: <span class="exturl" data-url="aHR0cDovL3BseXIuaGFkLmNvLm56Lw==" title="http://plyr.had.co.nz/">主页<i class="fa fa-external-link"></i></span><br>还有<span class="exturl" data-url="aHR0cDovL2NyYW4ucnN0dWRpby5jb20vd2ViL3BhY2thZ2VzL2RhdGEudGFibGUv" title="http://cran.rstudio.com/web/packages/data.table/">data.table<i class="fa fa-external-link"></i></span>包也是很强大的哦, 空下来可以学一学.</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;数据集类型&quot;&gt;数据集类型&lt;/h2&gt;&lt;p&gt;将过长过大的数据集转换为显示更友好的 tbl_df 类型:&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="dplyr" scheme="http://tiramisutes.github.io/tags/dplyr/"/>
    
  </entry>
  
  <entry>
    <title>R数据整形术之 tidyr</title>
    <link href="http://tiramisutes.github.io/2016/03/09/tidyr.html"/>
    <id>http://tiramisutes.github.io/2016/03/09/tidyr.html</id>
    <published>2016-03-09T13:07:46.000Z</published>
    <updated>2016-03-09T13:26:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote></blockquote></p>
<p></p><p>Happy families are all alike; every unhappy family is unhappy in its own way — Leo Tolstoy</p><br><br>R数据整形包之一tidyr最近迎来更新(<span class="exturl" data-url="aHR0cDovL2Jsb2cucnN0dWRpby5vcmcvMjAxNi8wMi8wMi90aWR5ci0wLTQtMC8=" title="http://blog.rstudio.org/2016/02/02/tidyr-0-4-0/">tidyr 0.4.0<i class="fa fa-external-link"></i></span>)，所以有必要对其<span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3RpZHlyL3ZpZ25ldHRlcy90aWR5LWRhdGEuaHRtbA==" title="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">Tidy data<i class="fa fa-external-link"></i></span>进行学习。<br>以下为个人简单总结：<p></p>
<pre class="r"><code>#gather--mutate--separate--select--arrange
setwd(&quot;F:/Rwork/tidyr&quot;)
library(tidyr)</code></pre>
<pre><code>## Warning: package 'tidyr' was built under R version 3.2.3</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## Warning: package 'dplyr' was built under R version 3.2.2</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'
## 
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>preg &lt;-read.csv(&quot;preg.csv&quot;,stringsAsFactors = FALSE)
preg</code></pre>
<pre><code>##           name treatmenta treatmentb
## 1   John Smith         NA         18
## 2     Jane Doe          4          1
## 3 Mary Johnson          6          7</code></pre>
<pre class="r"><code>preg6 &lt;-tbl_df(read.csv(&quot;preg.csv&quot;,stringsAsFactors = FALSE))
preg6</code></pre>
<pre><code>## Source: local data frame [3 x 3]
## 
##           name treatmenta treatmentb
##          (chr)      (int)      (int)
## 1   John Smith         NA         18
## 2     Jane Doe          4          1
## 3 Mary Johnson          6          7</code></pre>
<pre class="r"><code>preg2&lt;-preg %&gt;% 
  gather(treatment,n,treatmenta:treatmentb) %&gt;%  
#The first argument, is the name of the key column, which is the name of the variable defined by the values of the column headings. 
#The second argument is the name of the value column.
#The third argument defines the columns to gather, here, every column except religion.
 #gather(treatment,n,-name,na.rm = TRUE)    #the same above # na.rm to drop any missing values from the gather columns
  mutate(treatment=gsub(&quot;treatment&quot;,&quot;&quot;,treatment)) %&gt;%
  arrange(name,treatment)   #arrange=sort
preg2</code></pre>
<pre><code>##           name treatment  n
## 1     Jane Doe         a  4
## 2     Jane Doe         b  1
## 3   John Smith         a NA
## 4   John Smith         b 18
## 5 Mary Johnson         a  6
## 6 Mary Johnson         b  7</code></pre>
<pre class="r"><code>#each deplay one by one 
preg3&lt;-preg %&gt;% 
  gather(treatment,n,treatmenta:treatmentb)
preg3</code></pre>
<pre><code>##           name  treatment  n
## 1   John Smith treatmenta NA
## 2     Jane Doe treatmenta  4
## 3 Mary Johnson treatmenta  6
## 4   John Smith treatmentb 18
## 5     Jane Doe treatmentb  1
## 6 Mary Johnson treatmentb  7</code></pre>
<pre class="r"><code>preg33&lt;-preg3 %&gt;% separate(treatment, c(&quot;Treatments&quot;, &quot;group&quot;),9 )  #separate
preg33</code></pre>
<pre><code>##           name Treatments group  n
## 1   John Smith  treatment     a NA
## 2     Jane Doe  treatment     a  4
## 3 Mary Johnson  treatment     a  6
## 4   John Smith  treatment     b 18
## 5     Jane Doe  treatment     b  1
## 6 Mary Johnson  treatment     b  7</code></pre>
<pre class="r"><code>preg333&lt;-preg33 %&gt;% select(name,group,n)  # select
preg333</code></pre>
<pre><code>##           name group  n
## 1   John Smith     a NA
## 2     Jane Doe     a  4
## 3 Mary Johnson     a  6
## 4   John Smith     b 18
## 5     Jane Doe     b  1
## 6 Mary Johnson     b  7</code></pre>
<pre class="r"><code>preg3333&lt;-preg333 %&gt;% spread(group,n)  #spread: one column become two column
preg3333</code></pre>
<pre><code>##           name  a  b
## 1     Jane Doe  4  1
## 2   John Smith NA 18
## 3 Mary Johnson  6  7</code></pre>
<pre class="r"><code>preg4&lt;-preg3 %&gt;% mutate(treatment=gsub(&quot;treatment&quot;,&quot;&quot;,treatment))
preg4</code></pre>
<pre><code>##           name treatment  n
## 1   John Smith         a NA
## 2     Jane Doe         a  4
## 3 Mary Johnson         a  6
## 4   John Smith         b 18
## 5     Jane Doe         b  1
## 6 Mary Johnson         b  7</code></pre>
<pre class="r"><code>preg5&lt;-preg4 %&gt;% arrange(name,treatment)
preg5</code></pre>
<pre><code>##           name treatment  n
## 1     Jane Doe         a  4
## 2     Jane Doe         b  1
## 3   John Smith         a NA
## 4   John Smith         b 18
## 5 Mary Johnson         a  6
## 6 Mary Johnson         b  7</code></pre>
<pre class="r"><code>#reads all files from the same locaed pathway  into a single data frame.
library(plyr)</code></pre>
<pre><code>## -------------------------------------------------------------------------
## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)
## -------------------------------------------------------------------------
## 
## Attaching package: 'plyr'
## 
## The following objects are masked from 'package:dplyr':
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre class="r"><code>paths &lt;- dir(&quot;F:/Rwork/tidyr&quot;, pattern = &quot;\\.csv$&quot;, full.names = TRUE)
names(paths) &lt;- basename(paths)
all&lt;-ldply(paths, read.csv, stringsAsFactors = FALSE)
all</code></pre>
<pre><code>##               .id         name treatmenta treatmentb
## 1 preg - Copy.csv   John Smith         NA         18
## 2 preg - Copy.csv     Jane Doe          4          1
## 3 preg - Copy.csv Mary Johnson          6          7
## 4        preg.csv   John Smith         NA         18
## 5        preg.csv     Jane Doe          4          1
## 6        preg.csv Mary Johnson          6          7</code></pre>
<pre class="r"><code>#get some data from name column incloud John Smith and Jane Doe  located in preg3 data frame 
subset(preg3, name %in% c(&quot;John Smith&quot;, &quot;Jane Doe&quot;))</code></pre>
<pre><code>##         name  treatment  n
## 1 John Smith treatmenta NA
## 2   Jane Doe treatmenta  4
## 4 John Smith treatmentb 18
## 5   Jane Doe treatmentb  1</code></pre>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p&gt;Happy families are all alike; every unhappy family is unhappy in its own way — Leo Tolstoy&lt;/p&gt;&lt;br
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="tidyr" scheme="http://tiramisutes.github.io/tags/tidyr/"/>
    
  </entry>
  
  <entry>
    <title>Economist_Graph：复杂图形修改</title>
    <link href="http://tiramisutes.github.io/2016/03/09/Economist-Graph.html"/>
    <id>http://tiramisutes.github.io/2016/03/09/Economist-Graph.html</id>
    <published>2016-03-09T09:23:10.000Z</published>
    <updated>2018-09-28T02:33:17.382Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/20111210_WOC210.gif" width="600" height="300"></p><br>原图：<span class="exturl" data-url="aHR0cDovL3d3dy5lY29ub21pc3QuY29tL25vZGUvMjE1NDExNzg=" title="http://www.economist.com/node/21541178">http://www.economist.com/node/21541178<i class="fa fa-external-link"></i></span><p></p>
<h2 id="Basic_plot">Basic plot</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">dat &lt;- read.csv(<span class="string">"EconomistData.csv"</span>)</span><br><span class="line">pc1 &lt;- ggplot(dat, aes(x = CPI, y = HDI, color = Region))+</span><br><span class="line">       geom_point()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter1.png" alt=""></p>
<h2 id="Trend_line">Trend line</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pc2 &lt;- pc1 +</span><br><span class="line">   geom_smooth(aes(group = 1),</span><br><span class="line">               method = <span class="string">"lm"</span>,</span><br><span class="line">               formula = y ~ <span class="built_in">log</span>(x),</span><br><span class="line">               se = FALSE,</span><br><span class="line">               color = <span class="string">"red"</span>) +</span><br><span class="line">   geom_line()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter2.png" alt=""></p>
<h2 id="Open_points">Open points</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pc3 &lt;- pc2 +</span><br><span class="line">  geom_point(shape = 1, size = 4)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter3.png" alt=""></p>
<h2 id="Labelling_points">Labelling points</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pointsToLabel &lt;- c(<span class="string">"Russia"</span>, <span class="string">"Venezuela"</span>, <span class="string">"Iraq"</span>, <span class="string">"Myanmar"</span>, <span class="string">"Sudan"</span>,</span><br><span class="line">                   <span class="string">"Afghanistan"</span>, <span class="string">"Congo"</span>, <span class="string">"Greece"</span>, <span class="string">"Argentina"</span>, <span class="string">"Brazil"</span>,</span><br><span class="line">                   <span class="string">"India"</span>, <span class="string">"Italy"</span>, <span class="string">"China"</span>, <span class="string">"South Africa"</span>, <span class="string">"Spane"</span>,</span><br><span class="line">                   <span class="string">"Botswana"</span>, <span class="string">"Cape Verde"</span>, <span class="string">"Bhutan"</span>, <span class="string">"Rwanda"</span>, <span class="string">"France"</span>,</span><br><span class="line">                   <span class="string">"United States"</span>, <span class="string">"Germany"</span>, <span class="string">"Britain"</span>, <span class="string">"Barbados"</span>, <span class="string">"Norway"</span>, <span class="string">"Japan"</span>,</span><br><span class="line">                   <span class="string">"New Zealand"</span>, <span class="string">"Singapore"</span>)</span><br><span class="line">library(<span class="string">"ggrepel"</span>)</span><br><span class="line">pc4 &lt;- pc3 +  geom_text_repel(aes(label = Country),</span><br><span class="line">            color = <span class="string">"gray20"</span>,</span><br><span class="line">            data = subset(dat, Country %<span class="keyword">in</span>% pointsToLabel),</span><br><span class="line">            force = 10)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter4.png" alt=""><br>选择性的标注想要的点</p>
<h2 id="Change_the_region_labels_and_order">Change the region labels and order</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dat<span class="variable">$Region</span> &lt;- factor(dat<span class="variable">$Region</span>,</span><br><span class="line">                     levels = c(<span class="string">"EU W. Europe"</span>,</span><br><span class="line">                                <span class="string">"Americas"</span>,</span><br><span class="line">                                <span class="string">"Asia Pacific"</span>,</span><br><span class="line">                                <span class="string">"East EU Cemt Asia"</span>,</span><br><span class="line">                                <span class="string">"MENA"</span>,</span><br><span class="line">                                <span class="string">"SSA"</span>),</span><br><span class="line">                     labels = c(<span class="string">"OECD"</span>,</span><br><span class="line">                                <span class="string">"Americas"</span>,</span><br><span class="line">                                <span class="string">"Asia &amp;\nOceania"</span>,</span><br><span class="line">                                <span class="string">"Central &amp;\nEastern Europe"</span>,</span><br><span class="line">                                <span class="string">"Middle East &amp;\nnorth Africa"</span>,</span><br><span class="line">                                <span class="string">"Sub-Saharan\nAfrica"</span>))</span><br><span class="line">pc4<span class="variable">$data</span> &lt;- dat</span><br><span class="line">pc4</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter6.png" alt=""><br>修改图例值和顺序</p>
<h2 id="Add_title_and_format_axes">Add title and format axes</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">library(grid)</span><br><span class="line">pc5 &lt;- pc4 +</span><br><span class="line">  scale_x_continuous(name = <span class="string">"Corruption Perceptions Index, 2011 (10=least corrupt)"</span>,</span><br><span class="line">                     limits = c(.9, 10.5),</span><br><span class="line">                     breaks = 1:10) +</span><br><span class="line">  scale_y_continuous(name = <span class="string">"Human Development Index, 2011 (1=Best)"</span>,</span><br><span class="line">                     limits = c(0.2, 1.0),</span><br><span class="line">                     breaks = seq(0.2, 1.0, by = 0.1)) +</span><br><span class="line">  scale_color_manual(name = <span class="string">""</span>,</span><br><span class="line">                     values = c(<span class="string">"#24576D"</span>,</span><br><span class="line">                                <span class="string">"#099DD7"</span>,</span><br><span class="line">                                <span class="string">"#28AADC"</span>,</span><br><span class="line">                                <span class="string">"#248E84"</span>,</span><br><span class="line">                                <span class="string">"#F2583F"</span>,</span><br><span class="line">                                <span class="string">"#96503F"</span>)) +</span><br><span class="line">  ggtitle(<span class="string">"Corruption and Human development"</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter7.png" alt=""><br>利用scale来修改x，y轴，颜色和标出title</p>
<h2 id="Theme_tweaks">Theme tweaks</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">library(grid) <span class="comment"># for the 'unit' function</span></span><br><span class="line">pc6 &lt;- pc5 +</span><br><span class="line">  theme_minimal() + <span class="comment"># start with a minimal theme and add what we need</span></span><br><span class="line">  theme(text = element_text(color = <span class="string">"gray20"</span>),</span><br><span class="line">        legend.position = c(<span class="string">"top"</span>), <span class="comment"># position the legend in the upper left </span></span><br><span class="line">        legend.direction = <span class="string">"horizontal"</span>,</span><br><span class="line">        legend.justification = 0.1, <span class="comment"># anchor point for legend.position.</span></span><br><span class="line">        legend.text = element_text(size = 11, color = <span class="string">"gray10"</span>),</span><br><span class="line">        axis.text = element_text(face = <span class="string">"italic"</span>),</span><br><span class="line">        axis.title.x = element_text(vjust = -1), <span class="comment"># move title away from axis</span></span><br><span class="line">        axis.title.y = element_text(vjust = 2), <span class="comment"># move away for axis</span></span><br><span class="line">        axis.ticks.y = element_blank(), <span class="comment"># element_blank() is how we remove elements</span></span><br><span class="line">        axis.line = element_line(color = <span class="string">"gray40"</span>, size = 0.5),</span><br><span class="line">        axis.line.y = element_blank(),</span><br><span class="line">        panel.grid.major = element_line(color = <span class="string">"gray50"</span>, size = 0.5),</span><br><span class="line">        panel.grid.major.x = element_blank()</span><br><span class="line">        ))</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter8.png" alt=""><br>微调主题</p>
<h2 id="Add_model_R^2_and_source_note">Add model R^2 and source note</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mR2 &lt;- summary(lm(HDI ~ <span class="built_in">log</span>(CPI), data = dat))<span class="variable">$r</span>.squared</span><br><span class="line">library(grid)</span><br><span class="line">png(file = <span class="string">"images/econScatter10.png"</span>, width = 800, height = 600)</span><br><span class="line">pc6 </span><br><span class="line">grid.text(<span class="string">"Sources: Transparency International; UN Human Development Report"</span>,</span><br><span class="line">         x = .02, y = .03,</span><br><span class="line">         just = <span class="string">"left"</span>,</span><br><span class="line">         draw = TRUE)</span><br><span class="line">grid.segments(x0 = 0.81, x1 = 0.825,</span><br><span class="line">              y0 = 0.90, y1 = 0.90,</span><br><span class="line">              gp = gpar(col = <span class="string">"red"</span>),</span><br><span class="line">              draw = TRUE)</span><br><span class="line">grid.text(paste0(<span class="string">"R² = "</span>,</span><br><span class="line">                 as.integer(mR2*100),</span><br><span class="line">                 <span class="string">"%"</span>),</span><br><span class="line">          x = 0.835, y = 0.90,</span><br><span class="line">          gp = gpar(col = <span class="string">"gray20"</span>),</span><br><span class="line">          draw = TRUE,</span><br><span class="line">          just = <span class="string">"left"</span>)</span><br><span class="line"></span><br><span class="line">dev.off()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/econScatter10.png" alt=""><br>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3R1dG9yaWFscy5pcS5oYXJ2YXJkLmVkdS9SL1JncmFwaGljcy9SZ3JhcGhpY3MuaHRtbA==" title="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/20111210_WOC210.gif&quot; width=&quot;600&quot; height=&quot;300&quot;&gt;&lt;/p&gt;&lt;br&gt;原图：&lt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="ggplot2" scheme="http://tiramisutes.github.io/tags/ggplot2/"/>
    
  </entry>
  
  <entry>
    <title>myself ggplot2 learning tip (再学ggplot2： 遗漏细节)</title>
    <link href="http://tiramisutes.github.io/2016/03/09/ggplot2-learning.html"/>
    <id>http://tiramisutes.github.io/2016/03/09/ggplot2-learning.html</id>
    <published>2016-03-09T05:44:37.000Z</published>
    <updated>2018-09-28T02:35:28.904Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/20111210_WOC210.gif" width="500" height="250"></p><br>原图：<span class="exturl" data-url="aHR0cDovL3d3dy5lY29ub21pc3QuY29tL25vZGUvMjE1NDExNzg=" title="http://www.economist.com/node/21541178">http://www.economist.com/node/21541178<i class="fa fa-external-link"></i></span><p></p>
<h2 id="ggplot2绘图语法结构：">ggplot2绘图语法结构：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = &lt;default data <span class="built_in">set</span>&gt;, </span><br><span class="line">       aes(x = &lt;default x axis variable&gt;,</span><br><span class="line">           y = &lt;default y axis variable&gt;,</span><br><span class="line">           ... &lt;other default aesthetic mappings&gt;),</span><br><span class="line">       ... &lt;other plot defaults&gt;) +</span><br><span class="line"></span><br><span class="line">       geom_&lt;geom <span class="built_in">type</span>&gt;(aes(size = &lt;size variable <span class="keyword">for</span> this geom&gt;, </span><br><span class="line">                      ... &lt;other aesthetic mappings&gt;),</span><br><span class="line">                  data = &lt;data <span class="keyword">for</span> this point geom&gt;,</span><br><span class="line">                  <span class="built_in">stat</span> = &lt;statistic string or <span class="keyword">function</span>&gt;,</span><br><span class="line">                  position = &lt;position string or <span class="keyword">function</span>&gt;,</span><br><span class="line">                  color = &lt;<span class="string">"fixed color specification"</span>&gt;,</span><br><span class="line">                  &lt;other arguments, possibly passed to the _stat_ <span class="keyword">function</span>) +</span><br><span class="line"></span><br><span class="line">  scale_&lt;aesthetic&gt;_&lt;<span class="built_in">type</span>&gt;(name = &lt;<span class="string">"scale label"</span>&gt;,</span><br><span class="line">                     breaks = &lt;<span class="built_in">where</span> to put tick marks&gt;,</span><br><span class="line">                     labels = &lt;labels <span class="keyword">for</span> tick marks&gt;,</span><br><span class="line">                     ... &lt;other options <span class="keyword">for</span> the scale&gt;) +</span><br><span class="line"></span><br><span class="line">  theme(plot.background = element_rect(fill = <span class="string">"gray"</span>),</span><br><span class="line">        ... &lt;other theme elements&gt;)</span><br></pre></td></tr></table></figure>
<h2 id="Geometric_Objects(geom_XX)_and_Aesthetics_(aes())">Geometric Objects(geom_XX) and Aesthetics (aes())</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_&lt;tab&gt;查看所有Geometric Objects（几何学对象）</span><br></pre></td></tr></table></figure>
<h2 id="Statistical_Transformations（统计变换）">Statistical Transformations（统计变换）</h2><p>统计变换 （stat_） 比如求均值，求方差等，当我们需要展示出某个变量的某种统计特征的时候，需要用到统计变换。<br>每一个<code>geom_XX</code>都有一个默认的统计量，可通过<code>args(geom_XX)</code>查看（<code>args(stat_bin)</code>）例如<code>geom_bar</code>的默认统计量是<code>stat_count</code>,表示进行计数。什么意思呢？举例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(ggplot2)</span><br><span class="line">&gt; df &lt;- data.frame(trt = c(<span class="string">"a"</span>,<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>), outcome = c(2.3,5, 1.9, 3.2))</span><br><span class="line">&gt; df</span><br><span class="line">  trt outcome</span><br><span class="line">1   a     2.3</span><br><span class="line">2   a     5.0</span><br><span class="line">3   b     1.9</span><br><span class="line">4   c     3.2</span><br><span class="line">&gt; <span class="comment">##stat()</span></span><br><span class="line">&gt; ggplot(df, aes(trt, outcome)) +</span><br><span class="line">  geom_bar()</span><br><span class="line">Error: stat_count() must not be used with a y aesthetic.</span><br><span class="line"><span class="comment">#成功报错，因为第一句aes()中我们指定了y轴为outcome，即一个x轴的trt值对应一个y轴的outcome值，而geom_bar()</span></span><br><span class="line"><span class="comment">#中stat_count要进行计数，即计数trt中相同值出现的次数.最终y轴指定的outcome与需要表示的count值冲突，报错。</span></span><br><span class="line"><span class="comment">##解决：</span></span><br><span class="line">&gt; ggplot(df, aes(trt)) +</span><br><span class="line">  geom_bar()</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/count.png" alt=""><br>如果想要表示相同trt值相加后的对应值，修改stat=indentity即可。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ggplot(df, aes(trt, outcome)) +</span><br><span class="line">+   geom_bar(<span class="built_in">stat</span> = <span class="string">"identity"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/indentity.png" alt=""><br>ggplot2中包含的统计变换有如下多种：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/stat.png" alt=""><br>更多参见：<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzI0Nzc5MDE3" title="https://www.zhihu.com/question/24779017">https://www.zhihu.com/question/24779017<i class="fa fa-external-link"></i></span></p>
<h2 id="Scales">Scales</h2><h3 id="控制aes()映射">控制<code>aes()</code>映射</h3><p>Aesthetic (<code>aes()</code>) 映射仅仅是告诉一个变量应该映射到一个aesthetic，但并没有说明如何映射？例如，当我们用<code>aes(shape=x)</code>去映射一个变量到shape时，并没有说明用什么shape；同样的，<code>aes(color=z)</code>并无说明用什么颜色；通常在我们未定义这些时ggplot2会自动用默认值，而我们可以通过<em>scale</em>来修改这些值。<br>在ggplot2中scales包括：</p>
<li>position</li><br><li>color and fill</li><br><li>size</li><br><li>shape</li><br><li>line type</li><br><li>x,y</li><br>### 修改方式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scale_&lt;aesthetic&gt;_&lt;<span class="built_in">type</span>&gt;(name,limits,breaks,labels)</span><br><span class="line">通过键入scale_&lt;tab&gt;查看全部可修改函数。</span><br></pre></td></tr></table></figure><br><br>特殊scale函数有额外参数，例如对颜色的修改<code>scale_color_continuous</code>函数有<code>low</code>和<code>high</code>参数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scale_x_discrete(name=<span class="string">"State Abbreviation"</span>) +</span><br><span class="line">scale_color_continuous(name=<span class="string">""</span>,</span><br><span class="line">                         breaks = c(19751, 19941, 20131),</span><br><span class="line">                         labels = c(1971, 1994, 2013),</span><br><span class="line">                         low = <span class="string">"blue"</span>, high = <span class="string">"red"</span>)</span><br></pre></td></tr></table></figure><br><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/modifyScales3.png" alt=""><br>## Faceting<br>### 分面: 一页多图<br><code>facet_wrap()</code>：对数据分类只能应用一个标准，例<code>facet_wrap(~State, ncol = 10))</code>,按State分组后每行设置10个小图依次画出全部。<br><code>facet_grid()</code>：多个标准对数据进行分组绘图,<code>facet_grid(color~cut，margins=TRUE)</code>，波浪号前为小图分行标准，后面为分列标准，margins指用于分面的包含每个变量元素所有数据的数据组，相当于每个小图一个title。<br>## Themes<br>### 主题<br>更多ggplot2主题演示如下：<br><span class="exturl" data-url="aHR0cDovL2RvY3MuZ2dwbG90Mi5vcmcvZGV2L3ZpZ25ldHRlcy90aGVtZXMuaHRtbA==" title="http://docs.ggplot2.org/dev/vignettes/themes.html">http://docs.ggplot2.org/dev/vignettes/themes.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pybm9sZC9nZ3RoZW1lcw==" title="https://github.com/jrnold/ggthemes">https://github.com/jrnold/ggthemes<i class="fa fa-external-link"></i></span><br>### 修改主题默认值<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">theme_minimal() +</span><br><span class="line">  theme(text = element_text(color = <span class="string">"turquoise"</span>))</span><br></pre></td></tr></table></figure><br><br>### 自定义主题<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">theme_new &lt;- theme_bw() +</span><br><span class="line">  theme(plot.background = element_rect(size = 1, color = <span class="string">"blue"</span>, fill = <span class="string">"black"</span>),</span><br><span class="line">        text=element_text(size = 12, family = <span class="string">"Serif"</span>, color = <span class="string">"ivory"</span>),</span><br><span class="line">        axis.text.y = element_text(colour = <span class="string">"purple"</span>),</span><br><span class="line">        axis.text.x = element_text(colour = <span class="string">"red"</span>),</span><br><span class="line">        panel.background = element_rect(fill = <span class="string">"pink"</span>),</span><br><span class="line">        strip.background = element_rect(fill = muted(<span class="string">"orange"</span>)))</span><br><span class="line"></span><br><span class="line">p5 + theme_new</span><br></pre></td></tr></table></figure><br><br>## 关于晕晕的aes()<br><li><strong>任何与数据向量顺序相关，需要逐个指定的参数都必须写在aes里</strong></li><br><li>什么？还是搞不清该放aes里面还是外面？那就记着想统一整个图层时就放到aes外，想分成不同组调整，并且已经有一个与x、y长度一致的分组变量了，那就放到aes里</li><br>##其他总结<br><li>加注释，所有注释的实现都是通过annotate函数实现的，geom_text()是兼职的。</li><br><li>theme函数最妙的地方是将对于数据相关的美学调整和与数据无关的美学调整分离，将数据处理与数据美学分开，数据美学与数据无关的调整分开。</li>


]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/20111210_WOC210.gif&quot; width=&quot;500&quot; height=&quot;250&quot;&gt;&lt;/p&gt;&lt;br&gt;原图：&lt;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="ggplot2" scheme="http://tiramisutes.github.io/tags/ggplot2/"/>
    
  </entry>
  
  <entry>
    <title>Noncoding RNAs (ncRNAs)</title>
    <link href="http://tiramisutes.github.io/2016/01/29/ncRNA.html"/>
    <id>http://tiramisutes.github.io/2016/01/29/ncRNA.html</id>
    <published>2016-01-29T02:29:16.000Z</published>
    <updated>2016-06-12T02:42:16.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Noncoding_RNAs_(ncRNAs)">Noncoding RNAs (ncRNAs)</h2><p><li>most ncRNAs operate as RNA-protein complexes, including ribosomes, snRNPs, snoRNPs, telomerase, microRNAs, and long ncRNAs.</li></p>
<p><li></li></p>
<h2 id="Non-coding_RNA_database">Non-coding RNA database</h2><p><span class="exturl" data-url="aHR0cDovL3Jlc2VhcmNoLmltYi51cS5lZHUuYXUvcm5hZGIv" title="http://research.imb.uq.edu.au/rnadb/">http://research.imb.uq.edu.au/rnadb/<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Noncoding_RNAs_(ncRNAs)&quot;&gt;Noncoding RNAs (ncRNAs)&lt;/h2&gt;&lt;p&gt;&lt;li&gt;most ncRNAs operate as RNA-protein complexes, including ribosomes, snRNP
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="ncRNA" scheme="http://tiramisutes.github.io/tags/ncRNA/"/>
    
  </entry>
  
  <entry>
    <title>Retroelements</title>
    <link href="http://tiramisutes.github.io/2016/01/03/retroelements.html"/>
    <id>http://tiramisutes.github.io/2016/01/03/retroelements.html</id>
    <published>2016-01-03T12:18:31.000Z</published>
    <updated>2018-09-28T02:43:23.086Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>Retroelements are mobile genetic elements (MGEs) that retrotranspose via a RNA intermediate that is reverse-transcribed to DNA by the encoded reverse transcriptase and integrated into a new location within the host genome by an integrase enzyme. They have been found among different organisms from bacteria to humans and often constitute a significant part of genomes, particularly in higher plants and fungi. Various retroelements with different gene organizations and replicative mechanisms have evolved in the course of evolution. Although in most cases they have no effect on the host organism, there are many examples of mutations caused by retroelements resulting in various diseases. However co-adaptation has led in some cases to the use of retroelements for essential and beneficial host functions.</p>
<p>Retroelements (retrotransposons and retroviruses) can currently be divided into four systems or groups commonly known as the long terminal repeat (LTR) retroelements, the non-LTR retroelements, the tyrosine recombinase (YR) retroelements and the Penelope retrotransposons (Eickbush and Jamburuthugoda 2008).</p>
<h2 id="LTR_retroelements">LTR retroelements</h2><p>These include the broad range of LTR retrotransposons and retroviruses circulating in plants, fungi and animals. A full-lenght consensus LTR retroelement genome is characterized by an internal translating region (gag and pol genes, and env gene when is present) flanked by long terminal repeats (LTRs). They can be classified into four major groups or families based on sequence similarity and other features known as the Ty1/Copia, the Ty3/Gypsy, the Bel/Pao, and the Retroviridae families.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/LTR_retroel.jpg" alt=""></p>
<h3 id="补充材料">补充材料</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/env.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pictsimpleproteins.jpg" alt=""><br>Gag is a polyprotein and is an acronym for Group Antigens (ag).<br>Pol is the reverse transcriptase.<br>Env in the envelope protein.<br>The group antigens form the viral core structure, RNA genome binding proteins, and are the major proteins comprising the nucleoprotein core particle. Reverse transcriptase is the essential enzyme that carries out the reverse transcription process that take the RNA genome to a double-stranded DNA preintegrate form. The reverse transcriptase gene also encodes an Integrase activity and an RNase H activity that functions during genome reverse transscription.</p>
<h2 id="Non-LTR_retroelements">Non-LTR retroelements</h2><p></p><p>These constitute a system of retrotransposons widely distributed in eukaryotes, which do not present LTRs or terminal repeats; non-LTR retrotransposons end most frequently with a <i>poly(A)</i> tail at their 3′ end, while their 5′ end often contains variable deletions (5′ truncations). Depending on their capability to transpose or not autonomously these elements are classified as autonomous and non autonomous retroelements, respectively.<br></p><p><br><br><b>Autonomous non-LTR retroelements</b>. On the basis of their molecular structures the autonomous non-LTR retroelements have been grouped in two major classes:<br></p><p><u>R2 elements </u>: these constitute one of the most studied families of non-LTR retroelements (<a href="/index.php?title=Literature:100587&amp;action=edit&amp;redlink=1" class="new" title="Literature:100587 (page does not exist)">Eickbush 2002</a>). They encode for a single ORF with a central RT domain and an endonuclease (EN) conserved domain at the C-terminus.<br></p><p><u>Long INterspersed repetitive Elements (LINEs) </u>: these are a family of 6-8 kb long elements encoding for two ORFs. The first ORF shows similarity to retroviral <i>gags</i>. The second ORF encodes for a pol polyprotein displaying RT and apurinic-apyrimidinic endonuclease (APE) domains. However, some lineages additionally include a protein domain of unknown function at the C-terminus and in other cases an RNase H (RH) downstream of the RT domain as usual in LTR retrotransposons (<a href="/index.php?title=Literature:88885&amp;action=edit&amp;redlink=1" class="new" title="Literature:88885 (page does not exist)">Eickbush and Jamburuthugoda 2008</a>). LINEs are widespread in mammals (<a href="/index.php?title=Literature:100588&amp;action=edit&amp;redlink=1" class="new" title="Literature:100588 (page does not exist)">Moran and Gilbert 2002</a>).<br></p><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Non-LTRs1.jpg" alt=""><br><b>Non autonomous non-LTR retroelements</b>. These are DNA sequences of 80 to 630 bp known as Short INterspersed repetitive Elements (<b>SINEs</b>). They represent reverse-transcribed RNA molecules originally transcribed by RNA polymerase III into tRNA, rRNA, and other small nuclear RNAs (<a href="/index.php?title=Literature:46554&amp;action=edit&amp;redlink=1" class="new" title="Literature:46554 (page does not exist)">Malik and Eickbush 1998</a>). Like the LINEs, the SINEs end by a poly(A) tail or by A- or T-rich sequences, their 5’ and 3’ ends reveal similarities to tRNA genes (or, as shown for some animal SINEs, to 7SL RNA gene) and to the 3’ end of LINEs, respectively (<a href="/index.php?title=Literature:100584&amp;action=edit&amp;redlink=1" class="new" title="Literature:100584 (page does not exist)">Oshima <i>et al</i>. 1996</a>). Two conserved sequence motifs found in the SINE tRNA-like part, called box A and box B, show homology to RNA polymerase III promoters. SINEs do not encode their own reverse transcriptase and are therefore unable to transpose autonomously. For this reason it has been proposed that SINEs use the enzymatic machinery of LINEs for their retrotransposition (<a href="/index.php?title=Literature:45266&amp;action=edit&amp;redlink=1" class="new" title="Literature:45266 (page does not exist)">Luan <i>et al.</i> 1993</a>; <a href="/index.php?title=Literature:99195&amp;action=edit&amp;redlink=1" class="new" title="Literature:99195 (page does not exist)">Wallace <i>et al.</i> 2008</a>; <a href="/index.php?title=Literature:92284&amp;action=edit&amp;redlink=1" class="new" title="Literature:92284 (page does not exist)">Kroutter <i>et al.</i> 2009</a>). LINEs and SINEs elements have been not only described in the genomes of animals but also in many species across the Plantae Kingdom (<a href="/index.php?title=Literature:67257&amp;action=edit&amp;redlink=1" class="new" title="Literature:67257 (page does not exist)">Schmidt 1999</a>).<br><p></p><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Non-LTRs2.jpg" alt=""><p></p>
<h2 id="Tyrosine_recombinase_(YR)_retroelements">Tyrosine recombinase (YR) retroelements</h2><p></p><p>YR retroelements have been found in plants, protists, fungi, as well as a variety of animals including vertebrates, echinoderms and nematodes. The “gag-RT-RNaseH” genome organization of YR retroelements is similar to that of LTR retroelements but differ in the fact that YR retroelements lack the PR and usually show a <i>tyrosine recombinase</i> (instead of INT), which is typically involved in site-specific recombinations between similar or identical DNA sequences. YR retroelements can be divided into three families <b>DIRS</b>, <i><b>Ngaro</b></i> and <b>VIPER</b>  (<a href="/index.php?title=Literature:26665&amp;action=edit&amp;redlink=1" class="new" title="Literature:26665 (page does not exist)">Goodwin <i>et al</i>. 2004</a>; <a href="/index.php?title=Literature:26666&amp;action=edit&amp;redlink=1" class="new" title="Literature:26666 (page does not exist)">Goodwin and Poulter 2004</a>; <a href="/index.php?title=Literature:79660&amp;action=edit&amp;redlink=1" class="new" title="Literature:79660 (page does not exist)">Vazquez <i>et al</i>. 2000</a>; <a href="/index.php?title=Literature:44948&amp;action=edit&amp;redlink=1" class="new" title="Literature:44948 (page does not exist)">Lorenzi <i>et al</i>. 2006</a>). The typical structure of DIRS elements contains inverted terminal repeats (ITRs), internal ORFs and an internal complementary region (ICR) derived from the duplication of flanking ITR sequences. DIRS elements differ from the two other YR-like families in the presence of a conserved methyltransferase (MT) domain at C-terminal to RT/RH that is similar to those MTs encoded by various bacteriophages (<a href="/index.php?title=Literature:26666&amp;action=edit&amp;redlink=1" class="new" title="Literature:26666 (page does not exist)">Goodwin and Poulter 2004</a>). <i>Ngaro</i> elements show an ORF organization similar to that of DIRS elements but differ in the orientation of flanking repeats. While DIRS elements are delimited by inverted repeats, <i>Ngaro</i> elements are flanked by direct repeats (referred as A1, A2, B1 and B2). <i>Ngaro</i> elements have been found in different organisms as the zebrafish <i>Danio rerio</i> (Dr<i>Ngaro</i>1), as well as in fungi and in echinoderms (<a href="/index.php?title=Literature:26666&amp;action=edit&amp;redlink=1" class="new" title="Literature:26666 (page does not exist)">Goodwin and Poulter 2004</a>). In turn, VIPER (Vestigial interposed retroelement) elements have been described in the genomes of trypanosome protozoan parasites. As an example, the figure below also shows the genomic organization of <i>tcVIPER</i>, an element described in the genome of <i>T. cruzi</i>. This element contains a coding internal region flanked by a lineage of SINEs (called SIRE) also found in <i>T. cruzi</i> genome (<a href="/index.php?title=Literature:44948&amp;action=edit&amp;redlink=1" class="new" title="Literature:44948 (page does not exist)">Lorenzi <i>et al</i>. 2006</a>; <a href="/index.php?title=Literature:79660&amp;action=edit&amp;redlink=1" class="new" title="Literature:79660 (page does not exist)">Vazquez <i>et al</i>. 2000</a>).<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/YR_retroel.jpg" alt=""></p>
<h2 id="Penelope_retrotransposons_(PLEs)">Penelope retrotransposons (PLEs)</h2><p></p><p>This is a family of retrotransposons described in many animal genomes (more than 80 species belonging to at least 10 animal phyla), protists, fungi, and plants (<a href="/index.php?title=Literature:100585&amp;action=edit&amp;redlink=1" class="new" title="Literature:100585 (page does not exist)">Arkhipova 2006</a>). Their genome structure contains apparent LTRs that may be in either direct or inverted orientations flanking a coding region with RT and EN domains (i.e. a <i>pol</i> polyprotein domain). Phylogenetic reconstruction analysis indicate that PLEs-like RTs are closer to telomerase RTs (TERTs) than to any other characterized RTs (<a href="/index.php?title=Literature:2404&amp;action=edit&amp;redlink=1" class="new" title="Literature:2404 (page does not exist)">Arkhipova <i>et al.</i> 2003</a>). In turn, PLE-like ENs are related with the intron-encoded endonucleases and the bacterial repair endonuclease UvrC, both belonging to the <i>Uri</i> family of ENs (<a href="/index.php?title=Literature:61392&amp;action=edit&amp;redlink=1" class="new" title="Literature:61392 (page does not exist)">Pyatkov <i>et al.</i> 2004</a>). Studies realized with the fly <i>Drosophila virilis</i> and bdelloid rotifer organisms revealed that the majority of PLEs in these species contain spliceosomal introns (<a href="/index.php?title=Literature:2404&amp;action=edit&amp;redlink=1" class="new" title="Literature:2404 (page does not exist)">Arkhipova <i>et al.</i> 2003</a>). The peculiar structural organization of PLE elements, their ability to retain introns during transposition, and the distinct placement in the phylogeny of retroelements, suggest that PLEs constitute an ancient class of retroelements (<a href="/index.php?title=Literature:100585&amp;action=edit&amp;redlink=1" class="new" title="Literature:100585 (page does not exist)">Arkhipova 2006</a>; <a href="/index.php?title=Literature:100586&amp;action=edit&amp;redlink=1" class="new" title="Literature:100586 (page does not exist)">Schostak <i>et al.</i> 2008</a>).<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Penelope_retroel.jpg" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Legend.jpg" alt=""></p>
<p>Read more: <span class="exturl" data-url="aHR0cDovL2d5ZGIub3JnL2luZGV4LnBocC9SZXRyb2VsZW1lbnRz" title="http://gydb.org/index.php/Retroelements">http://gydb.org/index.php/Retroelements<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Introduction&quot;&gt;Introduction&lt;/h2&gt;&lt;p&gt;Retroelements are mobile genetic elements (MGEs) that retrotranspose via a RNA intermediate that i
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="retroelements" scheme="http://tiramisutes.github.io/tags/retroelements/"/>
    
  </entry>
  
  <entry>
    <title>SCI经典英语写作语句汇总</title>
    <link href="http://tiramisutes.github.io/2015/12/28/English-sentence.html"/>
    <id>http://tiramisutes.github.io/2015/12/28/English-sentence.html</id>
    <published>2015-12-28T14:39:04.000Z</published>
    <updated>2019-03-19T09:58:51.198Z</updated>
    
    <content type="html"><![CDATA[<li>It is time to ‘upgrade’ cancer epigenetics research and put together an ambitious plan to tackle the many unanswered questions in this field using epigenomics approaches.</li><br><li>Histones are no longer considered to be simple ‘DNA-packaging’ proteins; they are recognized as being dynamic regulators of gene activity that undergo manypost-translational chemical modifications, including acetylation, methylation, phosphorylation, ubiquitylation and sumoylation.</li><br><li>In addition to their influence on gene expression, emerging evidence indicates that specific histone modifications interface with other nuclear processes.</li><br><li>Histone modifications, together with DNA methylation, also have a vital role in organizing nuclear architecture,which, in turn, is involved in regulating transcription and other nuclear processes.</li><br><li>However, what distinguishes metabolomics from clinical chemistry is the fact that in metabolomics one is not attempting to characterize a few compounds at a time, but literally dozens or even hundreds of compounds at a time.</li><br><li>Blood is a special biofluid, as it potentially reflects all processes going on in all organs. This can be both a blessing and a curse, as metabolite perturbations in the blood, while easily detectable, cannot be easily traced to a specific organ or a specific cause.</li><br><li>On a cellular level, organisms face two main challenges: to maintain genome integrity in the face of mutagens and mobile genetic elements, and to express a specific repertoire of genes at the proper level and with the appropriate timing.</li><br><li>In sharp contrast to the low within-species genetic variation, differences between species-specific haplotypes were high.</li><br><li>Given the staggering crop losses that result from insect herbivory and the environmental problems associated with insecticide use, genomeenabled research on the natural mechanisms that plants use to defend themselves against insects will undoubtedly have not only ecological, but also agricultural relevance.</li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li><br><li></li>
]]></content>
    
    <summary type="html">
    
      &lt;li&gt;It is time to ‘upgrade’ cancer epigenetics research and put together an ambitious plan to tackle the many unanswered questions in this f
    
    </summary>
    
      <category term="Paper" scheme="http://tiramisutes.github.io/categories/Paper/"/>
    
    
      <category term="English-sentence" scheme="http://tiramisutes.github.io/tags/English-sentence/"/>
    
  </entry>
  
  <entry>
    <title>Awk经典实例总结</title>
    <link href="http://tiramisutes.github.io/2015/12/27/awk-shili.html"/>
    <id>http://tiramisutes.github.io/2015/12/27/awk-shili.html</id>
    <published>2015-12-27T05:09:47.000Z</published>
    <updated>2015-12-27T08:10:48.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="删除某一行">删除某一行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$ cat fkjsaf </span><br><span class="line">        GO_ids</span><br><span class="line">Gh_A01G0005     GO:0016021</span><br><span class="line">Gh_A01G0006     GO:0006629</span><br><span class="line">Gh_A01G0007</span><br><span class="line">Gh_A01G0008</span><br><span class="line">Gh_A01G0009</span><br><span class="line">Gh_A01G0010     GO:0008121,GO:0006122</span><br><span class="line">Gh_A01G0011</span><br><span class="line">Gh_A01G0012</span><br><span class="line">Gh_A01G0013     GO:0003677,GO:0006355</span><br><span class="line">Gh_A01G0014</span><br><span class="line">Gh_A01G0015     GO:0004713,GO:0005524,GO:0004674,GO:0004672,GO:0006468</span><br><span class="line">Gh_A01G0016     GO:0006886,GO:0005643,GO:0008536,GO:0005515,GO:0008565</span><br><span class="line">Gh_A01G0017     GO:0003676</span><br><span class="line">Gh_A01G0018</span><br><span class="line">Gh_A01G0019     GO:0016020,GO:0006810,GO:0005215</span><br><span class="line">[zpxu@node102 ~]$ awk <span class="string">'&#123;if(NR==1)&#123;next&#125; print $0&#125;'</span> fkjsaf </span><br><span class="line">Gh_A01G0005     GO:0016021</span><br><span class="line">Gh_A01G0006     GO:0006629</span><br><span class="line">Gh_A01G0007</span><br><span class="line">Gh_A01G0008</span><br><span class="line">Gh_A01G0009</span><br><span class="line">Gh_A01G0010     GO:0008121,GO:0006122</span><br><span class="line">Gh_A01G0011</span><br><span class="line">Gh_A01G0012</span><br><span class="line">Gh_A01G0013     GO:0003677,GO:0006355</span><br><span class="line">Gh_A01G0014</span><br><span class="line">Gh_A01G0015     GO:0004713,GO:0005524,GO:0004674,GO:0004672,GO:0006468</span><br><span class="line">Gh_A01G0016     GO:0006886,GO:0005643,GO:0008536,GO:0005515,GO:0008565</span><br><span class="line">Gh_A01G0017     GO:0003676</span><br><span class="line">Gh_A01G0018</span><br><span class="line">Gh_A01G0019     GO:0016020,GO:0006810,GO:0005215</span><br></pre></td></tr></table></figure>
<h2 id="删除列数小于N的行">删除列数小于N的行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$ awk <span class="string">'&#123;if(NF==1)&#123;next&#125; print $0&#125;'</span> fkjsaf </span><br><span class="line">Gh_A01G0005     GO:0016021</span><br><span class="line">Gh_A01G0006     GO:0006629</span><br><span class="line">Gh_A01G0010     GO:0008121,GO:0006122</span><br><span class="line">Gh_A01G0013     GO:0003677,GO:0006355</span><br><span class="line">Gh_A01G0015     GO:0004713,GO:0005524,GO:0004674,GO:0004672,GO:0006468</span><br><span class="line">Gh_A01G0016     GO:0006886,GO:0005643,GO:0008536,GO:0005515,GO:0008565</span><br><span class="line">Gh_A01G0017     GO:0003676</span><br><span class="line">Gh_A01G0019     GO:0016020,GO:0006810,GO:0005215</span><br></pre></td></tr></table></figure>
<h2 id="删除空行">删除空行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[zpxu@node102 ~]$ cat text</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line"></span><br><span class="line">222</span><br><span class="line">333</span><br><span class="line">[zpxu@node102 ~]$ awk NF text</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line">222</span><br><span class="line">333</span><br></pre></td></tr></table></figure>
<h2 id="不输出后两列">不输出后两列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat file </span><br><span class="line">a b c d e f</span><br><span class="line">1 2 3 4</span><br><span class="line">awk <span class="string">'NF-=2'</span> file</span><br><span class="line">a b c d</span><br><span class="line">1 2</span><br></pre></td></tr></table></figure>
<h2 id="不输出前两列">不输出前两列</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;for(i=3;i&lt;NF;i++)printf("%s ",$i);print $NF&#125;'</span> file</span><br><span class="line">c d e f</span><br><span class="line">3 4</span><br></pre></td></tr></table></figure>
<h2 id="文件1和文件2交集部分合并输出">文件1和文件2交集部分合并输出</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cat a.txt    //a.txt  </span><br><span class="line">111   aaa  </span><br><span class="line">222   bbb  </span><br><span class="line">333   cccc  </span><br><span class="line">444   ddd  </span><br><span class="line">cat b.txt    //b.txt  </span><br><span class="line">111  123  456  </span><br><span class="line">2    abc  cbd  </span><br><span class="line">444  rts  786  </span><br><span class="line"><span class="comment">#要求输出结果是</span></span><br><span class="line">111,aaa,123,456</span><br><span class="line">444,ddd,rts,786</span><br><span class="line"><span class="comment">#实现方法1</span></span><br><span class="line">awk <span class="string">'NR==FNR&#123;a[$1]=$2;&#125;NR!=FNR &amp;&amp; a[$1]&#123;print $1","a[$1]","$2","$3&#125;'</span> a.txt b.txt  </span><br><span class="line">111,aaa,123,456  </span><br><span class="line">444,ddd,rts,786</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-commenting-o"></i>解释<br>当NR和FNR相同时,这就说明在对第一个文件进行操作，<code>a[$1]=$2</code>表示，建立一个数组，以第一个字段为下标，第二个字段为值。当NR!=FNR时,说明在对第二个文件进行操作，注意：这个时候的,<code>$1</code>和前面的$1不是同一个东西了，前面的<code>$1</code>表示的是a.txt的第一个字段，而后面的<code>$1</code>表示的是b.txt的第一个字段。<code>a[$1]</code>表示以b.txt中第一个字段的为下标的值，如果a[$1]有值的话，说明也存在于a.txt文件中，这样就把数据print出来就行了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#方法2</span></span><br><span class="line">awk -v OFS=<span class="string">","</span> <span class="string">'NR==FNR&#123;a[$1]=$2;&#125; NR!=FNR &amp;&amp; $1 in a &#123; print $1,a[$1],$2,$3&#125;'</span> a.txt b.txt  </span><br><span class="line">111,aaa,123,456  </span><br><span class="line">444,ddd,rts,786</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-commenting-o"></i>解释<br>-v OFS=”,”这个是设置输出时的列分割符，<code>$1 in a</code>这个是b.txt文件中的第一列的值是不是在数组a的key中，这个对做程序的来说很好理解，各种语言当中都有这样的用法，或者函数。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;删除某一行&quot;&gt;删除某一行&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>sed中那些特殊的替换</title>
    <link href="http://tiramisutes.github.io/2015/12/26/sed-s.html"/>
    <id>http://tiramisutes.github.io/2015/12/26/sed-s.html</id>
    <published>2015-12-26T14:39:28.000Z</published>
    <updated>2015-12-26T15:01:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="修改匹配的第N个内容">修改匹配的第N个内容</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cat text1</span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">22</span><br><span class="line">2</span><br><span class="line">sed <span class="string">':a;N;$! ba;s/2/--/5'</span> text1   <span class="comment">#替换第5个</span></span><br><span class="line">2</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">22</span><br><span class="line">--</span><br><span class="line">sed <span class="string">':a;N;$!ba;s/\(.*\)2/\1--/'</span> text1  <span class="comment">#替换最后一个</span></span><br><span class="line">cat text2</span><br><span class="line">2 52 8 2</span><br><span class="line">sed <span class="string">'s/2/--/4'</span> text2</span><br><span class="line">2 52 8 --</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;修改匹配的第N个内容&quot;&gt;修改匹配的第N个内容&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cl
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="sed" scheme="http://tiramisutes.github.io/tags/sed/"/>
    
  </entry>
  
  <entry>
    <title>Awk系统变量和内置函数</title>
    <link href="http://tiramisutes.github.io/2015/12/26/Awk-System-Variables.html"/>
    <id>http://tiramisutes.github.io/2015/12/26/Awk-System-Variables.html</id>
    <published>2015-12-26T07:41:14.000Z</published>
    <updated>2018-09-28T02:30:11.130Z</updated>
    
    <content type="html"><![CDATA[<p>awk中有两种类型的系统变量。第一种类型定义的变量默认值可以改变，如字段和记录分隔符；第二种类型定义的变量的值可用于报告或数据处理中，如字段数量或记录数量。</p>
<h2 id="内置变量表">内置变量表</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk-evn.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk-ofs.png" alt=""></p>
<h2 id="实例">实例</h2><h3 id="处理多行记录">处理多行记录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ cat text.txt</span><br><span class="line">John Robinson</span><br><span class="line"></span><br><span class="line">Koren Inc.</span><br><span class="line"></span><br><span class="line">978 Commonwealth Ave.</span><br><span class="line"></span><br><span class="line">Boston</span><br><span class="line"></span><br><span class="line">MA 01760</span><br><span class="line"></span><br><span class="line">696-0987</span><br></pre></td></tr></table></figure>
<p>注：6个字段，记录之间用空行分隔。<br>为了处理这种包括多行数据的记录，可以将字段分隔符定义为换行符，记录分隔符定义为空字符串，代表一个空行。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BEGIN｛FS=<span class="string">"\n"</span>;RS=<span class="string">""</span>｝</span><br></pre></td></tr></table></figure></p>
<p>所以可以用下面脚本打印第一个和最后一个字段：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'BEGIN&#123; FS = "\n"; RS = "" &#125; &#123;print $1, $NF&#125;'</span> text.txt</span><br><span class="line">John Robinson 696-0987</span><br></pre></td></tr></table></figure></p>
<h3 id="输出数据格式设置：(OFMT使用）">输出数据格式设置：(OFMT使用）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'BEGIN&#123;OFMT="%.3f";print 2/3,123.11111111;&#125;'</span> /etc/passwd   </span><br><span class="line">0.667 123.111</span><br><span class="line"><span class="comment">#OFMT默认输出格式是：%.6g 保留六位小数，这里修改OFMT会修改默认数据输出格式</span></span><br></pre></td></tr></table></figure>
<h3 id="按宽度指定分隔符（FIELDWIDTHS使用）">按宽度指定分隔符（FIELDWIDTHS使用）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> 20100117054932 | awk <span class="string">'BEGIN&#123;FIELDWIDTHS="4 2 2 2 2 3"&#125;&#123;print $1"-"$2"-"$3,$4":"$5":"$6&#125;'</span></span><br><span class="line">2010-01-17 05:49:32</span><br><span class="line"><span class="comment">#FIELDWIDTHS其格式为空格分隔的一串数字，用以对记录进行域的分隔，FIELDWIDTHS="4 2 2 2 2 2"就表示$1宽度是4，$2是2，$3是2  .... 。这个时候会忽略：FS分隔符</span></span><br></pre></td></tr></table></figure>
<h2 id="内置函数">内置函数</h2><p>awk内置函数，主要分以下3种类似：算数函数、字符串函数、其它一般函数、时间函数</p>
<h3 id="字符串函数">字符串函数</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk-arrny.png" alt=""></p>
<h3 id="split">split</h3><p>awk的内建函数split允许你把一个字符串分隔为单词并存储在数组中。你可以自己定义域分隔符或者使用现在FS(域分隔符)的值。<br>格式：<br>   split (string, array, field separator)<br>   split (string, array)  —&gt;如果第三个参数没有提供，awk就默认使用当前FS值。<br><strong>split有3个参数，第一个传要切分的字符串，第二个放切分完后输出的数组，第三个定义分隔符;</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'BEGIN&#123;info = "this is a test";slen=split(info,ta," ");for (i=1;i&lt;=slen;i++) &#123;print i,ta[i];&#125;&#125;'</span></span><br><span class="line">1 this</span><br><span class="line">2 is</span><br><span class="line">3 a</span><br><span class="line">4 <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p>
<p>参考:<br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9jaGVuZ21vL2FyY2hpdmUvMjAxMC8xMC8wNi8xODQ0ODE4Lmh0bWw=" title="http://www.cnblogs.com/chengmo/archive/2010/10/06/1844818.html">http://www.cnblogs.com/chengmo/archive/2010/10/06/1844818.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;awk中有两种类型的系统变量。第一种类型定义的变量默认值可以改变，如字段和记录分隔符；第二种类型定义的变量的值可用于报告或数据处理中，如字段数量或记录数量。&lt;/p&gt;
&lt;h2 id=&quot;内置变量表&quot;&gt;内置变量表&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://raw.gith
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>Advanced-sed：n，N，d，D，p，P，b, T,t,h，H，g，G，x,y</title>
    <link href="http://tiramisutes.github.io/2015/12/25/advanced-sed.html"/>
    <id>http://tiramisutes.github.io/2015/12/25/advanced-sed.html</id>
    <published>2015-12-25T13:24:52.000Z</published>
    <updated>2018-09-28T02:28:42.678Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/adv-sed.png" width="600" height="300"></p><p></p>
<h2 id="高级命令分为3个组：">高级命令分为3个组：</h2><ol>
<li>处理多行模式空间(N,D,P)。</li>
<li>采用保持空间来保存模式空间的内容，并使它用于后续命令(H,h,G,g,x)。</li>
<li>编写使用分支和条件指令的脚本来更改控制流（：，b，T/t）。<h3 id="多行模式空间">多行模式空间</h3>awk，sed，grep的模式匹配是面向行的，在单个输入行上匹配一个模式。但是其他如在一行的结尾处开始到下一行的开始处结束的短语，则只有在多行上重复时才有意义。<br>sed能察看模式空间的多个行，允许匹配模式扩展到多行上.<br>这里的3个多行命令(N,D,P)对应于之前的小写字母的基本命令（n,d,p）。<h3 id="命令解释">命令解释</h3>D/d: d删除模式空间的内容，D只是删除模式空间的第一行内容。<br>P/p: p打印当前模式空间内容，追加到默认输出之后，P(大写)打印当前模式空间开端至\n的内容，并追加到默认输出之前。<br>N/n: Next(N)通过读取新的输入行，并将它添加到模式空间的现有内容之后来创建多行模式空间。模式空间最初的内容和新的输入行之间用换行符分隔。多行模式空间中，“^”匹配空间中的第一个字条，而不是换行符后面的字符，“$”只匹配模式空间中最后的换行符，不匹配任何嵌入的。next（n）输出模式空间的内容，然后读取新的输入行。<h2 id="实例">实例</h2><h3 id="n">n</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat aaa </span><br><span class="line">This is 1    </span><br><span class="line">This is 2    </span><br><span class="line">This is 3    </span><br><span class="line">This is 4    </span><br><span class="line">This is 5    </span><br><span class="line">     </span><br><span class="line">sed -n <span class="string">'n;p'</span> aaa         //-n表示隐藏默认输出内容    </span><br><span class="line">This is 2    </span><br><span class="line">This is 4</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注 释：读取This is 1，执行n命令，此时模式空间为This is 2，执行p，打印模式空间内容This is 2，之后读取 This is 3，执行n命令，此时模式空间为This is 4，执行p，打印模式空间内容This is 4，之后读取This is 5，执行n 命令，因为没有了，所以退出，并放弃p命令。</p>
<h3 id="N">N</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">'$!N;P'</span> aaa            </span><br><span class="line">This is 1   </span><br><span class="line">This is 3   </span><br><span class="line">This is 5</span><br><span class="line">sed -n <span class="string">'N;P'</span> aaa </span><br><span class="line">This is 1    </span><br><span class="line">This is 3</span><br></pre></td></tr></table></figure>
<p>注释中1代表This is 1   2代表This is 2  以此类推<br>注释：读取1，$!条件满足（不是尾行），执行N命令，得出1\n2，执行P，打印得1，读取3，$!条件满足（不是尾行），执行N命令，得出3\n4，执行P，打印得3，读取5，$!条件不满足，跳过N，执行P，打印得5.<br>$!N: 排除了对最后一行（$）执行Next命令。<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2Jsb2cuY2hpbmF1bml4Lm5ldC91aWQtMTA1NDA5ODQtaWQtMTc1OTU0OC5odG1s" title="http://blog.chinaunix.net/uid-10540984-id-1759548.html">http://blog.chinaunix.net/uid-10540984-id-1759548.html<i class="fa fa-external-link"></i></span><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat text </span><br><span class="line">Owner and Operator</span><br><span class="line">Guide</span><br><span class="line">sed <span class="string">'/Operator$/ &#123;N;s/Owner and Operator\nGuide/Installtion Guide/ &#125;'</span> text </span><br><span class="line">Installtion Guide</span><br></pre></td></tr></table></figure></p>
<p><strong>关于更详细的关于sed参数n和N，见ww.cbcb.umd.edu/software/PBcR/MHAP/asm/</strong></p>
<h3 id="d">d</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'n;d'</span> aaa           </span><br><span class="line">This is 1   </span><br><span class="line">This is 3   </span><br><span class="line">This is 5</span><br></pre></td></tr></table></figure>
<p>注释：读取1，执行n，得出2，执行d，删除2，得空，以此类推，读取3，执行n，得出4，执行d，删除4，得空，但是读取5时，因为n无法执行，所以d不执行。因无-n参数，故输出1\n3\n5.</p>
<h3 id="D">D</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'N;D'</span> aaa           </span><br><span class="line">This is 5</span><br></pre></td></tr></table></figure>
<p>注释：读取1，执行N，得出1\n2，执行D，得出2，执行N，得出2\n3，执行D，得出3，依此类推，得出5，执行N，条件失败退出，因无-n参数，故输出5.</p>
<h2 id="输入/输出循环">输入/输出循环</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sed2.png" alt=""><br>P（大写）经常出现在N之后D之前，通过N-P-D可建立一个输入/输出循环，用来维护两行的模式空间，但是一次只输出一行。这个循环的目的是只输出模式空间的第一行，然后返回到脚本的顶端将所有的命令应用于模式空间的第二行。<br><i class="fa fa-bar-chart"></i>案例分析：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">$ cat text.txt</span><br><span class="line">I want to see @f1(what will happen) <span class="keyword">if</span> we put the </span><br><span class="line">font change commands @f1(on a <span class="built_in">set</span> of lines). If I understand</span><br><span class="line">things (correctly), the @f1(third) line causes problems.(No?).</span><br><span class="line">Is this really the <span class="keyword">case</span>, or is it (maybe) just something <span class="keyword">else</span>?</span><br><span class="line"></span><br><span class="line">Let<span class="string">'s test having two on a line @f1(here) and @f1(there) as</span></span><br><span class="line"><span class="string">well as one that begins on one line and ends @f1(somewhere</span></span><br><span class="line"><span class="string">on another line). What if @f1(it is here) on the line?</span></span><br><span class="line"><span class="string">Another @f1(one).</span></span><br><span class="line"><span class="string">$ #将@f1(anything)替换为\fB anything \fR</span></span><br><span class="line"><span class="string">$ sed '</span>s/@f1(\(.*\))/\\fB\1\\fR/g<span class="string">'   #匹配@f1(.*) 并用“\(” 和 “\)” 保存括号中任意内容，在替换部分，保存的匹配部分用“\1” 回调。</span></span><br><span class="line"><span class="string">$ sed -f sed.len test</span></span><br><span class="line"><span class="string">I want to see \fBwhat will happen\fR if we put the</span></span><br><span class="line"><span class="string">font change commands \fBon a set of lines\fR. If I understand</span></span><br><span class="line"><span class="string">things (correctly), the \fBthird) line causes problems. (No?\fR.</span></span><br><span class="line"><span class="string">Is this really the case, or is it (maybe) just something else?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Let'</span>s <span class="built_in">test</span> having two on a line \fBhere) and @f1(there\fR as</span><br><span class="line">well as one that begins on one line and ends @f1(somewhere</span><br><span class="line">on another line). What <span class="keyword">if</span> \fBit is here\fR on the line?</span><br><span class="line">Another \fBone\fR.</span><br><span class="line">$ <span class="comment">#替换命令在第三行和第二段第一行失效，正则表达式贪婪匹配总是进行可能最长的匹配，“.*”匹配从"@f1(" 到这一行最后一个右圆括号中所有字符。</span></span><br><span class="line">$ sed <span class="string">'s/@f1(\([^)]*\))/\\fB\1\\fR/g'</span>  <span class="comment">#除“）”以外的零次或多次出现的任意字符</span></span><br><span class="line">I want to see \fBwhat will happen\fR <span class="keyword">if</span> we put the</span><br><span class="line">font change commands \fBon a <span class="built_in">set</span> of lines\fR. If I understand</span><br><span class="line">things (correctly), the \fBthird\fR line causes problems.(No?).</span><br><span class="line">Is this really the <span class="keyword">case</span>, or is it (maybe) just something <span class="keyword">else</span>?</span><br><span class="line"></span><br><span class="line">Let<span class="string">'s test having two on a line \fBhere\fR and \fBthere\fR as</span></span><br><span class="line"><span class="string">well as one that begins on one line and ends @f1(somewhere</span></span><br><span class="line"><span class="string">on another line). What if \fBit is here\fR on the line?</span></span><br><span class="line"><span class="string">Another \fBone\fR.</span></span><br><span class="line"><span class="string">$ #可以看到对于跨越两行的替换仍然没有完成。这时多行模式空间变可发挥其神奇功效了,如果匹配“@f1(” 并且没有找到右圆括号的话，那么就需要将另一行读入(N)缓冲区并试着生成与第一种情况相同的匹配。 </span></span><br><span class="line"><span class="string">$ cat sednew</span></span><br><span class="line"><span class="string">s/@f1(\([^)]*\))/\\fB\1\\fR/g</span></span><br><span class="line"><span class="string">/@f1(.*/ &#123;</span></span><br><span class="line"><span class="string">          N</span></span><br><span class="line"><span class="string">		  s/@f1(.*\n[^)]*\))/\\fB\1\\fR/g</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">$ #/@f1(.*/地址将过程限制在匹配/@f1(.*/的行上，并对其执行｛｝中的命令。</span></span><br><span class="line"><span class="string">$ sed -f sednew test</span></span><br><span class="line"><span class="string">I want to see \fBwhat will happen\fR if we put the</span></span><br><span class="line"><span class="string">font change commands \fBon a set of lines\fR. If I understand</span></span><br><span class="line"><span class="string">things (correctly), the \fBthird\fR line causes problems.(No?).</span></span><br><span class="line"><span class="string">Is this really the case, or is it (maybe) just something else?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Let'</span>s <span class="built_in">test</span> having two on a line \fBhere\fR and \fBthere\fR as</span><br><span class="line">well as one that begins on one line and ends \fBsomewhere</span><br><span class="line">on another line\fR. What <span class="keyword">if</span> @f1(it is here) on the line?</span><br><span class="line">Another \fBone\fR.</span><br><span class="line">$ <span class="comment">#可以看出倒数第二个替换不成功，why? 模式匹配/@f1(.*/找到@f1(somewhere\n后执行N输入第二行，此时模式空间为“well as one that begins on one line and ends @f1(somewhere\non another line). What if @f1(it is here) on the line?“，进行第二行脚本替换命令"s/@f1(.*\n[^)]*\))/\\fB\1\\fR/g",模式空间变为"well as one that begins on one line and ends \fBsomewhere\non another line\fR. What if @f1(it is here) on the line?"并一起输出，然后sed再次输入的是最后一行“Another @f1(one)”来从头执行脚本；我们发现这个替换脚本似乎是”忘记“了@f1(it is here)的存在，成功跳过它完成匹配。而这原因就是sed默认是输出模式空间的整个内容，所以@f1(it is here)没有机会让脚本程序重头对其执行，也就没能通过脚本第一行替换完成任务。</span></span><br><span class="line">$ <span class="comment">#如果我们在多行模式空间中完成跨越两行的匹配替换后只是输出第一行（P），然后将其删除（D），这样剩下的“What if @f1(it is here) on the line?”部分成为模式空间的第一行，并将控制转移到脚本的顶端，这时检查是否在该行上还有其他的“@f1(”,这得到机会让脚本从上至下的所有命令应用到它完成替换。</span></span><br><span class="line">$ cat sednew2</span><br><span class="line">s/@f1(\([^)]*\))/\\fB\1\\fR/g</span><br><span class="line">/@f1(.*/ &#123;</span><br><span class="line">          N</span><br><span class="line">		  s/@f1(\(.*\n[^)]*\))/\\fB\1\\fR/g</span><br><span class="line">		  P</span><br><span class="line">		  D</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="大于2行模式空间"><i class="fa fa-video-camera"></i>大于2行模式空间</h3><p>我们发现Next(N)命令只能的在读入第一行的基础上再次读入下一行，即模式空间中同时存在2行，如果想要匹配3行或更多怎么办？<br><i class="fa fa-users"></i>这时就该高级的流控制命令起作用了。<br>其中用于控制执行脚本的哪一部分以及何时执行的命令为分支(b)和测试(T/t)，他们将脚本中的控制转移到包含特殊标签的行，如果没有标签被指定，则转移到脚本结尾处。分支用于无条件转移，测试用于有条件转移。<br>标签是任意不多于7个字符的序列，标签本身占据一行并以冒号开始：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:mylabel</span><br></pre></td></tr></table></figure></p>
<p>注：冒号和标签间不允许有空格，行尾处的空格是标签的一部分。当在分支和测试命令中指定标签时，在命令和标签间允许有空格：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b mylabel</span><br></pre></td></tr></table></figure></p>
<p>所以对于大于2行的模式空间匹配可以通过一下实现：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">:begin</span><br><span class="line">/@f1(\([^)]*\))/&#123;</span><br><span class="line">                 s//\\fB\1\\fR/g</span><br><span class="line">                 b begin</span><br><span class="line">&#125;</span><br><span class="line">/@f1(.*/&#123;</span><br><span class="line">         N</span><br><span class="line">         s/@f1(\([^)]*\n[^)]*\))/\\fB\1\\fR/g</span><br><span class="line">         t again</span><br><span class="line">         b begin</span><br><span class="line">&#125;</span><br><span class="line">:again</span><br><span class="line">P</span><br><span class="line">D</span><br></pre></td></tr></table></figure></p>
<h2 id="保持空间">保持空间</h2><p>模式空间是容纳当前输入的缓冲区。还有一个保持空间(hold space)的顶留(set-aside)缓冲区,模式空间和保持空间内容可实现互换。保持空间用于临时存储，单独的命令不能寻址保持空间或更改他的内容。<br><i class="fa fa-bullhorn"></i>保持空间最常用的当改变模式空间中的原始内容时，用于保留当前输入行的副本。</p>
<h3 id="y">y</h3><p>y命令的作用在于字符转换<br>将aaa文件内容大写<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">'y/his/HIS/'</span> aaa  </span><br><span class="line">THIS IS 1  </span><br><span class="line">THIS IS 2  </span><br><span class="line">THIS IS 3  </span><br><span class="line">THIS IS 4  </span><br><span class="line">THIS IS 5</span><br><span class="line"><span class="comment">#或者echo "axxbxxcxx" | sed 'y/abc/123/'</span></span><br><span class="line">1xx2xx3xx</span><br><span class="line"><span class="comment">#不连续字符串的替换</span></span><br></pre></td></tr></table></figure></p>
<h3 id="h命令，H命令，g命令，G命令">h命令，H命令，g命令，G命令</h3><p>h命令是将当前模式空间中内容覆盖至保持空间，H命令是将当前模式空间中的内容追加至保持空间</p>
<p>g命令是将当前保持空间中内容覆盖至模式空间，G命令是将当前保持空间中的内容追加至模式空间<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">cat ddd   </span><br><span class="line">This is a and a is 1   </span><br><span class="line">This is b and b is 2   </span><br><span class="line">This is c and c is 3   </span><br><span class="line">This is d and d is 4   </span><br><span class="line">This is e and e is 5  </span><br><span class="line"><span class="comment">#将ddd文件中数字和字母互换，并将字母大写</span></span><br><span class="line">cat ddd.sed</span><br><span class="line">h  </span><br><span class="line">&#123;  </span><br><span class="line">s/.*is \(.*\) and .*/\1/  </span><br><span class="line">y/abcde/ABCDE/</span><br><span class="line">G  </span><br><span class="line">s/\(.*\)\n\(.*is \).*\(and \).*\(is \)\(.*\)/\2\5 \3\5 \4\1/  </span><br><span class="line">&#125;  </span><br><span class="line">                                           </span><br><span class="line">sed -f ddd.sed ddd  </span><br><span class="line">This is 1 and 1 is A  </span><br><span class="line">This is 2 and 2 is B  </span><br><span class="line">This is 3 and 3 is C  </span><br><span class="line">This is 4 and 4 is D  </span><br><span class="line">This is 5 and 5 is E</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sed3.png" alt=""></p>
<h3 id="x">x</h3><p>x命令是将当前保持空间和模式空间内容互换.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/adv-sed.png&quot; width=&quot;600&quot; height=&quot;300&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="sed" scheme="http://tiramisutes.github.io/tags/sed/"/>
    
  </entry>
  
  <entry>
    <title>perl-oneline</title>
    <link href="http://tiramisutes.github.io/2015/12/08/perl-oneline.html"/>
    <id>http://tiramisutes.github.io/2015/12/08/perl-oneline.html</id>
    <published>2015-12-08T06:40:52.000Z</published>
    <updated>2015-12-25T13:27:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>Perl有很多命令行参数. 通过它们, 我们有机会写出更简单的程序. 在这篇文章里我们来了解一些常用的参数.</p>
<p>第一部分：Safety Net Options 安全网参数</p>
<p>在使用Perl尝试一些聪明(或stupid)的想法时, 错误难免会发生. 有经验的Perl程序员常常使用三个参数来提前找到错误所在,<br>1：-C<br>这个参数编译 Perl 程序但不会真正运行它. 由此检查所有语法错误. 每次修改 perl 程序之后我都会立刻使用它来找到任何语法错误.<br>$ perl -c program.pl</p>
<p>2：-W<br>它会提示你任何潜在的问题.Perl 5.6.0之后的版本已经用use warnings; 替换了-w .你应该使用 use warnings 因为它要比 -w 更灵活.</p>
<p>3：-T<br>它把perl放到了tain模式.  在这个模式里, Perl 会质疑任何程序外传来的数据. 例如,从命令行读取, 外部文件里读取 或是 CGI 程序里传来的数据.<br>这些数据在 -T 模式里都会被 Tainted 掉.</p>
<p>第二部分：命令行Perl参数：可以让短小的Perl程序运行在命令行.</p>
<p>1：-e<br>可以让Perl程序在命令行上运行.<br>例如, 我们可以在命令行上运行 “Hello World” 程序而不用把它写入文件再运行.<br>$ perl -e ‘print “Hello Worldn”‘</p>
<p>多个 -e 也可以同时使用, 运行顺序根据它出现的位置.<br>$ perl -e ‘print “Hello “;’ -e ‘print “Worldn”‘<br>象所有的 Perl 程序一样, 只有程序的最后一行不需要以 ; 结尾.</p>
<p>2：-M<br>可以象通常一样引用模<br>$ perl -MLWP::Simple -e ‘getstore (“<span class="exturl" data-url="aHR0cDovL3d3dy4xNjMuY29tLyZxdW90OywmcXVvdDsxNjMuaHRtbCZxdW90OykmIzM5OyMj5LiL6L295pW05Liq572R6aG1" title="http://www.163.com/&quot;,&quot;163.html&quot;)&#39;##下载整个网页">http://www.163.com/&quot;,&quot;163.html&quot;)&#39;##下载整个网页<i class="fa fa-external-link"></i></span><br>-M+模块名 和 use模块名一样</p>
<p>第三部分:隐式循环<br>3：-n<br>增加了循环的功能, 使你可以一行一行来处理文件<br>$  perl -n -e’print;’ 1.txt #####$  perl -ne ‘print;’ 1.txt<br>这与下面的程序一样.<br>LINE:<br>    while (&lt;&gt;;) {<br>     print;<br>    }</p>
<p>&lt;&gt;; 打开命令行里的文件,一行行的读取.每一行缺省保存在 $<em><br>$ perl -n -e ‘print “$. - $</em>“‘ file</p>
<p>上面的这一行可以写成<br>  LINE:<br>    while (&lt;&gt;;) {<br>      print “$. - $<em>“<br>    }<br>输出当前行数 $. 和当前行 $</em>.</p>
<p>4:-p ,和 -n 一样，但是还会打印 $_ 的内容</p>
<p>如果想在循环的前后做些处理, 可以使用 BEGIN 或 END block. 下面的这一行计算文件里的字数.</p>
<p>$ perl -ne ‘END { print $t } @w = /(w+)/g; $t += @w’ file.txt</p>
<p>每一行所有匹配的字放入数组 @w , 然后把 @w 的元素数目递加到  $t. END block 里的 print 最后输出文件总字数.<br>还有两个参数可以让这个程序变得更简单.</p>
<p>5:-a<br>打开自动分离 (split)模式. 空格是缺省的分离号. 输入根据分离号被分离然后放入缺省数组@F</p>
<p>使用-a，上面的命令可以写成这样：<br>$ perl -ane ‘END {print $x} $x += @F’ file.txt  ##使用了-a</p>
<p>6：-F<br>把缺省的分离号改为你想要的.例如把分离号定为非字符，上面的命令可以改为：<br>$ perl -F’W’ -ane ‘END {print $x} $x += @F’ file.txt</p>
<p>下面通过Unix password 文件来介绍一个复杂的例子.  Unix password 是文本文件, 每一行是一个用户记录,<br>由冒号 : 分离. 第 7 行是用户的登录 shell 路径. 我们可以得出每一个不同 shell 路径被多少个用户使用 :</p>
<p>$ perl -F’:’ -ane ‘$s{$F[6]}++;’ &gt;; -e ‘END { print “$<em> : $s{$</em>}” for keys %s }’ /etc/passwd</p>
<p>虽然现在不是一行, 但是你可以看出使用参数可以解决什么问题.</p>
<p>第四部分：Record Separators 数据分隔符</p>
<p>$/ 和 $ — 输入,输出分隔号.<br>$/ 用来分隔从文件句柄里读出的数据, 缺省 $/ 分隔号是 n , 这样每次从文件句柄里就会一行行的读取<br>$ 缺省是空字符, 用来自动加到要 print 的数据尾端. 这就是为什么很多时候 print 都要在末尾加上 n.<br>$/ 和 $ 可与 -n -p 一起使用. 在命令行上相对应为 -0 (零) 和 -l ( 这是 L ).<br>-0 后面可以跟一个 16 进制或8进制数值, 这个值用来付给 $/ .<br>-00 打开段落模式, -0777 打开slurp 模式 (即可以一次把整个文件读入) , 这与把 $/ 设为空字符和 undef 一样效果.</p>
<p>单独使用 -l  有两个效果：<br>第一：自动 chomp 输入分隔号<br>第二：把$/ 值付给 $ (这样 print 的时候就会自动在末尾加 n )</p>
<p>1：-l 参数, 用来给每一个输出加 n. 例如<br>$ perl -le ‘print “Hello World”‘</p>
<p>第五部分：原位编辑</p>
<p>使用已有的参数我们可以写出很有效的命令行程序. 常见的Unix I/O 重定向:<br>$ perl -pe ‘some code’ &lt; input.txt &gt;  &gt; output.txt</p>
<p>这个程序从 input.txt 读取数据, 然后做一些处理再输出到 output.txt. 你当然也可以把输出重定向到同一个文件里.</p>
<p>上面的程序可以通过 -i 参数做的更简单些.</p>
<p>2: -i<br>把源文件更名然后从这个更名的源文件里读取.最后把处理后的数据写入源文件.<br>如果 -i 后跟有其他字符串, 这个字符串与源文件名合成后来生成一个新的文件名.<br>此文件会被用来储存原始文件以免被 -i  参数覆盖.</p>
<p>这个例子把所有 php 字符替换为 perl :<br>$ perl -i -pe ‘s/bPHPb/Perl/g’ file.txt<br>程序读取文件的每一行, 然后替换字符, 处理后的数据重新写入( 即覆盖 ) 源文件.</p>
<p>如果不想覆盖源文件, 可以使用<br>$perl -i.bak -pe ‘s/bPHPb/Perl/g’ file.txt</p>
<p>这里处理过的数据写入 file.txt , file.txt.bak 是源文件的备份.</p>
<pre><code><span class="keyword">perl</span>经典的例子
</code></pre><p>问题：<br>遇到一问题：<br>aaa@domain.com  2<br>aaa@domain.com 111<br>bbb@home.com   2222<br>bbb@home.com   1</p>
<p>类似这种输出，我想把他们变换成下面形式：</p>
<p>aaa@domain.com 113<br>bbb@home.com 2223<br>就是将相同邮箱名称后面的数字相加。各位大侠能否给些思路如何用perl来实现。</p>
<p>答案：<br>perl -anle ‘$cnt{$F[0]}+=$F[1];END{print “$<em>t$cnt{$</em>}” for keys %cnt}’ urfile</p>
<p>如果熟悉了上面几个perl命令行参数的用法，上面的这个命令应该很好理解：<br>每次读取urfile的一行，由于使用了-a，打开自动分离 (split)模式. 空格是缺省的分离号. 输入根据分离号被分离然后放入缺省数组@F中，<br>以文件的第一行为例子$F[0] 就是 aaa@domain.com , $F[1] 就是2</p>
<p>$cnt{$F[0]} +=$F[1] 就是一个哈希数组, 以$F[0]为key,$F[1]为value,把相同key的数值都叠加起来.然后把文件的每一行都这样处理一次.<br>END{} 就是在循环完之后再处理.里面的意思就是打印这个%cnt 哈希数组.这个哈希数组的key就是 邮箱名称,value就是叠加后的数字.</p>
<p>下面的是上面行命令的文本形式：</p>
<h1 id="!/usr/bin/perl">!/usr/bin/perl</h1><p>use strict;<br>use warnings;</p>
<p>my %hash;<br>while (&lt;&gt;){<br>      chomp;<br>     my @array=split;<br>     $hash{$array[0]} +=$array[1];<br>}</p>
<p>END{<br>foreach (keys %hash){<br>        print”$<em>t$hash{$</em>}n”;<br>}<br>}</p>
<p>与One-Liner相关的Perl命令行参数：</p>
<p>-0&lt;数字&gt;</p>
<p>(用8进制表示)指定记录分隔符($/变量)，默认为换行</p>
<p>-00，段落模式，即以连续换行为分隔符</p>
<p>-0777，禁用分隔符，即将整个文件作为一个记录</p>
<p>-a，自动分隔模式，用空格分隔$_并保存到@F中。相当于@F=split。分隔符可以使用-F参数指定</p>
<p>-F，指定-a的分隔符，可以使用正则表达式</p>
<p>-e，执行指定的脚本。</p>
<p>-i&lt;扩展名&gt;原地替换文件，并将旧文件用指定的扩展名备份。不指定扩展名则不备份。</p>
<p>-l，对输入内容自动chomp，对输出内容自动添加换行</p>
<p>-n，自动循环，相当于while(&lt;&gt;){脚本;}</p>
<p>-p，自动循环+自动输出，相当于while(&lt;&gt;){脚本;print;}</p>
<p><span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzRhZjNmMGQyMDEwMGc5b3ouaHRtbA==" title="http://blog.sina.com.cn/s/blog_4af3f0d20100g9oz.html">http://blog.sina.com.cn/s/blog_4af3f0d20100g9oz.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Perl有很多命令行参数. 通过它们, 我们有机会写出更简单的程序. 在这篇文章里我们来了解一些常用的参数.&lt;/p&gt;
&lt;p&gt;第一部分：Safety Net Options 安全网参数&lt;/p&gt;
&lt;p&gt;在使用Perl尝试一些聪明(或stupid)的想法时, 错误难免会发生. 有
    
    </summary>
    
      <category term="Perl" scheme="http://tiramisutes.github.io/categories/Perl/"/>
    
    
      <category term="perl" scheme="http://tiramisutes.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>How to use subscripts in ggplot2 legends -[expression()]</title>
    <link href="http://tiramisutes.github.io/2015/12/05/expression.html"/>
    <id>http://tiramisutes.github.io/2015/12/05/expression.html</id>
    <published>2015-12-05T03:16:17.000Z</published>
    <updated>2018-09-28T02:33:53.431Z</updated>
    
    <content type="html"><![CDATA[<p>If you want to incorporate Greek symbols etc. into the major tick labels, use an unevaluated <span class="exturl" data-url="aHR0cDovL3N0YXQuZXRoei5jaC9SLW1hbnVhbC9SLXBhdGNoZWQvbGlicmFyeS9iYXNlL2h0bWwvZXhwcmVzc2lvbi5odG1s" title="http://stat.ethz.ch/R-manual/R-patched/library/base/html/expression.html">expression<i class="fa fa-external-link"></i></span>.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">data &lt;- data.frame(names=tolower(LETTERS[1:4]),mean_p=runif(4))</span><br><span class="line"></span><br><span class="line">p &lt;- ggplot(data,aes(x=names,y=mean_p))</span><br><span class="line">p &lt;- p + geom_bar(colour=<span class="string">"black"</span>,fill=<span class="string">"white"</span>)</span><br><span class="line">p &lt;- p + xlab(<span class="string">"expressions"</span>) + scale_y_continuous(expression(paste(<span class="string">"Wacky Data"</span>)))</span><br><span class="line">p &lt;- p + scale_x_discrete(labels=c(a=expression(paste(Delta^2)),</span><br><span class="line">                               b=expression(paste(q^n)),</span><br><span class="line">                               c=expression(<span class="built_in">log</span>(z)),</span><br><span class="line">                               d=expression(paste(omega / (x + 13)^2))))</span><br><span class="line">p</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/expression.png" alt=""><br>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82MjAyNjY3L2hvdy10by11c2Utc3Vic2NyaXB0cy1pbi1nZ3Bsb3QyLWxlZ2VuZHMtcg==" title="http://stackoverflow.com/questions/6202667/how-to-use-subscripts-in-ggplot2-legends-r">http://stackoverflow.com/questions/6202667/how-to-use-subscripts-in-ggplot2-legends-r<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;If you want to incorporate Greek symbols etc. into the major tick labels, use an unevaluated &lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3N0Y
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="expression" scheme="http://tiramisutes.github.io/tags/expression/"/>
    
  </entry>
  
  <entry>
    <title>hexo语法：markdown基础篇</title>
    <link href="http://tiramisutes.github.io/2015/12/04/markdown.html"/>
    <id>http://tiramisutes.github.io/2015/12/04/markdown.html</id>
    <published>2015-12-04T14:59:58.000Z</published>
    <updated>2019-03-15T07:51:55.047Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><span class="exturl" data-url="aHR0cDovL3poLndpa2lwZWRpYS5vcmcvd2lraS9NYXJrZG93bg==" title="http://zh.wikipedia.org/wiki/Markdown">Markdown<i class="fa fa-external-link"></i></span>是一种轻量级的「标记语言」，目标是实现「易读易写」。我使用改语言，主要的目的还是因为github的缘故。所以了解一些Markdown的一些基本语法，就是非常有必要了。<br><a id="more"></a></p><p></p>
<h2 id="Markdown_常用语法">Markdown 常用语法</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/markdown.png" alt=""></p>
<h2 id="标题">标题</h2><p>只需要在文字前加 #。具体可以支持到1到6个#，建议在#后，最好加入一个空格，这是Mardown的标准写法。</p>
<h2 id="列表">列表</h2><p>列表主要两种类型，无序和有序。无序的只要在文字前加-或者*，有序的是使用1.,2.,3.标记。</p>
<h2 id="PDF">PDF</h2><div class="pdf" target="https://www.pnas.org/content/pnas/suppl/2019/02/14/1819778116.DCSupplemental/pnas.1819778116.sapp.pdf" height=""></div>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cucG5hcy5vcmcvY29udGVudC9wbmFzL3N1cHBsLzIwMTkvMDIvMTQvMTgxOTc3ODExNi5EQ1N1cHBsZW1lbnRhbC9wbmFzLjE4MTk3NzgxMTYuc2FwcC5wZGY=" title="https://www.pnas.org/content/pnas/suppl/2019/02/14/1819778116.DCSupplemental/pnas.1819778116.sapp.pdf">我是PDF<i class="fa fa-external-link"></i></span></p>
<h2 id="引用">引用</h2><p>要引用一段文字，在文字前使用标记 <code>&gt;</code> 这种尖括号（大于号）即可。</p>
<p><blockquote><p>这里是引用：hope</p></blockquote><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;blockquote&gt;&lt;p&gt;这里是引用：hope&lt;/p&gt;&lt;/blockquote&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="图片与链接">图片与链接</h2><p>图片：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![]()&#123;ImgCap&#125;&#123;/ImgCap&#125;</span><br></pre></td></tr></table></figure></p>
<p>或者：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">"https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pythonlogo.jpg"</span> width=<span class="string">"600"</span> height=<span class="string">"300"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>链接:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[标注](link)</span><br></pre></td></tr></table></figure></p>
<p><a href="http://tiramisutes.github.io/">http://tiramisutes.github.io/</a></p>
<h2 id="下载">下载</h2><p><a id="download" href="http://tiramisutes.github.io/" target="_blank" rel="external"><i class="fa fa-download"></i><span> Download Now</span><br></a></p>
<h2 id="粗体与斜体">粗体与斜体</h2><p>粗体与斜体也比较简单，两个<code><em></em></code>或<code>_</code>包含一段文本就是粗体，一个<code></code>或<code>_</code>包含一段文本就是斜体<br><strong>粗体</strong>   <em>斜体</em></p>
<h2 id="表格">表格</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| Tables        | Are           | Cool  |</span><br><span class="line">| ------------- |:-------------:| -----:|</span><br><span class="line">| col 3 is      | right-aligned | <span class="variable">$1600</span> |</span><br><span class="line">| col 2 is      | centered      |   <span class="variable">$12</span> |</span><br><span class="line">| zebra stripes | are neat      |    <span class="variable">$1</span> |</span><br></pre></td></tr></table></figure>
<p><strong>效果展示</strong><br>| Tables        | Are           | Cool  |<br>| ——————- |:——————-:| ——-:|<br>| col 3 is      | right-aligned | $1600 |<br>| col 2 is      | centered      |   $12 |<br>| zebra stripes | are neat      |    $1 |</p>
<p>如果让标题居中，加:——————-:，右对齐——-:</p>
<h2 id="代码框">代码框</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cord <span class="keyword">if</span> <span class="keyword">for</span> <span class="keyword">while</span></span><br></pre></td></tr></table></figure>
<h2 id="分割线">分割线</h2><p>分割线的语法只需要三个 * 号。</p>
<hr>
<p>我是分割线</p>
<hr>
<h2 id="视频">视频</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe width=<span class="string">"420"</span> height=<span class="string">"315"</span> src=<span class="string">"http://www.youtube.com/"</span> frameborder=<span class="string">"0"</span> allowfullscreen&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<h2 id="hexo_server">hexo server</h2><p>hexo s启动hexo服务时报错如下：</p>
<p><blockquote><p><br>FATAL Port 4000 has been used. Try other port instead.<br></p></blockquote><br>显示hexo默认4000端口被占用；<br><strong>解决办法：</strong></p>
<p><li>windows下检查端口是否占用并杀死该进程</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr 4000 （最后一列是pid）</span><br><span class="line">tasklist | findstr pid</span><br><span class="line">taskkill -PID pid -F</span><br></pre></td></tr></table></figure></p>
<p><li>或者换其他端口</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server --port=4001</span><br></pre></td></tr></table></figure></p>
<p>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3d3dy5qaWFuc2h1LmNvbS9wLzFlNDAyOTIyZWUzMg==" title="http://www.jianshu.com/p/1e402922ee32">http://www.jianshu.com/p/1e402922ee32<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2RhcmluZ2ZpcmViYWxsLm5ldC9wcm9qZWN0cy9tYXJrZG93bi9iYXNpY3M=" title="http://daringfireball.net/projects/markdown/basics">http://daringfireball.net/projects/markdown/basics<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9ndWlkZXMuZ2l0aHViLmNvbS9mZWF0dXJlcy9tYXN0ZXJpbmctbWFya2Rvd24v" title="https://guides.github.com/features/mastering-markdown/">https://guides.github.com/features/mastering-markdown/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbWljcm9jb3Ntdi9hcnRpY2xlL2RldGFpbHMvNTE4NjgyODQ=" title="http://blog.csdn.net/microcosmv/article/details/51868284">http://blog.csdn.net/microcosmv/article/details/51868284<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL3poLndpa2lwZWRpYS5vcmcvd2lraS9NYXJrZG93bg==&quot; title=&quot;http://zh.wikipedia.org/wiki/Markdown&quot;
    
    </summary>
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/categories/Hexo/"/>
    
    
      <category term="markdown" scheme="http://tiramisutes.github.io/tags/markdown/"/>
    
  </entry>
  
  <entry>
    <title>python基础教程总结</title>
    <link href="http://tiramisutes.github.io/2015/12/03/python-basic.html"/>
    <id>http://tiramisutes.github.io/2015/12/03/python-basic.html</id>
    <published>2015-12-03T11:05:19.000Z</published>
    <updated>2018-09-28T02:42:11.057Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pythonlogo.jpg" width="570" height="300"></p><p></p>
<h2 id="简介">简介</h2><p>Python 是一个高层次的结合了解释性、编译性、互动性和面向对象的脚本语言。<br>Python 的设计具有很强的可读性，相比其他语言经常使用英文关键字，其他语言的一些标点符号，它具有比其他语言更有特色语法结构。<br>Python 是一种解释型语言： 这意味着开发过程中没有了编译这个环节。类似于PHP和Perl语言。<br>Python 是交互式语言： 这意味着，您可以在一个Python提示符，直接互动执行写你的程序。<br>Python 是面向对象语言: 这意味着Python支持面向对象的风格或代码封装在对象的编程技术。<br>Python 是初学者的语言：Python 对初级程序员而言，是一种伟大的语言，它支持广泛的应用程序开发，从简单的文字处理到 WWW 浏览器再到游戏。</p>
<h3 id="Python_特点">Python 特点</h3><p>1.易于学习：Python有相对较少的关键字，结构简单，和一个明确定义的语法，学习起来更加简单。<br>2.易于阅读：Python代码定义的更清晰。<br>3.易于维护：Python的成功在于它的源代码是相当容易维护的。<br>4.一个广泛的标准库：Python的最大的优势之一是丰富的库，跨平台的，在UNIX，Windows和Macintosh兼容很好。<br>5.互动模式：互动模式的支持，您可以从终端输入并获得结果的语言，互动的测试和调试代码片断。<br>6.便携式：Python可以运行在多种硬件平台和所有平台上都具有相同的接口。<br>7.可扩展：可以添加低层次的模块到Python解释器。这些模块使程序员可以添加或定制自己的工具，更有效。<br>8.数据库：Python提供所有主要的商业数据库的接口。<br>9.GUI编程：Python支持GUI可以创建和移植到许多系统调用。<br>10.可扩展性：相比 shell 脚本，Python 提供了一个更好的结构，且支持大型程序。</p>
<h2 id="Python_环境搭建">Python 环境搭建</h2><p>可以通过终端窗口输入 “python” 命令来查看本地是否已经安装Python以及Python的安装版本。</p>
<h3 id="Python下载">Python下载</h3><p>Python最新源码，二进制文档，新闻资讯等可以在Python的官网查看到：<br>Python官网：<span class="exturl" data-url="aHR0cDovL3d3dy5weXRob24ub3JnLw==" title="http://www.python.org/">http://www.python.org/<i class="fa fa-external-link"></i></span><br>可以在一下链接中下载Python的文档，你可以下载 HTML、PDF 和 PostScript 等格式的文档。<br>Python文档下载地址：www.python.org/doc/</p>
<h3 id="Python安装">Python安装</h3><p>Unix &amp; Linux 平台安装 Python:</p>
<p><li>下载及解压压缩包。</li></p>
<p><li>如果你需要自定义一些选项修改<i>Modules/Setup</i> </li></p>
<p><li><b>执行</b> ./configure 脚本</li></p>
<p><li>make</li></p>
<p><li>make install</li></p>
<p></p><p>执行以上操作后，Python会安装在 /usr/local/bin 目录中，Python库安装在/usr/local/lib/pythonXX，XX为你使用的Python的版本号。</p><br>Window 平台安装 Python:<p></p>
<p><li>下载后，双击下载包，进入Python安装向导，安装非常简单，你只需要使用默认的设置一直点击”下一步”直到安装完成即可。</li></p>
<h3 id="环境变量配置">环境变量配置</h3><p>Unix/Linux 设置环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$PATH</span>:/usr/local/bin/python"</span> </span><br><span class="line"><span class="comment">##/usr/local/bin/python 是Python的安装目录</span></span><br></pre></td></tr></table></figure></p>
<p>Windows 设置环境变量：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##命令提示框中(cmd) : 输入 </span></span><br><span class="line">path %path%;C:\Python </span><br><span class="line"><span class="comment">##C:\Python 是Python的安装目录</span></span><br></pre></td></tr></table></figure></p>
<p>Python 重要环境变量：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/python—path.png" alt=""></p>
<h2 id="Python_中文打印错误">Python 中文打印错误</h2><p>解决方法为只要在文件开头加入 # -<em>- coding: UTF-8 -</em>- 或者 #coding=utf-8 就行了。</p>
<h2 id="Python_基础语法">Python 基础语法</h2><h3 id="行和缩进">行和缩进</h3><p>学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用缩进来写模块。<br>缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。<br><i class="fa fa-cogs"></i>IndentationError: unexpected indent 错误是python编译器是在告诉你”Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题”，所有python对格式要求非常严格。<br><i class="fa fa-cogs"></i>如果是 IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。<br>因此，在Python的代码块中必须使用相同数目的行首缩进空格数。<br><i class="fa fa-graduation-cap"></i>建议你在每个缩进层次使用 单个制表符 或 两个空格 或 四个空格 , 切记不能混用。</p>
<h3 id="多行语句">多行语句</h3><p>Python语句中一般以新行作为为语句的结束符，但是我们可以使用斜杠（ \）将一行的语句分为多行显示，语句中包含[], {} 或 () 括号就不需要使用多行连接符。</p>
<h3 id="Python注释">Python注释</h3><p>python中单行注释采用 # 开头，多行注释使用三个单引号(‘’’)或三个单引号(“””)。</p>
<h2 id="Python_变量">Python 变量</h2><p></p><p>Python有五个标准的数据类型：</p><p></p>
<p><li>Numbers（数字）</li></p>
<p><li>String（字符串）</li></p>
<p><li>List（列表）</li></p>
<p><li>Tuple（元组）</li></p>
<p><li>Dictionary（字典）</li></p>
<h2 id="Python数字(Number)">Python数字(Number)</h2><p></p><p>Python支持四种不同的数值类型：</p><p></p>
<p><li>int（有符号整型）</li></p>
<p><li>long（长整型[也可以代表八进制和十六进制]）</li>    </p>
<p><li>float（浮点型）</li>    </p>
<p><li>complex（复数）</li><br><i class="fa fa-area-chart"></i>Python数学函数：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/shuxue.png" alt=""></p>
<h2 id="Python字符串(String)">Python字符串(String)</h2><p>字符串或串(String)是由数字、字母、下划线组成的一串字符。<br>字符串用’’标识</p>
<p></p><p>python的字串列表有2种取值顺序:</p><p></p>
<p><li>从左到右索引默认0开始的，最大范围是字符串长度少1</li></p>
<p><li>从右到左索引默认-1开始的，最大范围是字符串开头</li><br><i class="fa fa-eye"></i>如果你的实要取得一段子串的话，可以用到变量[头下标:尾下标]，就可以截取相应的字符串，其中下标是从0开始算起，可以是正数或负数，下标可以为空表示取到头或尾。<br>加号（+）是字符串连接运算符，星号（*）是重复操作。<br><i class="fa fa-book"></i>Python字符串运算符：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/str.png" alt=""><br><i class="fa fa-book"></i>python的字符串内建函数：</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">string.capitalize()</td>
<td style="text-align:center">把字符串的第一个字符大写</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">string.center(width))</td>
<td style="text-align:center">返回一个原字符串居中,并使用空格填充至长度 width 的新字符串</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">string.count(str, beg=0, end=len(string))</td>
<td style="text-align:center">返回 str 在 string 里面出现的次数，如果 beg 或者 end 指定则返回指定范围内 str 出现的次数</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">string.decode(encoding=’UTF-8’, errors=’strict’)</td>
<td style="text-align:center">以 encoding 指定的编码格式解码 string，如果出错默认报一个 ValueError 的 异 常 ， 除 非 errors 指 定 的 是 ‘ignore’ 或 者’replace’</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">string.encode(encoding=’UTF-8’, errors=’strict’)</td>
<td style="text-align:center">以 encoding 指定的编码格式编码 string，如果出错默认报一个ValueError 的异常，除非 errors 指定的是’ignore’或者’replace’</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">string.endswith(obj, beg=0, end=len(string)))</td>
<td style="text-align:center">检查字符串是否以 obj 结束，如果beg 或者 end 指定则检查指定的范围内是否以 obj 结束，如果是，返回 True,否则返回 False.</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">string.expandtabs(tabsize=8)</td>
<td style="text-align:center">把字符串 string 中的 tab 符号转为空格，默认的空格数 tabsize 是 8.</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">string.join(seq)</td>
<td style="text-align:center">Merges (concatenates)以 string 作为分隔符，将 seq 中所有的元素(的字符串表示)合并为一个新的字符串</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">string.ljust(width)</td>
<td style="text-align:center">返回一个原字符串左对齐,并使用空格填充至长度 width 的新字符串</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">string.lower()</td>
<td style="text-align:center">转换 string 中所有大写字符为小写</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">string.lstrip()</td>
<td style="text-align:center">截掉 string 左边的空格</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">string.maketrans(intab, outtab])</td>
<td style="text-align:center">maketrans() 方法用于创建字符映射的转换表，对于接受两个参数的最简单的调用方式，第一个参数是字符串，表示需要转换的字符，第二个参数也是字符串表示转换的目标。</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">string.replace(str1, str2,  num=string.count(str1))</td>
<td style="text-align:center">把 string 中的 str1 替换成 str2,如果 num 指定，则替换不超过 num 次</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">string.rstrip()</td>
<td style="text-align:center">删除 string 字符串末尾的空格</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">string.split(str=””, num=string.count(str))</td>
<td style="text-align:center">以 str 为分隔符切片 string，如果 num有指定值，则仅分隔 num 个子字符串</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">string.strip([obj])</td>
<td style="text-align:center">在 string 上执行 lstrip()和 rstrip()</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center">string.title()</td>
<td style="text-align:center">返回”标题化”的 string,就是说所有单词都是以大写开始，其余字母均为小写(见 istitle())</td>
</tr>
</tbody>
</table>
<h2 id="Python列表(List)">Python列表(List)</h2><p>列表用[ ]标识。<br>列表中的值得分割也可以用到变量[头下标:尾下标]，就可以截取相应的列表，从左到右索引默认0开始的，从右到左索引默认-1开始，下标可以为空表示取到头或尾。<br>加号（+）是列表连接运算符，星号（*）是重复操作。</p>
<h3 id="访问列表中的值">访问列表中的值</h3><p>使用下标索引来访问列表中的值，同样你也可以使用方括号的形式截取字符。</p>
<h3 id="更新列表">更新列表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; list = [<span class="string">'physics'</span>, <span class="string">'chemistry'</span>, 1997, 2000]</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> list[2];</span><br><span class="line">1997</span><br><span class="line">&gt;&gt;&gt; list[2] = 2001;</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> list[2];</span><br><span class="line">2001</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> list;</span><br><span class="line">[<span class="string">'physics'</span>, <span class="string">'chemistry'</span>, 2001, 2000]</span><br></pre></td></tr></table></figure>
<h3 id="删除列表元素">删除列表元素</h3><p>可以使用 del 语句来删除列表的的元素<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; del list[2];</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> list;</span><br><span class="line">[<span class="string">'physics'</span>, <span class="string">'chemistry'</span>, 2000]</span><br></pre></td></tr></table></figure></p>
<h3 id="Python列表函数">Python列表函数</h3><table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">函数</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">cmp(list1, list2)</td>
<td style="text-align:center">比较两个列表的元素</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">len(list)</td>
<td style="text-align:center">列表元素个数</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">max(list)</td>
<td style="text-align:center">返回列表元素最大值</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">min(list)</td>
<td style="text-align:center">返回列表元素最小值</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">sum(list)</td>
<td style="text-align:center">返回列表元素总和</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">list(seq)</td>
<td style="text-align:center">将元组转换为列表</td>
</tr>
</tbody>
</table>
<h3 id="Python列表方法">Python列表方法</h3><table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">函数</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">list.append(obj)</td>
<td style="text-align:center">在列表末尾添加新的对象</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">list.count(obj)</td>
<td style="text-align:center">统计某个元素在列表中出现的次数</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">list.extend(seq)</td>
<td style="text-align:center">在列表末尾一次性追加另一个序列中的多个值（用新列表扩展原来的列表）</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">list.index(obj)</td>
<td style="text-align:center">从列表中找出某个值第一个匹配项的索引位置</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">list.insert(index, obj)</td>
<td style="text-align:center">将对象插入列表</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">list.pop(obj=list[-1])</td>
<td style="text-align:center">移除列表中的一个元素（默认最后一个元素），并且返回该元素的值</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">list.remove(obj)</td>
<td style="text-align:center">移除列表中某个值的第一个匹配项</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">list.reverse()</td>
<td style="text-align:center">反向列表中元素</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">list.sort([func])</td>
<td style="text-align:center">对原列表进行排序</td>
</tr>
</tbody>
</table>
<h2 id="Python元组">Python元组</h2><p>元组是另一个数据类型，类似于List（列表）。<br>元组用”()”标识。<br>内部元素用逗号隔开。但是元素不能二次赋值，相当于只读列表。</p>
<h3 id="元组内置函数">元组内置函数</h3><p>tuple(seq)：将列表转换为元组。</p>
<h2 id="Python元字典">Python元字典</h2><p>字典(dictionary)是除列表以外python之中最灵活的内置数据结构类型。列表是有序的对象结合，字典是无序的对象集合。<br>两者之间的区别在于：字典当中的元素是通过键来存取的，而不是通过偏移存取。<br>字典用”{ }”标识。字典由索引(key)和它对应的值value组成。<br>adict[key] 形式返回键key对应的值value，如果key不在字典中会引发一个KeyError。</p>
<h3 id="字典用法举例">字典用法举例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; code = &#123;<span class="string">"GLY"</span> : <span class="string">"G"</span>, <span class="string">"ALA"</span> : <span class="string">"A"</span>, <span class="string">"LEU"</span> : <span class="string">"L"</span>, <span class="string">"ILE"</span> : <span class="string">"I"</span>,</span><br><span class="line">... <span class="string">"ARG"</span> : <span class="string">"R"</span>, <span class="string">"LYS"</span> : <span class="string">"K"</span>, <span class="string">"MET"</span> : <span class="string">"M"</span>, <span class="string">"CYS"</span> : <span class="string">"C"</span>&#125;</span><br><span class="line">&gt;&gt;&gt; code[’VAL’]</span><br><span class="line">’V’</span><br><span class="line">&gt;&gt;&gt; code.keys()</span><br><span class="line">&gt;&gt;&gt; code.values()</span><br><span class="line">&gt;&gt;&gt; code.items()</span><br><span class="line">&gt;&gt;&gt; del code[’CYS’]</span><br><span class="line">&gt;&gt;&gt; code.update(&#123;’CYS’:’C’, ’MET’:’M’)</span><br><span class="line">&gt;&gt;&gt; one2three = &#123;&#125;</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> key,val <span class="keyword">in</span> code.items():</span><br><span class="line">... one2three[val]= key</span><br></pre></td></tr></table></figure>
<h3 id="字典内置函数&amp;方法">字典内置函数&amp;方法</h3><table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">函数</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">radiansdict.clear()</td>
<td style="text-align:center">删除字典内所有元素</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">radiansdict.copy()</td>
<td style="text-align:center">返回一个字典的浅复制</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">radiansdict.fromkeys()</td>
<td style="text-align:center">创建一个新字典，以序列seq中元素做字典的键，val为字典所有键对应的初始值</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">radiansdict.get(key, default=None)</td>
<td style="text-align:center">返回指定键的值，如果值不在字典中返回default值</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">radiansdict.items()</td>
<td style="text-align:center">以列表返回可遍历的(键, 值) 元组数组</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">radiansdict.keys()</td>
<td style="text-align:center">以列表返回一个字典所有的键</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">radiansdict.update(dict2)</td>
<td style="text-align:center">把字典dict2的键/值对更新到dict里</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">radiansdict.values()</td>
<td style="text-align:center">以列表返回字典中的所有值</td>
</tr>
</tbody>
</table>
<h3 id="Python数据类型转换">Python数据类型转换</h3><p>有时候，我们需要对数据内置的类型进行转换，数据类型的转换，你只需要将数据类型作为函数名即可。<br>以下几个内置的函数可以执行数据类型之间的转换。这些函数返回一个新的对象，表示转换的值。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/zhuanfan.png" alt=""></p>
<h2 id="Python_运算符">Python 运算符</h2><p></p><p>Python语言支持以下类型的运算符:</p><p></p>
<p><li><a href="#ysf1">算术运算符：+，-，<em>，/,%,<em>*(幂 - 返回x的y次幂x</em></em>y),//(取整除 - 返回商的整数部分)</a></li></p>
<p><li><a href="#ysf2">比较（关系）运算符:==,!=,&lt;&gt;(不等于),&gt;,&lt;,&gt;=,&lt;=</a></li></p>
<p><li><a href="#ysf3">赋值运算符：=，-=(减法赋值运算符),+=(加法赋值运算符),<em>=,/=,%=,*</em>=,//=</a></li></p>
<p><li><a href="#ysf4">逻辑运算符：and，or，not</a></li></p>
<p><li><a href="#ysf5">位运算符</a></li></p>
<p><li><a href="#ysf6">成员运算符：in，not in</a></li></p>
<p><li><a href="#ysf7">身份运算符：is，not is</a></li></p>
<p><li><a href="#ysf8">运算符优先级</a></li></p>
<h2 id="Python_条件语句">Python 条件语句</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 判断条件1:</span><br><span class="line">    执行语句1……</span><br><span class="line"><span class="keyword">elif</span> 判断条件2:</span><br><span class="line">    执行语句2……</span><br><span class="line"><span class="keyword">elif</span> 判断条件3:</span><br><span class="line">    执行语句3……</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    执行语句4……</span><br></pre></td></tr></table></figure>
<p>其中”判断条件”成立时（非零），则执行后面的语句，而执行内容可以多行，以缩进来区分表示同一范围。</p>
<h2 id="Python_循环语句">Python 循环语句</h2><p>Python提供了for循环和while循环<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/5xunhuan.png" alt=""></p>
<h2 id="Python_While循环语句">Python While循环语句</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line">count = 0</span><br><span class="line"><span class="keyword">while</span> (count &lt; 9):</span><br><span class="line">   <span class="built_in">print</span> <span class="string">'The count is:'</span>, count</span><br><span class="line">   count = count + 1</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">"Good bye!"</span></span><br><span class="line">输出：</span><br><span class="line">The count is: 0</span><br><span class="line">The count is: 1</span><br><span class="line">The count is: 2</span><br><span class="line">The count is: 3</span><br><span class="line">The count is: 4</span><br><span class="line">The count is: 5</span><br><span class="line">The count is: 6</span><br><span class="line">The count is: 7</span><br><span class="line">The count is: 8</span><br><span class="line">Good <span class="built_in">bye</span>!</span><br></pre></td></tr></table></figure>
<h2 id="Python_for_循环语句">Python for 循环语句</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> range(10,20):  <span class="comment"># 迭代 10 到 20 之间的数字</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> range(2,num): <span class="comment"># 根据因子迭代</span></span><br><span class="line">      <span class="keyword">if</span> num%i == 0:      <span class="comment"># 确定第一个因子</span></span><br><span class="line">         j=num/i          <span class="comment"># 计算第二个因子</span></span><br><span class="line">         <span class="built_in">print</span> <span class="string">'%d 等于 %d * %d'</span> % (num,i,j)</span><br><span class="line">         <span class="built_in">break</span>            <span class="comment"># 跳出当前循环</span></span><br><span class="line">   <span class="keyword">else</span>:                  <span class="comment"># 循环的 else 部分</span></span><br><span class="line">      <span class="built_in">print</span> num, <span class="string">'是一个质数'</span></span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">10 等于 2 * 5</span><br><span class="line">11 是一个质数</span><br><span class="line">12 等于 2 * 6</span><br><span class="line">13 是一个质数</span><br><span class="line">14 等于 2 * 7</span><br><span class="line">15 等于 3 * 5</span><br><span class="line">16 等于 2 * 8</span><br><span class="line">17 是一个质数</span><br><span class="line">18 等于 2 * 9</span><br><span class="line">19 是一个质数</span><br></pre></td></tr></table></figure>
<h2 id="Python函数">Python函数</h2><h3 id="自定义一个函数">自定义一个函数</h3><p></p><p>你可以定义一个由自己想要功能的函数，以下是简单的规则：</p><p></p>
<p><li>函数代码块以def关键词开头，后接函数标识符名称和圆括号()。</li></p>
<p><li>任何传入参数和自变量必须放在圆括号中间。圆括号之间可以用于定义参数。</li></p>
<p><li>函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。</li></p>
<p><li>函数内容以冒号起始，并且缩进。</li></p>
<p><li>Return[expression]结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。</li></p>
<h3 id="语法">语法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def functionname( parameters ):</span><br><span class="line">   <span class="string">"函数_文档字符串"</span></span><br><span class="line">   function_suite</span><br><span class="line">   <span class="built_in">return</span> [expression]</span><br></pre></td></tr></table></figure>
<h3 id="实例">实例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">total = 0; <span class="comment"># 这是一个全局变量</span></span><br><span class="line"><span class="comment"># 可写函数说明</span></span><br><span class="line">def sum( arg1, arg2 ):</span><br><span class="line">   <span class="comment">#返回2个参数的和."</span></span><br><span class="line">   total = arg1 + arg2; <span class="comment"># total在这里是局部变量.</span></span><br><span class="line">   <span class="built_in">print</span> <span class="string">"函数内是局部变量 : "</span>, total</span><br><span class="line">   <span class="built_in">return</span> total;  <span class="comment">#return语句[表达式]退出函数，选择性地向调用方返回一个表达式。不带参数值的return语句返回None</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#调用sum函数</span></span><br><span class="line">sum( 10, 20 );</span><br><span class="line"><span class="built_in">print</span> <span class="string">"函数外是全局变量 : "</span>, total </span><br><span class="line">以上实例输出结果：</span><br><span class="line"></span><br><span class="line">函数内是局部变量 :  30</span><br><span class="line">函数外是全局变量 :  0</span><br></pre></td></tr></table></figure>
<h2 id="Python_模块">Python 模块</h2><p>简单地说，模块就是一个保存了Python代码的文件。模块能定义函数，类和变量。模块里也能包含可执行的代码。关于模块的安装见<a href="http://tiramisutes.github.io/2015/11/27/python-install/">《python模块安装—无root权限（easy_install和pip）》</a></p>
<h3 id="import_语句">import 语句</h3><p>想使用Python源文件，只需在另一个源文件里执行import语句。</p>
<h3 id="From…import_语句">From…import 语句</h3><p>Python的from语句让你从模块中导入一个指定的部分到当前命名空间中。</p>
<h3 id="From…import*_语句">From…import* 语句</h3><p>把一个模块的所有内容全都导入到当前的命名空间也是可行的。</p>
<h3 id="Python中的包">Python中的包</h3><p>包是一个分层次的文件目录结构，它定义了一个由模块及子包，和子包下的子包等组成的Python的应用环境。</p>
<h2 id="Python_文件I/O">Python 文件I/O</h2><h3 id="读取键盘输入">读取键盘输入</h3><p>Python提供了两个内置函数从标准输入读入一行文本，默认的标准输入是键盘。如下：</p><p></p>
<p><li>raw_input：raw_input([prompt]) 函数从标准输入读取一个行，并返回一个字符串（去掉结尾的换行符）</li></p>
<p><li>input：input([prompt]) 函数和raw_input([prompt]) 函数基本可以互换，但是input会假设你的输入是一个有效的Python表达式，并返回运算结果。</li></p>
<h3 id="open()函数">open()函数</h3><p>你必须先用Python内置的open()函数打开一个文件，创建一个file对象，相关的辅助方法才可以调用它进行读写。</p>
<p></p><p><br>语法：<br></p><p></p>
<p><pre><br>file object = open(file_name [, access_mode][, buffering])<br></pre></p>
<p></p><p><br>各个参数的细节如下：<br></p><p></p>
<p><li>file_name：file_name变量是一个包含了你要访问的文件名称的字符串值。</li></p>
<p><li>access_mode：access_mode决定了打开文件的模式：只读，写入，追加等。所有可取值见如下的完全列表。这个参数是非强制的，默认文件访问模式为只读(r)。</li></p>
<p><li>buffering:如果buffering的值被设为0，就不会有寄存。如果buffering的值取1，访问文件时会寄存行。如果将buffering的值设为大于1的整数，表明了这就是的寄存区的缓冲大小。如果取负值，寄存区的缓冲大小则为系统默认。</li><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/open.png" alt=""></p>
<h3 id="Close()方法">Close()方法</h3><p></p><p><br>语法：<br></p><p></p>
<p><pre><br>fileObject.close();<br></pre></p>
<h3 id="Write()方法">Write()方法</h3><p>Write()方法在字符串的结尾不添加换行符(‘\n’)<br>注意：write(str())写入的数据必须是字符串。</p>
<p></p><p><br>语法：<br></p><p></p>
<p><pre><br>fileObject.write(string);<br></pre></p>
<h3 id="read()方法">read()方法</h3><p>read（）方法从一个打开的文件中读取一个字符串。</p>
<p><pre><br>fileObject.read([count]);<br></pre></p>
<h2 id="Python正则表达式">Python正则表达式</h2><p>Python 自1.5版本起增加了re 模块，它提供 Perl 风格的正则表达式模式。<br>re 模块使 Python 语言拥有全部的正则表达式功能。<br>compile 函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。<br><strong>re</strong> 模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。<br>详细内容分见<span class="exturl" data-url="aHR0cDovL20ucnVub29iLmNvbS9weXRob24vcHl0aG9uLXJlZy1leHByZXNzaW9ucy5odG1s" title="http://m.runoob.com/python/python-reg-expressions.html"><i class="fa fa-external-link"></i></span></p>
<h2 id="自己使用总结">自己使用总结</h2><h3 id="python字符串替换的2种有效方法：">python字符串替换的2种有效方法：</h3><p><em>用字符串本身<br>a = ‘hello word’<br>a.replace(‘word’,’python’)
</em>用正则表达式<br>import re<br>strinfo = re.compile(‘word’)<br>b = strinfo.sub(‘python’,a)<br>print b</p>
<h3 id="异常报错">异常报错</h3><p>TypeError: ‘str’ object does not support item assignment<br>AttributeError: ‘str’ object has no attribute ‘append’<br>错误原因：对str进行list的操作<br>解决办法：转换数据类型<br>list和str转化str.split()<br>这个内置函数实现的是将str转化为list。其中str=””是分隔符。<br>join可以说是split的逆运算<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; name=[<span class="string">'Albert'</span>, <span class="string">'Ainstain'</span>]</span><br><span class="line">&gt;&gt;&gt; <span class="string">""</span>.join(name)</span><br><span class="line"><span class="string">'AlbertAinstain'</span></span><br></pre></td></tr></table></figure></p>
<p>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL20ucnVub29iLmNvbS9weXRob24v" title="http://m.runoob.com/python/">http://m.runoob.com/python/<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy55bnB4cnouY29tL243ODE2NTljMjAyNS5hc3B4" title="http://www.ynpxrz.com/n781659c2025.aspx">http://www.ynpxrz.com/n781659c2025.aspx<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pythonlogo.jpg&quot; width=&quot;570&quot; height=&quot;300&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 i
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="python basic" scheme="http://tiramisutes.github.io/tags/python-basic/"/>
    
  </entry>
  
  <entry>
    <title>miRNA</title>
    <link href="http://tiramisutes.github.io/2015/12/01/miRNA.html"/>
    <id>http://tiramisutes.github.io/2015/12/01/miRNA.html</id>
    <published>2015-12-01T06:06:06.000Z</published>
    <updated>2018-09-28T02:38:29.543Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介">简介</h2><p>MicroRNAs (miRNAs) are short in sequence and are generated by enzymatic excision from precursor transcripts called primary miRNAs (pri-miRs), which until now had been assumed not to encode any proteins.<br><a href="/nature/journal/v520/n7545/full/nature14346.html">Lauressergues et al</a> find that plant pri-miRNAs contain short open reading frame sequences that encode regulatory peptides. This is the first report of a functional peptide being encoded by a pri-miR and provides a fresh perspective on the significance of pri-miR regions beyond those that directly give rise to miRNAs.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/miRNA.png" alt=""><br>图片注释：MicroRNAs and their associated peptides. The precursors of plant microRNAs (miRNAs) are<br>pri-miR sequences, which are transcribed from DNA by the enzyme RNA polymerase II (Pol II). They are<br>then modified by capping and addition of a poly(A) tail. The miRNA duplexes are subsequently excised by<br>the enzyme Dicer-like1 and transported to the cytoplasm; other parts of the pri-miR are degraded. After<br>further processing, the resulting miRNA sequence guides repression of gene expression as part of the<br>RISC complex. Lauressergues et al.report that some pri-miRs contain short open reading frame (ORF)<br>sequences that can produce peptides (miPEP). The miPEPs enhance expression of the pri-miR, leading<br>to more miRNA and so more effective cleavage of the target gene’s messenger RNA. Such ORFs may avoid<br>degradation as part of pri-miRs that might exit the nucleus without being processed by Dicer-like1.</p>
<h2 id="关键信息总结">关键信息总结</h2><p>1）    Both plant and animal pri-miRs are transcribed from DNA in the nucleus by the enzyme RNA polymerase II.<br>2）    The structured (fold-back) region of the transcript surrounding the miRNA sequence is recognized and processed by one of two enzymes-Drosha or Dicer-like1(In plants, Dicer-like1 cuts out the miRNA in a duplex form).<br>3)    Transporter proteins export the excised sequences to the cytoplasm, where they are further processed before becoming competent to guide the RNA-induced silencing complex (RISC) in repressing target genes through either cleavage or translational repression of their mRNAs.<br>4)    The miPEPs had the same tissue distribution as their associated mature miRNAs and enhanced the expression and effectiveness of these miRNAs. Moreover, the miPEPs promoted the transcription of their corresponding pri-miR, rather than enhancing miRNA stability.</p>
<h2 id="miRNA合成途径">miRNA合成途径</h2><p>miRNA的合成大体经过：初级miRNA(pri-miRNA, primary miRNA)→前体miRNA(pre-miRNA, precursor-miRNA)→成熟miRNA(miRNA, mature miRNA)。<br>其具体合成途径存在两种形式：经典合成途径和Mirtron合成途径；<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/nihms311773f1.jpg" alt=""></p>
<h3 id="经典合成途径">经典合成途径</h3><p>来源：基因间隔区或编码基因内含子中；<br>细胞核内编码miRNA 的基因通过RNA聚合酶II 或RNA聚合酶III 转录生成初级miRNA(pri-miRNA)，pri-miRNA与来自蛋白质编码基因mRNA相似，有5’ 端帽式结构和3’ 端多聚腺苷酸尾结构，长度可达数千个碱基。接着pri-miRNA在一种RNaseIII(Drosha 酶)和它的伴侣分子(DiGeorge syndrome critical region gene 8,DGCR8)组成的复合物作用下，剪切为70~80 个核苷酸长度、具有茎环结构的miRNA 前体(pre-miRNA)。miRNA 前体在Ran-GTP 依赖的核质/ 细胞质转运蛋白——输出蛋白5(exportin 5)的作用下，从核内运输到胞质中。随后miRNA前体在另一种RNaseIII(Dicer酶)的作用下被剪切成21~25 个核苷酸长度，而且其5’端磷酸化和3’端有2 nt 的悬垂序列，类似于siRNA 的不完全配对的双链RNA，它们是由成熟miRNA与miRNA* 组成的二聚体，miRNA*是pre-miRNA中的一段RNA，其位置恰好与成熟的miRNA 相对。最后在RNA解旋酶作用下生成成熟miRNA 和miRNA*，成熟miRNA结合到RNA诱导的基因沉默复合物(RNA-induced silencing complex, RISC)中发挥作用，miRNA* 则被降解。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ruby-et-al-nature-mirtron.jpg" alt=""></p>
<h3 id="Mirtron途径">Mirtron途径</h3><p>2007年，Ruby等在研究黑腹果蝇和秀丽隐杆线虫的小RNA 序列时首次发现mirtron，是一类定位于mRNA编码基因内含子内的miRNA，与<strong>经典miRNA合成相比其合成过程不需要经过Drosha酶切割</strong>，其形式功能与miRNA相同，具有以下特点：<br>(1)来自长度为56 nt 的内含子序列；<br>(2)能够形成miRNA:miRNA*复合物；<br>(3)内含子序列及其二级结构非常保守；<br>(4)内含子存在于基因组中的外显子中间并且有”GU-AG”的典型内含子特点；<br>(5)最后形成的成熟miRNA总来自于3’ 端侧的序列；<br>(6)合成需要Ldbr(lariat-debranching enzyme,套索分支酶)(参与内含子剪接) 的作用；<br>(7)与经典的miRNA一样，依赖Ran-GTP/ 输出蛋白5 的转运机制转运出核，在Dicer 酶的作用下成为成熟的miRNA。<br><code>同时，mirtron在哺乳动物中和在无脊椎动物中有明显的不同，如：</code><br>(1)哺乳动物中的mirtron途径合成的功能miRNA大多数来自mirtron的5’茎序列；<br>(2)不管哺乳动物中的mirtron3’ 茎序列能否成为成熟miRNA，它的起始核苷酸总是尿嘧啶(U)或胞嘧啶(C);<br>(3)哺乳动物中mirtron悬垂序列(overhang, 发夹结构末端突出序列)大多数为单核苷酸(G)，只有少数是双核苷酸(AG)；<br>(4)哺乳动物中mirtron比经典的miRNA前体和无脊椎动物mirtron的GC 含量要高，自由能要低。</p>
<h2 id="阻断miRNA对mRNA的调控作用">阻断miRNA对mRNA的调控作用</h2><h3 id="miRNA海绵(miRNA_sponges)">miRNA海绵(miRNA sponges)</h3><p>miRNA海绵是一种miRNA靶基因的竞争性抑制剂，是将若干个miRNA的反义序列串联在一起，连接到合适的载体中表达，其转录物”吸附”相应的miRNA，与miRNA靶基因形成竞争，导致靶基因去抑制化。<br><span class="exturl" data-url="aHR0cDovL2Qud2FuZmFuZ2RhdGEuY29tLmNuL1BlcmlvZGljYWwvZ3d5eC1menN3MjAxNDA0MDEw" title="http://d.wanfangdata.com.cn/Periodical/gwyx-fzsw201404010">miRNA海绵表达载体的构建策略<i class="fa fa-external-link"></i></span></p>
<h3 id="circRNA">circRNA</h3><p>环状RNA（circRNA）对miRNA的吸附作用。<i class="fa fa-link" aria-hidden="true"></i><a href="http://tiramisutes.github.io/2016/04/12/Circular-RNAs/">http://tiramisutes.github.io/2016/04/12/Circular-RNAs/</a></p>
<h2 id="miRNA数据库">miRNA数据库</h2><p>miocroRNA databases:<span class="exturl" data-url="aHR0cDovL21pY3Jvcm5hZGF0YWJhc2VzLmNvbS9EYXRhYmFzZXMuaHRtbA==" title="http://micrornadatabases.com/Databases.html">http://micrornadatabases.com/Databases.html<i class="fa fa-external-link"></i></span></p>
<h2 id="miRNA相关工具">miRNA相关工具</h2><h3 id="mirtron_prediction">mirtron prediction</h3><p><span class="exturl" data-url="aHR0cDovL2NiaW8ubXNrY2Mub3JnL2xlc2xpZWxhYi9taXJ0cm9ucy8=" title="http://cbio.mskcc.org/leslielab/mirtrons/">Mirtron’SVM’prediction<i class="fa fa-external-link"></i></span></p>
<h3 id="MicroRNA_Target_Prediction">MicroRNA Target Prediction</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5taWNyb3JuYS5vcmcvbWljcm9ybmEvaG9tZS5kbw==" title="http://www.microrna.org/microrna/home.do">miRanda<i class="fa fa-external-link"></i></span> &#8212; miRNA target prediction for human, drosophila and zebrafish genomes<br><span class="exturl" data-url="aHR0cDovL3d3dy5taXJiYXNlLm9yZy8=" title="http://www.mirbase.org/">miRBase<i class="fa fa-external-link"></i></span> &#8212; a comprehensive repository for miRNAs and their predicted targets<br><span class="exturl" data-url="aHR0cDovL21pcmRiLm9yZy9taVJEQi8=" title="http://mirdb.org/miRDB/">miRDB<i class="fa fa-external-link"></i></span> &#8212; an online database for miRNA target prediction and functional annotations in animals<br><span class="exturl" data-url="aHR0cDovL21pcm5hbWFwLm1iYy5uY3R1LmVkdS50dy8=" title="http://mirnamap.mbc.nctu.edu.tw/">miRNAMap<i class="fa fa-external-link"></i></span> &#8212; a genomic maps of microRNA genes and their target genes in mammalian genomes<br><span class="exturl" data-url="aHR0cDovL3dhdHNvbi5jb21wYmlvLml1cHVpLmVkdTo4MDgwL21pcjJkaXNlYXNlLw==" title="http://watson.compbio.iupui.edu:8080/mir2disease/">miR2Disease<i class="fa fa-external-link"></i></span> &#8212; a database providing comprehensive resource of miRNA deregulation in various human diseases<br><span class="exturl" data-url="aHR0cDovL2RpYW5hLmNzbGFiLmVjZS5udHVhLmdyL3RhcmJhc2Uv" title="http://diana.cslab.ece.ntua.gr/tarbase/">TarBase<i class="fa fa-external-link"></i></span> &#8212; a comprehensive database of experimentally supported animal microRNA targets<br><span class="exturl" data-url="aHR0cDovL3BpY3Rhci5tZGMtYmVybGluLmRlLw==" title="http://pictar.mdc-berlin.de/">PicTar<i class="fa fa-external-link"></i></span> &#8212; microRNA targets for vertebrates, fly and nematodes<br><span class="exturl" data-url="aHR0cDovL3d3dy50YXJnZXRzY2FuLm9yZy8=" title="http://www.targetscan.org/">TargetScan<i class="fa fa-external-link"></i></span> &#8212; a search for the presence of conserved sites that match the seed of each miRNA<br><span class="exturl" data-url="aHR0cDovL3d3dy5ydXNzZWxsLmVtYmwuZGUvbWlSTkFzLw==" title="http://www.russell.embl.de/miRNAs/">Target Gene Prediction at EMBL<i class="fa fa-external-link"></i></span> &#8212; miRNA-Target predictions for Drosophila miRNAs</p>
<h3 id="Databases_for_microRNA_Expression">Databases for microRNA Expression</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5taWNyb3JuYS5vcmcvbWljcm9ybmEvZ2V0RXhwckZvcm0uZG8=" title="http://www.microrna.org/microrna/getExprForm.do">microRNA.org<i class="fa fa-external-link"></i></span> &#8212; predicted microRNA targets &amp; target downregulation scores. Experimentally observed expression patterns<br><span class="exturl" data-url="aHR0cDovLzIwMi4zOC4xMjYuMTUxL2htZGQvbWlybmEvbWQv" title="http://202.38.126.151/hmdd/mirna/md/">HMDD<i class="fa fa-external-link"></i></span> &#8212; Human MicroRNA Disease Database (HMDD) is a database that contains the experimentally supported miRNA-disease<br>association data, which are manually curated from publications. The dysfunction evidence or miRNAs and literature PubMed ID are also given<br><span class="exturl" data-url="aHR0cDovLzIwMi4zOC4xMjYuMTUxL2htZGQvbWlybmEvdGYv" title="http://202.38.126.151/hmdd/mirna/tf/">TransmiR<i class="fa fa-external-link"></i></span> &#8212; a web query-driven database integrating the experimentally supported transcription factor and miRNA regulator relations</p>
<h3 id="RNA_Secondary_Structure_Prediction">RNA Secondary Structure Prediction</h3><p><span class="exturl" data-url="aHR0cDovL2RpYW5hLnBjYmkudXBlbm4uZWR1L2NnaS1iaW4vbWljcm9fdC5jZ2kv" title="http://diana.pcbi.upenn.edu/cgi-bin/micro_t.cgi/">DIANA MicroTest<i class="fa fa-external-link"></i></span> &#8212; a prediction of miRNA-mRNA interaction<br><span class="exturl" data-url="aHR0cDovL21mb2xkLmJpb2luZm8ucnBpLmVkdS8=" title="http://mfold.bioinfo.rpi.edu/">mfold<i class="fa fa-external-link"></i></span> &#8212; tools for predicting the secondary structure of RNA and DNA, mainly by using thermodynamic methods<br><span class="exturl" data-url="aHR0cDovL21pcm5hLmltYmIuZm9ydGguZ3IvbWljcm9pbnNwZWN0b3Iv" title="http://mirna.imbb.forth.gr/microinspector/">microInspector<i class="fa fa-external-link"></i></span> &#8212; a web tool for detection of miRNA binding sites in an RNA sequence<br><span class="exturl" data-url="aHR0cDovL3d3dy5taXJuYWluZm8uY29tL0VuZXJneUNhbGMuYXNweA==" title="http://www.mirnainfo.com/EnergyCalc.aspx">miRNA Bioinfor<i class="fa fa-external-link"></i></span> &#8212; miRNA End Energy calculator which takes miRNA duplex to calculate free energy for 5 base pairs at<br>one end plus a dangling nucleotide<br><span class="exturl" data-url="aHR0cDovL21pcnJpbS5uY3JuYS5vcmcv" title="http://mirrim.ncrna.org/">miRRim<i class="fa fa-external-link"></i></span> &#8212; a method for detecting miRNA foldbacks based on hidden Markov model (HMM)<br><span class="exturl" data-url="aHR0cDovL214c2Nhcm5hLm5jcm5hLm9yZy8=" title="http://mxscarna.ncrna.org/">MXSCARNA<i class="fa fa-external-link"></i></span> &#8212; a multiple alignment tool for RNA sequences using progressive alignment based on pairwise structural alignment algorithm of SCARNA. Good for large scale analyses.<br><span class="exturl" data-url="aHR0cDovL2JpYmlzZXJ2LnRlY2hmYWsudW5pLWJpZWxlZmVsZC5kZS9ybmFoeWJyaWQv" title="http://bibiserv.techfak.uni-bielefeld.de/rnahybrid/">RNAhybrid<i class="fa fa-external-link"></i></span>&#8212; a tool for finding the minimum free energy hybridisation of a long and a short RNA</p>
<h3 id="MicroRNA_Homologous_Prediction">MicroRNA Homologous Prediction</h3><p><span class="exturl" data-url="aHR0cDovL2dyb3Vwcy5jc2FpbC5taXQuZWR1L3BhZy9taXJuYW1pbmVyLw==" title="http://groups.csail.mit.edu/pag/mirnaminer/">miRNAminer<i class="fa fa-external-link"></i></span> &#8212; a web-based tool used for homologous miRNA gene search in several species<br><span class="exturl" data-url="aHR0cDovL3Blb3BsZS5jc2FpbC5taXQuZWR1L2FraWV6dW4vbWlSdmlld2VyLw==" title="http://people.csail.mit.edu/akiezun/miRviewer/">miRviewer<i class="fa fa-external-link"></i></span> &#8212; a global view of homologous miRNA genes in many species<br><span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMyNjc2MjU3L3BkZi8xNDcxLTIxMDUtMTAtMTA1LnBkZg==" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2676257/pdf/1471-2105-10-105.pdf">RISCbinder<i class="fa fa-external-link"></i></span>&#8212; prediction of guide strand of microRNAs<br><span class="exturl" data-url="aHR0cDovL3RhZ2MudW5pdi1tcnMuZnIvbWlyZXZhbC8=" title="http://tagc.univ-mrs.fr/mireval/">Mireval<i class="fa fa-external-link"></i></span> &#8212; Sequence evaluation of microRNA properties</p>
<h3 id="MicroRNA_Deep_Sequencing">MicroRNA Deep Sequencing</h3><p><span class="exturl" data-url="aHR0cDovL3dlYi5iaW9pbmZvcm1hdGljcy5jaWNiaW9ndW5lLmVzL21pY3JvUk5BL21pUmFuYWx5c2VyLnBocA==" title="http://web.bioinformatics.cicbiogune.es/microRNA/miRanalyser.php">miRanalyzer<i class="fa fa-external-link"></i></span>&#8212; A microRNA detection and analysis tool for next-generation sequencing experiments<br><span class="exturl" data-url="aHR0cDovL2liaXMudGF1LmFjLmlsL21pUk5Ba2V5Lw==" title="http://ibis.tau.ac.il/miRNAkey/">miRNAkey<i class="fa fa-external-link"></i></span>&#8212; A software pipeline for the analysis of microRNA Deep Sequencing data<br><span class="exturl" data-url="aHR0cDovL3d3dy5tZGMtYmVybGluLmRlL2VuL3Jlc2VhcmNoL3Jlc2VhcmNoX3RlYW1zL3N5c3RlbXNfYmlvbG9neV9vZl9nZW5lX3JlZ3VsYXRvcnlfZWxlbWVudHMvcHJvamVjdHMvbWlSRGVlcC9pbmRleC5odG1s" title="http://www.mdc-berlin.de/en/research/research_teams/systems_biology_of_gene_regulatory_elements/projects/miRDeep/index.html">miRDeep<i class="fa fa-external-link"></i></span>&#8212; Discovering known and novel miRNAs from deep sequencing data</p>
<h2 id="miRNA百科">miRNA百科</h2><p><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5nZW5lLXF1YW50aWZpY2F0aW9uLmRlL21pY3JvLXJuYS5odG1s" title="http://www.gene-quantification.de/micro-rna.html">microRNA.gene-quantification.info<i class="fa fa-external-link"></i></span></p>
<p>参考文献：<br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25hdHVyZS9qb3VybmFsL3Y1MjAvbjc1NDUvZnVsbC9uYXR1cmUxNDM3OC5odG1s" title="http://www.nature.com/nature/journal/v520/n7545/full/nature14378.html">Plant biology: Coding in non-coding RNAs<i class="fa fa-external-link"></i></span><br><i class="fa fa-link" aria-hidden="true"></i><span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzMTg1MTg5Lw==" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3185189/">Mirtrons: microRNA biogenesis via splicing<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介&quot;&gt;简介&lt;/h2&gt;&lt;p&gt;MicroRNAs (miRNAs) are short in sequence and are generated by enzymatic excision from precursor transcripts called pri
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="miRNA" scheme="http://tiramisutes.github.io/tags/miRNA/"/>
    
  </entry>
  
  <entry>
    <title>ChIP-sequencing介绍</title>
    <link href="http://tiramisutes.github.io/2015/12/01/chip-seq.html"/>
    <id>http://tiramisutes.github.io/2015/12/01/chip-seq.html</id>
    <published>2015-12-01T05:21:42.000Z</published>
    <updated>2019-03-19T09:57:29.326Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介(From_Wikipedia,_the_free_encyclopedia)">简介(From Wikipedia, the free encyclopedia)</h2><p>ChIP-sequencing, also known as ChIP-seq, is a method used to analyze protein interactions with DNA. ChIP-seq combines chromatin immunoprecipitation (ChIP) with massively parallel DNA sequencing to identify the binding sites of DNA-associated proteins. It can be used to map global binding sites precisely for any protein of interest. Previously, ChIP-on-chip was the most common technique utilized to study these protein–DNA relations.<br>ChIP-seq is used primarily to determine how transcription factors and other chromatin-associated proteins influence phenotype-affecting mechanisms. Determining how proteins interact with DNA to regulate gene expression is essential for fully understanding many biological processes and disease states. </p>
<h2 id="流程">流程</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/chip-seq.png" alt=""></p>
<h3 id="ChIP">ChIP</h3><p>The ChIP process enriches specific crosslinked DNA-protein complexes  using an <a href="/wiki/Antibody" title="Antibody">antibody</a> against the protein of interest. For a good description of the ChIP wet lab protocol see <a href="/wiki/ChIP-on-chip" title="ChIP-on-chip">ChIP-on-chip</a>. <a href="/wiki/Oligonucleotide" title="Oligonucleotide">Oligonucleotide</a> adaptors are then added to the small stretches of DNA that were bound to the protein of interest to enable massively parallel sequencing.</p>
<h3 id="Sequencing">Sequencing</h3><p>After size selection, all the resulting ChIP-DNA fragments are sequenced simultaneously using a genome sequencer. A single sequencing run can scan for genome-wide associations with high resolution, as opposed to large sets of tilingarrays required for lower resolution ChIP-chip.</p>
<h2 id="中文解释">中文解释</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/chip2.png" alt=""><br>ChIP 测序的基本原分为 ChIP 和测序两个步骤。ChIP 是英文 Chromatin immunoprecipitation 的缩写，即染色质免疫沉淀，其步骤包括：细胞内蛋白质和 DNA 的交联、DNA 分子分离及片段化、免疫沉淀和解除交联。测序就是对解除交联后的 DNA 片段进行测序，制备文库时也包括连接测序接头和片段筛选等步骤。由于免疫沉淀的 DNA 片段在蛋白质结合区域周围富集，因此识别蛋白质结合区域转化为检测测序标签富集的区域。在信息处理中，这是一个信号检测的问题。在转录因子 ChIP 测序数据分析中，由于测序标签还会在转录因子结合位点周围形成分布，通过对分布的统计建模分析，可从数据中精确定位结合位点。 </p>
<h2 id="Computational_analysis">Computational analysis</h2><p>The read count data generated by ChIP-seq is massive. It motivates the development of computational analysis methods. To predict DNA-binding sites from ChIP-seq read count data, <a href="/wiki/Peak_calling" title="Peak calling">peak calling</a> methods have been developed. The most popular method is MACS which empirically models the shift size of ChIP-Seq tags, and uses it to improve the spatial resolution of predicted binding sites.<sup id="cite_ref-10" class="reference"><a href="#cite_note-10"><span>[</span>10<span>]</span></a></sup></p>
<p></p><p>Another relevant computational problem is Differential peak calling, which identifies significant differences in two ChIP-seq signals from distinct biological conditions. Differential peak callers segment two ChIP-seq signals and identify differential peaks using <a href="/wiki/Hidden_Markov_Model" title="Hidden Markov Model" class="mw-redirect">Hidden Markov Models</a>. Examples for two-stage differential peak callers are ChIPDiff<sup id="cite_ref-11" class="reference"><a href="#cite_note-11"><span>[</span>11<span>]</span></a></sup> and ODIN.<br>具体数据分析详细见：<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5wbG9iLm9yZy8yMDEyLzA5LzI5LzM3NjAuaHRtbA==" title="http://www.plob.org/2012/09/29/3760.html">http://www.plob.org/2012/09/29/3760.html<i class="fa fa-external-link"></i></span></p>
<p>Contribution from ：<br><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ2hJUC1zZXF1ZW5jaW5n" title="https://en.wikipedia.org/wiki/ChIP-sequencing">https://en.wikipedia.org/wiki/ChIP-sequencing<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5pbGx1bWluYS5jb20vZG9jdW1lbnRzL3Byb2R1Y3RzL2RhdGFzaGVldHMvZGF0YXNoZWV0X2NoaXBfc2VxdWVuY2UucGRm" title="http://www.illumina.com/documents/products/datasheets/datasheet_chip_sequence.pdf">http://www.illumina.com/documents/products/datasheets/datasheet_chip_sequence.pdf<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2Jpb2luZm8uYXUudHNpbmdodWEuZWR1LmNuL21lbWJlci94d2FuZy9maWxlcy9UaGVzaXNfWGlXYW5nX09MLnBkZg==" title="http://bioinfo.au.tsinghua.edu.cn/member/xwang/files/Thesis_XiWang_OL.pdf">http://bioinfo.au.tsinghua.edu.cn/member/xwang/files/Thesis_XiWang_OL.pdf<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介(From_Wikipedia,_the_free_encyclopedia)&quot;&gt;简介(From Wikipedia, the free encyclopedia)&lt;/h2&gt;&lt;p&gt;ChIP-sequencing, also known as ChIP-seq,
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="Chip_seq" scheme="http://tiramisutes.github.io/tags/Chip-seq/"/>
    
  </entry>
  
  <entry>
    <title>Linux 下批量下载 http 中链接内容</title>
    <link href="http://tiramisutes.github.io/2015/12/01/wegt-http.html"/>
    <id>http://tiramisutes.github.io/2015/12/01/wegt-http.html</id>
    <published>2015-12-01T00:31:16.000Z</published>
    <updated>2018-09-28T02:45:22.677Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/kobas.png" alt=""><br>KOBAS这个软件所需数据库有3540个物种数据，如何实现批量下载…<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/kobas2.png" alt=""><br>察看html网页源文件可发现：所有这些下载链接都整齐排列于 <code><a href="../download/sqlite3/ko.db.gz">KO</a><br></code>这样一个html语法结构中，所以可以通过正则表达式匹配找出所有的下载链接；</p>
<h2 id="方法1:python抓取网页并下载"><i class="fa fa-key"></i>方法1:python抓取网页并下载</h2><p>python中实现爬虫，解析网页html文件和下载文件的简单容易上手的优秀模块分别为requests，BeautifulSoup和re，通过三者的组合可实现爬虫网页并批量下载。<br>导入所需模块<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!~/bin/Python-2.7.10/</span></span><br><span class="line">from BeautifulSoup import BeautifulSoup</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"><span class="comment">#—--name:url-batch-download.py--</span></span><br><span class="line"><span class="comment">#—--修改:hope--</span></span><br><span class="line"><span class="comment"># point to output directory</span></span><br><span class="line">outpath = <span class="string">'/backend3/'</span></span><br><span class="line">url = <span class="string">'http://kobas.cbi.pku.edu.cn/site/download_db.jsp'</span></span><br><span class="line">mbyte=1024*1024</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">'Reading: '</span>, url</span><br><span class="line">html = requests.get(url).text</span><br><span class="line">soup = BeautifulSoup(html)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">'Processing: '</span>, url</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> soup.findAll(<span class="string">'a'</span>, href=True):</span><br><span class="line">    gzurl = name[<span class="string">'href'</span>]</span><br><span class="line">    strinfo = re.compile(<span class="string">'\../'</span>)</span><br><span class="line">    xzp= strinfo.sub(<span class="string">'http://kobas.cbi.pku.edu.cn/'</span>,gzurl)</span><br><span class="line">    <span class="built_in">print</span> xzp</span><br><span class="line">    <span class="keyword">if</span>( xzp.endswith(<span class="string">'.gz'</span>) ):</span><br><span class="line">        outfname = outpath + xzp.split(<span class="string">'/'</span>)[-1]</span><br><span class="line">        r = requests.get(xzp, stream=True)</span><br><span class="line">        <span class="keyword">if</span>( r.status_code == requests.codes.ok ) :</span><br><span class="line">            fsize = int(r.headers[<span class="string">'content-length'</span>])</span><br><span class="line">            <span class="built_in">print</span> <span class="string">'Downloading %s (%sMb)'</span> % ( outfname, fsize/mbyte )</span><br><span class="line">            with open(outfname, <span class="string">'wb'</span>) as fd:</span><br><span class="line">                <span class="keyword">for</span> chunk <span class="keyword">in</span> r.iter_content(chunk_size=1024): <span class="comment"># chuck size can be larger</span></span><br><span class="line">                    <span class="keyword">if</span> chunk: <span class="comment"># ignore keep-alive requests</span></span><br><span class="line">                        fd.write(chunk)</span><br><span class="line">                fd.close()</span><br></pre></td></tr></table></figure></p>
<p>修稿py文件为可执行文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x url-batch-download.py</span><br></pre></td></tr></table></figure></p>
<p>开始爬虫并批量下载<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2.7 url-batch-download.py</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-key"></i>方法2：wget批量下载<br>1） wget下载整个html页面后批量下载<br>wget都很熟悉，但是通常只是用来下载单个文件，如果需要批量下载呢？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://kobas.cbi.pku.edu.cn/site/download_db.jsp</span><br></pre></td></tr></table></figure></p>
<p>对于这个链接下载完后是jsp后缀文件，可以重命名为index.html。<br>2） 开始批量下载<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -i index.html -F -B http://kobas.cbi.pku.edu.cn/site/download_db.jsp</span><br></pre></td></tr></table></figure></p>
<p>参数解释：<br>-i 表示从文件导入链接，默认是直接按行读取URL<br>-F 表示将文件以HTML的格式解析，其实就是解析<a><br>-B 因为发现解析出来的链接用的都是相对路径，而为了下载这个文件，必须在相对路径前添加上Base URL，-B就是用来添加Base URL。</a></p>
<p>这样就可以批量下载当前目录中的文件了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/kobas.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;KOBAS这个软件所需数据库有3540个物种数据，如何实现批量下载…&lt;br&gt;&lt;img 
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="batch-download" scheme="http://tiramisutes.github.io/tags/batch-download/"/>
    
  </entry>
  
  <entry>
    <title>DNA methylation</title>
    <link href="http://tiramisutes.github.io/2015/11/30/DNA-methylation.html"/>
    <id>http://tiramisutes.github.io/2015/11/30/DNA-methylation.html</id>
    <published>2015-11-30T15:49:08.000Z</published>
    <updated>2018-09-28T02:33:01.196Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介">简介</h2><p>DNA methylation is a process by which methyl groups are added to DNA. Methylation modifies the function of the DNA. When located in a gene promoter, DNA methylation typically acts to repress gene transcription. DNA methylation is essential for normal development and is associated with a number of key processes including genomic imprinting, X-chromosome inactivation, repression of repetitive elements, and carcinogenesis.<br>DNA methylation at the 5 position of cytosine has the specific effect of reducing gene expression and has been found in every vertebrate examined. In adult somatic cells (cells in the body, not used for reproduction), DNA methylation typically occurs in a CpG dinucleotide context; non-CpG methylation is prevalent in embryonic stem cells,[5][6][7] and has also been indicated in neural development.</p>
<h2 id="原理">原理</h2><p>在甲基转移酶的催化下，DNA的CG两个核苷酸的胞嘧啶被选择性地添加甲基，形成5－甲基胞嘧啶，这常见于基因的5’-CG-3’序列。大多数脊椎动物基因组DNA都有少量的甲基化胞嘧啶，主要集中在基因5’端的非编码区，并成簇存在。甲基化位点可随DNA的复制而遗传，因为DNA复制后，甲基化酶可将新合成的未甲基化的位点进行甲基化。DNA的甲基化可引起基因的失活，DNA甲基化导致某些区域DNA构象变化，从而影响了蛋白质与DNA的相互作用，甲基化达到一定程度时会发生从常规的B-DNA向Z-DNA的过渡，由于Z-DNA结构收缩，螺旋加深，使许多蛋白质因子赖以结合的原件缩入大沟而不利于转录的起始，导致基因失活。<br>DNA甲基化主要形成5－甲基胞嘧啶（5-mC）和少量的N6-甲基腺嘌呤（N6-mA）及7－甲基鸟嘌呤（7-mG）。</p>
<h2 id="结构基因编辑">结构基因编辑</h2><p>含有很多CpG 结构，2CpG 和2GPC 中两个胞嘧啶的5 位碳原子通常被甲基化，且两个甲基集团在DNA 双链大沟中呈特定三维结构。基因组中60%～ 90% 的CpG 都被甲基化，未甲基化的CpG 成簇地组成CpG 岛，位于结构基因启动子的核心序列和转录起始点。有实验证明超甲基化阻遏转录的进行。DNA 甲基化可引起基因组中相应区域染色质结构变化，使DNA 失去核酶&ouml;限制性内切酶的切割位点，以及DNA 酶的敏感位点，使染色质高度螺旋化，凝缩成团，失去转录活性。5 位C 甲基化的胞嘧啶脱氨基生成胸腺嘧啶，由此可能导致基因置换突变，发生碱基错配： T2G，如果在细胞分裂过程中不被纠正，就会诱发遗传病或癌症，而且，生物体甲基化的方式是稳定的，可遗传的。</p>
<h2 id="The_Role_of_Methylation_in_Gene_Expression">The Role of Methylation in Gene Expression</h2><p>1) Not all genes are active at all times. DNA methylation is one of several epigenetic mechanisms that cells use to control gene expression.<br>2) 5-azacytidine Experiments Provide Early Clues to the Role of Methylation in Gene Expression.</p>
<h2 id="候选基因CpG岛区域和候选基因甲基化与表观基因组学">候选基因CpG岛区域和候选基因甲基化与表观基因组学</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/jiajihua.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Figure 1 | Altered DNA-methylation patterns <span class="keyword">in</span> tumorigenesis. The hypermethylation of CpG islands of tumoursuppressor</span><br><span class="line">genes is a common alteration <span class="keyword">in</span> cancer cells, and leads to the transcriptional inactivation of these genes</span><br><span class="line">and the loss of their normal cellular <span class="built_in">functions</span>. This contributes to many of the hallmarks of cancer cells. At the same</span><br><span class="line">time, the genome of the cancer cell undergoes global hypomethylation at repetitive sequences, and tissue-specific</span><br><span class="line">and imprinted genes can also show loss of DNA methylation. In some cases, this hypomethylation is known to</span><br><span class="line">contribute to cancer cell phenotypes, causing changes such as loss of imprinting, and might also contribute to the</span><br><span class="line">genomic instability that characterizes tumours. E, exon.</span><br></pre></td></tr></table></figure></p>
<p>如图1左所示，在正常细胞中，位于抑癌基因启动子区域的CpG岛处于低水平或未甲基化状态，此时抑癌基因处于正常的开放状态，抑癌基因不断表达抑制肿瘤的发生。而在肿瘤细胞中，该区域的CpG岛被高度甲基化，染色质构象发生改变，抑癌基因的表达被关闭，从而导致细胞进入细胞周期，凋亡丧失，DNA修复缺陷，血管生成以及细胞粘附功能缺失等，最终导致肿瘤发生。同样，如图1右所示，对于在正常细胞中处于高度甲基化的一些基因和重复序列，如果其甲基化水平降低，这些基因将表达和重复序列将激活，从而导致基因印记丢失，细胞过度增长，不合适的细胞特异性表达，基因组脆性增加，以及内寄生序列(endoparasitic sequence)的激活，最终也导致肿瘤发生。</p>
<h2 id="DNA甲基化检测方法">DNA甲基化检测方法</h2><p>据检测样本不同，可以分为DNA和mRNA。现有方法，绝大部分都是取样于细胞的DNA，根据研究水平，又将这些方法归为3大类，即：基因组甲基化水平(Methylation Content)的分析，候选基因甲基化分析，和基因组层次的DNA甲基化模式(Methylation pattern)与甲基化谱(Methylation Profiling)分析。</p>
<h3 id="基因组甲基化水平(Methylation_Content)">基因组甲基化水平(Methylation Content)</h3><h4 id="高效液相色谱(High-performance_Liquid_Chromatography,_HPLC)">高效液相色谱(High-performance Liquid Chromatography, HPLC)</h4><p>根据DNA或蛋白分子量和构象的不同而使其加以分离。由于在动态相和静态相下分子的光吸收度并不相同而加以定量。随着系统的压强的增加，其分辨率增高。故而能够定量测定基因组整体水平DNA甲基化水平。<br>过程是将DNA样品先经盐酸或氢氟酸水解成碱基，水解产物通过色谱柱，结果与标准品比较，用紫外光测定吸收峰值及其量，计算5 mC/(5mC+5C)的积分面积就得到基因组整体的甲基化水平。这是一种检测DNA甲基化水平的标准方法。</p>
<h4 id="高效毛细管电泳法(High-performance_Capillary_Electrophoresis,_HPCE)">高效毛细管电泳法(High-performance Capillary Electrophoresis, HPCE)</h4><p>利用窄孔熔融石英毛细管来从复合物中分离不同化学组分的技术。其基础是在强电场下不同分子的由于其所带电荷，大小，结构以及疏水性等不同而相互分开。用HPCE方法处理DNA水解产物来确定5mC水平，简便，经济且敏感性高。<br><i class="fa fa-comments-o"></i>以上各种方法虽然能够明确检测出目的序列中所有CpG位点的甲基化状况，但并不能对甲基化位点进行定位。</p>
<h3 id="候选基因(Candidate_Gene)">候选基因(Candidate Gene)</h3><h4 id="甲基化敏感性限制性内切酶-PCR/Southern法(_methylation-sensitive_restriction_Endonuclease_-PCR/Southern,_MSRE-PCR/Southern)">甲基化敏感性限制性内切酶-PCR/Southern法( methylation-sensitive restriction Endonuclease -PCR/Southern, MSRE-PCR/Southern)</h4><p>这种方法利用甲基化敏感性限制性内切酶对甲基化区的不切割的特性，将DNA消化为不同大小的片段后，进行Southern或PCR扩增分离产物，明确甲基化状态再进行分析。常使用的甲基化敏感的限制性内切酶有HpaⅡ-MspⅠ(CCGG)和SmaⅠ-Xmal(CCCGGG)等。</p>
<h4 id="重亚硫酸盐测序法(Bisulphite_Sequencing)">重亚硫酸盐测序法(Bisulphite  Sequencing)</h4><p>该方法首先用重亚硫酸盐使DNA中未发生甲基化的胞嘧啶脱氨基转变成尿嘧啶,而甲基化的胞嘧啶保持不变，行PCR扩增所需片段,则尿嘧啶全部转化成胸腺嘧啶，最后,对PCR产物进行测序并且与未经处理的序列比较,判断是否CpG位点发生甲基化。此方法是精确度很高，能明确目的片段中每一个CpG位点的甲基化状态，但需要大量的克隆测序,过程较为繁琐、昂贵。</p>
<h4 id="甲基化特异性的PCR(methylation-specific_PCR,_MS-PCR)">甲基化特异性的PCR(methylation-specific PCR, MS-PCR)</h4><p>该方法同样DNA先用重亚硫酸盐处理，随后行引物特异性的PCR。其设计两对引物，分别与重亚硫酸盐处理后的序列互补配对，即一对结合处理后的甲基化DNA链，另一对结合处理后的非甲基化DNA链。检测MS-PCR扩增产物，如果用针对处理后甲基化DNA链的引物能扩增出片段，则说明该被检测的位点存在甲基化；反之亦然。</p>
<h4 id="甲基化荧光法(MethyLight)">甲基化荧光法(MethyLight)</h4><p>结合重亚硫酸盐处理待测DNA片段，设计一个能与待测位点区互补的探针，探针的5’端连接报告荧光，3’端连接淬灭荧光，随后行实时定量PCR。如果探针能够与DNA杂交，则在PCR用引物延伸时，TaqDNA聚合酶5′到3′端的外切酶活性会将探针序列上5′端的报告荧光切下，淬灭荧光不再能对报告荧光进行抑制，这样报告荧光发光，测定每个循环报告荧光的强度即可得到该位点的甲基化情况及水平。本方法高效，迅速，具备可重复、所需样本量少、不需要电泳分离的特点。</p>
<h4 id="焦磷酸测序(Pyrosequencing)">焦磷酸测序(Pyrosequencing)</h4><p>该方法，由4种酶催化同一反应体系中的酶级联化学发光反应，在每一轮测序反应中，只加入一种dNTP，若该dNTP与模板配对，聚合酶就能将其加入到引物链中并释放出等摩尔数的焦磷酸(PPi)。PPi可最终转化为可见光信号，并由PyrogramTM转化为一个峰值，其高度与核苷酸数目成正比。当用于甲基化检测时，经重亚硫酸盐处理的序列可以看作是C-T型的SNP改变。其操作简单，结果准确可靠，可以行大规模分析。</p>
<h4 id="结合重亚硫酸盐的限制性内切酶法(combined_bisulfiterestriction_analysis,_COBRA)">结合重亚硫酸盐的限制性内切酶法(combined bisulfiterestriction analysis, COBRA)</h4><p>这种方法对标本DNA行重亚硫酸盐处理及PCR扩增，处理后原甲基化的胞嘧啶被保留，而非甲基化的胞嘧啶变为胸腺嘧啶。随后用限制性内切酶对转化后PCR产物切割的特性以识别原标本DNA的甲基化状况。该方法相对简单，不需预先知道CpG位点及样本序列。</p>
<h3 id="基因组范围的DNA甲基化模式(Methylation_pattern)与甲基化谱(Methylation_Profiling)">基因组范围的DNA甲基化模式(Methylation　pattern)与甲基化谱(Methylation Profiling)</h3><h4 id="限制性标记基因组扫描(Restriction_Landmark_Genomic_Scanning,_RLGS)">限制性标记基因组扫描(Restriction Landmark Genomic Scanning, RLGS)</h4><p>RLGS是最早适用于基因组范围DNA甲基化分析的方法之一。该方法先用甲基化敏感的稀频限制性内切酶NotⅠ消化基因组DNA，甲基化位点保留，标记末端、切割、行一维电泳，随后再用更高频的甲基化不敏感的内切酶切割，行二维电泳，这样甲基化的部分被切割开并在电泳时显带，得到RLGS图谱与正常对照得出缺失条带即为甲基化的可能部位。</p>
<h4 id="甲基化间区位点扩增(amplification_of_inter-methylated_sites,_AIMS)">甲基化间区位点扩增(amplification of inter-methylated sites, AIMS)</h4><p>AIMS是基于任意引物PCR(Arbitrary Primed PCR)的一种方法，由于任意引物PCR使用寡核苷酸连接子(linker) 进行连接，不需要依赖任何序列的先验信息。在该方法中，用来进行扩增的模板序列首先通过甲基化敏感的限制性内切酶进行消化而富集，其特异性由该酶酶切片断一端的特定序列结合连接子来保证。随后，由内切酶进行第二次消化，再次连接，提纯进行PCR扩增，最后电泳，提取目的序列进行测序。</p>
<h4 id="甲基化CpG岛扩增(Methylated_CpG-island_amplification,_MCA)">甲基化CpG岛扩增(Methylated  CpG-island amplification, MCA)</h4><p>MCA也是基于任意引物PCR的方法，该方法使用两种对甲基化具有不同敏感度的限制性内切酶(如SmaI和XmaI)先后进行消化，然后对甲基化敏感的限制性酶切片断进行接头(Adaptor)连接，行PCR，那些富含CpG的序列就会被选择性的扩增。该方法对甲基化分析和克隆甲基化差异性基因都非常有帮助。</p>
<h4 id="差异甲基化杂交(Differential_Methylation_Hybridization,DMH)">差异甲基化杂交(Differential Methylation Hybridization,DMH)</h4><p>DMH属于一种芯片技术，在该技术中，包括扩增子(Amplicon)生成和CGI文库筛选两个重要组成部分。在扩增子生成中，首先用MseI来酶切DNA样本，然后接上连接子，并去除重复序列，这时的样本一分为二，其一直接进行PCR扩增，生成仅由MseI处理过的扩增子，而另一半则用甲基化敏感的酶BstUI进行消化,然后进行PCR扩增，生成由MseI/BstUI共同处理过的扩增子。CGI文库通过筛查出重复序列，然后进行PCR，选出含有BstUI位点的克隆，最后这些克隆一式两份点到芯片上，制备成CGI芯片。然后把两种不同的扩增子分别杂交到相应的CGI克隆点上，最后通过差异性对比检测出那些未甲基化位点。</p>
<h4 id="由连接子介导PCR出的HpaII小片断富集分析(HpaII_tiny_fragement_Enrichment_by_Ligation-mediated_PCR,_HELP)">由连接子介导PCR出的HpaII小片断富集分析(HpaII tiny fragement Enrichment by Ligation-mediated PCR, HELP)</h4><p>该方法用HpaII与其对甲基化敏感同裂酶MspI对同一基因组序列进行消化，产生不同的代表性序列，然后对此序列进行连接子介导的PCR，瑞和进行电泳等比较分析或将此DNA样本共杂交到基因组芯片上进行分析。这种方法已经揭示了大量的组织特异性，差异甲基化区域，并用于正常细胞和癌症细胞的基因组比较分析。</p>
<h4 id="甲基化DNA免疫沉淀法(Methylated_DNA_immunoprecipitation,_MeDIP)">甲基化DNA免疫沉淀法(Methylated DNA immunoprecipitation, MeDIP)</h4><p>这是一种高效富集甲基化DNA的方法。在该方法中，可与5mC特异性结合的抗体加入到变性的基因组DNA片段中，从而使甲基化的基因组片断免疫沉淀，形成富集。通过与已有DNA微芯片技术相结合，从而进行大规模DNA甲基化分析。该方法简便，特异性高，适合DNA甲基化组学(DNA Methylome)的分析。</p>
<h2 id="候选基因甲基化分析网址">候选基因甲基化分析网址</h2><p><span class="exturl" data-url="aHR0cDovL2thdGFoZGluLm1zc20uZWR1L2tpc21ldGgvcmV2cGFnZS5wbA==" title="http://katahdin.mssm.edu/kismeth/revpage.pl">http://katahdin.mssm.edu/kismeth/revpage.pl<i class="fa fa-external-link"></i></span><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL3NjaXRhYmxlL3RvcGljcGFnZS90aGUtcm9sZS1vZi1tZXRoeWxhdGlvbi1pbi1nZW5lLWV4cHJlc3Npb24tMTA3MA==" title="http://www.nature.com/scitable/topicpage/the-role-of-methylation-in-gene-expression-1070">http://www.nature.com/scitable/topicpage/the-role-of-methylation-in-gene-expression-1070<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25yZy9qb3VybmFsL3Y4L240L2Z1bGwvbnJnMjAwNS5odG1s" title="http://www.nature.com/nrg/journal/v8/n4/full/nrg2005.html">http://www.nature.com/nrg/journal/v8/n4/full/nrg2005.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5saWZlb21pY3MuY29tLz9wPTE4NDU4" title="http://www.lifeomics.com/?p=18458">http://www.lifeomics.com/?p=18458<i class="fa fa-external-link"></i></span></p>
<h2 id="甲基化引物设计">甲基化引物设计</h2><p>Methyl Primer Express® Software v1.0<br><span class="exturl" data-url="aHR0cHM6Ly93d3cudGhlcm1vZmlzaGVyLmNvbS9vcmRlci9jYXRhbG9nL3Byb2R1Y3QvNDM3NjA0MQ==" title="https://www.thermofisher.com/order/catalog/product/4376041">https://www.thermofisher.com/order/catalog/product/4376041<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介&quot;&gt;简介&lt;/h2&gt;&lt;p&gt;DNA methylation is a process by which methyl groups are added to DNA. Methylation modifies the function of the DNA. Wh
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="methylation" scheme="http://tiramisutes.github.io/tags/methylation/"/>
    
  </entry>
  
  <entry>
    <title>Degradome-降解组</title>
    <link href="http://tiramisutes.github.io/2015/11/30/degradome.html"/>
    <id>http://tiramisutes.github.io/2015/11/30/degradome.html</id>
    <published>2015-11-30T15:36:38.000Z</published>
    <updated>2018-09-28T02:32:45.309Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Degradome_sequencing">Degradome sequencing</h2><p>Degradome sequencing (Degradome-Seq),also referred to as parallel analysis of RNA ends (PARE),is a modified version of 5’-Rapid Amplification of cDNA Ends (RACE) using high-throughput, deep sequencing method using as Illumina’s SBS technology. Degradome sequencing provides a comprehensive means of analyzing patterns of RNA degradation.</p>
<p>Degradome sequencing has been used to identify microRNA (miRNA) cleavage sites,because miRNAs can cause endonucleolytic cleavage of mRNA by extensive and often perfect complementarity to mRNAs.Degradome sequencing revealed many known and novel plant miRNA (siRNA) targets. Recently, degradome sequencing also has been applied to identify animal (human and mouse) miRNA-derived cleavages.</p>
<h2 id="原理">原理</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/degradome.jpg" alt=""><br>在植物体内绝大多数的miRNA是利用剪切作用调控靶基因的表达，且剪切常发生在miRNA与mRNA互补区域的第十位核苷酸上。靶基因经剪切产生二个片段，5’ 剪切片段和3’ 剪切片段。其中3’ 剪切片段，包含有自由的5’ 单磷酸和3’ polyA尾巴，可被RNA连接酶连接，连接产物可用于下游高通量测序；而含有5’ 帽子结构的完整基因，含有帽子结构的5’ 剪切片段或是其他缺少5’ 单磷酸基团的RNA是无法被RNA酶连接的，因而无法进入下游的测序实验；对测序数据进行深入地比对分析，可以直观地发现在mRNA序列的某个位点会出现一个波峰，而该处正是候选的miRNA剪切位点。</p>
<h2 id="測序數據的分析方法">測序數據的分析方法</h2><p>測序數據使用賓州大學 Addo-Quaye 等建立CleaveLand 分析方法進行比對分析，可以直觀地發現在 mRNA 序列的某個位點會出現一個波峰，而該處正是候選的 miRNA 剪切位元點。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Degradome_sequencing&quot;&gt;Degradome sequencing&lt;/h2&gt;&lt;p&gt;Degradome sequencing (Degradome-Seq),also referred to as parallel analysis of RNA 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="degradome" scheme="http://tiramisutes.github.io/tags/degradome/"/>
    
  </entry>
  
  <entry>
    <title>Fluorescence in situ Hybridization(荧光原位杂交)</title>
    <link href="http://tiramisutes.github.io/2015/11/29/FISH.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/FISH.html</id>
    <published>2015-11-29T14:51:46.000Z</published>
    <updated>2018-09-28T02:34:48.391Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Multiplex_ViewRNA_FISH_Assay_in_Jurkat_and_HeLa_cells.jpg" alt=""></p>
<h2 id="简介">简介</h2><p>荧光原位杂交（fluorescence in situ hybridization，FISH）是在20世纪80年代末在放射性原位杂交技术的基础上发展起来的一种非放射性分子细胞遗传技术，以荧光标记取代同位素标记而形成的一种新的原位杂交方法。探针首先与某种介导分子（reporter molecule）结合，杂交后再通过免疫细胞化学过程连接上荧光染料。FISH的基本原理是将DNA（或RNA）探针用特殊的核苷酸分子标记，然后将探针直接杂交到染色体或DNA纤维切片上，再用与荧光素分子偶联的单克隆抗体与探针分子特异性结合来检测DNA序列在染色体或DNA纤维切片上的定性、定位、相对定量分析。FISH具有安全、快速、灵敏度高、探针能长期保存、能同时显示多种颜色等优点，不但能显示中期分裂相，还能显示于间期核。同时在荧光原位杂交基础上又发展了多彩色荧光原位杂交技术和染色质纤维荧光原位杂交技术.。</p>
<h2 id="Preparation_and_hybridization_process_–_DNA">Preparation and hybridization process – DNA</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/FISH.jpg" alt=""><br>First, a probe is constructed. The probe must be large enough to hybridize specifically with its target but not so large as to impede the hybridization process. The probe is tagged directly with fluorophores, with targets for antibodies or with biotin. Tagging can be done in various ways, such as nick translation, or PCR using tagged nucleotides.</p>
<p>Then, an interphase or metaphase chromosome preparation is produced. The chromosomes are firmly attached to a substrate, usually glass. Repetitive DNA sequences must be blocked by adding short fragments of DNA to the sample. The probe is then applied to the chromosome DNA and incubated for approximately 12 hours while hybridizing. Several wash steps remove all unhybridized or partially hybridized probes. The results are then visualized and quantified using a microscope that is capable of exciting the dye and recording images.</p>
<p>If the fluorescent signal is weak, amplification of the signal may be necessary in order to exceed the detection threshold of the microscope. Fluorescent signal strength depends on many factors such as probe labeling efficiency, the type of probe, and the type of dye. Fluorescently tagged antibodies or streptavidin are bound to the dye molecule. These secondary components are selected so that they have a strong signal.</p>
<h2 id="Difference_between_Southern_Blot_and_Fluorescence_in_situ_hybridization_(FISH)_?">Difference between Southern Blot and Fluorescence in situ hybridization (FISH) ?</h2><p>FISH is performed on intact chromosomes through interphase or metaphase.it doesnt need DNA extraction and is performed on microscopic slides. its a type of kariotyping.its use is to determine the chromosomal abberations(numerical and structural) of a patient.<br>But,in Southern blotting you should first extract DNA of the specimen then cleave it with a restriction enzyme and then run on gel electrophoresis. the next step is to blot the DNA on a membrane and hybridaze it with a labeled probe. the use of suthern blot is in detecting mutations and restriction length fragment polymorphysms.<br><i class="fa fa-volume-up"></i><span class="exturl" data-url="aHR0cHM6Ly9hbnN3ZXJzLnlhaG9vLmNvbS9xdWVzdGlvbi9pbmRleD9xaWQ9MjAxMjA2MTEwOTU1NDBBQTFZWGhs" title="https://answers.yahoo.com/question/index?qid=20120611095540AA1YXhl">https://answers.yahoo.com/question/index?qid=20120611095540AA1YXhl<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Multiplex_ViewRNA_FISH_Assay_in_Jurkat_and_HeLa_cells.jpg&quot; alt=&quot;&quot;
    
    </summary>
    
      <category term="molecular biology" scheme="http://tiramisutes.github.io/categories/molecular-biology/"/>
    
    
      <category term="FISH" scheme="http://tiramisutes.github.io/tags/FISH/"/>
    
  </entry>
  
  <entry>
    <title>R数据整形术之plyr</title>
    <link href="http://tiramisutes.github.io/2015/11/29/plyr.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/plyr.html</id>
    <published>2015-11-29T08:24:33.000Z</published>
    <updated>2018-09-28T02:42:04.167Z</updated>
    
    <content type="html"><![CDATA[<p>plyr包可以进行类似于数据透视表的操作，将数据分割成更小的数据，对分割后的数据进行些操作，最后把操作的结果汇总。<br>本文主要介绍以下内容：<br>Split-Aapply-Combine 原理介绍<br>baby_names的名字排名<br>求分段拟合的系数<br>部分其他函数介绍<br>在正式开始之前，请确保电脑上已经安装plyr，如果没有，通过install.packages()函数安装。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; require(plyr)  <span class="comment">#载入plyr包</span></span><br><span class="line">&gt; <span class="comment">##假设有美国新生婴儿的取名汇总，每一年，会统计男孩和女孩的取名情况，形成如下的一张表。baby_names数据集包含1880 ~ 2008年间的数据， 包含统计的年份(year)，新生婴儿的性别、名字、以及改名字的比例。</span></span><br><span class="line">&gt; baby_names&lt;-read.csv(<span class="string">"baby-names.csv"</span>)</span><br><span class="line">&gt; head(baby_names)</span><br><span class="line">  year    name  percent sex</span><br><span class="line">1 1880    John 0.081541 boy</span><br><span class="line">2 1880 William 0.080511 boy</span><br><span class="line">3 1880   James 0.050057 boy</span><br><span class="line">4 1880 Charles 0.045167 boy</span><br><span class="line">5 1880  George 0.043292 boy</span><br><span class="line">6 1880   Frank 0.027380 boy</span><br></pre></td></tr></table></figure></p>
<h2 id="以提问并解决问题的形式对plyr做介绍。">以提问并解决问题的形式对plyr做介绍。</h2><p>想知道数据集中，每年都有多少记录？<br>数据集中，男孩和女孩名的各自排名？<br>男孩名和女孩名各自排名前100在当年中的比例？<br>数据集中，每年都有多少记录<br>先假设我们有某一年的数据，我们会如何统计其中的记录数呢？由于数据集中，每条记录一行，只需要统计对应的行数就可以得到对应的记录数。<br>写个函数试试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; record_count &lt;- <span class="keyword">function</span>(df) &#123;</span><br><span class="line">+     <span class="built_in">return</span>(data.frame(count = nrow(df)))</span><br><span class="line">+ &#125;</span><br></pre></td></tr></table></figure></p>
<p>返回值类型是data.frame类型，是为即将介绍的ddply()函数做铺垫。先来看看2008年，数据集中有多少记录。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; baby_names_2008 &lt;- subset(baby_names, year == 2008)</span><br><span class="line">&gt; record_count(baby_names_2008)</span><br><span class="line">  count</span><br><span class="line">1  2000</span><br></pre></td></tr></table></figure></p>
<p>结果显示2000条，貌似我们已经得到答案。下面想想，该如何得到1880 ~ 2008这129年间，每年的记录数呢？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; baby_names_1880_2008&lt;-ddply(baby_names,     <span class="comment"># 数据集</span></span><br><span class="line">+                  .(year),        <span class="comment"># 分类的标准</span></span><br><span class="line">+                  record_count    <span class="comment"># 函数</span></span><br><span class="line">+                             )</span><br><span class="line">&gt; head(baby_names_1880_2008)</span><br><span class="line">  year count</span><br><span class="line">1 1880  2000</span><br><span class="line">2 1881  2000</span><br><span class="line">3 1882  2000</span><br><span class="line">4 1883  2000</span><br><span class="line">5 1884  2000</span><br><span class="line">6 1885  2000</span><br><span class="line">&gt; dim(baby_names_1880_2008)</span><br><span class="line">[1] 129   2</span><br></pre></td></tr></table></figure></p>
<p>ddply解释：<br>定义了一个负责计数的函数record_count()<br>调用ddply()，这里出现刚刚定义的函数<br>ddply()函数是plyr包中用于对data.frame结构的数据做处理的函数，其结果也是data.frame。ddply的参数列表如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ddply(.data, .variables, .fun = NULL, ..., .progress = <span class="string">"none"</span>,</span><br><span class="line">  .inform = FALSE, .drop = TRUE, .parallel = FALSE, .paropts = NULL)</span><br></pre></td></tr></table></figure></p>
<p>各部分解释如下<br>第一个参数是要操作的原始数据集，比如baby<em>name<br>第二个参数是按照某个（也可以几个）变量，对数据集分割，比如按照year对数据集分割，可以写成.(year)的形式<br>第三个参数是具体执行操作的函数，对分割后的每一个子数据集，调用该函数<br>第四个参数可选，表示第三个参数对应函数所需的额外参数<br>其他参数，可以暂时不用考虑。ddply()函数会自动的将分割后的每一小部分的计算结果汇总，以data.frame的格式保存。分割后的数据，是fun的第一个参数。<br>在上面的描述中，提到的分割、<em>_操作、汇总</em></em>，在plyr包中是一种处理方式(“frame”)，即”Split - Apply - Combine”。在plyr包中有很多这种处理方式的函数，在介绍这些函数之前，我们再来看看ddply()的一些更深入的用法。</p>
<h2 id="各年，男孩名与女孩名的各自排名">各年，男孩名与女孩名的各自排名</h2><p>以2008年的数据为例，男孩名”Jacob”的比例最高，排名应当是第一，”Michael”紧跟其后，排名应当第二，依此类推。对于女孩名，”Emma”排名第一，”Isabella”排名第二，”Emily”排名第三等等。我们希望得到这样的结果。</p>
<p>对于2008年的数据，可以通过简单的rank即可得到，不过要对男孩和女孩分别排序。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">baby_names_2008_boy &lt;- subset(baby_names_2008, sex == <span class="string">"boy"</span>) <span class="comment"># 获取男孩名</span></span><br><span class="line">baby_names_2008_boy<span class="variable">$rank</span> &lt;- rank(- baby_names_2008_boy<span class="variable">$percent</span>) <span class="comment"># 排序</span></span><br><span class="line">head(baby_names_2008_boy) <span class="comment"># 查看</span></span><br></pre></td></tr></table></figure></p>
<p>如何利用ddply()对原始数据集做相应的操作呢？这里需要介绍R语言中的一个函数transform()，该函数对原始数据集做一些操作，并把结果存储在原始数据中，更详细的用法，参见帮助文档?transform。</p>
<p>第一个版本的处理方式是这样的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ddply(baby_names, </span><br><span class="line">      .(year, sex), </span><br><span class="line">      transform, </span><br><span class="line">      rank = rank(-percent, ties.method = <span class="string">"first"</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>第二个参数有点变化，除了year，还有sex，这表示对baby_name数据集，对year和sex分类（类似于SQL中的group by year, sex）。<br>第四个参数是transform的额外参数，如果查看transform的帮助文档，其函数调用方式如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform(_data, ...)</span><br></pre></td></tr></table></figure></p>
<p>第一参数为操作的数据，在ddply()中为按年份和性别分割后的子数据集；后面的…参数是tag = value的形式，这种tag:value将追加在数据中。<br>由于rank默认对数据进行升序排序，若要实现逆序排序，常规的做法是将数据的符号取反，这也就是上面的rank函数中出现-percent的原因。在plyr中，有一个类似的函数，实现取反的操作，是desc。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- 1:10</span><br><span class="line">desc(x)</span><br><span class="line"><span class="comment"># -1  -2  -3  -4  -5  -6  -7  -8  -9 -10</span></span><br></pre></td></tr></table></figure></p>
<p>所以，上面对percent取反的操作，可以写得更优雅些，就有了第二个版本的函数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">baby_names &lt;- ddply(baby_names, </span><br><span class="line">                    .(year, sex), </span><br><span class="line">                    transform, </span><br><span class="line">                    rank = rank(desc(percent), ties.method = <span class="string">"first"</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>注意这里把结果赋给了baby_name，因为后面还会用到排名的信息，就把结果保存下来。</p>
<h2 id="排名前100的男孩名与女孩名在当年中的比例">排名前100的男孩名与女孩名在当年中的比例</h2><p>跟前一问类似，处理方法是：</p>
<p>把每年排名前100的数据筛选出来<br>把男孩和女孩对应的percent相加<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">baby_names_top100 &lt;- subset(baby_names, rank &lt;= 100)  <span class="comment"># 将前100排名的数据筛选出来</span></span><br><span class="line">baby_names_top100_trend &lt;- ddply(baby_names_top100, </span><br><span class="line">                                 .(year, sex), <span class="comment"># 按年和性别分割</span></span><br><span class="line">                                 summarize, <span class="comment"># 汇总数据</span></span><br><span class="line">                                 trend = sum(percent)) <span class="comment"># 汇总方式（求和）</span></span><br></pre></td></tr></table></figure></p>
<p>这里出现一个新的操作函数summarize()，该函数是对数据做汇总，与transform不一样的是，该函数并不追加结果到原始数据，而是产生新的数据集。比如想知道，2008年的男孩名中，排名最高和最低的名字的百分比之差，可以通过如下方式求得：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">summarize(baby_names_2008_boy, trend = max(percent) - min(percent))</span><br><span class="line"><span class="comment"># 0.010266</span></span><br></pre></td></tr></table></figure></p>
<p>回到刚才的问题，从1880 ~ 2008年间，男孩名与女孩名的前100所占比例（可以衡量名字大众化的程度）到底是什么样的呢？画个图就知道了。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ddply.jpeg" alt=""><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5qaWFuc2h1LmNvbS9wL2JmZGRmZTI5YWEzOQ==" title="http://www.jianshu.com/p/bfddfe29aa39">http://www.jianshu.com/p/bfddfe29aa39<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;plyr包可以进行类似于数据透视表的操作，将数据分割成更小的数据，对分割后的数据进行些操作，最后把操作的结果汇总。&lt;br&gt;本文主要介绍以下内容：&lt;br&gt;Split-Aapply-Combine 原理介绍&lt;br&gt;baby_names的名字排名&lt;br&gt;求分段拟合的系数&lt;br&gt;部
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="plyr" scheme="http://tiramisutes.github.io/tags/plyr/"/>
    
  </entry>
  
  <entry>
    <title>R数据整形术之reshape2</title>
    <link href="http://tiramisutes.github.io/2015/11/29/reshape2.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/reshape2.html</id>
    <published>2015-11-29T07:23:03.000Z</published>
    <updated>2018-09-28T02:43:16.200Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数据类型">数据类型</h2><p>宽数据<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#   ozone   wind  temp</span></span><br><span class="line"><span class="comment"># 1 23.62 11.623 65.55</span></span><br><span class="line"><span class="comment"># 2 29.44 10.267 79.10</span></span><br><span class="line"><span class="comment"># 3 59.12  8.942 83.90</span></span><br><span class="line"><span class="comment"># 4 59.96  8.794 83.97</span></span><br></pre></td></tr></table></figure></p>
<p>长数据<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#    variable  value</span></span><br><span class="line"><span class="comment"># 1     ozone 23.615</span></span><br><span class="line"><span class="comment"># 2     ozone 29.444</span></span><br><span class="line"><span class="comment"># 3     ozone 59.115</span></span><br><span class="line"><span class="comment"># 4     ozone 59.962</span></span><br><span class="line"><span class="comment"># 5      wind 11.623</span></span><br><span class="line"><span class="comment"># 6      wind 10.267</span></span><br><span class="line"><span class="comment"># 7      wind  8.942</span></span><br><span class="line"><span class="comment"># 8      wind  8.794</span></span><br><span class="line"><span class="comment"># 9      temp 65.548</span></span><br><span class="line"><span class="comment"># 10     temp 79.100</span></span><br><span class="line"><span class="comment"># 11     temp 83.903</span></span><br><span class="line"><span class="comment"># 12     temp 83.968</span></span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-desktop"></i>长数据有一列数据是变量的类型，有一列是变量的值。长数据不一定只有两列。ggplot2需要长类型的数据，plyr也需要长类型的数据，大多数的模型(比如lm(), glm()以及gam())也需要长数据。</p>
<h2 id="reshape2_包">reshape2 包</h2><p>reshape2 用得比较多的是melt和cast两个函数。</p>
<p>melt函数对宽数据进行处理，得到长数据；<br>cast函数对长数据进行处理，得到宽数据；</p>
<h2 id="melt函数">melt函数</h2><p>melt(参数)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">melt(data,id.vars,measure.vars,</span><br><span class="line">    variable.name = <span class="string">"variable"</span>, ..., na.rm = FALSE,</span><br><span class="line">    value.name = <span class="string">"value"</span>)</span><br></pre></td></tr></table></figure></p>
<p>其中id.vars可以指定一系列变量，然后measure.vars就可以留空了，这样生成的新数据会保留id.vars的所有列，然后增加两个新列：variable和value，一个存储变量的名称一个存储变量值。<br>此处用R内置的airquality数据集<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(airquality)</span><br><span class="line">  Ozone Solar.R Wind Temp Month Day</span><br><span class="line">1    41     190  7.4   67     5   1</span><br><span class="line">2    36     118  8.0   72     5   2</span><br><span class="line">3    12     149 12.6   74     5   3</span><br><span class="line">4    18     313 11.5   62     5   4</span><br><span class="line">5    NA      NA 14.3   56     5   5</span><br><span class="line">6    28      NA 14.9   66     5   6</span><br></pre></td></tr></table></figure></p>
<p>首先将列名改成小写，然后查看相应的数据<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&gt; names(airquality)&lt;- tolower(names(airquality))</span><br><span class="line">&gt; head(airquality)</span><br><span class="line">  ozone solar.r wind temp month day</span><br><span class="line">1    41     190  7.4   67     5   1</span><br><span class="line">2    36     118  8.0   72     5   2</span><br><span class="line">3    12     149 12.6   74     5   3</span><br><span class="line">4    18     313 11.5   62     5   4</span><br><span class="line">5    NA      NA 14.3   56     5   5</span><br><span class="line">6    28      NA 14.9   66     5   6</span><br><span class="line"><span class="comment">##直接用metl函数处理上述的数据</span></span><br><span class="line">&gt; library(<span class="string">"reshape2"</span>)</span><br><span class="line">&gt; aql &lt;- melt(airquality)</span><br><span class="line">No id variables; using all as measure variables</span><br><span class="line">&gt; head(aql)</span><br><span class="line">  variable value</span><br><span class="line">1    ozone    41</span><br><span class="line">2    ozone    36</span><br><span class="line">3    ozone    12</span><br><span class="line">4    ozone    18</span><br><span class="line">5    ozone    NA</span><br><span class="line">6    ozone    28</span><br><span class="line">&gt; tail(aql)</span><br><span class="line">    variable value</span><br><span class="line">913      day    25</span><br><span class="line">914      day    26</span><br><span class="line">915      day    27</span><br><span class="line">916      day    28</span><br><span class="line">917      day    29</span><br><span class="line">918      day    30</span><br></pre></td></tr></table></figure></p>
<p>默认情况下，melt认为所有数值列的变量均有值。很多情况下，这都是我们想要的情况。在这里，我们想知道每个月(month)以及每天(day)的ozone, solar.r, wind以及temp的值。因此，我们需要告诉melt，month和day是”ID variables”。ID variables就是那些能够区分不同行数据的变量，个人感觉类似于数据库中的主键。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; aql &lt;- melt(airquality, id.vars = c(<span class="string">"month"</span>, <span class="string">"day"</span>))</span><br><span class="line">&gt; head(aql)</span><br><span class="line">  month day variable value</span><br><span class="line">1     5   1    ozone    41</span><br><span class="line">2     5   2    ozone    36</span><br><span class="line">3     5   3    ozone    12</span><br><span class="line">4     5   4    ozone    18</span><br><span class="line">5     5   5    ozone    NA</span><br><span class="line">6     5   6    ozone    28</span><br></pre></td></tr></table></figure></p>
<p>如果我们想修改长数据中的列名，该如何操作呢?<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; aql &lt;- melt(airquality, id.vars = c(<span class="string">"month"</span>, <span class="string">"day"</span>),</span><br><span class="line">+             variable.name = <span class="string">"climate_variable"</span>, </span><br><span class="line">+             value.name = <span class="string">"climate_value"</span>)</span><br><span class="line">&gt; head(aql)</span><br><span class="line">  month day climate_variable climate_value</span><br><span class="line">1     5   1            ozone            41</span><br><span class="line">2     5   2            ozone            36</span><br><span class="line">3     5   3            ozone            12</span><br><span class="line">4     5   4            ozone            18</span><br><span class="line">5     5   5            ozone            NA</span><br><span class="line">6     5   6            ozone            28</span><br></pre></td></tr></table></figure></p>
<h2 id="cast函数">cast函数</h2><p>从宽格式数据变换到长格式的数据比较直观，然后反过来则需要一些二外的功夫。</p>
<p>在reshape2中有好几个cast版本的函数。若你经常使用data.frame，就需要使用dcast函数。acast函数返回向量、矩阵或者数组。</p>
<p>dcast借助于公式来描述数据的形状，左边参数表示”ID variables”，而右边的参数表示measured variables。可能需要几次尝试，才能找到合适的公式。</p>
<p>这里，我们需要告知dcast，month和day是ID variables，variable则表示measured variables。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; aql &lt;- melt(airquality, id.vars = c(<span class="string">"month"</span>, <span class="string">"day"</span>))</span><br><span class="line">&gt; aqw &lt;- dcast(aql, month + day ~ variable)</span><br><span class="line">&gt; head(aqw)</span><br><span class="line">  month day ozone solar.r wind temp</span><br><span class="line">1     5   1    41     190  7.4   67</span><br><span class="line">2     5   2    36     118  8.0   72</span><br><span class="line">3     5   3    12     149 12.6   74</span><br><span class="line">4     5   4    18     313 11.5   62</span><br><span class="line">5     5   5    NA      NA 14.3   56</span><br><span class="line">6     5   6    28      NA 14.9   66</span><br><span class="line">&gt; head(airquality) <span class="comment"># 与原始数据比较</span></span><br><span class="line">  ozone solar.r wind temp month day</span><br><span class="line">1    41     190  7.4   67     5   1</span><br><span class="line">2    36     118  8.0   72     5   2</span><br><span class="line">3    12     149 12.6   74     5   3</span><br><span class="line">4    18     313 11.5   62     5   4</span><br><span class="line">5    NA      NA 14.3   56     5   5</span><br><span class="line">6    28      NA 14.9   66     5   6</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-pencil-square"></i>If it isn’t clear to you what just happened there, then have a look at this illustration:<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/dcast-illustration.png" alt=""><br><i class="fa fa-bars"></i>蓝色阴影块是能够表示每一行数据的ID variables；红色阴影块包含了将待生成数据的列名；而灰色的数据表示用于填充相关区域的数据。<br><i class="fa fa-user-times"></i>令人产生疑惑的情况往往是，一个数据单元有一个以上的数据。比如，我们的ID variables不包含day，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; dcast(aql, month ~ variable)</span><br><span class="line">Aggregation <span class="keyword">function</span> missing: defaulting to length</span><br><span class="line">  month ozone solar.r wind temp</span><br><span class="line">1     5    31      31   31   31</span><br><span class="line">2     6    30      30   30   30</span><br><span class="line">3     7    31      31   31   31</span><br><span class="line">4     8    31      31   31   31</span><br><span class="line">5     9    30      30   30   30</span><br></pre></td></tr></table></figure></p>
<p>再次查看dcast的输出数据，可以看到每个单元是month与climate组合的个数。所得到数据是month对应的day的记录数。当每个单元有多个数据是，需要告诉dcast如何聚合(aggregate)这些数据，比如取均值(mean)，计算中位数(median)，或者简单的求和(sum)。比如，在这里，我们简单的计算下均值，同时通过na.rm = TRUE删除NA值。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; dcast(aql, month ~ variable, fun.aggregate = mean, na.rm = TRUE)</span><br><span class="line">  month    ozone  solar.r      wind     temp</span><br><span class="line">1     5 23.61538 181.2963 11.622581 65.54839</span><br><span class="line">2     6 29.44444 190.1667 10.266667 79.10000</span><br><span class="line">3     7 59.11538 216.4839  8.941935 83.90323</span><br><span class="line">4     8 59.96154 171.8571  8.793548 83.96774</span><br><span class="line">5     9 31.44828 167.4333 10.180000 76.90000</span><br></pre></td></tr></table></figure></p>
<h2 id="Additional_help">Additional help</h2><p>Read the package help:<br><code>help(package = &quot;reshape2&quot;)</code></p>

<p>See the <code>reshape2</code> website:<br><span class="exturl" data-url="aHR0cDovL2hhZC5jby5uei9yZXNoYXBlLw==" title="http://had.co.nz/reshape/">http://had.co.nz/reshape/<i class="fa fa-external-link"></i></span></p>

<p>And read the paper on <code>reshape</code>:<br>Wickham, H. (2007). Reshaping data with the <code>reshape</code> package.<br>21(12):1–20.<br><span class="exturl" data-url="aHR0cDovL3d3dy5qc3RhdHNvZnQub3JnL3YyMS9pMTI=" title="http://www.jstatsoft.org/v21/i12">http://www.jstatsoft.org/v21/i12<i class="fa fa-external-link"></i></span><br><br>(But note that the paper is written for the <code>reshape</code> package not the<br><code>reshape2</code> package.)</p>

]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;数据类型&quot;&gt;数据类型&lt;/h2&gt;&lt;p&gt;宽数据&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span clas
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="reshape2" scheme="http://tiramisutes.github.io/tags/reshape2/"/>
    
  </entry>
  
  <entry>
    <title>Linux常用命令之find</title>
    <link href="http://tiramisutes.github.io/2015/11/29/find.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/find.html</id>
    <published>2015-11-29T07:14:58.000Z</published>
    <updated>2016-03-21T04:17:01.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="想查看当前文件夹及子文件夹里有没有文件名为”abc”的文件">想查看当前文件夹及子文件夹里有没有文件名为”abc”的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -name abc</span></span><br></pre></td></tr></table></figure>
<p><code>.</code> ：表示当前目录</p>
<p>-name：表示要根据名称查找</p>
<h2 id="想查看当前文件夹及子文件夹里有没有”xyz”目录">想查看当前文件夹及子文件夹里有没有”xyz”目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -type d -name xyz</span></span><br></pre></td></tr></table></figure>
<p>-type：表示设定类型，d表示文件夹类型，可以替换为f(普通文件)、l(链接文件)</p>
<h2 id="想找出当前文件夹及子文件夹里所有后缀是”-txt”的文件">想找出当前文件夹及子文件夹里所有后缀是”.txt”的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -name "*.txt"</span></span><br></pre></td></tr></table></figure>
<h2 id="想查找当前目录及其子文件夹中”roc”用户自己的文件有哪些">想查找当前目录及其子文件夹中”roc”用户自己的文件有哪些</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -user roc</span></span><br></pre></td></tr></table></figure>
<p>-user：用于设定所属用户的名称，此处可替换为-group，即所属用户组的名称</p>
<h2 id="想查找当前文件夹及子文件夹里权限设定为755的所有文件">想查找当前文件夹及子文件夹里权限设定为755的所有文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -perm 755</span></span><br></pre></td></tr></table></figure>
<p>-perm：用于设定权限</p>
<h2 id="想查找当前文件夹及子文件夹里的同时含有b字符和3字符的文件：用到正则表达式技术">想查找当前文件夹及子文件夹里的同时含有b字符和3字符的文件：用到正则表达式技术</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -regex '.*b.*3'</span></span><br></pre></td></tr></table></figure>
<p>-regex：表示使用正则表达式进行匹配。请注意，此命令会和”全路径”进行匹配，也就是说前面要加.*，因为输出结果中会有”./“符号。</p>
<h2 id="如果想全部输出用find命令查找出的”*-abc”文件的内容">如果想全部输出用find命令查找出的”*.abc”文件的内容</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -type f -name "*.abc" -exec cat &#123;&#125; \;</span></span><br></pre></td></tr></table></figure>
<p>-exec 表示由find找到的匹配项会作为”-exec后面设定的命令”的参数</p>
<p>可以使用-ok代替-exec，这样对每个匹配项进行操作，都会要求用户确认（y为是，n为否）</p>
<p>命令最后的{} \; 别忘了写，其中{}代表用find查找到的结果中的每一个查找项。</p>
<h2 id="查找当前目录下在5分钟内被访问过的文件">查找当前目录下在5分钟内被访问过的文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -amin -5</span></span><br></pre></td></tr></table></figure>
<p>访问过用amin，修改过用mmin，文件状态改变过用cmin</p>
<p>精确到分钟的用amin,mmin,cmin，精确到天的用atime,mtime,ctime</p>
<p>在5分钟之内的用-5，在5分钟以上的用＋5</p>
<h2 id="想查找当前目录及子目录下文件大小大于10M的所有文件">想查找当前目录及子目录下文件大小大于10M的所有文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -size +10000000c</span></span><br></pre></td></tr></table></figure>
<p>-size：表示文件大小，＋表示大于某个数，－表示小于某个数。c表示单位是字节，你可以将c换成k,M,G。</p>
<h2 id="上述所有的find命令都是查找当前目录及其子目录。如果不想深入到子目录中，而是只查找当前一层目录，则可以：">上述所有的find命令都是查找当前目录及其子目录。如果不想深入到子目录中，而是只查找当前一层目录，则可以：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find . -maxdepth 1 -name "*.c"</span></span><br></pre></td></tr></table></figure>
<p></p><p></p><br>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3JvY2xpbnV4LmNuLz9wPTE4" title="http://roclinux.cn/?p=18">http://roclinux.cn/?p=18<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;想查看当前文件夹及子文件夹里有没有文件名为”abc”的文件&quot;&gt;想查看当前文件夹及子文件夹里有没有文件名为”abc”的文件&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="find" scheme="http://tiramisutes.github.io/tags/find/"/>
    
  </entry>
  
  <entry>
    <title>Linux常用命令之cut</title>
    <link href="http://tiramisutes.github.io/2015/11/29/cut.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/cut.html</id>
    <published>2015-11-29T06:55:55.000Z</published>
    <updated>2017-04-18T02:55:06.540Z</updated>
    
    <content type="html"><![CDATA[<h2 id="定位">定位</h2><p>cut命令主要是接受三个定位方法：</p>
<h3 id="第一，字节（bytes），用选项-b"><i class="fa fa-ship"></i>第一，字节（bytes），用选项<code>-b</code></h3><p>-b支持形如3-5的写法，而且多个定位之间用逗号隔开就成了,如：3-5，7<br>但有一点要注意，cut命令如果使用了-b选项，那么执行此命令时，cut会先把-b后面所有的定位进行从小到大排序，然后再提取<br>-3表示从第一个字节到第三个字节，而3-表示从第三个字节到行尾</p>
<h3 id="第二，字符（characters），用选项-c"><i class="fa fa-train"></i>第二，字符（characters），用选项<code>-c</code></h3><p>主要用于提取中文操作</p>
<h3 id="第三，域（fields），用选项-f"><i class="fa fa-fighter-jet"></i>第三，域（fields），用选项<code>-f</code></h3><p>为什么会有”域”的提取呢，因为刚才提到的-b和-c只能在固定格式的文档中提取信息，而对于非固定格式的信息则束手无策。这时候”域”就派上用场了。<br>-d  来设置间隔符<br><i class="fa fa-comments"></i>如果遇到空格和制表符时，怎么分辨呢？<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat tab_space.txt</span><br><span class="line"><span class="keyword">this</span> <span class="keyword">is</span> tab	finish.</span><br><span class="line"><span class="keyword">this</span> <span class="keyword">is</span> several space      finish.</span><br><span class="line">$ sed -n l tab_space.txt</span><br><span class="line"><span class="keyword">this</span> <span class="keyword">is</span> tab\tfinish.$</span><br><span class="line"><span class="keyword">this</span> <span class="keyword">is</span> several space      finish.$</span><br></pre></td></tr></table></figure></p>
<p>看到了吧，如果是制表符（TAB），那么会显示为\t符号，如果是空格，就会原样显示。<br>通过此方法即可以判断制表符和空格了。<br>注意，上面<code>sed -n</code>后面的字符是<code>L</code>的小写字母，不要看错。</p>
<h2 id="取反">取反</h2><p><code>--complement：补足被选择的字节、字符或字段；</code><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cut -f2 --complement dddd </span><br><span class="line"><span class="number">1</span>       <span class="number">3</span></span><br><span class="line">$  cat dddd </span><br><span class="line"><span class="number">1</span>       <span class="number">2</span>       <span class="number">3</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;定位&quot;&gt;定位&lt;/h2&gt;&lt;p&gt;cut命令主要是接受三个定位方法：&lt;/p&gt;
&lt;h3 id=&quot;第一，字节（bytes），用选项-b&quot;&gt;&lt;i class=&quot;fa fa-ship&quot;&gt;&lt;/i&gt;第一，字节（bytes），用选项&lt;code&gt;-b&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;-b支
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="cut" scheme="http://tiramisutes.github.io/tags/cut/"/>
    
  </entry>
  
  <entry>
    <title>Linux常用命令之sort强悍参数“k”</title>
    <link href="http://tiramisutes.github.io/2015/11/29/sort-k.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/sort-k.html</id>
    <published>2015-11-29T06:33:06.000Z</published>
    <updated>2019-12-05T09:21:21.520Z</updated>
    
    <content type="html"><![CDATA[<h2 id="准备素材">准备素材</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cat facebook.txt</span><br><span class="line">google 110 5000</span><br><span class="line">baidu 100 5000</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br></pre></td></tr></table></figure>
<p>第一个域是公司名称，第二个域是公司人数，第三个域是员工平均工资。</p>
<h2 id="排序">排序</h2><p><i class="fa fa-gavel"></i>让这个文件按公司的字母顺序排序，也就是按第一个域进行排序：（这个facebook.txt文件有三个域）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -t <span class="string">' '</span> -k 1 facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br></pre></td></tr></table></figure></p>
<p>看到了吧，就直接用-k 1设定就可以了。（其实此处并不严格，稍后你就会知道）<br><strong>若数据存在表头，而我们一般不需要对表头排序，但是又希望排序后表头依然存在，该如何操作呢？</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## if you have two header lines and want to keep both of them:</span></span><br><span class="line">(sed -n <span class="string">'1,2p'</span> your_file; cat your_file | sed <span class="string">'1,2d'</span> | sort) &gt; sort_header.txt</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-gavel"></i>让facebook.txt按照公司人数排序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -t <span class="string">' '</span> -k 2 facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">baidu 100 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p>但是，此处出现了问题，那就是baidu和sohu的公司人数相同，都是100人，这个时候怎么办呢？按照默认规矩，是从第一个域开始进行升序排序，因此baidu排在了sohu前面。<br><i class="fa fa-gavel"></i>让facebook.txt按照公司人数排序 ，人数相同的按照员工平均工资升序排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -t <span class="string">' '</span> -k 2 -k 3 facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p>加了一个-k2 -k3就解决了问题,sort支持这种设定，就是说设定域排序的优先级，先以第2个域进行排序，如果相同，再以第3个域进行排序。（如果你愿意，可以一直这么写下去，设定很多个排序优先级）<br><i class="fa fa-gavel"></i>让facebook.txt按照员工工资降序排序，如果员工人数相同的，则按照公司人数升序排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -t <span class="string">' '</span> -k 3r -k 2 facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">guge 50 3000</span><br></pre></td></tr></table></figure></p>
<p>此处有使用了一些小技巧，你仔细看看，在-k 3后面偷偷加上了一个小写字母r,r和-r选项的作用是一样的，就是表示逆序。因为sort默认是按照升序排序的，所以此处需要加上r表示第三个域（员工平均工资）是按照降序排序。此处你还可以加上n，就表示对这个域进行排序时，要按照数值大小进行排序，举个例子吧：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -t <span class="string">' '</span> -k 3nr -k 2n facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">guge 50 3000</span><br></pre></td></tr></table></figure></p>
<p>看，我们去掉了最前面的-n选项，而是将它加入到了每一个-k选项中了。</p>
<p><i class="fa fa-gavel"></i> -k选项的具体语法格式</p>
<p>要继续往下深入的话，就不得不来点理论知识。你需要了解-k选项的语法格式，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ FStart [ .CStart ] ] [ Modifier ] [ , [ FEnd [ .CEnd ] ][ Modifier ] ]</span><br></pre></td></tr></table></figure></p>
<p>这个语法格式可以被其中的逗号（”，”）分为两大部分，Start部分和End部分。</p>
<p>先给你灌输一个思想，那就是”如果不设定End部分，那么就认为End被设定为行尾”。这个概念很重要的，但往往你不会重视它。</p>
<p>Start部分也由三部分组成，其中的Modifier部分就是我们之前说过的类似n和r的选项部分。我们重点说说Start部分的FStart和C.Start。</p>
<p>C.Start也是可以省略的，省略的话就表示从本域的开头部分开始。之前例子中的-k 2和-k 3就是省略了C.Start的例子喽。</p>
<p>FStart.CStart，其中FStart就是表示使用的域，而CStart则表示在FStart域中从第几个字符开始算”排序首字符”。</p>
<p>同理，在End部分中，你可以设定FEnd.CEnd，如果你省略.CEnd，则表示结尾到”域尾”，即本域的最后一个字符。或者，如果你将CEnd设定为0(零)，也是表示结尾到”域尾”。</p>
<p><i class="fa fa-gavel"></i>从公司英文名称的第二个字母开始进行排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -t <span class="string">' '</span> -k 1.2 facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">google 110 5000</span><br><span class="line">guge 50 3000</span><br></pre></td></tr></table></figure></p>
<p>使用了-k 1.2，这就表示对第一个域的第二个字符开始到本域的最后一个字符为止的字符串进行排序。你会发现baidu因为第二个字母是a而名列榜首。sohu和google第二个字符都是o，但sohu的h在google的o前面，所以两者分别排在第二和第三。guge只能屈居第四了。</p>
<p><i class="fa fa-gavel"></i>只针对公司英文名称的第二个字母进行排序，如果相同的按照员工工资进行降序排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -t <span class="string">' '</span> -k 1.2,1.2 -k 3,3nr facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">guge 50 3000</span><br></pre></td></tr></table></figure></p>
<p>由于只对第二个字母进行排序，所以我们使用了-k 1.2,1.2的表示方式，表示我们”只”对第二个字母进行排序。（如果你问”我使用-k 1.2怎么不行？”，当然不行，因为你省略了End部分，这就意味着你将对从第二个字母起到本域最后一个字符为止的字符串进行排序）。对于员工工资进行排序，我们也使用了-k 3,3，这是最准确的表述，表示我们”只”对本域进行排序，因为如果你省略了后面的3，就变成了我们”对第3个域开始到最后一个域位置的内容进行排序”了。</p>
<p><i class="fa fa-gavel"></i>在modifier部分还可以用到哪些选项？</p>
<p>可以用到b、d、f、i、n 或 r。</p>
<p>其中n和r你肯定已经很熟悉了。</p>
<p>b表示忽略本域的签到空白符号。</p>
<p>d表示对本域按照字典顺序排序（即，只考虑空白和字母）。</p>
<p>f表示对本域忽略大小写进行排序。</p>
<p>i表示忽略”不可打印字符”，只针对可打印字符进行排序。（有些ASCII就是不可打印字符，比如\a是报警，\b是退格，\n是换行，\r是回车等等）</p>
<p><i class="fa fa-gavel"></i>思考关于-k和-u联合使用的例子：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cat facebook.txt</span><br><span class="line">google 110 5000</span><br><span class="line">baidu 100 5000</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br></pre></td></tr></table></figure></p>
<p>这是最原始的facebook.txt文件。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -k 2 facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">baidu 100 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">google 110 5000</span><br><span class="line">$ sort -n -k 2 -u facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p>当设定以公司员工域进行数值排序，然后加-u后，sohu一行就被删除了！原来-u只识别用-k设定的域，发现相同，就将后续相同的行都删除。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ sort  -k 1 -u facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br><span class="line"></span><br><span class="line">$ sort  -k 1.1,1.1 -u facebook.txt</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br><span class="line">sohu 100 4500</span><br></pre></td></tr></table></figure></p>
<p>这个例子也同理，开头字符是g的guge就没有幸免于难。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -k 2 -k 3 -u facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p>咦！这里设置了两层排序优先级的情况下，使用-u就没有删除任何行。原来-u是会权衡所有-k选项，将都相同的才会删除，只要其中有一级不同都不会轻易删除的:)（不信，你可以自己加一行sina 100 4500试试看）</p>
<p><i class="fa fa-heartbeat"></i>最诡异的排序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -k 2.2,3.1 facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">baidu 100 5000</span><br><span class="line">sohu 100 4500</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p>以第二个域的第二个字符开始到第三个域的第一个字符结束的部分进行排序。</p>
<p>第一行，会提取0 3，第二行提取00 5，第三行提取00 4，第四行提取10 5。</p>
<p>又因为sort认为0小于00小于000小于0000….</p>
<p>因此0 3肯定是在第一个。10 5肯定是在最后一个。但为什么00 5却在00 4前面呢？（你可以自己做实验思考一下。）</p>
<p>答案揭晓：原来”跨域的设定是个假象”，sort只会比较第二个域的第二个字符到第二个域的最后一个字符的部分，而不会把第三个域的开头字符纳入比较范围。当发现00和00相同时，sort就会自动比较第一个域去了。当然baidu在sohu前面了。用一个范例即可证实：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort -n -k 2.2,3.1 -k 1,1r facebook.txt</span><br><span class="line">guge 50 3000</span><br><span class="line">sohu 100 4500</span><br><span class="line">baidu 100 5000</span><br><span class="line">google 110 5000</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-times"></i>有时候在sort命令后会看到+1 -2这些符号，这是什么东东？</p>
<p>关于这种语法，最新的sort是这么进行解释的：</p>
<p>On older systems, <code>sort&#39; supports an obsolete origin-zero syntax</code>+POS1 [-POS2]’ for specifying sort keys.  POSIX 1003.1-2001 (*note Standards conformance::) does not allow this; use `-k’ instead.</p>
<p>原来，这种古老的表示方式已经被淘汰了，以后可以理直气壮的鄙视使用这种表示方法的脚本喽！</p>
<p>（为了防止古老脚本的存在，在这再说一下这种表示方法，加号表示Start部分，减号表示End部分。最最重要的一点是，这种方式方法是从0开始计数的，以前所说的第一个域，在此被表示为第0个域。以前的第2个字符，在此表示为第1个字符.）</p>
<h2 id="其他有用参数">其他有用参数</h2><h3 id="V(大写)：聪明的字母和数字排序">V(大写)：聪明的字母和数字排序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cat example2.bed</span><br><span class="line">chr2    15      19</span><br><span class="line">chr22   32      46</span><br><span class="line">chr10   31      47</span><br><span class="line">chr1    34      49</span><br><span class="line">chr11   6       16</span><br><span class="line">chr2    17      22</span><br><span class="line">chr2    27      46</span><br><span class="line">chr10   30      42</span><br><span class="line">$ sort -k1,1 -k2,2n example2.bed</span><br><span class="line">chr1    34      49</span><br><span class="line">chr10   30      42</span><br><span class="line">chr10   31      47</span><br><span class="line">chr11   6       16</span><br><span class="line">chr2    15      19</span><br><span class="line">chr2    17      22</span><br><span class="line">chr2    27      46</span><br><span class="line">chr22   32      46</span><br><span class="line">$ sort -k1,1V -k2,2n example2.bed</span><br><span class="line">chr1    34      49</span><br><span class="line">chr2    15      19</span><br><span class="line">chr2    17      22</span><br><span class="line">chr2    27      46</span><br><span class="line">chr10   30      42</span><br><span class="line">chr10   31      47</span><br><span class="line">chr11   6       16</span><br><span class="line">chr22   32      46</span><br></pre></td></tr></table></figure>
<p><strong>V is only for GNU sort which will sort chromsome in alpha-numeric order。</strong></p>
<h2 id="设置临时目录">设置临时目录</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-T, <span class="attribute">--temporary-directory</span>=DIR</span><br><span class="line">             use DIR <span class="keyword">for</span> temporaries, <span class="keyword">not</span> <span class="variable">$TMPDIR</span> <span class="keyword">or</span> /tmp; multiple options specify multiple directories</span><br></pre></td></tr></table></figure>
<p>因为sort命令默认临时文件目录为”/tmp”，在sort执行过程中，如果产生的临时文件过大会导致”/tmp”目录被占满的。</p>
<p></p><p></p><br>Contribution from ：<br>本原创文章属于《Linux大棚》博客，博客地址为<span class="exturl" data-url="aHR0cDovL3JvY2xpbnV4LmNu44CC5paH56ug5L2c6ICF5Li6cm9jcm9ja2V044CC" title="http://roclinux.cn。文章作者为rocrocket。">http://roclinux.cn。文章作者为rocrocket。<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;准备素材&quot;&gt;准备素材&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="sort" scheme="http://tiramisutes.github.io/tags/sort/"/>
    
  </entry>
  
  <entry>
    <title>sed：流编辑器(stream editor)简单总结</title>
    <link href="http://tiramisutes.github.io/2015/11/29/sed.html"/>
    <id>http://tiramisutes.github.io/2015/11/29/sed.html</id>
    <published>2015-11-29T05:29:36.000Z</published>
    <updated>2018-09-28T02:44:00.678Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sed.jpg" alt=""></p>
<h2 id="Sed简介">Sed简介</h2><p>sed 是一种在线编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为”模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有 改变，除非你使用重定向存储输出。</p>
<h2 id="sed命令形式">sed命令形式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed [options] <span class="string">'command'</span> file(s)    </span><br><span class="line">sed [options] -f scriptfile file(s)</span><br></pre></td></tr></table></figure>
<h2 id="sed_command">sed command</h2><p><i class="fa fa-bicycle"></i>command部分可以分为两部分，一部分是确定范围部分，一部分是处理方式部分。</p>
<h3 id="确定范围部分">确定范围部分</h3><p>1 指定行数：例如3,5表示第3、第4和第5行；5,$表示第5行至最后一行；<br>2 用模式匹配进行指定：例如/^[^dD]/表示匹配行首不是以d或D开头的行等；</p>
<h3 id="处理方式部分呢，有很多命令可用，介绍几个最常用的：">处理方式部分呢，有很多命令可用，介绍几个最常用的：</h3><p>d 表示删除行<br>p 打印该行<br>r 读取指定文件的内容<br>w 写入指定文件sed ‘/200[4-6]/w new.txt’ mysed.txt（w new.txt表示将来源于mysed.txt中含有2004、2005、2006的行写入到new.txt文件中）<br>a\ 在特定行”下面”插入特定内容sed ‘/2004/a\China’ mysed.txt<br>i\ 在特定行”上面”插入特定内容sed ‘/2004/i\China’ mysed.txt<br>y  就表示将第一栏的每个字符都替换为相对应的第二栏的字符sed ‘y/eijng/EIJNG/‘ mysed.txt<br>n; 对匹配行的下一行进行处理sed ‘/2004/{n;y/eijng/EIJNG/;}’ mysed.txt  (找含有2004的行，然后将它下面的一行中的eijng替换为大写的EIJNG。这里面的”n;”起到了”移至下一行”的作用。n背后的含义其实是将下一行放到模式空间中去)</p>
<h2 id="sed选项">sed选项</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-e <span class="built_in">command</span>, --expression=<span class="built_in">command</span>  允许多台编辑，sed -n -e <span class="string">'1,2p'</span> -e <span class="string">'4p'</span> mysed.txt </span><br><span class="line">-h, --<span class="built_in">help</span>                        打印帮助，并显示bug列表的地址。  </span><br><span class="line">-n, --quiet, --silent             取消默认输出（默认为全输出）,-n之后只输出后面处理过的行。  </span><br><span class="line">-f, --filer=script-file           引导sed脚本文件名。  </span><br><span class="line">-V, --version                     打印版本和版权信息。</span><br><span class="line">-r, --regexp-extended             使用扩展的正则表达式，如果不用r参数就要在正则表达式里使用很多的\来进行强制转换，如果使用r了就可以直接写正则表达式，而不用写那么多\了</span><br></pre></td></tr></table></figure>
<h2 id="sed元字符集">sed元字符集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">^  锚定行的开始 如：/^sed/匹配所有以sed开头的行。  </span><br><span class="line">$  锚定行的结束 如：/sed$/匹配所有以sed结尾的行。 </span><br><span class="line">.  匹配一个非换行符的字符 如：/s.d/匹配s后接一个任意字符，然后是d。</span><br><span class="line">*  匹配零或多个字符 如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。</span><br><span class="line">[] 匹配一个指定范围内的字符，如/[Ss]ed/匹配sed和Sed。  </span><br><span class="line">[^]匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。  </span><br><span class="line">\(..\) 保存匹配的字符，如s/\(love\)able/\1rs，loveable被替换成lovers。  </span><br><span class="line">&amp;  保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love变成**love**。   </span><br><span class="line">\&lt; 锚定单词的开始，如:/\&lt;love/匹配包含以love开头的单词的行。   </span><br><span class="line">\&gt; 锚定单词的结束，如/love\&gt;/匹配包含以love结尾的单词的行。   </span><br><span class="line">x\&#123;m\&#125;  重复字符x，m次，如：/0\&#123;5\&#125;/匹配包含5个o的行。   </span><br><span class="line">x\&#123;m,\&#125; 重复字符x,至少m次，如：/o\&#123;5,\&#125;/匹配至少有5个o的行。   </span><br><span class="line">x\&#123;m,n\&#125; 重复字符x，至少m次，不多于n次，如：/o\&#123;5,10\&#125;/匹配5--10个o的行。</span><br></pre></td></tr></table></figure>
<h2 id="sed实例">sed实例</h2><p>例一 显示test文件的第20到30行：sed -n ‘20,30p’ test<br>例二 将所有以d或D开头的行的所有小写x变为大写X：sed ‘/^[dD]/s/x/X/g’ test<br>例三 删除每行最后的两个字符：sed ‘s/..$//‘ test<br>例四 删除每一行的前两个字符：sed ‘s/..//‘ test<br>例五<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span> mysed.txt</span><br><span class="line">Beijing Beijing Beijing Beijing</span><br><span class="line"><span class="variable">$sed</span> <span class="string">'s/\(Beijing\)\(.*\)\(Beijing\)/\12008\2\32008/'</span> mysed.txt</span><br><span class="line">Beijing2008 Beijing Beijing Beijing2008</span><br><span class="line"><span class="comment">##这个命令稍显复杂，其中用到了一个技巧，就是预存储，即被\(和\)括起来的匹配内容会被按顺序存储起来，存储到\1、\2…里面。这样你就可以使用\加数字来调用这些内容了。这个例子就是使用了这个技巧，分别存储了三个内容，分别为匹配Beijing、匹配.*和匹配Beijing。</span></span><br></pre></td></tr></table></figure></p>
<p>任意字符:  sed -n ‘/.<em>ing/‘p temp.txt     注意是.</em>ing,而不是<em>ing<br>‘s/^[][]</em>//g’      删除行首空格<br>‘s/^$/d’           删除空行<br>‘s/COL/(…/)//g’  删除紧跟COL的后三个字母</p>
<p>more<i class="fa fa-database"></i><span class="exturl" data-url="aHR0cDovL3d3dy5ncnltb2lyZS5jb20vVW5peC9TZWQuaHRtbA==" title="http://www.grymoire.com/Unix/Sed.html">http://www.grymoire.com/Unix/Sed.html<i class="fa fa-external-link"></i></span><br>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3JvY2xpbnV4LmNuLz9wPTEzNjM=" title="http://roclinux.cn/?p=1363">http://roclinux.cn/?p=1363<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGV5ZS5jb20vdG9waWMvNTg3Njcz" title="http://www.iteye.com/topic/587673">http://www.iteye.com/topic/587673<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9lbWFubGVlL2FyY2hpdmUvMjAxMy8wOS8wNy8zMzA3NjQyLmh0bWw=" title="http://www.cnblogs.com/emanlee/archive/2013/09/07/3307642.html">http://www.cnblogs.com/emanlee/archive/2013/09/07/3307642.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sed.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Sed简介&quot;&gt;Sed简介&lt;/h2&gt;&lt;p&gt;sed 是一种在线编辑器，它一次
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="sed" scheme="http://tiramisutes.github.io/tags/sed/"/>
    
  </entry>
  
  <entry>
    <title>python模块安装--无root权限（easy_install和pip）</title>
    <link href="http://tiramisutes.github.io/2015/11/27/python-install.html"/>
    <id>http://tiramisutes.github.io/2015/11/27/python-install.html</id>
    <published>2015-11-27T05:17:35.000Z</published>
    <updated>2015-11-28T02:38:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>easy_install是由PEAK(Python Enterprise Application Kit)开发的setuptools包里带的一个命令，所以使用easy_install实际上是在调用setuptools来完成安装模块的工作。 Perl 用户比较熟悉 CPAN，而 Ruby 用户则比较熟悉 Gems；引导 setuptools 的ez_setup工具和随之而生的扩展后的easy_install 与”Cheeseshop”（Python Package Index，也称为 “PyPI”）一起工作来实现相同的功能。它可以很方便的让您自动下载，编译，安装和管理Python包。【百度百科】<br>easy_install和pip都是用来下载安装Python一个公共资源库PyPI的相关资源包的，pip类似RedHat里面的yum，安装Python包非常方便。本节详细介绍pip的安装、以及使用方法。</p>
<h2 id="首先安装setuptools">首先安装setuptools</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">"https://bitbucket.org/pypa/setuptools/get/default.tar.gz#egg=setuptools-dev"</span> --no-check-certificate</span><br><span class="line">tar -xzvf default.tar.gz</span><br><span class="line"><span class="built_in">cd</span> pypa-setuptools-eb92fc5071bf //依据你的解压目录名而定</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
<h2 id="安装easy_install">安装easy_install</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://pypi.python.org/pypi/ez_setup</span><br></pre></td></tr></table></figure>
<p>解压,安装.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ez_setup.py</span><br></pre></td></tr></table></figure></p>
<h3 id="easy_install安装包">easy_install安装包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">easy_install 【要安装的模块】</span><br></pre></td></tr></table></figure>
<h2 id="pip下载安装">pip下载安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">"https://pypi.python.org/packages/source/p/pip/pip-1.5.4.tar.gz#md5=834b2904f92d46aaa333267fb1c922bb"</span> --no-check-certificate</span><br></pre></td></tr></table></figure>
<h3 id="pip安装">pip安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf pip-1.5.4.tar.gz</span><br><span class="line"><span class="built_in">cd</span> pip-1.5.4</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
<h2 id="pip使用详解">pip使用详解</h2><h3 id="pip安装包">pip安装包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install SomePackage</span><br><span class="line">[...]</span><br><span class="line">Successfully installed SomePackage</span><br></pre></td></tr></table></figure>
<h3 id="pip查看已安装的包">pip查看已安装的包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pip show --files SomePackage</span><br><span class="line">Name: SomePackage</span><br><span class="line">Version: 1.0</span><br><span class="line">Location: /my/env/lib/pythonx.x/site-packages</span><br><span class="line">Files:</span><br><span class="line">../somepackage/__init__.py</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<h3 id="pip检查哪些包需要更新">pip检查哪些包需要更新</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip list --outdated</span><br><span class="line">SomePackage (Current: 1.0 Latest: 2.0)</span><br></pre></td></tr></table></figure>
<h3 id="pip升级包">pip升级包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade SomePackage</span><br><span class="line">[...]</span><br><span class="line">Found existing installation: SomePackage 1.0</span><br><span class="line">Uninstalling SomePackage:</span><br><span class="line">Successfully uninstalled SomePackage</span><br><span class="line">Running setup.py install <span class="keyword">for</span> SomePackage</span><br><span class="line">Successfully installed SomePackage</span><br></pre></td></tr></table></figure>
<h3 id="pip卸载包">pip卸载包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall SomePackage</span><br><span class="line">Uninstalling SomePackage:</span><br><span class="line">/my/env/lib/pythonx.x/site-packages/somepackage</span><br><span class="line">Proceed (y/n)? y</span><br><span class="line">Successfully uninstalled SomePackage</span><br></pre></td></tr></table></figure>
<h2 id="常见错误">常见错误</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImportError No module named setuptools</span><br></pre></td></tr></table></figure>
<p>解决办法：安装setuptools</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;easy_install是由PEAK(Python Enterprise Application Kit)开发的setuptools包里带的一个命令，所以使用easy_install实际上是在调用setuptools来完成安装模块的工作。 Perl 用户比较熟悉 CPAN，
    
    </summary>
    
      <category term="Python" scheme="http://tiramisutes.github.io/categories/Python/"/>
    
    
      <category term="module install" scheme="http://tiramisutes.github.io/tags/module-install/"/>
    
  </entry>
  
  <entry>
    <title>Genes and Isoforms</title>
    <link href="http://tiramisutes.github.io/2015/11/25/gene-isoforms.html"/>
    <id>http://tiramisutes.github.io/2015/11/25/gene-isoforms.html</id>
    <published>2015-11-25T11:44:00.000Z</published>
    <updated>2015-12-01T05:20:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Isoforms">Isoforms</h2><h3 id="Definition(s)">Definition(s)</h3><p>Different forms of a protein that may be produced from different genes, or from the same gene by alternative splicing.<br>Definition from:&nbsp;MeSH via <span class="exturl" data-url="aHR0cHM6Ly93d3cubmxtLm5paC5nb3YvcmVzZWFyY2gvdW1scy8=" title="https://www.nlm.nih.gov/research/umls/">Unified Medical Language <nobr>System </nobr><i class="fa fa-external-link"></i></span> at the National Library of Medicine<br>The protein products of different versions of messenger RNA created from the<br>same gene by employing different promoters, which causes transcription to<br>skip certain exons. Since the promoters are tissue-specific, different tissues<br>express different protein products of the same gene.<br>Definition from:&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L2Jvb2tzL05CSzUxOTEv" title="http://www.ncbi.nlm.nih.gov/books/NBK5191/"><nobr>GeneReviews</nobr><i class="fa fa-external-link"></i></span>from the University of Washington and the National Center for Biotechnology Information</p>
<h2 id="Related_discussion_in_the_Handbook">Related discussion in the Handbook</h2><p><li> <a href="/handbook/traits/fingerprints">Are fingerprints determined by genetics?</a></li></p>
<h2 id="Gene">Gene</h2><h3 id="Definition(s)-1">Definition(s)</h3><p>The functional and physical unit of heredity passed from parent to offspring. Genes are pieces of DNA, and most genes contain the information for making a specific protein.<br>Definition from:&nbsp;Physician Data Query via <span class="exturl" data-url="aHR0cHM6Ly93d3cubmxtLm5paC5nb3YvcmVzZWFyY2gvdW1scy8=" title="https://www.nlm.nih.gov/research/umls/">Unified Medical Language <nobr>System</nobr><i class="fa fa-external-link"></i></span> at the National Library of Medicine<br>The basic unit of heredity, consisting of a segment of DNA arranged in a linear<br>manner along a chromosome, which codes for a specific protein or segment<br>of protein leading to a particular characteristic or function.<br>Definition from:&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L2Jvb2tzL05CSzUxOTEv" title="http://www.ncbi.nlm.nih.gov/books/NBK5191/"><nobr>GeneReviews</nobr><i class="fa fa-external-link"></i></span>from the University of Washington and the National Center for Biotechnology.<br>The gene is the basic physical unit of inheritance. Genes are passed from parents to offspring and contain the information needed to specify traits. Genes are arranged, one after another, on structures called chromosomes. A chromosome contains a single, long DNA molecule, only a portion of which corresponds to a single gene. Humans have approximately 23,000 genes arranged on their chromosomes.<br>Definition from:&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5nZW5vbWUuZ292L2dsb3NzYXJ5Lw==" title="http://www.genome.gov/glossary/">Talking Glossary of Genetic <nobr>Terms</nobr><i class="fa fa-external-link"></i></span> from the National Human Genome Research Institute<br>The fundamental physical and functional unit of heredity. A gene is an ordered sequence of nucleotides located in a particular position on a particular chromosome that encodes a specific functional product (i.e., a protein or RNA molecule).<br>Definition from:&nbsp;<span class="exturl" data-url="aHR0cDovL3dlYi5vcm5sLmdvdi9zY2kvdGVjaHJlc291cmNlcy9IdW1hbl9HZW5vbWUvZ2xvc3Nhcnkuc2h0bWw=" title="http://web.ornl.gov/sci/techresources/Human_Genome/glossary.shtml">Human Genome Project <nobr>Information</nobr><i class="fa fa-external-link"></i></span>at the U.S. Department of Energy</p>
<h2 id="Related_discussion_in_the_Handbook-1">Related discussion in the Handbook</h2><p><li> <a href="/handbook/basics/gene">What is a gene?</a>           </li></p>
<p><li> <a href="/handbook/howgeneswork/genelocation">How do geneticists indicate the location of a gene?</a>  </li></p>
<p><li> <a href="/handbook/therapy">Gene Therapy</a>           </li></p>
<p><li> <a href="/handbook/howgeneswork/genefamilies">What are gene families?</a>           </li></p>
<p>See also <a href="/Resources/medicalterminology">Understanding Medical Terminology</a>.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Isoforms&quot;&gt;Isoforms&lt;/h2&gt;&lt;h3 id=&quot;Definition(s)&quot;&gt;Definition(s)&lt;/h3&gt;&lt;p&gt;Different forms of a protein that may be produced from different 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Glossary" scheme="http://tiramisutes.github.io/tags/Glossary/"/>
    
  </entry>
  
  <entry>
    <title>重测序文献精读</title>
    <link href="http://tiramisutes.github.io/2015/11/14/read-resequence.html"/>
    <id>http://tiramisutes.github.io/2015/11/14/read-resequence.html</id>
    <published>2015-11-14T12:57:42.000Z</published>
    <updated>2018-09-28T02:43:05.384Z</updated>
    
    <content type="html"><![CDATA[<p>了解一项新的工作或研究内容，文献精读是首选，而Nature系类文章技术含金量高，文章内容条理清晰，精读一定会收获颇丰。<br>全基因组重测序是对已知基因组序列的物种进行不同个体的基因组测序，并在此基础上对个体或群体进行差异性分析。全基因组重测序的个体，通过序列比对，可以找到大量的单核苷酸多态性位点（SNP），插入缺失位点（InDel，Insertion/Deletion）、结构变异位点（SV，Structure Variation）位点，在全基因组水平上扫描并检测与重要性状相关的基因序列差异和结构变异，实现遗传进化分析及重要性状候选基因预测。<br>基于其研究的重要性，<a href="http://tiramisutes.github.io/2015/07/28/google/" target="_blank">Google Scholar</a>关键词搜索resequence，检索到《Resequencing of 31 wild and cultivated soybean genomes identifies patterns of genetic diversity and selection》，《Resequencing 302 wild and cultivated accessions identifies genes related to domestication and improvement in soybean》，现选择第一篇精读。</p>
<h2 id="关键点总结">关键点总结</h2><h3 id="测序相关">测序相关</h3><ol>
<li>Approximately ×5 depth and &gt;90% coverage.</li>
<li>Previous reports have shown that the SNP calling accuracy from resequencing data is ~95–99% (Wang, J. et al. The diploid genome sequence of an Asian individual. Nature 456,60–65 (2008)；Xia, Q. et al. Complete resequencing of 40 genomes reveals domestication events and genes in silkworm (Bombyx). Science 326, 433–436 (2009)).</li>
<li>D-value (Tajima’s D) distribution was significantly higher that indicating a significant loss of rare SNPs, which may be due to reduced recombination within the LD blocks.</li>
<li>Divergence index (FST) value allowed us to identify genomic regions of large FST value, which signified areas having a high degree of diversification.Subregions that have very high FST values may provide an indication of the functional genes or alleles involved.</li>
<li>A genome-wide sequencing comparison to reveal haplotype sharing could provide a unique tool to identify introgression events in the history of these cultivars.</li>
<li>Previous studies have indicated that whole genome duplication (WGD) events can cause gene loss and rapid functional diversification. <h3 id="大豆研究相关">大豆研究相关</h3></li>
<li>They have exceptionally high linkage disequilibrium (LD) and a high ratio of average nonsynonymous versus synonymous nucleotide differences (Nonsyn/Syn). </li>
<li>There was a recent history of introgression from wild soybean.</li>
<li>Human selection probably had a strong impact on the genetic diversity in the cultivated soybeans.</li>
<li>Genome-wide analyses showed the opposite: we found that the low-frequency alleles were less abundant among the wild as compared to the cultivated accessions.</li>
<li>In comparison with other crops, SNP analysis showed that the cultivated soybean exhibited a lower diversity (cultivated soybean: 1.89 × 10−3; rice: 2.29 × 10−3; corn: 6.6 × 10−3).</li>
<li>The average distance over which LD decays to half of its maximum value in soybean was substantially longer than that of all plants analyzed<br>to date.</li>
<li>SNP analyses in the LD blocks showed that there was a lower SNP ratio in long LD blocks as compared to the whole genome in both wild and cultivated.</li>
<li>Allelic diversity in wild soybeans was higher than in cultivated soybeans across the entire genome.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence4.png" alt=""></li>
<li>Only ~3% of the total SNPs identified were present in coding regions. The remaining ~97% SNPs were in noncoding regions.</li>
<li>The presence of a higher Nonsyn/Syn value at the whole-genome level and more large-effect mutations suggested that the soybean genome had accumulated a higher ratio of deleterious mutations.</li>
<li>High LD(long LD blocks) would result in the lack of effective recombination; consequently, deleterious mutations could not be eliminated and would accumulate.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence5.png" alt=""></li>
<li>Selection signals during domestication and improvement.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence6.png" alt=""><h2 id="分析大致流程">分析大致流程</h2><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence.png" alt=""></li>
<li>进化相关工作，包括phylogenetic tree(<a href="http://tiramisutes.github.io/2015/08/05/bio-online/" target="_blank">iTO</a>)，principle component analysis(PCA)，population structure(Bayesian clustering analysis).</li>
<li>Whole-genome SNP analysis (using the parameter θπ) and the distribution of genome-wide diversity.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence3.png" alt=""></li>
<li>High linkage disequilibrium and genomewide patterns of nucleotide diversity(Selection and introgression).</li>
<li>Genome duplication（copy number variations (CNVs)） and Gene content variation.<h2 id="涉及软件">涉及软件</h2></li>
<li>STRUCTURE，Bayesian clustering program，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3ByaXRjaGFyZGxhYi5zdGFuZm9yZC5lZHUvc3RydWN0dXJlLmh0bWw=" title="http://pritchardlab.stanford.edu/structure.html">http://pritchardlab.stanford.edu/structure.html<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sequence2.png" alt=""></li>
<li>Haploview，LD analysis，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cHM6Ly93d3cuYnJvYWRpbnN0aXR1dGUub3JnL3NjaWVudGlmaWMtY29tbXVuaXR5L3NjaWVuY2UvcHJvZ3JhbXMvbWVkaWNhbC1hbmQtcG9wdWxhdGlvbi1nZW5ldGljcy9oYXBsb3ZpZXcvaGFwbG92aWV3" title="https://www.broadinstitute.org/scientific-community/science/programs/medical-and-population-genetics/haploview/haploview">https://www.broadinstitute.org/scientific-community/science/programs/medical-and-population-genetics/haploview/haploview<i class="fa fa-external-link"></i></span></li>
<li>AUGUSTUS ，基因注释，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2Jpb2luZi51bmktZ3JlaWZzd2FsZC5kZS9hdWd1c3R1cy8=" title="http://bioinf.uni-greifswald.de/augustus/">http://bioinf.uni-greifswald.de/augustus/<i class="fa fa-external-link"></i></span></li>
<li>GeneWise and Genomewise，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM0NzkxMzAv" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC479130/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC479130/<i class="fa fa-external-link"></i></span>   ，<span class="exturl" data-url="aHR0cDovL3d3dy5lYmkuYWMudWsvVG9vbHMvcHNhL2dlbmV3aXNlLw==" title="http://www.ebi.ac.uk/Tools/psa/genewise/">http://www.ebi.ac.uk/Tools/psa/genewise/<i class="fa fa-external-link"></i></span><br>GeneWise, which predicts gene structure using similar protein sequences, and Genomewise, which provides a gene structure final parse across cDNA- and EST-defined spliced structure. Both algorithms are heavily used by the Ensembl annotation system. The GeneWise algorithm was developed from a principled combination of hidden Markov models (HMMs). Both algorithms are highly accurate and can provide both accurate and complete gene structures when used with the correct evidence.</li>
<li>SOAP and SOAPsnp,Short Oligonucleotide Alignment Program(45-bp or 76-bp), <i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3NvYXAuZ2Vub21pY3Mub3JnLmNuLw==" title="http://soap.genomics.org.cn/">http://soap.genomics.org.cn/<i class="fa fa-external-link"></i></span>;</li>
<li>BWA，Paired-end sequencing reads mapping，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9iaW8tYndhL2ZpbGVzLw==" title="http://sourceforge.net/projects/bio-bwa/files/">http://sourceforge.net/projects/bio-bwa/files/<i class="fa fa-external-link"></i></span></li>
<li>SAMtools，SNP detection<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5odHNsaWIub3JnL++8jGh0dHA6Ly9iaW9iaXRzLm9yZy9zYW10b29sc19wcmltZXIuaHRtbA==" title="http://www.htslib.org/，http://biobits.org/samtools_primer.html">http://www.htslib.org/，http://biobits.org/samtools_primer.html<i class="fa fa-external-link"></i></span></li>
<li>Picard package，Duplicated reads filtered，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3BpY2FyZC5zb3VyY2Vmb3JnZS5uZXQv" title="http://picard.sourceforge.net/">http://picard.sourceforge.net/<i class="fa fa-external-link"></i></span></li>
<li>BEDtools，coverage of sequence alignments<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2JlZHRvb2xzLnJlYWR0aGVkb2NzLm9yZy9lbi9sYXRlc3Qv" title="http://bedtools.readthedocs.org/en/latest/">http://bedtools.readthedocs.org/en/latest/<i class="fa fa-external-link"></i></span></li>
<li>Genome Analysis Toolkit (GATK)，SNP/Indel calling，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cHM6Ly93d3cuYnJvYWRpbnN0aXR1dGUub3JnL2dhdGsvZ2F0a2RvY3Mvb3JnX2Jyb2FkaW5zdGl0dXRlX2dhdGtfdG9vbHNfd2Fsa2Vyc19nZW5vdHlwZXJfVW5pZmllZEdlbm90eXBlci5waHA=" title="https://www.broadinstitute.org/gatk/gatkdocs/org_broadinstitute_gatk_tools_walkers_genotyper_UnifiedGenotyper.php">https://www.broadinstitute.org/gatk/gatkdocs/org_broadinstitute_gatk_tools_walkers_genotyper_UnifiedGenotyper.php<i class="fa fa-external-link"></i></span></li>
<li>ANNOVAR，SNP annotation<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2Fubm92YXIub3BlbmJpb2luZm9ybWF0aWNzLm9yZy9lbi9sYXRlc3Qv" title="http://annovar.openbioinformatics.org/en/latest/">http://annovar.openbioinformatics.org/en/latest/<i class="fa fa-external-link"></i></span></li>
<li>EIGENSOFT，Principal component analysis (PCA) of whole-genome SNPs<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2dlbmV0aWNzLm1lZC5oYXJ2YXJkLmVkdS9yZWljaC9SZWljaF9MYWIvU29mdHdhcmUuaHRtbA==" title="http://genetics.med.harvard.edu/reich/Reich_Lab/Software.html">http://genetics.med.harvard.edu/reich/Reich_Lab/Software.html<i class="fa fa-external-link"></i></span></li>
<li>PLINK，Whole genome association analysis toolset，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3BuZ3UubWdoLmhhcnZhcmQuZWR1L35wdXJjZWxsL3BsaW5rLw==" title="http://pngu.mgh.harvard.edu/~purcell/plink/">http://pngu.mgh.harvard.edu/~purcell/plink/<i class="fa fa-external-link"></i></span></li>
<li>GAPIT，Genome Association and Prediction<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5tYWl6ZWdlbmV0aWNzLm5ldC8jIWdhcGl0L2Nta3Y=" title="http://www.maizegenetics.net/#!gapit/cmkv">http://www.maizegenetics.net/#!gapit/cmkv<i class="fa fa-external-link"></i></span></li>
<li>manhattan plot，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cHM6Ly9wb2RzLmlwbGFudGNvbGxhYm9yYXRpdmUub3JnL3dpa2kvZGlzcGxheS9lb3QvTWFrZSttYW5oYXR0YW4rcGxvdCt3aXRoK2dncGxvdDIrc2NyaXB077yMaHR0cDovL2Jsb2cuaG93LXRvLWNvZGUuaW5mby9yL01hbmhhdHRhbi1wbG90Lmh0bWw=" title="https://pods.iplantcollaborative.org/wiki/display/eot/Make+manhattan+plot+with+ggplot2+script，http://blog.how-to-code.info/r/Manhattan-plot.html">https://pods.iplantcollaborative.org/wiki/display/eot/Make+manhattan+plot+with+ggplot2+script，http://blog.how-to-code.info/r/Manhattan-plot.html<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/manhattanplot.png" alt=""><h2 id="内容补充链接">内容补充链接</h2></li>
<li>Tajima’s D，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVGFqaW1hJTI3c19E77yb" title="https://en.wikipedia.org/wiki/Tajima%27s_D；">https://en.wikipedia.org/wiki/Tajima%27s_D；<i class="fa fa-external-link"></i></span><i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2JhaWtlLmJhaWR1LmNvbS9saW5rP3VybD1oa1JQUWNVdEJWTVRWaE1sMnd6S0dMeTVRdERjck13b25VVjdDc3BxeHFkcGhrR3p0clNORlpMaVVZYXpxNm96NnJ4WnlWb3kxWWhIamV4aGk5T3A5Xw==" title="http://baike.baidu.com/link?url=hkRPQcUtBVMTVhMl2wzKGLy5QtDcrMwonUV7CspqxqdphkGztrSNFZLiUYazq6oz6rxZyVoy1YhHjexhi9Op9_">http://baike.baidu.com/link?url=hkRPQcUtBVMTVhMl2wzKGLy5QtDcrMwonUV7CspqxqdphkGztrSNFZLiUYazq6oz6rxZyVoy1YhHjexhi9Op9_<i class="fa fa-external-link"></i></span>.</li>
<li>Penn State University Center for Comparative Genomics and Bioinformatics，<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL3d3dy5ieC5wc3UuZWR1L21pbGxlcl9sYWIv" title="http://www.bx.psu.edu/miller_lab/">http://www.bx.psu.edu/miller_lab/<i class="fa fa-external-link"></i></span></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;了解一项新的工作或研究内容，文献精读是首选，而Nature系类文章技术含金量高，文章内容条理清晰，精读一定会收获颇丰。&lt;br&gt;全基因组重测序是对已知基因组序列的物种进行不同个体的基因组测序，并在此基础上对个体或群体进行差异性分析。全基因组重测序的个体，通过序列比对，可以找到
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="resequence" scheme="http://tiramisutes.github.io/tags/resequence/"/>
    
  </entry>
  
  <entry>
    <title>What&#39;s the probability that a significant p-value indicates a true effect?</title>
    <link href="http://tiramisutes.github.io/2015/11/14/P-FDR.html"/>
    <id>http://tiramisutes.github.io/2015/11/14/P-FDR.html</id>
    <published>2015-11-14T11:32:12.000Z</published>
    <updated>2018-09-28T02:40:27.337Z</updated>
    
    <content type="html"><![CDATA[<p>If the p-value is &lt; .05, then the probability of falsely rejecting the null hypothesis is  &lt;5%, right? That means, a maximum of 5% of all significant results is a false-positive (that’s what we control with the α rate).</p>
<p>Well, no. As you will see in a minute, the “false discovery rate” (aka. false-positive rate), which indicates the probability that a significant p-value actually is a false-positive, usually is much higher than 5%.</p>
<h2 id="A_common_misconception_about_p-values">A common misconception about p-values</h2><p>Oates (1986) asked the following question to students and senior scientists:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You have a p-value of .01. Is the following statement <span class="literal">true</span>, or <span class="literal">false</span>?</span><br><span class="line"></span><br><span class="line">You know, <span class="keyword">if</span> you decide to reject the null hypothesis, the probability that you are making the wrong decision.</span><br></pre></td></tr></table></figure></p>
<p>The answer is “false” (you will learn why it’s false below). But 86% of all professors and lecturers in the sample who were teaching statistics (!) answered this question erroneously with “true”. Gigerenzer, Kraus, and Vitouch replicated this result in 2000 in a German sample (here, the “statistics lecturer” category had 73% wrong). Hence, it is a wide-spread error to confuse the p-value with the false discovery rate.</p>
<h2 id="The_False_Discovery_Rate_(FDR)_and_the_Positive_Predictive_Value_(PPV)">The False Discovery Rate (FDR) and the Positive Predictive Value (PPV)</h2><p>To answer the question “What’s the probability that a significant p-value indicates a true effect?”, we have to look at the positive predictive value (PPV) of a significant p-value. The PPV indicates the proportion of significant p-values which indicate a real effect amongst all significant p-values. Put in other words: Given that a p-value is significant: What is the probability (in a frequentist sense) that it stems from a real effect?</p>
<p>(The false discovery rate simply is 1-PPV: the probability that a significant p-value stems from a population with null effect).</p>
<p>That is, we are interested in a conditional probability Prob(effect is real | p-value is significant).<br>Inspired by Colquhoun (2014) one can visualize this conditional probability in the form of a tree-diagram (see below). Let’s assume, we carry out 1000 experiments for 1000 different research questions. We now have to make a couple of prior assumptions (which you can make differently in the app we provide below). For now, we assume that 30% of all studies have a real effect and the statistical test used has a power of 35% with an α level set to 5%. That is of the 1000 experiments, 300 investigate a real effect, and 700 a null effect. Of the 300 true effects, 0.35<em>300 = 105 are detected, the remaining 195 effects are non-significant false-negatives. On the other branch of 700 null effects, 0.05</em>700 = 35 p-values are significant by chance (false positives) and 665 are non-significant (true negatives).<br>This path is visualized here (completely inspired by Colquhoun, 2014):<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PPV_tree.jpeg" alt=""><br>Now we can compute the false discovery rate (FDR): 35 of (35+105) = 140 significant p-values actually come from a null effect. That means, 35/140 = 25% of all significant p-values do not indicate a real effect! That is much more than the alleged 5% level.</p>
<p></p><p></p><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5yLWJsb2dnZXJzLmNvbS93aGF0cy10aGUtcHJvYmFiaWxpdHktdGhhdC1hLXNpZ25pZmljYW50LXAtdmFsdWUtaW5kaWNhdGVzLWEtdHJ1ZS1lZmZlY3Qv" title="http://www.r-bloggers.com/whats-the-probability-that-a-significant-p-value-indicates-a-true-effect/">http://www.r-bloggers.com/whats-the-probability-that-a-significant-p-value-indicates-a-true-effect/<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;If the p-value is &amp;lt; .05, then the probability of falsely rejecting the null hypothesis is  &amp;lt;5%, right? That means, a maximum of 5% 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="P_FDR" scheme="http://tiramisutes.github.io/tags/P-FDR/"/>
    
  </entry>
  
  <entry>
    <title>主成份分析、因子分析和聚类分析的异同点</title>
    <link href="http://tiramisutes.github.io/2015/11/11/pca-f-c.html"/>
    <id>http://tiramisutes.github.io/2015/11/11/pca-f-c.html</id>
    <published>2015-11-11T13:33:50.000Z</published>
    <updated>2015-11-11T15:18:32.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基本介绍">基本介绍</h2><p>主成分分析就是将多项指标转化为少数几项综合指标,用综合指标来解释多变量的方差- 协方差结构。综合指标即为主成分。所得出的少数几个主成分，要尽可能多地保留原始变量的信息，且彼此不相关。</p>
<p>因子分析是研究如何以最少的信息丢失，将众多原始变量浓缩成少数几个因子变量，以及如何使因子变量具有较强的可解释性的一种多元统计分析方法。</p>
<p>聚类分析是依据实验数据本身所具有的定性或定量的特征来对大量的数据进行分组归类以了解数据集的内在结构，并且对每一个数据集进行描述的过程。其主要依据是聚到同一个数据集中的样本应该彼此相似，而属于不同组的样本应该足够不相似。</p>
<p>三种分析方法既有区别也有联系，本文力图将三者的异同进行比较，并举例说明三者在实际应用中的联系,以期为更好地利用这些高级统计方法为研究所用有所裨益。</p>
<h2 id="基本思想的异同">基本思想的异同</h2><h3 id="共同点">共同点</h3><p>主成分分析法和因子分析法都是用少数的几个变量(因子) 来综合反映原始变量(因子) 的主要信息，变量虽然较原始变量少，但所包含的信息量却占原始信息的85 %以上，所以即使用少数的几个新变量，可信度也很高，也可以有效地解释问题。并且新的变量彼此间互不相关，消除了多重共线性。这两种分析法得出的新变量，并不是原始变量筛选后剩余的变量。在主成分分析中，最终确定的新变量是原始变量的线性组合，如原始变量为x1 ，x2 ，. . . ，x3 ，经过坐标变换，将原有的p个相关变量xi 作线性变换，每个主成分都是由原有p 个变量线性组合得到。在诸多主成分Zi 中，Z1 在方差中占的比重最大，说明它综合原有变量的能力最强，越往后主成分在方差中的比重也小，综合原信息的能力越弱。因子分析是要利用少数几个公共因子去解释较多个要观测变量中存在的复杂关系，它不是对原始变量的重新组合，而是对原始变量进行分解，分解为公共因子与特殊因子两部分。公共因子是由所有变量共同具有的少数几个因子；特殊因子是每个原始变量独自具有的因子。对新产生的主成分变量及因子变量计算其得分，就可以将主成分得分或因子得分代替原始变量进行进一步的分析，因为主成分变量及因子变量比原始变量少了许多，所以起到了降维的作用，为我们处理数据降低了难度。</p>
<p>聚类分析的基本思想是: 采用多变量的统计值，定量地确定相互之间的亲疏关系，考虑对象多因素的联系和主导作用，按它们亲疏差异程度，归入不同的分类中一元，使分类更具客观实际并能反映事物的内在必然联系。也就是说，聚类分析是把研究对象视作多维空间中的许多点，并合理地分成若干类，因此它是一种根据变量域之间的相似性而逐步归群成类的方法，它能客观地反映这些变量或区域之间的内在组合关系[3 ]。聚类分析是通过一个大的对称矩阵来探索相关关系的一种数学分析方法，是多元统计分析方法，分析的结果为群集。对向量聚类后，我们对数据的处理难度也自然降低，所以从某种意义上说，聚类分析也起到了降维的作用。</p>
<h3 id="不同之处">不同之处</h3><p>主成分分析是研究如何通过少数几个主成分来解释多变量的方差一协方差结构的分析方法，也就是求出少数几个主成分(变量) ，使它们尽可能多地保留原始变量的信息，且彼此不相关。它是一种数学变换方法，即把给定的一组变量通过线性变换，转换为一组不相关的变量(两两相关系数为0 ，或样本向量彼此相互垂直的随机变量) ，在这种变换中，保持变量的总方差(方差之和) 不变，同时具有最大方差，称为第一主成分；具有次大方差，称为第二主成分。依次类推。若共有p 个变量，实际应用中一般不是找p 个主成分，而是找出m (m &lt; p) 个主成分就够了，只要这m 个主成分能反映原来所有变量的绝大部分的方差。主成分分析可以作为因子分析的一种方法出现。</p>
<p>因子分析是寻找潜在的起支配作用的因子模型的方法。因子分析是根据相关性大小把变量分组，使得同组内的变量之间相关性较高，但不同的组的变量相关性较低，每组变量代表一个基本结构，这个基本结构称为公共因子。对于所研究的问题就可试图用最少个数的不可测的所谓公共因子的线性函数与特殊因子之和来描述原来观测的每一分量。通过因子分析得来的新变量是对每个原始变量进行内部剖析。因子分析不是对原始变量的重新组合，而是对原始变量进行分解，分解为公共因子和特殊因子两部分。具体地说，就是要找出某个问题中可直接测量的具有一定相关性的诸指标，如何受少数几个在专业中有意义、又不可直接测量到、且相对独立的因子支配的规律，从而可用各指标的测定来间接确定各因子的状态。因子分析只能解释部分变异，主成分分析能解释所有变异。       </p>
<p>聚类分析算法是给定m 维空间R 中的n 个向量，把每个向量归属到k 个聚类中的某一个，使得每一个向量与其聚类中心的距离最小。聚类可以理解为: 类内的相关性尽量大，类间相关性尽量小。聚类问题作为一种无指导的学习问题，目的在于通过把原来的对象集合分成相似的组或簇，来获得某种内在的数据规律。</p>
<p>从三类分析的基本思想可以看出，聚类分析中并没于产生新变量，但是主成分分析和因子分析都产生了新变量。</p>
<h2 id="数据标准化的比较">数据标准化的比较</h2><p>主成分分析中为了消除量纲和数量级，通常需要将原始数据进行标准化，将其转化为均值为0方差为1 的无量纲数据。而因子分析在这方面要求不是太高，因为在因子分析中可以通过主因子法、加权最小二乘法、不加权最小二乘法、重心法等很多解法来求因子变量，并且因子变量是每一个变量的内部影响变量，它的求解与原始变量是否同量纲关系并不太大，当然在采用主成分法求因子变量时，仍需标准化。不过在实际应用的过程中，为了尽量避免量纲或数量级的影响，建议在使用因子分析前还是要进行数据标准化。在构造因子变量时采用的是主成分分析方法，主要将指标值先进行标准化处理得到协方差矩阵，即相关矩阵和对应的特征值与特征向量，然后构造综合评价函数进行评价。</p>
<p>聚类分析中如果参与聚类的变量的量纲不同会导致错误的聚类结果。因此在聚类过程进行之前必须对变量值进行标准化，即消除量纲的影响。不同方法进行标准化，会导致不同的聚类结果要注意变量的分布。如果是正态分布应该采用z 分数法。</p>
<h2 id="应用中的优缺点比较">应用中的优缺点比较</h2><h3 id="主成分分析">主成分分析</h3><p><i class="fa fa-diamond"></i>优点：首先它利用降维技术用少数几个综合变量来代替原始多个变量，这些综合变量集中了原始变量的大部分信息。其次它通过计算综合主成分函数得分，对客观经济现象进行科学评价。再次它在应用上侧重于信息贡献影响力综合评价。<br><i class="fa fa-times"></i>缺点：当主成分的因子负荷的符号有正有负时，综合评价函数意义就不明确。命名清晰性低。</p>
<h3 id="因子分析">因子分析</h3><p><i class="fa fa-diamond"></i>优点：第一它不是对原有变量的取舍，而是根据原始变量的信息进行重新组合，找出影响变量的共同因子，化简数据；第二，它通过旋转使得因子变量更具有可解释性，命名清晰性高。<br><i class="fa fa-times"></i>缺点：在计算因子得分时，采用的是最小二乘法，此法有时可能会失效。</p>
<h3 id="聚类分析">聚类分析</h3><p><i class="fa fa-diamond"></i>优点：聚类分析模型的优点就是直观，结论形式简明。<br><i class="fa fa-times"></i>缺点：在样本量较大时，要获得聚类结论有一定困难。由于相似系数是根据被试的反映来建立反映被试间内在联系的指标，而实践中有时尽管从被试反映所得出的数据中发现他们之间有紧密的关系，但事物之间却无任何内在联系，此时，如果根据距离或相似系数得出聚类分析的结果，显然是不适当的，但是，聚类分析模型本身却无法识别这类错误。<br>Contribution from ：<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzY2ZDM2MmQ3MDEwMWZpdWouaHRtbA==" title="http://blog.sina.com.cn/s/blog_66d362d70101fiuj.html">http://blog.sina.com.cn/s/blog_66d362d70101fiuj.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;基本介绍&quot;&gt;基本介绍&lt;/h2&gt;&lt;p&gt;主成分分析就是将多项指标转化为少数几项综合指标,用综合指标来解释多变量的方差- 协方差结构。综合指标即为主成分。所得出的少数几个主成分，要尽可能多地保留原始变量的信息，且彼此不相关。&lt;/p&gt;
&lt;p&gt;因子分析是研究如何以最少的信息
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="statistics" scheme="http://tiramisutes.github.io/tags/statistics/"/>
    
  </entry>
  
  <entry>
    <title>R中cluster包进行聚类分析</title>
    <link href="http://tiramisutes.github.io/2015/11/11/cluster.html"/>
    <id>http://tiramisutes.github.io/2015/11/11/cluster.html</id>
    <published>2015-11-11T13:05:33.000Z</published>
    <updated>2018-09-28T02:31:41.446Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Description">Description</h2><p>Methods for Cluster analysis. Much extended the original from Peter Rousseeuw, Anja Struyf and Mia Hubert, based on Kaufman and Rousseeuw (1990) ``Finding Groups in Data’’.<br>聚类分析：按照个体或样品(individuals, objects or subjects)的特征将它们分类，使同一类别内的个体具有尽可能高的同质性(homogeneity)，而类别之间则应具有尽可能高的异质性(heterogeneity)。<br>Cluster analysis or clustering is the task of grouping a set of objects in such a way that objects in the same group (called a cluster) are more similar (in some sense or another) to each other than to those in other groups (clusters). It is a main task of exploratory data mining, and a common technique for statistical data analysis, used in many fields, including machine learning, pattern recognition, image analysis, information retrieval, and bioinformatics.</p>
<h2 id="Typical_cluster_models">Typical cluster models</h2><p><ul></ul></p>
<p><li>Connectivity models: for example <a href="/wiki/Hierarchical_clustering" title="Hierarchical clustering">hierarchical clustering</a> builds models based on distance connectivity.</li></p>
<p><li>Centroid models: for example the <a href="/wiki/K-means_algorithm" title="K-means algorithm" class="mw-redirect">k-means algorithm</a> represents each cluster by a single mean vector.</li></p>
<p><li>Distribution models: clusters are modeled using statistical distributions, such as <a href="/wiki/Multivariate_normal_distribution" title="Multivariate normal distribution">multivariate normal distributions</a> used by the <a href="/wiki/Expectation-maximization_algorithm" title="Expectation-maximization algorithm" class="mw-redirect">Expectation-maximization algorithm</a>.</li></p>
<p><li>Density models: for example <a href="/wiki/DBSCAN" title="DBSCAN">DBSCAN</a> and <a href="/wiki/OPTICS" title="OPTICS" class="mw-redirect">OPTICS</a> defines clusters as connected dense regions in the data space.</li></p>
<p><li>Subspace models: in <a href="/wiki/Biclustering" title="Biclustering">Biclustering</a> (also known as Co-clustering or two-mode-clustering), clusters are modeled with both cluster members and relevant attributes.</li></p>
<p><li>Group models: some algorithms do not provide a refined model for their results and just provide the grouping information.</li></p>
<p><li>Graph-based models: a <a href="/wiki/Clique_(graph_theory)" title="Clique (graph theory)">clique</a>, i.e., a subset of nodes in a <a href="/wiki/Graph_(mathematics)" title="Graph (mathematics)">graph</a> such that every two nodes in the subset are connected by an edge can be considered as a prototypical form of cluster. Relaxations of the complete connectivity requirement (a fraction of the edges can be missing) are known as quasi-cliques, as in the <a href="/wiki/HCS_clustering_algorithm" title="HCS clustering algorithm">HCS clustering algorithm</a>.</li><br></p>
<h2 id="Algorithms">Algorithms</h2><h3 id="Connectivity_based_clustering_(hierarchical_clustering)">Connectivity based clustering (hierarchical clustering)</h3><p>Connectivity based clustering, also known as hierarchical clustering, is based on the core idea of objects being more related to nearby objects than to objects farther away. These algorithms connect “objects” to form “clusters” based on their distance. A cluster can be described largely by the maximum distance needed to connect parts of the cluster. At different distances, different clusters will form, which can be represented using a dendrogram, which explains where the common name “hierarchical clustering” comes from: these algorithms do not provide a single partitioning of the data set, but instead provide an extensive hierarchy of clusters that merge with each other at certain distances. In a dendrogram, the y-axis marks the distance at which the clusters merge, while the objects are placed along the x-axis such that the clusters don’t mix.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cluster1.png" alt=""></p>
<h3 id="Centroid-based_clustering">Centroid-based clustering</h3><p>In centroid-based clustering, clusters are represented by a central vector, which may not necessarily be a member of the data set. When the number of clusters is fixed to k, k-means clustering gives a formal definition as an optimization problem: find the k cluster centers and assign the objects to the nearest cluster center, such that the squared distances from the cluster are minimized.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cluster2.png" alt=""></p>
<h3 id="Distribution-based_clustering">Distribution-based clustering</h3><p>The clustering model most closely related to statistics is based on distribution models. Clusters can then easily be defined as objects belonging most likely to the same distribution. A convenient property of this approach is that this closely resembles the way artificial data sets are generated: by sampling random objects from a distribution.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cluster3.png" alt=""></p>
<h3 id="Density-based_clustering">Density-based clustering</h3><p>The most popular density based clustering method is DBSCAN. In contrast to many newer methods, it features a well-defined cluster model called “density-reachability”. Similar to linkage based clustering, it is based on connecting points within certain distance thresholds. However, it only connects points that satisfy a density criterion, in the original variant defined as a minimum number of other objects within this radius.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cluster4.png" alt=""><br>综上内容看出其和主成份分析(Principal component analysis,PCA)有较多相似性，所以开始前先对<a href="http://tiramisutes.github.io/2015/11/11/pca-f-c/" target="_blank">主成份分析、因子分析和聚类分析的异同点</a>进行比较分析，具体关于PCA分析可看本博博文<a href="http://tiramisutes.github.io/2015/07/29/PCA/" target="_blank">PCA分析</a>。</p>
<h2 id="R中进行聚类分析">R中进行聚类分析</h2><h3 id="cluster包">cluster包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(cluster)</span><br><span class="line">&gt; <span class="comment">#载入所需数据</span></span><br><span class="line">&gt; data(votes.repub)</span><br><span class="line">&gt; votes.diss &lt;- daisy(votes.repub)</span><br><span class="line">&gt; pamv &lt;- pam(votes.diss, 2, diss = TRUE)</span><br><span class="line">&gt; clusplot(pamv, shade = TRUE)</span><br><span class="line">&gt; <span class="comment">## is the same as</span></span><br><span class="line">&gt; votes.clus &lt;- pamv<span class="variable">$clustering</span></span><br><span class="line">&gt; clusplot(votes.diss, votes.clus, diss = TRUE, shade = TRUE)</span><br><span class="line">&gt; <span class="comment">##Remove the dotted line</span></span><br><span class="line">&gt; clusplot(votes.diss, votes.clus, diss = TRUE)</span><br><span class="line">&gt; <span class="comment">## show label</span></span><br><span class="line">&gt; op &lt;- par(new=TRUE, cex = 0.6)</span><br><span class="line">&gt; clusplot(votes.diss, votes.clus, diss = TRUE,</span><br><span class="line">+          axes=FALSE,ann=FALSE, sub=<span class="string">""</span>, col.p=NA, col.txt=<span class="string">"dark green"</span>, labels=3)</span><br><span class="line">&gt; par(op)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cluster5.png" alt=""><br><i class="fa fa-slideshare fa-2x"></i>参数解释：<br><i class="fa fa-cogs"></i>daisy:Dissimilarity Matrix(相异度矩阵)Calculation,compute all the pairwise dissimilarities (distances) between observations in the data set.<br>相异度矩阵：相异度矩阵是对象—对象结构的一种数据表达方式，多数聚类算法都是建立在相异度矩阵基础上，如果数据是以数据矩阵形式给出的，就要将数据矩阵转化为相异度矩阵。对象间的相似度或相异度是基于两个对象间的距离来计算的。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">daisy(x, metric = c(<span class="string">"euclidean"</span>, <span class="string">"manhattan"</span>, <span class="string">"gower"</span>),stand = FALSE, <span class="built_in">type</span> = list(), weights = rep.int(1, p))</span><br></pre></td></tr></table></figure></p>
<p>x—numeric matrix or data frame, of dimension n*p.<br>metric—“euclidean” (the default), “manhattan” and “gower”.Euclidean distances are root sum-of-squares of differences, and manhattan distances<br>are the sum of absolute differences.”Gower’s distance” is chosen by metric “gower” or automatically if some columns of x are not numeric.<br>stand—logical flag: if TRUE, then the measurements in x are standardized before calculating the dissimilarities. Measurements are standardized for each variable (column), by subtracting the variable’s mean value and dividing by the variable’s mean absolute deviation.<br><i class="fa fa-cogs"></i>pam:Partitioning (clustering) of the data into k clusters “around medoids”, a more robust version of K-means.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pam(x, k, diss = inherits(x, <span class="string">"dist"</span>), metric = <span class="string">"euclidean"</span>,</span><br><span class="line">medoids = NULL, stand = FALSE, cluster.only = FALSE,</span><br><span class="line">do.swap = TRUE,</span><br><span class="line">keep.diss = !diss &amp;&amp; !cluster.only &amp;&amp; n &lt; 100,</span><br><span class="line">keep.data = !diss &amp;&amp; !cluster.only,</span><br><span class="line">pamonce = FALSE, trace.lev = 0)</span><br></pre></td></tr></table></figure></p>
<p>x—data matrix or data frame, or dissimilarity matrix or object.In case of a dissimilarity matrix, x is typically the output of daisy or dist.<br>k—positive integer specifying the number of clusters, less than the number of observations.<br>diss—logical flag: if TRUE (default for dist or dissimilarity objects), then x will be considered as a dissimilarity matrix. If FALSE, then x will be considered as a matrix of observations by variables.<br>metric—“euclidean” and “manhattan”,If x is already a dissimilarity matrix, then this argument will be ignored.<br><i class="fa fa-cogs"></i>clusplot:Bivariate Cluster Plot (clusplot) Default Method<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">clusplot(x, clus, diss = FALSE,</span><br><span class="line">s.x.2d = mkCheckX(x, diss), stand = FALSE,</span><br><span class="line">lines = 2, shade = FALSE, color = FALSE,</span><br><span class="line">labels= 0, plotchar = TRUE,</span><br><span class="line">col.p = <span class="string">"dark green"</span>, col.txt = col.p,</span><br><span class="line">col.clus = <span class="keyword">if</span>(color) c(2, 4, 6, 3) <span class="keyword">else</span> 5, cex = 1, cex.txt = cex,</span><br><span class="line">span = TRUE,</span><br><span class="line">add = FALSE,</span><br><span class="line">xlim = NULL, ylim = NULL,</span><br><span class="line">main = paste(<span class="string">"CLUSPLOT("</span>, deparse(substitute(x)),<span class="string">")"</span>),</span><br><span class="line">sub = paste(<span class="string">"These two components explain"</span>,</span><br><span class="line">round(100 * var.dec, digits = 2), <span class="string">"% of the point variability."</span>),</span><br><span class="line">xlab = <span class="string">"Component 1"</span>, ylab = <span class="string">"Component 2"</span>,</span><br><span class="line">verbose = getOption(<span class="string">"verbose"</span>),</span><br><span class="line">...)</span><br></pre></td></tr></table></figure></p>
<p>x—data matrix or data frame, or dissimilarity matrix or object.In case of a dissimilarity matrix, x is typically the output of daisy or dist.<br>clus—clus is often the clustering component of the output of pam.<br>diss—logical flag: if TRUE (default for dist or dissimilarity objects), then x will be considered as a dissimilarity matrix. If FALSE, then x will be considered as a matrix of observations by variables.<br>lines—lines = 0, no distance lines will appear on the plot;lines = 1, the line segment between m1 and m2 is drawn;lines = 2, a line segment between the boundaries of E1 and E2 is drawn (along the line connecting m1 and m2).<br>shade—logical flag: if TRUE, then the ellipses are shaded in relation to their density.<br>color—logical flag: if TRUE, then the ellipses are colored with respect to their density.labels—labels= 0, no labels are placed in the plot;<br>labels= 1, points and ellipses can be identified in the plot (see identify);labels= 2, all points and ellipses are labelled in the plot;labels= 3, only the points are labelled in the plot;labels= 4, only the ellipses are labelled in the plot.labels= 5, the ellipses are labelled in the plot, and points can be identified.<br>col.p—color code(s) used for the observation points.</p>
<h2 id="更多资源">更多资源</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3ZpZXdzL0NsdXN0ZXIuaHRtbA==" title="https://cran.r-project.org/web/views/Cluster.html">https://cran.r-project.org/web/views/Cluster.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Description&quot;&gt;Description&lt;/h2&gt;&lt;p&gt;Methods for Cluster analysis. Much extended the original from Peter Rousseeuw, Anja Struyf and Mia H
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="cluster" scheme="http://tiramisutes.github.io/tags/cluster/"/>
    
  </entry>
  
  <entry>
    <title>批量求fasta格式序列长度</title>
    <link href="http://tiramisutes.github.io/2015/11/08/fa-length.html"/>
    <id>http://tiramisutes.github.io/2015/11/08/fa-length.html</id>
    <published>2015-11-08T14:14:22.000Z</published>
    <updated>2016-12-07T11:37:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>linux下用awk计算fasta序列的长度<br>fasta序列文件data.fa<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;Gorai.004G111100.1</span><br><span class="line">ATGGGTACTGCTCCAACCCAGTGCCCTTCTGGAATCACTGCAAATTTCCACGCCAAATTTGATAACAGAACTGAGTTTTC</span><br><span class="line">&gt;Gorai.004G111100.2</span><br><span class="line">ATGTTTTTCATGCTCCGGTGGACAAGATACTCTGGGATGCCGGGGAACAGTTTTTCCTTTTCTTGGCAGACATATGCACATAAAATTCTT</span><br><span class="line">&gt;Gorai.004G111100.3</span><br><span class="line">ATGGGTACTGCTCCAACCCAGTGCCCTTCTGGAATCACTGCAAATTTCCAC</span><br><span class="line">&gt;Gorai.004G111100.4</span><br><span class="line">ATGGGAATGCATGAACTAGCAGCCAAAGTTGATGAGT</span><br></pre></td></tr></table></figure></p>
<p>首先将fasta序列转换成一行显示，命令如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/^&gt;/&amp;&amp;NR&gt;1&#123;print "";&#125;&#123; printf "%s",/^&gt;/ ? $0"%":$0 &#125;'</span>  data.fa &gt;data2.fa</span><br></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;Gorai.004G111100.1%ATGGGTACTGCTCCAACCCAGTGCCCTTCTGGAATCACTGCAAATTTCCACGCCAAATTTGATAACAGAACTGAGTTTTC</span><br><span class="line">&gt;Gorai.004G111100.2%ATGTTTTTCATGCTCCGGTGGACAAGATACTCTGGGATGCCGGGGAACAGTTTTTCCTTTTCTTGGCAGACATATGCACATAAAATTCTT</span><br><span class="line">&gt;Gorai.004G111100.3%ATGGGTACTGCTCCAACCCAGTGCCCTTCTGGAATCACTGCAAATTTCCAC</span><br><span class="line">&gt;Gorai.004G111100.4%ATGGGAATGCATGAACTAGCAGCCAAAGTTGATGAGT</span><br></pre></td></tr></table></figure></p>
<p>长度计算：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F<span class="string">"%"</span> <span class="string">'&#123;print $1"\t"length($2)&#125;'</span>  data2.fa &gt;data3.fa</span><br></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;Gorai.004G111100.1 80</span><br><span class="line">&gt;Gorai.004G111100.2 90</span><br><span class="line">&gt;Gorai.004G111100.3 51</span><br><span class="line">&gt;Gorai.004G111100.4 37</span><br></pre></td></tr></table></figure></p>
<p>More： <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlvc3RhcnMub3JnL3AvOTI2Mi8jOTI2NA==" title="https://www.biostars.org/p/9262/#9264">Question: Multiline Fasta To Single Line Fasta<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;linux下用awk计算fasta序列的长度&lt;br&gt;fasta序列文件data.fa&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/spa
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="fa_length" scheme="http://tiramisutes.github.io/tags/fa-length/"/>
    
  </entry>
  
  <entry>
    <title>R中的基础函数</title>
    <link href="http://tiramisutes.github.io/2015/11/08/R-fun.html"/>
    <id>http://tiramisutes.github.io/2015/11/08/R-fun.html</id>
    <published>2015-11-08T08:53:00.000Z</published>
    <updated>2016-11-04T11:57:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>在R中偶尔也需要对一些数据进行简短的处理，掌握一些基本函数是必须的，本文将持续收集那些短小精悍的R函数，正确的运用还是能起到四两拔千斤的效果，欢迎评论补充。</p>
<h3 id="aggregate">aggregate</h3><p>功能:aggregate(formula, data, FUN)<br>首先将数据进行分组（按行），然后对每一组数据进行函数统计，最后把结果组合成一个比较nice的表格返回.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(chickwts)</span><br><span class="line">  weight      feed</span><br><span class="line">1    179 horsebean</span><br><span class="line">2    160 horsebean</span><br><span class="line">3    136 horsebean</span><br><span class="line">4    227 horsebean</span><br><span class="line">5    217 horsebean</span><br><span class="line">6    168 horsebean</span><br><span class="line">&gt; unique(chickwts<span class="variable">$feed</span>)</span><br><span class="line">[1] horsebean linseed   soybean   sunflower meatmeal  casein   </span><br><span class="line">Levels: casein horsebean linseed meatmeal soybean sunflower</span><br><span class="line">&gt; <span class="comment">#aggregate(chickwts$weight, by=list(chickwts$feed), FUN=mean)</span></span><br><span class="line">&gt; aggregate(weight ~ feed, data = chickwts, mean)</span><br><span class="line">       feed   weight</span><br><span class="line">1    casein 323.5833</span><br><span class="line">2 horsebean 160.2000</span><br><span class="line">3   linseed 218.7500</span><br><span class="line">4  meatmeal 276.9091</span><br><span class="line">5   soybean 246.4286</span><br><span class="line">6 sunflower 328.9167</span><br><span class="line">&gt; head(iris)</span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line">1          5.1         3.5          1.4         0.2  setosa</span><br><span class="line">2          4.9         3.0          1.4         0.2  setosa</span><br><span class="line">3          4.7         3.2          1.3         0.2  setosa</span><br><span class="line">4          4.6         3.1          1.5         0.2  setosa</span><br><span class="line">5          5.0         3.6          1.4         0.2  setosa</span><br><span class="line">6          5.4         3.9          1.7         0.4  setosa</span><br><span class="line">&gt; unique(iris<span class="variable">$Species</span>)</span><br><span class="line">[1] setosa     versicolor virginica </span><br><span class="line">Levels: setosa versicolor virginica</span><br><span class="line">&gt; aggregate(. ~ Species, data = iris, mean)</span><br><span class="line">     Species Sepal.Length Sepal.Width Petal.Length Petal.Width</span><br><span class="line">1     setosa        5.006       3.428        1.462       0.246</span><br><span class="line">2 versicolor        5.936       2.770        4.260       1.326</span><br><span class="line">3  virginica        6.588       2.974        5.552       2.026</span><br></pre></td></tr></table></figure></p>
<h3 id="paste">paste</h3><p>功能：paste(…, sep = “ “, collapse = NULL)<br>字符串连接<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; paste(<span class="string">"CK"</span>, 1:6, sep = <span class="string">""</span>)</span><br><span class="line">[1] <span class="string">"CK1"</span> <span class="string">"CK2"</span> <span class="string">"CK3"</span> <span class="string">"CK4"</span> <span class="string">"CK5"</span> <span class="string">"CK6"</span></span><br><span class="line">&gt; <span class="comment">#设置collapse参数，连成一个字符串</span></span><br><span class="line">&gt; paste(<span class="string">"CK"</span>, 1:6, sep = <span class="string">""</span>, collapse = <span class="string">"-"</span>)</span><br><span class="line">[1] <span class="string">"CK1-CK2-CK3-CK4-CK5-CK6"</span></span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-binoculars" aria-hidden="true"></i>paste在不指定分割符的情况下，默认分割符是空格 ，paste0在不指定分割符的情况下，默认分割符是空。</p>
<h3 id="strsplit">strsplit</h3><p>功能：strsplit(x, split, fixed = FALSE, perl = FALSE, useBytes = FALSE)<br>字符串拆分，生成一个list<br>参数解释：<br>x为字串向量，每个元素都将单独进行拆分。<br>split为拆分位置的字串向量（分隔符），默认为正则表达式匹配（fixed=FALSE）。如果你没接触过正则表达式，设置fixed=TRUE，表示使用普通文本匹配或正则表达式的精确匹配。普通文本的运算速度快。<br>perl=TRUE/FALSE的设置和perl语言版本有关，如果正则表达式很长，正确设置表达式并且使用perl=TRUE可以提高运算速度。<br>useBytes设置是否逐个字节进行匹配，默认为FALSE，即按字符而不是字节进行匹配。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; text &lt;- <span class="string">"Hello Adam!\nHello Ava!"</span></span><br><span class="line">&gt; strsplit(text, <span class="string">"\\s"</span>)</span><br><span class="line">[[1]]</span><br><span class="line">[1] <span class="string">"Hello"</span> <span class="string">"Adam!"</span> <span class="string">"Hello"</span> <span class="string">"Ava!"</span></span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-bullhorn" aria-hidden="true"></i>如果要对一个向量使用该函数，需要注意。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#分割向量的每一个元素，并取分割后的第一个元素</span></span><br><span class="line">unlist(lapply(X = c(<span class="string">"abc"</span>, <span class="string">"bcd"</span>, <span class="string">"dfafadf"</span>), FUN = <span class="keyword">function</span>(x) &#123;<span class="built_in">return</span>(strsplit(x, split = <span class="string">""</span>)[[1]][1])&#125;))</span><br><span class="line">[1] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"d"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="grep/regexpr/gregexpr/regexec">grep/regexpr/gregexpr/regexec</h3><p>功能:grep(pattern, x, ignore.case = FALSE, perl = FALSE, value = FALSE, fixed = FALSE, useBytes = FALSE, invert = FALSE)<br>grep仅返回匹配项的下标.<br>regexpr、gregexpr和regexec返回的结果包含了匹配的具体位置和字符串长度信息.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&gt; text &lt;- c(<span class="string">"Hellow, Adam!"</span>, <span class="string">"Hi, Adam!"</span>, <span class="string">"How are you, Adam."</span>)</span><br><span class="line">&gt; text</span><br><span class="line">[1] <span class="string">"Hellow, Adam!"</span>      <span class="string">"Hi, Adam!"</span>          <span class="string">"How are you, Adam."</span></span><br><span class="line">&gt; grep(<span class="string">"Adam"</span>,text)</span><br><span class="line">[1] 1 2 3</span><br><span class="line">&gt; regexpr(<span class="string">"Adam"</span>, text)</span><br><span class="line">[1]  9  5 14</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4 4 4</span><br><span class="line">attr(,<span class="string">"useBytes"</span>)</span><br><span class="line">[1] TRUE</span><br><span class="line">&gt; gregexpr(<span class="string">"Adam"</span>, text)</span><br><span class="line">[[1]]</span><br><span class="line">[1] 9</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br><span class="line">attr(,<span class="string">"useBytes"</span>)</span><br><span class="line">[1] TRUE</span><br><span class="line"></span><br><span class="line">[[2]]</span><br><span class="line">[1] 5</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br><span class="line">attr(,<span class="string">"useBytes"</span>)</span><br><span class="line">[1] TRUE</span><br><span class="line"></span><br><span class="line">[[3]]</span><br><span class="line">[1] 14</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br><span class="line">attr(,<span class="string">"useBytes"</span>)</span><br><span class="line">[1] TRUE</span><br><span class="line"></span><br><span class="line">&gt; regexec(<span class="string">"Adam"</span>, text)</span><br><span class="line">[[1]]</span><br><span class="line">[1] 9</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br><span class="line"></span><br><span class="line">[[2]]</span><br><span class="line">[1] 5</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br><span class="line"></span><br><span class="line">[[3]]</span><br><span class="line">[1] 14</span><br><span class="line">attr(,<span class="string">"match.length"</span>)</span><br><span class="line">[1] 4</span><br></pre></td></tr></table></figure></p>
<h3 id="substr">substr</h3><p>功能：substr(x, start, stop)<br>字符串提取<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; substr(text,9,12)</span><br><span class="line">[1] <span class="string">"Adam"</span> <span class="string">"!"</span>    <span class="string">"you,"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="strtrim">strtrim</h3><p>功能：strtrim(x, width)<br>将字符串修剪到特定的显示宽度.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; head(iris)</span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line">1            5         3.5          1.4         0.2  setosa</span><br><span class="line">2            4         3.0          1.4         0.2  setosa</span><br><span class="line">3            4         3.2          1.3         0.2  setosa</span><br><span class="line">4            4         3.1          1.5         0.2  setosa</span><br><span class="line">5            5         3.6          1.4         0.2  setosa</span><br><span class="line">6            5         3.9          1.7         0.4  setosa</span><br><span class="line">&gt; strtrim(head(iris)<span class="variable">$Sepal</span>.Length,1)</span><br><span class="line">[1] <span class="string">"5"</span> <span class="string">"4"</span> <span class="string">"4"</span> <span class="string">"4"</span> <span class="string">"5"</span> <span class="string">"5"</span></span><br><span class="line">&gt; iris<span class="variable">$Sepal</span>.Length&lt;-strtrim(head(iris)<span class="variable">$Sepal</span>.Length,1)</span><br><span class="line">&gt; head(iris)</span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line">1            5         3.5          1.4         0.2  setosa</span><br><span class="line">2            4         3.0          1.4         0.2  setosa</span><br><span class="line">3            4         3.2          1.3         0.2  setosa</span><br><span class="line">4            4         3.1          1.5         0.2  setosa</span><br><span class="line">5            5         3.6          1.4         0.2  setosa</span><br><span class="line">6            5         3.9          1.7         0.4  setosa</span><br></pre></td></tr></table></figure></p>
<h3 id="length/nchar">length/nchar</h3><p>nchar是向量元素的字符个数，而length是向量长度.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; length(<span class="string">"ATGGGAATGCATGAACTAGCAGCCAAAGTTGATGAGT"</span>)</span><br><span class="line">[1] 1</span><br><span class="line">&gt; car &lt;- c(<span class="string">'bmw'</span>,<span class="string">'ford'</span>,<span class="string">'mini'</span>,<span class="string">'bmw'</span>,<span class="string">'mini'</span>)</span><br><span class="line">&gt; length(car)</span><br><span class="line">[1] 5</span><br><span class="line">&gt; length(unique(car))</span><br><span class="line">[1] 3</span><br><span class="line">&gt; nchar(<span class="string">"ATGGGAATGCATGAACTAGCAGCCAAAGTTGATGAGT"</span>)</span><br><span class="line">[1] 37</span><br></pre></td></tr></table></figure></p>
<h3 id="round">round</h3><p>功能：round(x, digits = 0)<br>四舍五入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; round(c(1.1254,0.1247844),3)</span><br><span class="line">[1] 1.125 0.125</span><br></pre></td></tr></table></figure></p>
<h3 id="axes/axis">axes/axis</h3><p>axes=FALSE       暂时禁止坐标轴的生成|以便使用axis()函数添加你自己定制的坐标轴。默认情况是axes=TRUE，即包含坐标轴。<br>axis(side, . . . )<br>在当前图形的指定边上添加坐标，在哪个边上由第一个参数指定（1到4，从底部按照顺时针顺序）。其他参数控制坐标的位置|在图形内或图形外，以及标记的位置和标签。适合在调用参数为axes=FALSE的函数plot()后添加定制的坐标轴。</p>
<h3 id="order()">order()</h3><p>A[order(A[,4],decreasing=T),] ＃按照第4列降序排序<br>data  #dataframe对象 含有v1,v2两列<br>data[sort(data$v1,index.return=TRUE)$ix,]　　#对data的数据按v1排列,v1须为numeric  as.numeric()</p>
<h3 id="%in%">%in%</h3><p>功能：在数据框中选取某一列只含特定字符的行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt; library(dplyr)</span><br><span class="line">&gt; library(tidyr)</span><br><span class="line">&gt; df &lt;- data_frame(</span><br><span class="line">+   group = c(1:2, 1),</span><br><span class="line">+   item_name = c(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"b"</span>),</span><br><span class="line">+   value1 = 1:3,</span><br><span class="line">+   value2 = 4:6</span><br><span class="line">+ )</span><br><span class="line">&gt; df</span><br><span class="line">Source: <span class="built_in">local</span> data frame [3 x 4]</span><br><span class="line"></span><br><span class="line">  group item_name value1 value2</span><br><span class="line">  (dbl)     (chr)  (int)  (int)</span><br><span class="line">1     1         a      1      4</span><br><span class="line">2     2         b      2      5</span><br><span class="line">3     1         b      3      6</span><br><span class="line">&gt;<span class="comment">#选取item_name列中只含有a的行</span></span><br><span class="line">&gt; a&lt;-c(<span class="string">"a"</span>)</span><br><span class="line">&gt; df[df<span class="variable">$item_name</span> %<span class="keyword">in</span>% a,]</span><br><span class="line">Source: <span class="built_in">local</span> data frame [1 x 4]</span><br><span class="line"></span><br><span class="line">  group item_name value1 value2</span><br><span class="line">  (dbl)     (chr)  (int)  (int)</span><br><span class="line">1     1         a      1      4</span><br></pre></td></tr></table></figure></p>
<h3 id="table">table</h3><p>功能：统计数据的频数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; a&lt;-c(1,1,1,2,2,3)</span><br><span class="line">&gt; table(a)</span><br><span class="line">a</span><br><span class="line">1 2 3 </span><br><span class="line">3 2 1</span><br></pre></td></tr></table></figure></p>
<h3 id="str()">str()</h3><p>功能：查看数据结构<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; str(reps )</span><br><span class="line"><span class="string">'data.frame'</span>:	255956 obs. of  17 variables:</span><br><span class="line"> $ bin      : int  585 585 585 585 585 585 585 585 585 585 ...</span><br><span class="line"> $ swScore  : int  342 2271 3379 2704 180 380 1113 233 388 673 ...</span><br><span class="line"> $ milliDiv : int  0 159 80 108 0 131 168 302 256 182 ...</span><br><span class="line"> $ milliDel : int  0 37 4 31 0 0 19 0 0 7 ...</span><br><span class="line"> $ milliIns : int  0 25 0 10 0 14 19 68 14 90 ...</span><br><span class="line"> $ genoName : Factor w/ 1 level <span class="string">"chrX"</span>: 1 1 1 1 1 1 1 1 1 1 ...</span><br><span class="line"> $ genoStart: int  0 41 1799 2290 2797 2945 3015 3565 5012 5164 ...</span><br><span class="line"> $ genoEnd  : int  38 446 2272 2703 2817 3015 3221 3757 5164 5186 ...</span><br><span class="line"> $ genoLeft : int  -154913716 -154913308 -154911482 -154911051 -154910937 -154910739 -154910533 -154909997 -154908590 -154908568 ...</span><br><span class="line"> $ strand   : Factor w/ 2 levels <span class="string">"-"</span>,<span class="string">"+"</span>: 2 2 2 2 2 2 1 2 1 2 ...</span><br><span class="line"> $ repName  : Factor w/ 1105 levels <span class="string">"(A)n"</span>,<span class="string">"(AAATG)n"</span>,..: 90 519 656 579 90 183 248 284 940 240 ...</span><br><span class="line"> $ repClass : Factor w/ 15 levels <span class="string">"DNA"</span>,<span class="string">"LINE"</span>,<span class="string">"Low_complexity"</span>,..: 10 4 4 4 10 10 11 3 4 11 ...</span><br><span class="line"> $ repFamily: Factor w/ 35 levels <span class="string">"AcHobo"</span>,<span class="string">"Alu"</span>,..: 28 7 7 7 28 28 2 12 13 2 ...</span><br><span class="line"> $ repStart : int  3 741 1 1 2 1 -20 1 -200 1 ...</span><br><span class="line"> $ repEnd   : int  40 1150 475 422 21 69 292 179 228 22 ...</span><br><span class="line"> $ repLeft  : int  0 -104 -83 -79 0 0 87 0 37 -280 ...</span><br><span class="line"> $ id       : int  1 2 3 4 5 6 7 8 9 1 ...</span><br></pre></td></tr></table></figure></p>
<h3 id="ifelse">ifelse</h3><p>功能：条件判断<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; set.seed(123)</span><br><span class="line">&gt; col1 &lt;- runif (5, 0, 2)</span><br><span class="line">&gt; col2 &lt;- rnorm (5, 0, 2)</span><br><span class="line">&gt; col3 &lt;- rpois (5, 3)</span><br><span class="line">&gt; col4 &lt;- rchisq (5, 0.1)</span><br><span class="line">&gt; df &lt;- data.frame (col1, col2, col3, col4)</span><br><span class="line">&gt; df</span><br><span class="line">       col1       col2 col3         col4</span><br><span class="line">1 0.5751550 -3.3791113    5 2.771082e-01</span><br><span class="line">2 1.5766103  2.4789918    2 3.888853e-04</span><br><span class="line">3 0.8179538 -0.2179319    0 8.652702e-05</span><br><span class="line">4 1.7660348 -0.2344839    2 6.492406e-17</span><br><span class="line">5 1.8809346  0.3661652    6 2.963428e-02</span><br><span class="line">&gt; output &lt;- ifelse ((df<span class="variable">$col1</span>) &gt; 1 &amp; (df<span class="variable">$col3</span>) &gt; 2, <span class="string">"yes"</span>, <span class="string">"no"</span>)</span><br><span class="line">&gt; df<span class="variable">$output</span> &lt;- output</span><br><span class="line">&gt; df</span><br><span class="line">       col1       col2 col3         col4 output</span><br><span class="line">1 0.5751550 -3.3791113    5 2.771082e-01     no</span><br><span class="line">2 1.5766103  2.4789918    2 3.888853e-04     no</span><br><span class="line">3 0.8179538 -0.2179319    0 8.652702e-05     no</span><br><span class="line">4 1.7660348 -0.2344839    2 6.492406e-17     no</span><br><span class="line">5 1.8809346  0.3661652    6 2.963428e-02    yes</span><br></pre></td></tr></table></figure></p>
<h3 id="gsub和sub">gsub和sub</h3><p>字符串替换<br>gsub替换匹配到的全部<br>sub 替换匹配到的第一个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将b替换为B</span></span><br><span class="line">gsub(pattern = <span class="string">"b"</span>, replacement = <span class="string">"B"</span>, x = c(<span class="string">"abcb"</span>, <span class="string">"boy"</span>, <span class="string">"baby"</span>))</span><br><span class="line">[1] <span class="string">"aBcB"</span> <span class="string">"Boy"</span>  <span class="string">"BaBy</span></span><br><span class="line"><span class="string"># 只替换第一个b</span></span><br><span class="line"><span class="string">sub(pattern = "</span>b<span class="string">", replacement = "</span>B<span class="string">", x = c("</span>abcb<span class="string">", "</span>baby<span class="string">"))</span></span><br><span class="line"><span class="string">[1] "</span>aBcb<span class="string">" "</span>Baby<span class="string">"</span></span><br></pre></td></tr></table></figure>
<h3 id="字符串中字符统计">字符串中字符统计</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s &lt;- <span class="string">"aababac"</span></span><br><span class="line">p &lt;- <span class="string">"a"</span></span><br><span class="line">countCharOccurrences &lt;- <span class="keyword">function</span>(char, s) &#123;</span><br><span class="line">    s2 &lt;- gsub(char,<span class="string">""</span>,s)</span><br><span class="line">    <span class="built_in">return</span> (nchar(s) - nchar(s2))</span><br><span class="line">&#125;</span><br><span class="line">countCharOccurrences(p,s)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在R中偶尔也需要对一些数据进行简短的处理，掌握一些基本函数是必须的，本文将持续收集那些短小精悍的R函数，正确的运用还是能起到四两拔千斤的效果，欢迎评论补充。&lt;/p&gt;
&lt;h3 id=&quot;aggregate&quot;&gt;aggregate&lt;/h3&gt;&lt;p&gt;功能:aggregate(formu
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="function" scheme="http://tiramisutes.github.io/tags/function/"/>
    
  </entry>
  
  <entry>
    <title>ANOVA单因素方差分析与R实现</title>
    <link href="http://tiramisutes.github.io/2015/10/08/ANOVA.html"/>
    <id>http://tiramisutes.github.io/2015/10/08/ANOVA.html</id>
    <published>2015-10-08T15:37:43.000Z</published>
    <updated>2018-09-28T02:28:58.078Z</updated>
    
    <content type="html"><![CDATA[<h2 id="单因子方差分析">单因子方差分析</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;方差分析(analysis of variance, 简写为ANOVA)是工农业生产和科学研究中分析试验数据的一种有效的统计方法. 引起观测值不同(波动)的原因主要有两类: 一类是试验过程中随机因素的干扰或观测误差所引起不可控制的的波动, 另一类则是由于试验中处理方式不同或试验条件不同引起的可以控制的波动.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>方差分析</strong>的主要工作就是将观测数据的总变异(波动)按照变异的原因的不同分解为因子效应与试验误差，并对其作出数量分析，发现多组数据之间的差异显著行，比较各种原因在总变异中所占的重要程度，以此作为进一步统计推断的依据.<br><strong>在进行方差分析之前先对几条假设进行检验，由于随机抽取，假设总体满足独立、正态，考察方差齐次性（用bartlett检验）.</strong></p>
<p><iframe width="420" height="315" src="https://www.youtube.com/embed/bklkCjiY3E0" frameborder="0" allowfullscreen></iframe></p>
<h3 id="正态性检验">正态性检验</h3><p>在进行方差分析前先对输入数据做正态性检验。<br>对数据的正态性，利用Shapiro-Wilk正态检验方法(W检验)，它通常用于样本容量n≤50时，检验样本是否符合正态分布。</p>
<p>R中，函数shapiro.test()提供了W统计量和相应P值，所以可以直接使用P值作为判断标准(<strong>P值大于0.05说明数据正态</strong>)，其调用格式为shapiro.test(x)，参数x即所要检验的数据集，它是长度在3到5000之间的向量。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nx &lt;- c(rnorm(10))</span><br><span class="line">nx</span><br><span class="line">[1] -0.83241783 -0.29609562 -0.06736888 -0.02366562</span><br><span class="line">0.23652392 0.97570959</span><br><span class="line">[7] -0.85301145 1.51769488 -0.84866517 0.20691119</span><br><span class="line">shapiro.test(nx)</span><br><span class="line">Shapiro-Wilk normality <span class="built_in">test</span></span><br><span class="line">data: nx</span><br><span class="line">W = 0.9084, p-value = 0.2699</span><br><span class="line"><span class="comment">#检验结果，因为p 值小于W 值，所以数据为正态分布.</span></span><br></pre></td></tr></table></figure></p>
<p>更多正态性检验见：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9ibHVlaWNlbHkvYXJjaGl2ZS8yMDEzLzAxLzA4LzI4NTA5MjkuaHRtbA==" title="http://www.cnblogs.com/blueicely/archive/2013/01/08/2850929.html">R语言做正态分布检验<i class="fa fa-external-link"></i></span><br>其中，<strong>D检验(Kolmogorov - Smirnov)是比较精确的正态检验法。</strong></p>
<p><li><strong>SPSS 规定:当样本含量3 ≤n ≤5000 时,结果以Shapiro - Wilk (W 检验) 为准,当样本含量n &gt; 5000 结果以Kolmogorov - Smirnov 为准。</strong></li></p>
<p><li><strong>SAS 规定:当样本含量n ≤2000 时,结果以Shapiro - Wilk (W 检验) 为准,当样本含量n &gt;2000 时,结果以Kolmogorov - Smirnov (D 检验) 为准。</strong></li></p>
<h3 id="方差齐性检验">方差齐性检验</h3><p>方差分析的另一个假设：方差齐性，需要检验不同水平下的数据方差是否相等。R中最常用的是Bartlett检验,bartlett.test()调用格式为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bartlett.test(x，g…)</span><br></pre></td></tr></table></figure></p>
<p>其中，参数X是数据向量或列表(list) ; g是因子向量，如果X是列表则忽略g.当使用数据集时，也通过formula调用函数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bartlett.test(formala, data, subset，na.action…)</span><br></pre></td></tr></table></figure></p>
<p>formula是形如lhs一rhs的方差分析公式;data指明数据集:subset是可选项，可以用来指定观测值的一个子集用于分析:na.action表示遇到缺失值时应当采取的行为。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; x=c(x1,x2,x3)</span><br><span class="line">&gt; account=data.frame(x,A=factor(rep(1:3,each=7)))</span><br><span class="line">&gt; bartlett.test(x~A,data=account)</span><br><span class="line"> </span><br><span class="line">Bartlett <span class="built_in">test</span> of homogeneity of variances</span><br><span class="line"> </span><br><span class="line">data: x by A</span><br><span class="line">Bartlett<span class="string">'s K-squared = 0.13625, df = 2, p-value = 0.9341</span></span><br></pre></td></tr></table></figure></p>
<p>由于P值远远大于显著性水平a=0.05，因此不能拒绝原假设，我们认为不同水平下的数据是等方差的。</p>
<h3 id="方差分析：F-Test">方差分析：F-Test</h3><p>In R the function var.test allows for the comparison of two variances using an F-test.Although it is possible to compare values of s2 for two samples, there is no capability within R for comparing the variance of a sample,s2,to the variance of a population, σ2. The syntax for the testing variances is :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var.test(X, Y, ratio = 1, alternative = <span class="string">"two.sided"</span>, conf.level = 0.95)</span><br></pre></td></tr></table></figure></p>
<p>where X and Y are vectors containing the two samples.<br>The optional command ratio is the null hypothesis; the default value is 1 if not specified.<br>The command alternative gives the alternative hypothesis should the experimental F-ratio is found to be significantly different than that specified by ratio. The default for alternative is “two-sided” with the other possible choices being “less” or “greater” .<br>The command conf.level gives the confidence level to be used in the test and the default value of 0.95 is equivalent to α = 0.05.<br>Here is a typical result using the objects std.method and new.method.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; std.method&lt;-c( 21.62, 22.20, 24.27, 23.54, 24.25, 23.09, 21.01 )</span><br><span class="line">&gt; new.method&lt;-c(21.54 ,20.51 ,22.31, 21.30, 24.62, 25.72, 21.54 ) </span><br><span class="line">&gt; var(std.method); var(new.method) </span><br><span class="line">[1] 1.638495</span><br><span class="line">[1] 3.690329</span><br><span class="line">&gt; var.test(std.method, new.method)    </span><br><span class="line"></span><br><span class="line">	F <span class="built_in">test</span> to compare two variances</span><br><span class="line"></span><br><span class="line">data:  std.method and new.method</span><br><span class="line">F = 0.444, num df = 6, denom df = 6, p-value = 0.3462</span><br><span class="line">alternative hypothesis: <span class="literal">true</span> ratio of variances is not equal to 1</span><br><span class="line">95 percent confidence interval:</span><br><span class="line"> 0.07629135 2.58395513</span><br><span class="line">sample estimates:</span><br><span class="line">ratio of variances </span><br><span class="line">         0.4439971</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>There are two ways to interpret the results provided by R.<br>First, the p-value provides the smallest value of α for which the F-ratio is significantly different from the hypothesized value.<br>If this value is larger than the desired α, then there is insufficient evidence to reject the null hypothesis; otherwise, the null hypothesis is rejected. Second, R provides the desired confidence interval for the F-ratio;<br>if the calculated value falls within the confidence interval, then the null hypothesis is retained. For this example, the null hypothesis is retained and we find no evidence for a difference in the variances for the objects std.method and new.method. Note that R does not restrict the F-ratio to values greater than 1.<br>1）判断组间是否有差别<br>R中的函数aov()用于方差分析的计算，其调用格式为:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aov(formula, data = NULL, projections =FALSE, qr = TRUE,contrasts = NULL, ...)</span><br></pre></td></tr></table></figure></p>
<p>其中的参数formula表示方差分析的公式，在单因素方差分析中即为x~A ;<br>data表示做方差分析的数据框:projections为逻辑值，表示是否返回预测结果;<br>qr同样是逻辑值，表示是否返回QR分解结果，默认为TRUE;<br>contrasts是公式中的一些因子的对比列表;<br>通过函数summary()可列出方差分析表的详细结果。<br>以淀粉为原料生产葡萄的过程中, 残留许多糖蜜, 可作为生产酱色的原料. 在生产酱色的过程之前应尽可能彻彻底底除杂, 以保证酱色质量.为此对除杂方法进行选择. 在实验中选用5种不同的除杂方法, 每种方法做4次试验, 即重复4次, 结果见表.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aoc.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; X&lt;-c(25.6, 22.2, 28.0, 29.8, 24.4, 30.0, 29.0, 27.5, 25.0, 27.7,</span><br><span class="line">       23.0, 32.2, 28.8, 28.0, 31.5, 25.9, 20.6, 21.2, 22.0, 21.2)</span><br><span class="line">&gt; A&lt;-factor(rep(1:5, each=4))</span><br><span class="line">&gt; miscellany&lt;-data.frame(X, A)</span><br><span class="line">&gt; miscellany</span><br><span class="line">      X A</span><br><span class="line">1  25.6 1</span><br><span class="line">2  22.2 1</span><br><span class="line">3  28.0 1</span><br><span class="line">4  29.8 1</span><br><span class="line">5  24.4 2</span><br><span class="line">6  30.0 2</span><br><span class="line">7  29.0 2</span><br><span class="line">8  27.5 2</span><br><span class="line">9  25.0 3</span><br><span class="line">10 27.7 3</span><br><span class="line">11 23.0 3</span><br><span class="line">12 32.2 3</span><br><span class="line">13 28.8 4</span><br><span class="line">14 28.0 4</span><br><span class="line">15 31.5 4</span><br><span class="line">16 25.9 4</span><br><span class="line">17 20.6 5</span><br><span class="line">18 21.2 5</span><br><span class="line">19 22.0 5</span><br><span class="line">20 21.2 5</span><br><span class="line">&gt; aov.mis&lt;-aov(X~A, data=miscellany)</span><br><span class="line">&gt; summary(aov.mis)</span><br><span class="line">            Df Sum Sq Mean Sq F value Pr(&gt;F)  </span><br><span class="line">A            4  132.0   32.99   4.306 0.0162 *</span><br><span class="line">Residuals   15  114.9    7.66                 </span><br><span class="line">---</span><br><span class="line">Signif. codes: 0 <span class="string">'***'</span> 0.001 <span class="string">'**'</span> 0.01 <span class="string">'*'</span> 0.05 <span class="string">'.'</span> 0.1 <span class="string">' '</span> 1</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>上述结果中, Df表示自由度; sum Sq表示平方和; Mean Sq表示均方和;<br>F value表示F检验统计量的值, 即F比; Pr(&gt;F)表示检验的p值; A就是因素A;<br>Residuals为残差.<br>可以看出, F = 4.3061 &gt; F0.05(5-1, 20-5) = 3.06, 或者p=0.01618&lt;0.05,<br>说明有理由拒绝原假设, 即认为五种除杂方法有显著差异.<br>2）如果有差别，判断是哪两组间有差别<br>其中，上述所得结果为5个除杂方法之间的差异显著性分析，如果假设上述5中处理中A1为对照组，其余A2,A3,A4,A5均为处理组，现在若想分析一个对照和多个处理间的差异显著性，可以通过以下代码实现：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; A1A2&lt;-miscellany[1:8,]</span><br><span class="line">&gt; A1A2</span><br><span class="line">     X A</span><br><span class="line">1 25.6 1</span><br><span class="line">2 22.2 1</span><br><span class="line">3 28.0 1</span><br><span class="line">4 29.8 1</span><br><span class="line">5 24.4 2</span><br><span class="line">6 30.0 2</span><br><span class="line">7 29.0 2</span><br><span class="line">8 27.5 2</span><br><span class="line">&gt; an.aov.mis&lt;-aov(X~A, data=A1A2)</span><br><span class="line">&gt; summary(an.aov.mis)</span><br><span class="line">            Df Sum Sq Mean Sq F value Pr(&gt;F)</span><br><span class="line">A            1   3.51   3.511   0.419  0.542</span><br><span class="line">Residuals    6  50.31   8.385</span><br></pre></td></tr></table></figure>
<p>即选取对照为一组数据，处理为另一组，缺点是对于多个处理一个对照需要重复此操作，现在还没找到好的处理办法，希望以后能学到或者有谁知道望相告。<br><i class="fa fa-bullhorn"></i>最近总结出的另一个比较有效的办法：<br><i class="fa fa-level-up"></i>接上aov()的F检验通过summary(aov.mis)看出五种除杂方法有显著差异.接下来考察具体的差异（多重比较）通过 <strong>TukeyHSD()</strong>函数：<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">  &gt; TukeyHSD(aov.mis)</span><br><span class="line">  Tukey multiple comparisons of means</span><br><span class="line">    95% family-wise confidence level</span><br><span class="line"></span><br><span class="line">Fit: aov(formula = X ~ A, data = miscellany)</span><br><span class="line"></span><br><span class="line"><span class="variable">$A</span></span><br><span class="line">      diff        lwr        upr     p adj</span><br><span class="line">2-1  1.325  -4.718582  7.3685818 0.9584566</span><br><span class="line">3-1  0.575  -5.468582  6.6185818 0.9981815</span><br><span class="line">4-1  2.150  -3.893582  8.1935818 0.8046644</span><br><span class="line">5-1 -5.150 -11.193582  0.8935818 0.1140537</span><br><span class="line">3-2 -0.750  -6.793582  5.2935818 0.9949181</span><br><span class="line">4-2  0.825  -5.218582  6.8685818 0.9926905</span><br><span class="line">5-2 -6.475 -12.518582 -0.4314182 0.0330240</span><br><span class="line">4-3  1.575  -4.468582  7.6185818 0.9251337</span><br><span class="line">5-3 -5.725 -11.768582  0.3185818 0.0675152</span><br><span class="line">5-4 -7.300 -13.343582 -1.2564182 0.0146983 </span><br><span class="line">  &gt; miscellany</span><br><span class="line">      X A</span><br><span class="line">1  25.6 1</span><br><span class="line">2  22.2 1</span><br><span class="line">3  28.0 1</span><br><span class="line">4  29.8 1</span><br><span class="line">5  24.4 2</span><br><span class="line">6  30.0 2</span><br><span class="line">7  29.0 2</span><br><span class="line">8  27.5 2</span><br><span class="line">9  25.0 3</span><br><span class="line">10 27.7 3</span><br><span class="line">11 23.0 3</span><br><span class="line">12 32.2 3</span><br><span class="line">13 28.8 4</span><br><span class="line">14 28.0 4</span><br><span class="line">15 31.5 4</span><br><span class="line">16 25.9 4</span><br><span class="line">17 20.6 5</span><br><span class="line">18 21.2 5</span><br><span class="line">19 22.0 5</span><br><span class="line">20 21.2 5</span><br><span class="line"><span class="comment">#TukeyHSD图</span></span><br><span class="line"> &gt; plot(TukeyHSD(aov.mis))</span><br></pre></td></tr></table></figure></p>
<p> 注意：<strong>可以看出上述结果是所有分组间的两两比较，但经常我们所需要的仅仅是一个对照组和其他几个处理组间的比较，这时multcomp包是不错的选择；</strong><br><strong>Dunnett</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = c(56,60,44,53)</span><br><span class="line">b = c(29,38,18,35)</span><br><span class="line">c = c(11,25,7,18)</span><br><span class="line">d = c(26,44,20,32)</span><br><span class="line">strains.frame = data.frame(a, b, c, d)</span><br><span class="line">strains = stack(strains.frame)  <span class="comment">#stack是reshape2包中的一个函数，用于将宽格式数据转化为长格式；</span></span><br><span class="line">colnames(strains) = c(<span class="string">"weight"</span>, <span class="string">"group"</span>)</span><br><span class="line"><span class="comment">##常规的两两相互比较计算</span></span><br><span class="line">TukeyHSD( aov(weight ~ group, data=strains) )</span><br><span class="line">library(multcomp)</span><br><span class="line">summary(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br><span class="line"><span class="comment">## The first group ("a" in this example) is used as the reference group. </span></span><br><span class="line"><span class="comment">## If this is not the case, use the relevel() command to set the reference.</span></span><br><span class="line">strains<span class="variable">$group</span> = relevel(strains<span class="variable">$group</span>, <span class="string">"b"</span>)</span><br><span class="line">summary(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br><span class="line">plot(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov2.png" alt=""><br>More: <span class="exturl" data-url="aHR0cDovL2JhcmN3aWtpLndpLm1pdC5lZHUvd2lraS9TT1BzL2Fub3Zh" title="http://barcwiki.wi.mit.edu/wiki/SOPs/anova">http://barcwiki.wi.mit.edu/wiki/SOPs/anova<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov3.png" alt=""><br><i class="fa fa-book" aria-hidden="true"></i>multcomp包部分参数解释：<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>glht</strong>：General Linear Hypotheses，General linear hypotheses and multiple comparisons for parametric models, including generalized linear models, linear mixed effects models, and survival models.<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>linfct</strong>：a specification of the linear hypotheses to be tested，即指定之前的线性model将用于何种检验。<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>mcp (Multiple comparisons)</strong>：多重比较的意思，For each factor, which is included in model as independent variable, a contrast matrix or a symbolic description of the contrasts can be specified as arguments to mcp，其参数意思为Tukey’s all-pair comparisons or Dunnett’s comparison with a control.</p>
<p><i class="fa fa-bullhorn"></i>同样高效的办法：<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; person &lt;- rep(c(1:10),2)</span><br><span class="line">&gt; treat &lt;- c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>)</span><br><span class="line">&gt; phase &lt;- rep(c(1,2),each=10)</span><br><span class="line">&gt; x &lt;- c(760,860,568,780,960,940,635,440,528,800,770,855,602,800,958,952,650,450,530,803)</span><br><span class="line">&gt; data46 &lt;- data.frame(person,treat,phase,x)</span><br><span class="line">&gt; data46<span class="variable">$person</span>&lt;-factor(data46<span class="variable">$person</span>)</span><br><span class="line">&gt; data46</span><br><span class="line">   person treat phase   x</span><br><span class="line">1       1     A     1 760</span><br><span class="line">2       2     B     1 860</span><br><span class="line">3       3     A     1 568</span><br><span class="line">4       4     A     1 780</span><br><span class="line">5       5     B     1 960</span><br><span class="line">6       6     B     1 940</span><br><span class="line">7       7     A     1 635</span><br><span class="line">8       8     B     1 440</span><br><span class="line">9       9     A     1 528</span><br><span class="line">10     10     B     1 800</span><br><span class="line">11      1     B     2 770</span><br><span class="line">12      2     A     2 855</span><br><span class="line">13      3     B     2 602</span><br><span class="line">14      4     B     2 800</span><br><span class="line">15      5     A     2 958</span><br><span class="line">16      6     A     2 952</span><br><span class="line">17      7     B     2 650</span><br><span class="line">18      8     A     2 450</span><br><span class="line">19      9     B     2 530</span><br><span class="line">20     10     A     2 803</span><br><span class="line">&gt; result&lt;-aov(x~phase+person+treat,data=data46)</span><br><span class="line">&gt; summary(result)</span><br><span class="line">            Df Sum Sq Mean Sq  F value   Pr(&gt;F)    </span><br><span class="line">phase        1    490     490    9.925   0.0136 *  </span><br><span class="line">person       9 551111   61235 1240.195 1.32e-11 ***</span><br><span class="line">treat        1    198     198    4.019   0.0799 .  </span><br><span class="line">Residuals    8    395      49                      </span><br><span class="line">---</span><br><span class="line">Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span><br></pre></td></tr></table></figure></p>
<p> 观察p adj值发现两两二者间的方差显著性.<br>据上述结果可以填写下面的方差分析表:<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aoc2.png" alt=""><br>再通过函数plot( )绘图可直观描述5种不同除杂方法之间的差异, R中运行命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; plot(miscellany<span class="variable">$X</span>~miscellany<span class="variable">$A</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov.png" alt=""><br>从图形上也可以看出, 5种除杂方法产生的除杂量有显著差异, 特别第5种与前面的4种, 而方法1与3, 方法2与4的差异不<br>明显.</p>
<p></p><p></p><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9qcGxkL3AvNDU5NDAwMy5odG1s" title="http://www.cnblogs.com/jpld/p/4594003.html">http://www.cnblogs.com/jpld/p/4594003.html<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;单因子方差分析&quot;&gt;单因子方差分析&lt;/h2&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;方差分析(analysis of variance, 简写为ANOVA)是工农业生产和科学研究中分析试验数据的一种有效的
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="ANOVA" scheme="http://tiramisutes.github.io/tags/ANOVA/"/>
    
  </entry>
  
  <entry>
    <title>bar</title>
    <link href="http://tiramisutes.github.io/2015/10/08/bar.html"/>
    <id>http://tiramisutes.github.io/2015/10/08/bar.html</id>
    <published>2015-10-08T14:18:26.000Z</published>
    <updated>2018-09-28T02:30:23.149Z</updated>
    
    <content type="html"><![CDATA[<p>The bar geom is used to produce 1d area plots: bar charts for categorical x, and histograms for continuous y. stat_bin explains the details of these summaries in more detail. In particular, you can use the weight aesthetic to create weighted histograms and barcharts where the height of the bar no longer represent a count of observations, but a sum over some other variable. See the examples for a practical example.</p>
<h2 id="Usage">Usage</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_bar(mapping = NULL, data = NULL, <span class="built_in">stat</span> = <span class="string">"bin"</span>, position = <span class="string">"stack"</span>, ...)</span><br></pre></td></tr></table></figure>
<h2 id="Aesthetics">Aesthetics</h2><p>geom_bar understands the following aesthetics (required aesthetics are in bold):</p>
<p><li> <code><strong>x</strong></code><br>  </li></p>
<p><li> <code>alpha</code><br>  </li></p>
<p><li> <code>colour</code><br>  </li></p>
<p><li> <code>fill</code><br>  </li></p>
<p><li> <code>linetype</code><br>  </li></p>
<p><li> <code>size</code><br>  </li></p>
<p><li> <code>weight</code><br></li></p>
<h2 id="Grouping_Bars_Together">Grouping Bars Together</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p&lt;- ggplot(df2, aes(x=sample, y=high, fill=sample)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,fill=<span class="string">"lightblue"</span>, color=<span class="string">"black"</span>, </span><br><span class="line">           position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=high-sd, ymax=high+sd), width=.2,</span><br><span class="line">                position=position_dodge(.9)) +</span><br><span class="line">  theme(legend.position=<span class="string">'none'</span>) +</span><br><span class="line">  labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Sample"</span>, y = <span class="string">"high"</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>aes中fill可指定不同类显示柱子颜色.<br>geom_bar()的fill修改柱子填充颜色，color修改柱子外围颜色.<br>theme()控制图例.<br>labs()添加x，y轴和主题标签.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scale_fill_brewer(palette=<span class="string">"Pastel1"</span>) <span class="comment">#亦可用来修改柱子颜色</span></span><br></pre></td></tr></table></figure></p>
<h2 id="在柱状图中使用不同颜色—把适当的变量映射到Fill中">在柱状图中使用不同颜色—把适当的变量映射到Fill中</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(upc, aes(x=reorder(Abb, Change), y=Change, fill=Region)) +</span><br><span class="line">	  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, colour=<span class="string">"black"</span>)  +</span><br><span class="line">	  scale_fill_manual(values=c(<span class="string">"#669933"</span>, <span class="string">"#FFCC66"</span>)) + </span><br><span class="line">	  xlab(<span class="string">"State"</span>)</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>reorder函数，把柱状图按照大小排列.<br>xlab()对x轴修改坐标轴注释.<br>其方法随可以为不同柱子fill不同颜色，但所填充颜色是ggplot2系统自动生成，有时候颜色不好看想要修改为你自己制定的颜色，方法如下：<br><strong>方法1:breaks()</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MYdata &lt;- data.frame(Age = rep(c(0,1,3,6,9,12), each=20),</span><br><span class="line">                    Richness = rnorm(120, 10000, 2500))</span><br><span class="line">ggplot(data = MYdata, aes(x = Age, y = Richness)) + </span><br><span class="line">  geom_boxplot(aes(fill=factor(Age))) + </span><br><span class="line">  geom_point(aes(color = factor(Age))) +</span><br><span class="line">  scale_x_continuous(breaks = c(0, 1, 3, 6, 9, 12)) +</span><br><span class="line">  scale_colour_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>)) +</span><br><span class="line">  scale_fill_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/HPZWL.png" alt=""><br>With this color scheme, the points that fall inside the boxplot are not visible (since they are the same color as the boxplot’s fill). Perhaps leaving the boxplot hollow and drawing its lines in the color would be better.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = MYdata, aes(x = Age, y = Richness)) + </span><br><span class="line">  geom_boxplot(aes(colour=factor(Age)), fill=NA) + </span><br><span class="line">  geom_point(aes(color = factor(Age))) +</span><br><span class="line">  scale_x_continuous(breaks = c(0, 1, 3, 6, 9, 12)) +</span><br><span class="line">  scale_colour_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Xmn5v.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br>操作自己数据时可能会出现报错 “Continuous value supplied to discrete scale” ，Brian Diggs<i class="fa fa-thumbs-o-up"></i>大神给出的解释是：<br><i class="fa fa-commenting-o"></i>Age is a continuous variable, but you are trying to use it in a discrete scale (by specifying the color for specific values of age). In general, a scale maps the variable to the visual; for a continuous age, there is a corresponding color for every possible value of age, not just the ones that happen to appear in your data. However, you can simultaneously treat age as a categorical variable (factor) for some of the aesthetics. For the third part of your question, within the scale description, you can define specific labels corresponding to specific breaks in the scale.<br>也就是要转换连续型变量为因子变量.<br><strong>方法2：Change the default palettes</strong><br>These are color-blind-friendly palettes, one with gray, and one with black.</p>
<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-5-1.png" alt=""><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-5-2.png" alt=""></p><br>To use with ggplot2, it is possible to store the palette in a variable, then use it later.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The palette with grey:</span></span><br><span class="line">cbPalette &lt;- c(<span class="string">"#999999"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>, <span class="string">"#CC79A7"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The palette with black:</span></span><br><span class="line">cbbPalette &lt;- c(<span class="string">"#000000"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>, <span class="string">"#CC79A7"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use for fills, add</span></span><br><span class="line">  scale_fill_manual(values=cbPalette)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use for line and point colors, add</span></span><br><span class="line">  scale_colour_manual(values=cbPalette)</span><br></pre></td></tr></table></figure><p></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colorblind_palette.jpg" alt=""></p>
<h2 id="Coloring_Negative_and_Postive_Bars_Differently—设定新的变量，将新建变量映射到fill中">Coloring Negative and Postive Bars Differently—设定新的变量，将新建变量映射到fill中</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">csub &lt;- subset(climate, Source==<span class="string">"Berkeley"</span> &amp; Year &gt;= 1900)</span><br><span class="line">	csub<span class="variable">$pos</span> &lt;- csub<span class="variable">$Anomaly10y</span> &gt;= 0</span><br><span class="line">	ggplot(csub, aes(x=Year, y=Anomaly10y, fill=pos)) +</span><br><span class="line">  	  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, position=<span class="string">"identity"</span>, colour=<span class="string">"black"</span>, size=0.25) +</span><br><span class="line">	  scale_fill_manual(values=c(<span class="string">"#CCEEFF"</span>, <span class="string">"#FFDDDD"</span>), guide=FALSE)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/gS0niDp.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br>首先通过subset()函数选取一个数集赋值到csub，选取原则为：climate数据中Source这一列值为Berkeley并且Year这一列&gt;= 1900.<br>csub$pos为原数集添加pos这一列，若Anomaly10y &gt;= 0则其值为TRUE,否则为FALSE.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">      Source Year Anomaly1y Anomaly5y Anomaly10y Unc10y   pos</span><br><span class="line">155 Berkeley 1954        NA        NA     -0.032  0.038 FALSE</span><br><span class="line">156 Berkeley 1955        NA        NA     -0.022  0.035 FALSE</span><br><span class="line">157 Berkeley 1956        NA        NA      0.012  0.031  TRUE</span><br><span class="line">158 Berkeley 1957        NA        NA      0.007  0.028  TRUE</span><br><span class="line">159 Berkeley 1958        NA        NA      0.002  0.027  TRUE</span><br><span class="line">160 Berkeley 1959        NA        NA      0.002  0.026  TRUE</span><br><span class="line">161 Berkeley 1960        NA        NA     -0.019  0.026 FALSE</span><br><span class="line">162 Berkeley 1961        NA        NA     -0.001  0.021 FALSE</span><br><span class="line">163 Berkeley 1962        NA        NA      0.017  0.018  TRUE</span><br><span class="line">164 Berkeley 1963        NA        NA      0.004  0.016  TRUE</span><br><span class="line">165 Berkeley 1964        NA        NA     -0.028  0.018 FALSE</span><br><span class="line">166 Berkeley 1965        NA        NA     -0.006  0.017 FALSE</span><br><span class="line">167 Berkeley 1966        NA        NA     -0.024  0.017 FALSE</span><br></pre></td></tr></table></figure></p>
<p>最后将pos映射到fill，geom_bar()中size改变柱子外框黑线的厚度.<br>scale_fill_manual()进行修改颜色，通过设定guide=FALSE 去掉图例.<br>geom_bar(width=0.5)调整width改变柱子宽度，也就是改变了柱子之间的距离.</p>
<h2 id="pylr改变图中堆积的颜色—order=desc()">pylr改变图中堆积的颜色—order=desc()</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(plyr) <span class="comment"># Needed for desc()</span></span><br><span class="line">ggplot(cabbage_exp, aes(x=Date, y=Weight, fill=Cultivar, order=desc(Cultivar))) +</span><br><span class="line">      geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br></pre></td></tr></table></figure>
<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/52ChlFe.png" width="340"><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/9k0Y2le.png" width="340"></p><p></p>
<h2 id="Making_a_Propotional_Stacked_Bar_Graph">Making a Propotional Stacked Bar Graph</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(gcookbook) <span class="comment"># For the data set</span></span><br><span class="line">library(plyr)</span><br><span class="line"><span class="comment"># Do a group-wise transform(), splitting on "Date"</span></span><br><span class="line">ce &lt;- ddply(cabbage_exp, <span class="string">"Date"</span>, transform,</span><br><span class="line">            percent_weight = Weight / sum(Weight) * 100)</span><br><span class="line">ggplot(ce, aes(x=Date, y=percent_weight, fill=Cultivar)) +</span><br><span class="line">      geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pZAfWxF.png" alt=""><br><i class="fa fa-hand-o-right"></i>plyr里ddply的语法解析<br>cabbage是数据集<br>“Date” 通俗来说就是x轴的变量<br>transform是要做的变形，在ddply中还有summarize等<br>最后一项是是新建的变量和变型方法</p>
<h2 id="柱条上添加文字">柱条上添加文字</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(ggthemes)</span><br><span class="line">dt = data.frame(obj = c(<span class="string">'A'</span>,<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'E'</span>,<span class="string">'C'</span>), val = c(2,15,6,9,7))</span><br><span class="line">dt<span class="variable">$obj</span> = factor(dt<span class="variable">$obj</span>, levels=c(<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'E'</span>))   <span class="comment">## 设置柱条的顺序</span></span><br><span class="line">p = ggplot(dt, aes(x = obj, y = val, fill = obj, group = factor(1))) + </span><br><span class="line">    geom_bar(<span class="built_in">stat</span> = <span class="string">"identity"</span>, width = 0.5) +   <span class="comment">## 修改柱条的宽度</span></span><br><span class="line">    theme_pander() + </span><br><span class="line">    geom_text(aes(label = val, vjust = -0.8, hjust = 0.5, color = obj), show_guide = FALSE) +   <span class="comment">## 显示柱条上的数字</span></span><br><span class="line">    ylim(min(dt<span class="variable">$val</span>, 0)*1.1, max(dt<span class="variable">$val</span>)*1.1)   <span class="comment">## 加大 Y 轴的范围，防止数字显示不齐全</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ggthemes.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br><span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dndGhlbWVzL3ZpZ25ldHRlcy9nZ3RoZW1lcy5odG1s" title="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">ggthemes<i class="fa fa-link"></i><i class="fa fa-external-link"></i></span>为ggplot2的一个主题包，通过theme_pander()修改ggplot2默认主题（theme）.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dt<span class="variable">$obj</span>是因子类型，ggplot2作图时按照因子水平顺序来的，所以修改因子水平的顺序即可修改作图顺序，具体可以输出dt<span class="variable">$obl</span>.</span><br></pre></td></tr></table></figure></p>
<p>另一种改变柱子顺序方式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p + scale_x_discrete(limits=c(<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'E'</span>))</span><br></pre></td></tr></table></figure></p>
<p></p><p></p><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3lhbmdjaGFvLm1lLzIwMTMvMDIvZ2dwbG90Mi1iYXItY2hhcnQv" title="http://yangchao.me/2013/02/ggplot2-bar-chart/">http://yangchao.me/2013/02/ggplot2-bar-chart/<i class="fa fa-external-link"></i></span><br>                       <span class="exturl" data-url="aHR0cDovL3d3dy5idWJ1a28uY29tL2luZm9kZXRhaWwtMTA1MTk0MC5odG1s" title="http://www.bubuko.com/infodetail-1051940.html">http://www.bubuko.com/infodetail-1051940.html<i class="fa fa-external-link"></i></span><br>                       <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDgwNTY0My9nZ3Bsb3QyLWFkZC1jb2xvci10by1ib3hwbG90LWNvbnRpbnVvdXMtdmFsdWUtc3VwcGxpZWQtdG8tZGlzY3JldGUtc2NhbGUtZXI=" title="http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er">http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;The bar geom is used to produce 1d area plots: bar charts for categorical x, and histograms for continuous y. stat_bin explains the detai
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="bar" scheme="http://tiramisutes.github.io/tags/bar/"/>
    
  </entry>
  
  <entry>
    <title>Icons</title>
    <link href="http://tiramisutes.github.io/2015/10/07/icon.html"/>
    <id>http://tiramisutes.github.io/2015/10/07/icon.html</id>
    <published>2015-10-07T05:56:31.000Z</published>
    <updated>2018-09-28T02:36:13.967Z</updated>
    
    <content type="html"><![CDATA[<p><i class="fa fa-bullhorn fa-3x"></i> Setting up Font Awesome can be as simple as adding two lines of code to your website, or you can be a pro and<br>customize the LESS yourself! Font Awesome even plays nicely with<span class="exturl" data-url="aHR0cDovL2dldGJvb3RzdHJhcC5jb20=" title="http://getbootstrap.com">Bootstrap 3<i class="fa fa-external-link"></i></span>!</p>
<h2 id="Paste_the_following_code_into_the_section_of_your_site’s_HTML-"><i class="fa fa-pencil-square-o"></i>Paste the following code into the <head> section of your site’s HTML.</head></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="如果font-awesome-min-css文件在本地，则按一下操作：">如果font-awesome.min.css文件在本地，则按一下操作：</h3><p><i class="fa fa-hand-lizard-o"></i> 进入<i class="fa fa-chain-broken"></i> <span class="exturl" data-url="aHR0cDovL2ZvbnRhd2Vzb21lLmlvLyNtb2RhbC1kb3dubG9hZA==" title="http://fontawesome.io/#modal-download">fontawesome<i class="fa fa-external-link"></i></span>下载字体<i class="fa fa-font"></i>和相应的CSS<i class="fa fa-th"></i>文件。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/font.png" alt=""></p>
<p></p><p></p><br><i class="fa fa-hand-lizard-o"></i> 找到下载<i class="fa fa-download"></i>压缩文件<i class="fa fa-file-archive-o"></i>中的fonts<i class="fa fa-file"></i>和css<i class="fa fa-file"></i>文件夹，将其中内容拷贝<i class="fa fa-files-o"></i>到自己站点下。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/font2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">your blog address\themes\jacman\<span class="built_in">source</span>\font   修改字体文件</span><br><span class="line">your blog address\jacman\<span class="built_in">source</span>\css    修改字体相应的css</span><br></pre></td></tr></table></figure><p></p>
<p><i class="fa fa-hand-lizard-o"></i> following code into the <head> section of your site’s HTML.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href=<span class="string">"/css/font-awesome.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure></head></p>
<h2 id="Examples"><i class="fa fa-pencil-square-o"></i>Examples</h2><h3 id="Basic_Icons">Basic Icons</h3><p><i class="fa fa-camera-retro"></i> fa-camera-retro<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro"</span>&gt;&lt;/i&gt; fa-camera-retro</span><br></pre></td></tr></table></figure></p>
<h3 id="Larger_Icons">Larger Icons</h3><p><i class="fa fa-camera-retro fa-lg"></i> fa-lg<br><i class="fa fa-camera-retro fa-2x"></i> fa-2x<br><i class="fa fa-camera-retro fa-3x"></i> fa-3x<br><i class="fa fa-camera-retro fa-4x"></i> fa-4x<br><i class="fa fa-camera-retro fa-5x"></i> fa-5x<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-lg"</span>&gt;&lt;/i&gt; fa-lg</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-2x"</span>&gt;&lt;/i&gt; fa-2x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-3x"</span>&gt;&lt;/i&gt; fa-3x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-4x"</span>&gt;&lt;/i&gt; fa-4x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-5x"</span>&gt;&lt;/i&gt; fa-5x</span><br></pre></td></tr></table></figure></p>
<h3 id="Fixed_Width_Icons">Fixed Width Icons</h3><p>  <a class="list-group-item" href="#"><i class="fa fa-home fa-fw"></i>&nbsp; Home</a><br>  <a class="list-group-item" href="#"><i class="fa fa-book fa-fw"></i>&nbsp; Library</a><br>  <a class="list-group-item" href="#"><i class="fa fa-pencil fa-fw"></i>&nbsp; Applications</a><br>  <a class="list-group-item" href="#"><i class="fa fa-cog fa-fw"></i>&nbsp; Settings</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=<span class="string">"list-group"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-home fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Home&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-book fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Library&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-pencil fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Applications&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-cog fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Settings&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="List_Icons">List Icons</h3><p>  <li><i class="fa-li fa fa-check-square"></i>List icons</li><br>  <li><i class="fa-li fa fa-check-square"></i>can be used</li><br>  <li><i class="fa-li fa fa-spinner fa-spin"></i>as bullets</li><br>  <li><i class="fa-li fa fa-square"></i>in lists</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class=<span class="string">"fa-ul"</span>&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-check-square"</span>&gt;&lt;/i&gt;List icons&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-check-square"</span>&gt;&lt;/i&gt;can be used&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-spinner fa-spin"</span>&gt;&lt;/i&gt;as bullets&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-square"</span>&gt;&lt;/i&gt;<span class="keyword">in</span> lists&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Bordered_&amp;_Pulled_Icons">Bordered &amp; Pulled Icons</h3><p><i class="fa fa-quote-left fa-3x fa-pull-left fa-border"></i><br>…tomorrow we will run faster, stretch out our arms farther…<br>And then one fine morning— So we beat on, boats against the<br>current, borne back ceaselessly into the past.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-quote-left fa-3x fa-pull-left fa-border"</span>&gt;&lt;/i&gt;</span><br><span class="line">...tomorrow we will run faster, stretch out our arms farther...</span><br><span class="line">And <span class="keyword">then</span> one fine morning— So we beat on, boats against the</span><br><span class="line">current, borne back ceaselessly into the past.</span><br></pre></td></tr></table></figure></p>
<h3 id="Animated_Icons">Animated Icons</h3><p><i class="fa fa-spinner fa-spin"></i><br><i class="fa fa-circle-o-notch fa-spin"></i><br><i class="fa fa-refresh fa-spin"></i><br><i class="fa fa-cog fa-spin"></i><br><i class="fa fa-spinner fa-pulse"></i><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-spinner fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-circle-o-notch fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-refresh fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-cog fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-spinner fa-pulse"</span>&gt;&lt;/i&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Rotated_&amp;_Flipped">Rotated &amp; Flipped</h3><p><i class="fa fa-shield"></i> normal<br><br><i class="fa fa-shield fa-rotate-90"></i> fa-rotate-90<br><br><i class="fa fa-shield fa-rotate-180"></i> fa-rotate-180<br><br><i class="fa fa-shield fa-rotate-270"></i> fa-rotate-270<br><br><i class="fa fa-shield fa-flip-horizontal"></i> fa-flip-horizontal<br><br><i class="fa fa-shield fa-flip-vertical"></i> icon-flip-vertical<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-shield"</span>&gt;&lt;/i&gt; normal&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-90"</span>&gt;&lt;/i&gt; fa-rotate-90&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-180"</span>&gt;&lt;/i&gt; fa-rotate-180&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-270"</span>&gt;&lt;/i&gt; fa-rotate-270&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-flip-horizontal"</span>&gt;&lt;/i&gt; fa-flip-horizontal&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-flip-vertical"</span>&gt;&lt;/i&gt; icon-flip-vertical</span><br></pre></td></tr></table></figure></p>
<h3 id="Stacked_Icons">Stacked Icons</h3><p><span class="fa-stack fa-lg"><br>  <i class="fa fa-square-o fa-stack-2x"></i><br>  <i class="fa fa-twitter fa-stack-1x"></i><br></span><br>fa-twitter on fa-square-o<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-circle fa-stack-2x"></i><br>  <i class="fa fa-flag fa-stack-1x fa-inverse"></i><br></span><br>fa-flag on fa-circle<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-square fa-stack-2x"></i><br>  <i class="fa fa-terminal fa-stack-1x fa-inverse"></i><br></span><br>fa-terminal on fa-square<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-camera fa-stack-1x"></i><br>  <i class="fa fa-ban fa-stack-2x text-danger"></i><br></span><br>fa-ban on fa-camera<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-square-o fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-twitter fa-stack-1x"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-twitter on fa-square-o&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-circle fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-flag fa-stack-1x fa-inverse"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-flag on fa-circle&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-square fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-terminal fa-stack-1x fa-inverse"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-terminal on fa-square&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-camera fa-stack-1x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-ban fa-stack-2x text-danger"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-ban on fa-camera</span><br></pre></td></tr></table></figure></p>
<h3 id="Bootstrap_3_Examples">Bootstrap 3 Examples</h3><p><a class="btn btn-danger" href="#"><br>  <i class="fa fa-trash-o fa-lg"></i> Delete</a><br><a class="btn btn-default btn-sm" href="#"><br>  <i class="fa fa-cog"></i> Settings</a></p>
<p><a class="btn btn-lg btn-success" href="#"><br>  <i class="fa fa-flag fa-2x pull-left"></i> Font Awesome<br>Version 4.4.0</a></p>
<div class="btn-group"><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-left"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-center"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-right"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-justify"></i></a><br></div>

<div class="input-group margin-bottom-sm"><br>  <span class="input-group-addon"><i class="fa fa-envelope-o fa-fw"></i></span><br>  <input class="form-control" type="text" placeholder="Email address"><br></div><br><div class="input-group"><br>  <span class="input-group-addon"><i class="fa fa-key fa-fw"></i></span><br>  <input class="form-control" type="password" placeholder="Password"><br></div>

<p><div class="btn-group open"><br>  <a class="btn btn-primary" href="#"><i class="fa fa-user fa-fw"></i> User</a><br>  <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><br>    <span class="fa fa-caret-down"></span></a><br>  <ul class="dropdown-menu"><br>    <li><a href="#"><i class="fa fa-pencil fa-fw"></i> Edit</a></li><br>    <li><a href="#"><i class="fa fa-trash-o fa-fw"></i> Delete</a></li><br>    <li><a href="#"><i class="fa fa-ban fa-fw"></i> Ban</a></li><br>    <li><a href="#"><i class="i"></i> Make admin</a></li><br>  </ul><br></div><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;a class=<span class="string">"btn btn-danger"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-trash-o fa-lg"</span>&gt;&lt;/i&gt; Delete&lt;/a&gt;</span><br><span class="line">&lt;a class=<span class="string">"btn btn-default btn-sm"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-cog"</span>&gt;&lt;/i&gt; Settings&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;a class=<span class="string">"btn btn-lg btn-success"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-flag fa-2x pull-left"</span>&gt;&lt;/i&gt; Font Awesome&lt;br&gt;Version 4.4.0&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"btn-group"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-left"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-center"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-right"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-justify"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"input-group margin-bottom-sm"</span>&gt;</span><br><span class="line">  &lt;span class=<span class="string">"input-group-addon"</span>&gt;&lt;i class=<span class="string">"fa fa-envelope-o fa-fw"</span>&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class="line">  &lt;input class=<span class="string">"form-control"</span> <span class="built_in">type</span>=<span class="string">"text"</span> placeholder=<span class="string">"Email address"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=<span class="string">"input-group"</span>&gt;</span><br><span class="line">  &lt;span class=<span class="string">"input-group-addon"</span>&gt;&lt;i class=<span class="string">"fa fa-key fa-fw"</span>&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class="line">  &lt;input class=<span class="string">"form-control"</span> <span class="built_in">type</span>=<span class="string">"password"</span> placeholder=<span class="string">"Password"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"btn-group open"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-primary"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-user fa-fw"</span>&gt;&lt;/i&gt; User&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-primary dropdown-toggle"</span> data-toggle=<span class="string">"dropdown"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">    &lt;span class=<span class="string">"fa fa-caret-down"</span>&gt;&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">  &lt;ul class=<span class="string">"dropdown-menu"</span>&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-pencil fa-fw"</span>&gt;&lt;/i&gt; Edit&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-trash-o fa-fw"</span>&gt;&lt;/i&gt; Delete&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-ban fa-fw"</span>&gt;&lt;/i&gt; Ban&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"i"</span>&gt;&lt;/i&gt; Make admin&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL2ZvbnRhd2Vzb21lLmlvL2V4YW1wbGVzLw==" title="http://fontawesome.io/examples/">http://fontawesome.io/examples/<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;i class=&quot;fa fa-bullhorn fa-3x&quot;&gt;&lt;/i&gt; Setting up Font Awesome can be as simple as adding two lines of code to your website, or you can be 
    
    </summary>
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/categories/Hexo/"/>
    
    
      <category term="icon" scheme="http://tiramisutes.github.io/tags/icon/"/>
    
  </entry>
  
  <entry>
    <title>为图形添加文本</title>
    <link href="http://tiramisutes.github.io/2015/10/05/plot-text.html"/>
    <id>http://tiramisutes.github.io/2015/10/05/plot-text.html</id>
    <published>2015-10-05T11:52:16.000Z</published>
    <updated>2018-09-28T02:41:59.448Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&gt; text1&lt;-read.delim(<span class="string">"fun.txt"</span>,header=FALSE)</span><br><span class="line">&gt; text1</span><br><span class="line">                                                                    V1</span><br><span class="line">1                                   INFORMATION STORAGE AND PROCESSING</span><br><span class="line">2                 [J] Translation, ribosomal structure and biogenesis </span><br><span class="line">3                                 [A] RNA processing and modification </span><br><span class="line">4                                                   [K] Transcription </span><br><span class="line">5                           [L] Replication, recombination and repair </span><br><span class="line">6                                [B] Chromatin structure and dynamics </span><br><span class="line">7                                     CELLULAR PROCESSES AND SIGNALING</span><br><span class="line">8      [D] Cell cycle control, cell division, chromosome partitioning </span><br><span class="line">9                                               [Y] Nuclear structure </span><br><span class="line">10                                             [V] Defense mechanisms </span><br><span class="line">11                                 [T] Signal transduction mechanisms </span><br><span class="line">12                         [M] Cell wall/membrane/envelope biogenesis </span><br><span class="line">13                                                  [N] Cell motility </span><br><span class="line">14                                                   [Z] Cytoskeleton </span><br><span class="line">15                                       [W] Extracellular structures </span><br><span class="line">16  [U] Intracellular trafficking, secretion, and vesicular transport </span><br><span class="line">17   [O] Posttranslational modification, protein turnover, chaperones </span><br><span class="line">18                                                          METABOLISM</span><br><span class="line">19                               [C] Energy production and conversion </span><br><span class="line">20                          [G] Carbohydrate transport and metabolism </span><br><span class="line">21                            [E] Amino acid transport and metabolism </span><br><span class="line">22                            [F] Nucleotide transport and metabolism </span><br><span class="line">23                              [H] Coenzyme transport and metabolism </span><br><span class="line">24                                 [I] Lipid transport and metabolism </span><br><span class="line">25                         [P] Inorganic ion transport and metabolism </span><br><span class="line">26   [Q] Secondary metabolites biosynthesis, transport and catabolism </span><br><span class="line">27                                                POORLY CHARACTERIZED</span><br><span class="line">28                               [R] General <span class="keyword">function</span> prediction only </span><br><span class="line">29                                               [S] Function unknown </span><br><span class="line">&gt; a&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>);</span><br><span class="line">&gt; b&lt;-c(1,2,3);</span><br><span class="line">&gt; c&lt;-c(4,6,7);</span><br><span class="line">&gt; abc&lt;-data.frame(a,b,c);</span><br><span class="line">&gt; abc;</span><br><span class="line">  a b c</span><br><span class="line">1 a 1 4</span><br><span class="line">2 b 2 6</span><br><span class="line">3 c 3 7</span><br><span class="line">&gt; library(reshape2);</span><br><span class="line">&gt; agcd&lt;-melt(abc,id.vars=<span class="string">"a"</span>,value.name=<span class="string">"value"</span>,variable.name=<span class="string">"bq"</span>);</span><br><span class="line">&gt; len&lt;-nrow(text1);</span><br><span class="line">&gt; a1&lt;-agcd[,1];</span><br><span class="line">&gt; b1&lt;-agcd[,3];</span><br><span class="line">&gt; library(ggplot2);</span><br><span class="line">&gt; library(grid);</span><br><span class="line">&gt; vp1&lt;-viewport(width=0.6,height=1,x=0.3,y=0.5);</span><br><span class="line">&gt; pm&lt;-ggplot(agcd,aes(a1,weight=value,fill=bq))+geom_bar(position=<span class="string">"dodge"</span>)+theme(legend.title=element_blank(),legend.position=c(0.1,0.9))+xlab(<span class="string">"COG"</span>)+ylab(<span class="string">"M82/smithella  and  M82/SB"</span>);</span><br><span class="line"><span class="comment">#之上为画图部分，下面开始绘制文本</span></span><br><span class="line">&gt; par(fig=c(0.55,1,0,1),bty=<span class="string">"n"</span>);</span><br><span class="line">&gt; b&lt;-20;</span><br><span class="line">&gt; plot(1:b,1:b,<span class="built_in">type</span>=<span class="string">"n"</span>,xaxt=<span class="string">"n"</span>,yaxt=<span class="string">"n"</span>,xlab=<span class="string">""</span>,ylab=<span class="string">""</span>);</span><br><span class="line">&gt; sum=b+b/(2*len);</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:(len))&#123;</span><br><span class="line">+   <span class="keyword">if</span> (i %<span class="keyword">in</span>% c(1,7,18,27) )&#123;</span><br><span class="line">+     text(1,sum,text1[i,],adj=0,cex=0.8,font=2);</span><br><span class="line">+     sum=sum-b/(len);</span><br><span class="line">+   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">+     text(1,sum,text1[i,],adj=0,cex=0.8);</span><br><span class="line">+     sum=sum-b/(len);&#125;&#125;</span><br><span class="line"><span class="comment">#将图形和文本合并</span></span><br><span class="line">&gt; <span class="built_in">print</span>(pm,vp=vp1);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plot-text.png" alt=""></p>
<h3 id="关键点解释">关键点解释</h3><p>设置图形参数—函数par()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adj：设定在text、mtext、title中字符串的对齐方向。0表示左对齐，0.5（默认值）表示居中，而1表示右对齐。</span><br><span class="line">ann：如果ann=FALSE，那么高水平绘图函数会调用函数plot.default使对坐标轴名称、整体图像名称不做任何注解。</span><br><span class="line">bty：用于限定图形的边框类型。如果bty的值为<span class="string">"o"</span>（默认值）、<span class="string">"l"</span>、<span class="string">"7"</span>、<span class="string">"c"</span>、<span class="string">"u"</span>或者<span class="string">"]"</span>中的任意一个，对应的边框类型就和该字母的形状相似，<span class="string">"n"</span>，表示无边框。</span><br><span class="line">fig: c(x1, x2, y1, y2)，设定当前图形在绘图设备中所占区域，需要满足x1&lt;x2,y1&lt;y2。如果修改参数fig，会自动打开一个新的绘图设备，而若希望在原来的绘图设备中添加新的图形，需要和参数new=TRUE一起使用。</span><br><span class="line">fin：当前绘图区域的尺寸规格，形式为(width,height)。</span><br><span class="line">lty：直线类型。参数的值可以为整数（0为空，1为实线（默认值），2为虚线，3为点线。</span><br><span class="line">oma：参数形式为c(bottom, left, top, right) ，用于设定外边界。</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fig.jpg" alt=""><br>melt()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id.vars 是被当做维度的列变量，每个变量在结果中占一列；</span><br><span class="line">measure.vars 是被当成观测值的列变量，它们的列变量名称和值分别组成 variable 和 value两列，列变量名称用variable.name 和 value.name来指定。</span><br></pre></td></tr></table></figure></p>
<p>position()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">geom_bar(position=<span class="string">"dodge"</span>)调整条形图排列方式，可选参数为<span class="string">"dodge，fill，identity，jitter，stack"</span>。legend.position调整图例位置。</span><br><span class="line">dodge：<span class="string">"避让"</span>方式，即往旁边闪，如柱形图的并排方式就是这种</span><br><span class="line">fill：填充方式， 先把数据归一化，再填充到绘图区的顶部</span><br><span class="line">identity：原地不动，不调整位置</span><br><span class="line">jitter：随机抖一抖，让本来重叠的露出点头来</span><br><span class="line">stack：叠罗汉</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&lt;-20;为自定义值，根据图形微调。</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1,7,18,27为文本文件中特殊行。</span><br></pre></td></tr></table></figure>
<h2 id="附加">附加</h2><p>通过设置par（）绘制一页多图<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">attach(mtcars)</span><br><span class="line">opar&lt;-par(no.readonly=T) </span><br><span class="line">par(fig=c(0,0.8,0,0.8))</span><br><span class="line">plot(wt,mpg,xlab=<span class="string">"Miles per Gallon"</span>,ylab=<span class="string">"car weight"</span>)</span><br><span class="line">par(fig=c(0,0.8,0.55,1),new=T)</span><br><span class="line">boxplot(wt,horizontal=T,axes=F)</span><br><span class="line">par(fig=c(0.65,1,0,0.8),new=T)</span><br><span class="line">boxplot(mpg,axes=F)</span><br><span class="line">par(opar)</span><br><span class="line">detach(mtcars)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/duotu.png" alt=""></p>
<p><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5kYXRhZ3VydS5jbi9hcnRpY2xlLTQ4MjctMS5odG1s" title="http://www.dataguru.cn/article-4827-1.html">http://www.dataguru.cn/article-4827-1.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="plot-text" scheme="http://tiramisutes.github.io/tags/plot-text/"/>
    
  </entry>
  
  <entry>
    <title>R中分组统计函数</title>
    <link href="http://tiramisutes.github.io/2015/10/05/statistics.html"/>
    <id>http://tiramisutes.github.io/2015/10/05/statistics.html</id>
    <published>2015-10-05T11:37:27.000Z</published>
    <updated>2015-10-05T11:50:53.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="apply（对一个数组按行或者按列进行计算）">apply（对一个数组按行或者按列进行计算）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply(X, MARGIN, FUN, ...)</span><br></pre></td></tr></table></figure></p>
<p>其中X为一个数组；MARGIN为一个向量（表示要将函数FUN应用到X的行还是列），若为1表示取行，为2表示取列，为c(1,2)表示行、列都计算。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; ma &lt;- matrix(c(1:4, 1, 6:8), nrow = 2)</span><br><span class="line">&gt; ma</span><br><span class="line">     [,1] [,2] [,3] [,4]</span><br><span class="line">[1,]    1    3    1    7</span><br><span class="line">[2,]    2    4    6    8</span><br><span class="line">&gt; apply(ma, c(1,2), sum)</span><br><span class="line">     [,1] [,2] [,3] [,4]</span><br><span class="line">[1,]    1    3    1    7</span><br><span class="line">[2,]    2    4    6    8</span><br><span class="line">&gt; apply(ma, 1, sum)</span><br><span class="line">[1] 12 20</span><br><span class="line">&gt; apply(ma, 2, sum)</span><br><span class="line">[1]  3  7  7 15</span><br></pre></td></tr></table></figure></p>
<h2 id="tapply（分组统计）">tapply（分组统计）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tapply(X, INDEX, FUN = NULL, ..., simplify = TRUE)</span><br></pre></td></tr></table></figure></p>
<p>其中X通常是一向量；<br>INDEX是一个list对象，且该list中的每一个元素都是与X有同样长度的因子；<br>FUN是需要计算的函数；<br>simplify是逻辑变量，若取值为TRUE（默认值），且函数FUN的计算结果总是为一个标量值，那么函数tapply返回一个数组；<br>                  若取值为FALSE，则函数tapply的返回值为一个list对象。<br>需要注意的是，当第二个参数INDEX不是因子时，函数 tapply() 同样有效，因为必要时 R 会用 as.factor()把参数强制转换成因子。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt; a&lt;-data.frame(name=c(<span class="string">"tom"</span>,<span class="string">"sam"</span>,<span class="string">"mik"</span>,<span class="string">"ali"</span>),age=c(8,9,8,9),math=c(50,100,70,90),verbal=c(90,60,96,80))</span><br><span class="line">&gt; a</span><br><span class="line">  name age math verbal</span><br><span class="line">1  tom   8   50     90</span><br><span class="line">2  sam   9  100     60</span><br><span class="line">3  mik   8   70     96</span><br><span class="line">4  ali   9   90     80</span><br><span class="line">&gt; ages&lt;-levels(as.factor(a<span class="variable">$age</span>))</span><br><span class="line">&gt; ages</span><br><span class="line">[1] <span class="string">"8"</span> <span class="string">"9"</span></span><br><span class="line">&gt; b&lt;-matrix(nrow=length(ages),ncol=2)</span><br><span class="line">&gt; rownames(b)&lt;-ages</span><br><span class="line">&gt; colnames(b)&lt;-c(<span class="string">"math"</span>,<span class="string">"verbal"</span>)</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:2)&#123;</span><br><span class="line">+   b[,i]&lt;-tapply(a[,i+2],a[,<span class="string">"age"</span>],mean)   <span class="comment">#tapply的排序方法是输入factor的levels.</span></span><br><span class="line">+   &#125;</span><br><span class="line">&gt; b</span><br><span class="line">  math verbal</span><br><span class="line">8   60     93</span><br><span class="line">9   95     70</span><br></pre></td></tr></table></figure></p>
<h2 id="table（因子出现的频数）">table（因子出现的频数）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table(..., exclude = <span class="keyword">if</span> (useNA == <span class="string">"no"</span>) c(NA, NaN), useNA = c(<span class="string">"no"</span>,</span><br><span class="line">    <span class="string">"ifany"</span>, <span class="string">"always"</span>), dnn = list.names(...), deparse.level = 1)</span><br></pre></td></tr></table></figure></p>
<p>其中参数exclude表示哪些因子不计算。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; d &lt;- factor(rep(c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>), 10), levels=c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>,<span class="string">"E"</span>))</span><br><span class="line">&gt; d</span><br><span class="line"> [1] A B C A B C A B C A B C A B C A B C A B C A B C A B C A B C</span><br><span class="line">Levels: A B C D E</span><br><span class="line">&gt; table(d)</span><br><span class="line">d</span><br><span class="line"> A  B  C  D  E</span><br><span class="line">10 10 10  0  0</span><br><span class="line">&gt; table(d, exclude=<span class="string">"B"</span>)</span><br><span class="line">d</span><br><span class="line"> A  C  D  E</span><br><span class="line">10 10  0  0</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;apply（对一个数组按行或者按列进行计算）&quot;&gt;apply（对一个数组按行或者按列进行计算）&lt;/h2&gt;&lt;p&gt;使用格式为：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="statistics" scheme="http://tiramisutes.github.io/tags/statistics/"/>
    
  </entry>
  
  <entry>
    <title>R作图--坐标中断(axis breaks)-- plotrix</title>
    <link href="http://tiramisutes.github.io/2015/10/05/plotrix.html"/>
    <id>http://tiramisutes.github.io/2015/10/05/plotrix.html</id>
    <published>2015-10-05T05:12:51.000Z</published>
    <updated>2018-09-28T02:41:52.559Z</updated>
    
    <content type="html"><![CDATA[<p>R当中的坐标中断一般都使用plotrix库中的axis.break(), gap.plot(), gap.barplot(), gap.boxplot()等几个函数来实现.</p>
<h2 id="axis-break">axis.break</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(plotrix)</span><br><span class="line">opar&lt;-par(mfrow=c(1,3))</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of gap"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of slash"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of zigzag"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"zigzag"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix1.png" alt=""></p>
<h3 id="parameters">parameters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">axis.break(axis=1,breakpos=NULL,pos=NA,bgcol=<span class="string">"white"</span>,breakcol=<span class="string">"black"</span>,</span><br><span class="line">           style=<span class="string">"slash"</span>,brw=0.02)</span><br><span class="line">axis：    <span class="built_in">which</span> axis to <span class="built_in">break</span>,1=x轴，2=y轴，3=顶端x轴，4=右y轴</span><br><span class="line">breakpos：<span class="built_in">where</span> to place the <span class="built_in">break</span> <span class="keyword">in</span> user units</span><br><span class="line">pos：     position of the axis (see axis)</span><br><span class="line">bgcol：   the color of the plot background</span><br><span class="line">breakcol：the color of the <span class="string">"break"</span> marker</span><br><span class="line">style：   Either gap, slash or zigzag</span><br><span class="line">brw：     <span class="built_in">break</span> width relative to plot width</span><br></pre></td></tr></table></figure>
<h2 id="gap-plot">gap.plot</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">opar&lt;-par(mfrow=c(1,3))</span><br><span class="line">twogrp&lt;-c(rnorm(5)+4,rnorm(5)+20,rnorm(5)+5,rnorm(5)+22)</span><br><span class="line">gap.plot(twogrp,gap=c(8,16,25,35),</span><br><span class="line">          xlab=<span class="string">"X values"</span>,ylab=<span class="string">"Y values"</span>,xlim=c(1,30),ylim=c(0,45),</span><br><span class="line">          main=<span class="string">"Test two gap plot with the lot"</span>,xtics=seq(0,30,by=5),</span><br><span class="line">          ytics=c(4,6,18,20,22,38,40,42),</span><br><span class="line">          lty=c(rep(1,10),rep(2,10)),</span><br><span class="line">          pch=c(rep(2,10),rep(3,10)),</span><br><span class="line">          col=c(rep(2,10),rep(3,10)),</span><br><span class="line">          <span class="built_in">type</span>=<span class="string">"b"</span>)</span><br><span class="line">gap.plot(21:30,rnorm(10)+40,gap=c(8,16,25,35),add=TRUE,</span><br><span class="line">         lty=rep(3,10),col=rep(4,10),<span class="built_in">type</span>=<span class="string">"l"</span>)</span><br><span class="line">gap.barplot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ytics=c(3,6,17,20),</span><br><span class="line">         ylab=<span class="string">"Group values"</span>,main=<span class="string">"Barplot with gap"</span>)</span><br><span class="line">gap.barplot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ytics=c(3,6,17,20),</span><br><span class="line">         ylab=<span class="string">"Group values"</span>,horiz=TRUE,main=<span class="string">"Horizontal barplot with gap"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">opar&lt;-par(mfrow=c(1,2))</span><br><span class="line">twovec&lt;-list(vec1=c(rnorm(30),-6),vec2=c(sample(1:10,40,TRUE),20))</span><br><span class="line">gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),</span><br><span class="line">        main=<span class="string">"Show outliers separately"</span>)</span><br><span class="line">gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),range=0,</span><br><span class="line">         main=<span class="string">"Include outliers in whiskers"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix3.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">twogrp&lt;-c(rnorm(5)+4,rnorm(5)+20,rnorm(5)+5,rnorm(5)+22)</span><br><span class="line">gpcol&lt;-c(2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5)</span><br><span class="line">gap.plot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ylab=<span class="string">"Group values"</span>, main=<span class="string">"E "</span>,col=gpcol)</span><br><span class="line">legend(19, 9.5, c(<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>), pch = 1, col = 2:5)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix4.png" alt=""></p>
<h3 id="parameters-1">parameters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">gap.plot(x,y,gap,gap.axis=<span class="string">"y"</span>,bgcol=<span class="string">"white"</span>,breakcol=<span class="string">"black"</span>,brw=0.02,xlim=range(x),ylim=range(y),</span><br><span class="line">xticlab,xtics=NA,yticlab,ytics=NA,lty=rep(1,length(x)),col=rep(par(<span class="string">"col"</span>),length(x)),</span><br><span class="line">pch=rep(1,length(x)),add=FALSE,stax=FALSE,...)</span><br><span class="line"> </span><br><span class="line">x,y:      data values</span><br><span class="line">gap:      the range(s) of values to be left out  省略的轴</span><br><span class="line">gap.axis: whether the gaps are to be on the x or y axis   在哪个轴上省略</span><br><span class="line">bgcol:    the color of the plot background</span><br><span class="line">breakcol: the color of the <span class="string">"break"</span> marker</span><br><span class="line">brw:      <span class="built_in">break</span> width relative to plot width</span><br><span class="line">xlim,ylim:the plot limits.</span><br><span class="line">xticlab:  labels <span class="keyword">for</span> the x axis ticks</span><br><span class="line">xtics:    position of the x axis ticks  <span class="comment">#x轴显示的表号</span></span><br><span class="line">yticlab:  labels <span class="keyword">for</span> the y axis ticks</span><br><span class="line">ytics:    position of the y axis ticks</span><br><span class="line">lty:      line <span class="built_in">type</span>(s) to use <span class="keyword">if</span> there are lines</span><br><span class="line">col:      color(s) <span class="keyword">in</span> <span class="built_in">which</span> to plot the values</span><br><span class="line">pch:      symbols to use <span class="keyword">in</span> plotting.</span><br><span class="line">add:      whether to add values to an existing plot.</span><br><span class="line">stax:     whether to call staxlab <span class="keyword">for</span> staggered axis labels.</span><br></pre></td></tr></table></figure>
<h2 id="gap-barplot">gap.barplot</h2><p>使用gap.plot, gap.barplot, gap.boxplot之后重新使用axis.break来修改中断类型，使得看上去美一点,<br>并绘制出双反斜线中断，可以视实际情况延伸断点起止位置.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">library(plotrix)</span><br><span class="line">opar&lt;-par(mfrow=c(2,2))</span><br><span class="line">x&lt;-c(1:5,6.9,7)</span><br><span class="line">y&lt;-2^x</span><br><span class="line">from&lt;-33</span><br><span class="line">to&lt;-110</span><br><span class="line">plot(x,y,<span class="built_in">type</span>=<span class="string">"b"</span>,main=<span class="string">"normal plot"</span>)</span><br><span class="line">gap.plot(x,y,gap=c(from,to),<span class="built_in">type</span>=<span class="string">"b"</span>,main=<span class="string">"gap plot"</span>)</span><br><span class="line">axis.break(2,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(2,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(4,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(2,at=from)</span><br><span class="line">gap.barplot(y,gap=c(from,to),col=as.numeric(x),main=<span class="string">"barplot with gap"</span>)</span><br><span class="line">axis.break(2,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(2,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(4,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(2,at=from)</span><br><span class="line">gap.barplot(y,gap=c(from,to),col=as.numeric(x),horiz=T,main=<span class="string">"Horizontal barplot with gap"</span>)</span><br><span class="line">axis.break(1,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(1,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(3,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(1,at=from) </span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix5.png" alt=""><br><i class="fa fa-diamond"></i>如果画图过程中困惑了，记得重新来看一下内容，有惊喜：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">x1=c(3,5,6,9,375,190);</span><br><span class="line">x1</span><br><span class="line">x2=c(2,2,3,30,46,60);</span><br><span class="line">x2</span><br><span class="line">data=rbind(x1,x2);</span><br><span class="line">data</span><br><span class="line">colnames(data)=c(<span class="string">"Pig"</span>,<span class="string">"Layer"</span>,<span class="string">"Broiler"</span>,<span class="string">"Dairy"</span>,<span class="string">"Beef"</span>,<span class="string">"Sheep"</span>)</span><br><span class="line">rownames(data)=c(<span class="string">"1980"</span>,<span class="string">"2010"</span>)</span><br><span class="line">data</span><br><span class="line">library(plotrix)</span><br><span class="line">newdata&lt;-data</span><br><span class="line">newdata[newdata&gt;200]&lt;-newdata[newdata&gt;200]-150</span><br><span class="line">newdata</span><br><span class="line">barpos&lt;-barplot(newdata,names.arg=colnames(newdata),</span><br><span class="line">                ylim=c(0,250),beside=TRUE,col=c(<span class="string">"darkblue"</span>,<span class="string">"red"</span>),axes=FALSE)</span><br><span class="line">axis(2,at=c(0,50,100,150,200,235),</span><br><span class="line">     labels=c(0,50,100,150,200,375))</span><br><span class="line">box()</span><br><span class="line">axis.break(2,210,style=<span class="string">"gap"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/axis.png" alt=""><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5kYXRhZ3VydS5jbi9hcnRpY2xlLTQ4MjctMS5odG1s" title="http://www.dataguru.cn/article-4827-1.html">http://www.dataguru.cn/article-4827-1.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;R当中的坐标中断一般都使用plotrix库中的axis.break(), gap.plot(), gap.barplot(), gap.boxplot()等几个函数来实现.&lt;/p&gt;
&lt;h2 id=&quot;axis-break&quot;&gt;axis.break&lt;/h2&gt;&lt;figure cla
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="coordinates" scheme="http://tiramisutes.github.io/tags/coordinates/"/>
    
  </entry>
  
  <entry>
    <title>Modify the coordinates</title>
    <link href="http://tiramisutes.github.io/2015/10/03/coordinates.html"/>
    <id>http://tiramisutes.github.io/2015/10/03/coordinates.html</id>
    <published>2015-10-03T07:30:33.000Z</published>
    <updated>2018-09-28T04:12:12.082Z</updated>
    
    <content type="html"><![CDATA[<h2 id="修改坐标的函数">修改坐标的函数</h2><p>修改坐标的这类属性，要用到theme()函数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gg&lt;-ggplot(diamonds[1:20,])</span><br><span class="line">gg+geom_bar(aes(price,fill=cut)) + theme(axis.text.x=element_text(family=<span class="string">"myFont2"</span>,face=<span class="string">"bold"</span>,size=10,angle=45,color=<span class="string">"red"</span>))</span><br></pre></td></tr></table></figure></p>
<h3 id="效果:">效果:</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo.png" alt=""></p>
<h3 id="解释：">解释：</h3><p>凡事要修改坐标文字的格式，都加一句来修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme(axis.text.x=theme_text(X轴属性),asix.text.y=theme_text(Y轴属性))</span><br></pre></td></tr></table></figure></p>
<p>theme_text()是存储文字属性的函数，其内置属性如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">family：字体</span><br><span class="line">face：粗体、斜体等</span><br><span class="line">size：字体大小</span><br><span class="line">angle：倾斜角度</span><br><span class="line">color：颜色</span><br></pre></td></tr></table></figure></p>
<h2 id="修改字体">修改字体</h2><p>提前设置一下字体：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windowsFonts(myFont1=windowsFont(<span class="string">"Times New Roman"</span>),myFont2=windowsFont(<span class="string">"宋体"</span>))</span><br></pre></td></tr></table></figure></p>
<p>然后才可以用family来修改字体<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Family=<span class="string">"myfont1"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="修改字体粗细">修改字体粗细</h2><p>Face可以设置的属性有以下几个：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plain：普通</span><br><span class="line">italic：斜体</span><br><span class="line">bold：粗体</span><br><span class="line">bold.italic：粗体+斜体</span><br></pre></td></tr></table></figure></p>
<h2 id="修改尺寸大小">修改尺寸大小</h2><p>用数字代表字体大小即可，普通的字体可以设置为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">size=8</span><br></pre></td></tr></table></figure></p>
<h2 id="修改角度">修改角度</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angle=45</span><br></pre></td></tr></table></figure>
<p>表示字体逆时针倾斜45°，范围是0-360</p>
<h2 id="修改颜色">修改颜色</h2><p>用color或者colour都可以修改颜色，颜色用关键字来表示，或者用十六进制的颜色代码来表示<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colour.png" alt=""><br>详细说明<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYm9uZV9hY2UvYXJ0aWNsZS9kZXRhaWxzLzQ3MzYyNjE5" title="http://blog.csdn.net/bone_ace/article/details/47362619">http://blog.csdn.net/bone_ace/article/details/47362619<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jb29rYm9vay1yLmNvbS9HcmFwaHMvQ29sb3JzXyhnZ3Bsb3QyKS8=" title="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/<i class="fa fa-external-link"></i></span></p>
<h2 id="修改位置">修改位置</h2><p>修改位置用下面的参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hjust：调整横向位置</span><br><span class="line">vjust：调整纵向位置</span><br><span class="line">上面都设置数字，一般调整0.5左右，可以是负值</span><br></pre></td></tr></table></figure></p>
<h2 id="修改刻度标签">修改刻度标签</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xname&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>)</span><br><span class="line">p&lt;- ggplot(data, aes(x=name, y=high),xaxt=<span class="string">"n"</span>)+</span><br><span class="line">           scale_y_discrete(labels=xname)</span><br><span class="line">           scale_x_discrete(labels=xname)</span><br></pre></td></tr></table></figure>
<p>scale_xx_manual(values=c(a,b,c))对ggplot2自动设置aes()进行修改，xx可以是aes()包括的fill，colour，shape.</p>
<h2 id="legend图例的修改">legend图例的修改</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/legend2.jpg" alt=""><br><i class="fa fa-bullhorn fa-2x"></i>ggplot2中的legend包括四个部分:legend.tittle, legend.text, legend.key, legend.backgroud。针对每一部分有四种处理方式：<br><i class="fa fa-bell-o"></i>element_text()绘制标签和标题，可控制字体的family, face, colour, size, hjust, vjust, angle, lineheight,当改变角度时，序将hjust调整至0或1.<br><i class="fa fa-bell-o"></i>element_rect()绘制主要供背景使用的矩形，你可以控制颜色的填充（fill）和边界的colour, size, linetype<br><i class="fa fa-bell-o"></i>element_blank()表示空主题，即对元素不分配相应的绘图空间。该函数可以山区我们不感兴趣的绘图元素。使用之前的colour=NA，fill=NA,让某些元素不可见，但仍然占绘图空间。<br><i class="fa fa-bell-o"></i>element_get()可得到当前主题的设置。<br><i class="fa fa-check"></i>theme()可在一幅图中对某些元素进行局部性修改，theme_update()可为后面图形的绘制进行全局性的修改<br><i class="fa fa-hand-o-right"></i>不加Legend<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.title=element_blank())</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>图例（legend）的位置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.position=<span class="string">"left"</span>)</span><br></pre></td></tr></table></figure></p>
<p>图例（legend）的位置和对齐使用的主题设置legend.position来控制，其值可为right,left,top,bottom,none。<br><i class="fa fa-hand-o-right"></i>修改legend.tittle内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p+scale_colour_hue(name=<span class="string">"what does it eat?"</span>,breaks=c(<span class="string">"herbi"</span>,<span class="string">"carni"</span>,<span class="string">"omni"</span>,NA),labels=c(<span class="string">"plants"</span>,<span class="string">"meat"</span>,<span class="string">"both"</span>,<span class="string">"don't know"</span>))</span><br><span class="line">注：name定义标签标题(legend.tittle)</span><br><span class="line">    breaks为标签原内容(legend.text)</span><br><span class="line">	labels为自定义后的标签内容(legend.text)</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>修改尺寸大小<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.background=element_rect(colour=<span class="string">"purple"</span>,fill=<span class="string">"pink"</span>,size=3,linetype=<span class="string">"dashed"</span>));</span><br><span class="line">p+theme(legend.key.size=unit(2,<span class="string">'cm'</span>));</span><br><span class="line">p+theme(legend.key.width=unit(5,<span class="string">'cm'</span>));</span><br><span class="line">p+theme(legend.text = element_text(colour = <span class="string">'red'</span>, angle = 45, size = 10, hjust = 3, vjust = 3, face = <span class="string">'bold'</span>))</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-times"></i>报错：could not find function “unit”<br><i class="fa fa-commenting-o"></i>解决办法：library(grid)<br><i class="fa fa-hand-o-right"></i>颜色的修改以及一致性<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">library(RColorBrewer);</span><br><span class="line">newpalette&lt;-colorRampPalette(brewer.pal(12,<span class="string">"Set3"</span>))(length(unique(eee<span class="variable">$name</span>)));</span><br><span class="line">p+scale_fill_manual(values=newpalette);</span><br><span class="line">p+geom_bar(position=<span class="string">"stack"</span>,aes(order=desc(name)))</span><br></pre></td></tr></table></figure></p>
<p>更多图例修改：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhZGxleS9nZ3Bsb3QyL3dpa2kvTGVnZW5kLUF0dHJpYnV0ZXM=" title="https://github.com/hadley/ggplot2/wiki/Legend-Attributes">https://github.com/hadley/ggplot2/wiki/Legend-Attributes<i class="fa fa-external-link"></i></span></p>
<h2 id="修改坐标轴的显示范围">修改坐标轴的显示范围</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +labs(title=<span class="string">"example"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">     labs(title=<span class="string">"example"</span>) +</span><br><span class="line">     scale_x_continuous(limits=c(60,64))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo3.png" alt=""></p>
<h2 id="修改坐标的显示刻度">修改坐标的显示刻度</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">    labs(title=<span class="string">"example"</span>) +</span><br><span class="line">    scale_x_continuous(limits=c(60,64)) +</span><br><span class="line">    theme(axis.text.x=element_text(angle=45,size=5))</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo4.png" alt=""><br>修改坐标轴显示间隔用到breaks参数，并且要用seq(起始值，终止值，间隔)函数来设置间隔<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">    labs(title=<span class="string">"example"</span>) +</span><br><span class="line">    scale_x_continuous(limits=c(60,64),breaks=seq(60,64,2)) +</span><br><span class="line">    theme(axis.text.x=element_text(angle=45,size=5))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo5.png" alt=""><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzY3MDQ0NTI0MDEwMnYyNTAuaHRtbA==" title="http://blog.sina.com.cn/s/blog_670445240102v250.html">http://blog.sina.com.cn/s/blog_670445240102v250.html<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;修改坐标的函数&quot;&gt;修改坐标的函数&lt;/h2&gt;&lt;p&gt;修改坐标的这类属性，要用到theme()函数：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;li
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="coordinates" scheme="http://tiramisutes.github.io/tags/coordinates/"/>
    
  </entry>
  
  <entry>
    <title>Mix multiple graphs on the same page</title>
    <link href="http://tiramisutes.github.io/2015/10/03/multiple-R.html"/>
    <id>http://tiramisutes.github.io/2015/10/03/multiple-R.html</id>
    <published>2015-10-03T03:23:52.000Z</published>
    <updated>2015-10-03T06:31:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>Easy way to mix multiple graphs on the same page - R software and data visualization</p>
<h2 id="Install_and_load_required_packages">Install and load required packages</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"gridExtra"</span>)</span><br><span class="line">library(<span class="string">"gridExtra"</span>)</span><br><span class="line">install.packages(<span class="string">"cowplot"</span>)</span><br><span class="line">library(<span class="string">"cowplot"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Prepare_some_data">Prepare some data</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df &lt;- ToothGrowth</span><br><span class="line"><span class="comment"># Convert the variable dose from a numeric to a factor variable</span></span><br><span class="line">df<span class="variable">$dose</span> &lt;- as.factor(df<span class="variable">$dose</span>)</span><br><span class="line">head(df)</span><br><span class="line"><span class="comment">##    len supp dose</span></span><br><span class="line"><span class="comment">## 1  4.2   VC  0.5</span></span><br><span class="line"><span class="comment">## 2 11.5   VC  0.5</span></span><br><span class="line"><span class="comment">## 3  7.3   VC  0.5</span></span><br><span class="line"><span class="comment">## 4  5.8   VC  0.5</span></span><br><span class="line"><span class="comment">## 5  6.4   VC  0.5</span></span><br><span class="line"><span class="comment">## 6 10.0   VC  0.5</span></span><br></pre></td></tr></table></figure>
<h2 id="Cowplot:_Publication-ready_plots">Cowplot: Publication-ready plots</h2><p>The cowplot package is an extension to ggplot2 and it can be used to provide a publication-ready plots.</p>
<h2 id="Basic_plots">Basic plots</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(cowplot)</span><br><span class="line"><span class="comment"># Default plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line">bp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add gridlines</span></span><br><span class="line">bp + background_grid(major = <span class="string">"xy"</span>, minor = <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-1.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-2.png" width="192"><br>Recall that, the function <strong>ggsave()</strong>[in <strong>ggplot2</strong> package] can be used to save ggplots. However, when working with <strong>cowplot</strong>, the function <strong>save_plot()</strong> [in <strong>cowplot</strong> package] is preferred. It’s an alternative to <strong>ggsave</strong> with a better support for multi-figur plots.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">save_plot(<span class="string">"mpg.pdf"</span>, plot.mpg,</span><br><span class="line">          base_aspect_ratio = 1.3 <span class="comment"># make room for figure legend</span></span><br><span class="line">          )</span><br></pre></td></tr></table></figure></p>
<h2 id="Arranging_multiple_graphs_using_cowplot">Arranging multiple graphs using cowplot</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Scatter plot</span></span><br><span class="line">sp &lt;- ggplot(mpg, aes(x = cty, y = hwy, colour = factor(cyl)))+ </span><br><span class="line">  geom_point(size=2.5)</span><br><span class="line">sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bar plot</span></span><br><span class="line">bp &lt;- ggplot(diamonds, aes(clarity, fill = cut)) +</span><br><span class="line">  geom_bar() +</span><br><span class="line">  theme(axis.text.x = element_text(angle=70, vjust=0.5))</span><br><span class="line">bp</span><br></pre></td></tr></table></figure>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-2.png" width="259.2"><br>Combine the two plots (the scatter plot and the bar plot):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot_grid(sp, bp, labels=c(<span class="string">"A"</span>,<span class="string">"B"</span>), ncol = 2, nrow = 1)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-2-1.png" width="528"><br>The function <strong>draw_plot()</strong> can be used to place graphs at particular locations with a particular sizes. The format of the function is:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw_plot(plot, x = 0, y = 0, width = 1, height = 1)</span><br></pre></td></tr></table></figure></p>
<p><ul></ul></p>
<p><li><strong>plot</strong>: the plot to place (ggplot2 or a gtable)</li></p>
<p><li><strong>x</strong>: The x location of the lower left corner of the plot.</li></p>
<p><li><strong>y</strong>: The y location of the lower left corner of the plot.</li></p>
<p><li><strong>width, height</strong>: the width and the height of the plot</li><br><br>The function <strong>ggdraw()</strong> is used to initialize an empty drawing canvas.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plot.iris &lt;- ggplot(iris, aes(Sepal.Length, Sepal.Width)) + </span><br><span class="line">  geom_point() + facet_grid(. ~ Species) + stat_smooth(method = <span class="string">"lm"</span>) +</span><br><span class="line">  background_grid(major = &amp;<span class="comment">#39;y&amp;#39;, minor = "none") + # add thin horizontal lines </span></span><br><span class="line">  panel_border() <span class="comment"># and a border around each panel</span></span><br><span class="line"><span class="comment"># plot.mpt and plot.diamonds were defined earlier</span></span><br><span class="line">ggdraw() +</span><br><span class="line">  draw_plot(plot.iris, 0, .5, 1, .5) +</span><br><span class="line">  draw_plot(sp, 0, 0, .5, .5) +</span><br><span class="line">  draw_plot(bp, .5, 0, .5, .5) +</span><br><span class="line">  draw_plot_label(c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>), c(0, 0, 0.5), c(1, 0.5, 0.5), size = 15)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-3-1.png" width="537.6"></p>
<h2 id="grid-arrange:_Create_and_arrange_multiple_plots">grid.arrange: Create and arrange multiple plots</h2><p>The R code below creates a box plot, a dot plot, a violin plot and a stripchart (jitter plot) :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># Create a box plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a dot plot</span></span><br><span class="line"><span class="comment"># Add the mean point and the standard deviation</span></span><br><span class="line">dp &lt;- ggplot(df, aes(x=dose, y=len, fill=dose)) +</span><br><span class="line">  geom_dotplot(binaxis=&amp;<span class="comment">#39;y&amp;#39;, stackdir=&amp;#39;center&amp;#39;)+</span></span><br><span class="line">  stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">                 geom=<span class="string">"pointrange"</span>, color=<span class="string">"red"</span>)+</span><br><span class="line">   theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a violin plot</span></span><br><span class="line">vp &lt;- ggplot(df, aes(x=dose, y=len)) +</span><br><span class="line">  geom_violin()+</span><br><span class="line">  geom_boxplot(width=0.1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a stripchart</span></span><br><span class="line">sc &lt;- ggplot(df, aes(x=dose, y=len, color=dose, shape=dose)) +</span><br><span class="line">  geom_jitter(position=position_jitter(0.2))+</span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">  theme_gray()</span><br></pre></td></tr></table></figure></p>
<p>Combine the plots using the function <strong>grid.arrange()</strong> [in <strong>gridExtra</strong>] :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">grid.arrange(bp, dp, vp, sc, ncol=2, </span><br><span class="line">             main=<span class="string">"Multiple plots on the same page"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-grid-arrange-data-visualization-1.png" width="518.4"></p>
<h2 id="Add_a_common_legend_for_multiple_ggplot2_graphs">Add a common legend for multiple ggplot2 graphs</h2><p>This can be done in four simple steps :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create the plots : p1, p2, ….</li></p>
<p><li>Save the legend of the plot p1 as an external graphical element (called a “grob” in Grid terminology)</li></p>
<p><li>Remove the legends from all plots</li></p>
<p><li>Draw all the plots with only one legend in the right panel</li><br><br>To <strong>save the legend</strong> of a ggplot, the helper function below can be used :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">get_legend&lt;-<span class="keyword">function</span>(myggplot)&#123;</span><br><span class="line">  tmp &lt;- ggplot_gtable(ggplot_build(myggplot))</span><br><span class="line">  leg &lt;- <span class="built_in">which</span>(sapply(tmp<span class="variable">$grobs</span>, <span class="keyword">function</span>(x) x<span class="variable">$name</span>) == <span class="string">"guide-box"</span>)</span><br><span class="line">  legend &lt;- tmp<span class="variable">$grobs</span>[[leg]]</span><br><span class="line">  <span class="built_in">return</span>(legend)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>(The function above is derived from this <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjUzOTM0OC9nZ3Bsb3Qtc2VwYXJhdGUtbGVnZW5kLWFuZC1wbG90" title="http://stackoverflow.com/questions/12539348/ggplot-separate-legend-and-plot">forum<i class="fa fa-external-link"></i></span>. )<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Create the plots</span></span><br><span class="line"><span class="comment">#++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Create a box plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a violin plot</span></span><br><span class="line">vp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_violin()+</span><br><span class="line">  geom_boxplot(width=0.1)+</span><br><span class="line">  theme(legend.position=<span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Save the legend</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++</span></span><br><span class="line">legend &lt;- get_legend(bp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Remove the legend from the box plot</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++</span></span><br><span class="line">bp &lt;- bp + theme(legend.position=<span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Arrange ggplot2 graphs with a specific width</span></span><br><span class="line">grid.arrange(bp, vp, legend, ncol=3, widths=c(2.3, 2.3, 0.8))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-common-legend-data-visualization-1.png" width="518.4"></p>
<h2 id="Scatter_plot_with_marginal_density_plots">Scatter plot with marginal density plots</h2><p><strong>Step 1/3. Create some data :</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(rnorm(500, mean = -1), rnorm(500, mean = 1.5))</span><br><span class="line">y &lt;- c(rnorm(500, mean = 1), rnorm(500, mean = 1.7))</span><br><span class="line">group &lt;- as.factor(rep(c(1,2), each=500))</span><br><span class="line">df2 &lt;- data.frame(x, y, group)</span><br><span class="line">head(df2)</span><br><span class="line">##             x          y group</span><br><span class="line">## 1 -2.20706575 -0.2053334     1</span><br><span class="line">## 2 -0.72257076  1.3014667     1</span><br><span class="line">## 3  0.08444118 -0.5391452     1</span><br><span class="line">## 4 -3.34569770  1.6353707     1</span><br><span class="line">## 5 -0.57087531  1.7029518     1</span><br><span class="line">## 6 -0.49394411 -0.9058829     1</span><br></pre></td></tr></table></figure></p>
<p><strong>Step 2/3. Create the plots :</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Scatter plot of x and y variables and color by groups</span></span><br><span class="line">scatterPlot &lt;- ggplot(df2,aes(x, y, color=group)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  scale_color_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position=c(0,1), legend.justification=c(0,1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Marginal density plot of x (top panel)</span></span><br><span class="line">xdensity &lt;- ggplot(df2, aes(x, fill=group)) + </span><br><span class="line">  geom_density(alpha=.5) + </span><br><span class="line">  scale_fill_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Marginal density plot of y (right panel)</span></span><br><span class="line">ydensity &lt;- ggplot(df2, aes(y, fill=group)) + </span><br><span class="line">  geom_density(alpha=.5) + </span><br><span class="line">  scale_fill_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure></p>
<p>Create a blank placeholder plot :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">lankPlot &lt;- ggplot()+geom_blank(aes(1,1))+</span><br><span class="line">  theme(</span><br><span class="line">    plot.background = element_blank(), </span><br><span class="line">   panel.grid.major = element_blank(),</span><br><span class="line">   panel.grid.minor = element_blank(), </span><br><span class="line">   panel.border = element_blank(),</span><br><span class="line">   panel.background = element_blank(),</span><br><span class="line">   axis.title.x = element_blank(),</span><br><span class="line">   axis.title.y = element_blank(),</span><br><span class="line">   axis.text.x = element_blank(), </span><br><span class="line">   axis.text.y = element_blank(),</span><br><span class="line">   axis.ticks = element_blank(),</span><br><span class="line">   axis.line = element_blank()</span><br><span class="line">     )</span><br></pre></td></tr></table></figure></p>
<p><strong>Step 3/3. Put the plots together:</strong><br>Arrange ggplot2 with adapted height and width for each row and column :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"gridExtra"</span>)</span><br><span class="line">grid.arrange(xdensity, blankPlot, scatterPlot, ydensity, </span><br><span class="line">        ncol=2, nrow=2, widths=c(4, 1.4), heights=c(1.4, 4))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-put-multiple-plot-together-data-visualization-1.png" width="480"></p>
<h2 id="Create_a_complex_layout_using_the_function_viewport()">Create a complex layout using the function viewport()</h2><p>The different steps are :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create plots : p1, p2, p3, ….</li></p>
<p><li>Move to a new page on a grid device using the function <strong>grid.newpage()</strong></li></p>
<p><li>Create a layout 2X2 - number of columns = 2; number of rows = 2</li></p>
<p><li>Define a grid viewport : a rectangular region on a graphics device</li></p>
<p><li>Print a plot into the viewport</li><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Move to a new page</span></span><br><span class="line">grid.newpage()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create layout : nrow = 2, ncol = 2</span></span><br><span class="line">pushViewport(viewport(layout = grid.layout(2, 2)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># A helper function to define a region on the layout</span></span><br><span class="line">define_region &lt;- <span class="keyword">function</span>(row, col)&#123;</span><br><span class="line">  viewport(layout.pos.row = row, layout.pos.col = col)</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment"># Arrange the plots</span></span><br><span class="line"><span class="built_in">print</span>(scatterPlot, vp=define_region(1, 1:2))</span><br><span class="line"><span class="built_in">print</span>(xdensity, vp = define_region(2, 1))</span><br><span class="line"><span class="built_in">print</span>(ydensity, vp = define_region(2, 2))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-complex-layout-data-visualization-1.png" width="480"></p>
<h2 id="Insert_an_external_graphical_element_inside_a_ggplot">Insert an external graphical element inside a ggplot</h2><p>The function <strong>annotation_custom()</strong> [in <strong>ggplot2</strong>] can be used for adding tables, plots or other grid-based elements. The simplified format is :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotation_custom(grob, xmin, xmax, ymin, ymax)</span><br></pre></td></tr></table></figure></p>
<p><ul></ul></p>
<p><li><strong>grob</strong>: the external graphical element to display</li></p>
<p><li><strong>xmin, xmax</strong> : x location in data coordinates (horizontal location)</li></p>
<p><li><strong>ymin, ymax</strong> : y location in data coordinates (vertical location)</li><br><br>The different steps are :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create a scatter plot of y = f(x)</li></p>
<p><li>Add, for example, the box plot of the variables x and y inside the scatter plot using the function <strong>annotation_custom()</strong></li><br><br><span class="warning">As the inset box plot overlaps with some points, a <strong>transparent background</strong> is used for the box plots.</span><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a transparent theme object</span></span><br><span class="line">transparent_theme &lt;- theme(</span><br><span class="line"> axis.title.x = element_blank(),</span><br><span class="line"> axis.title.y = element_blank(),</span><br><span class="line"> axis.text.x = element_blank(), </span><br><span class="line"> axis.text.y = element_blank(),</span><br><span class="line"> axis.ticks = element_blank(),</span><br><span class="line"> panel.grid = element_blank(),</span><br><span class="line"> axis.line = element_blank(),</span><br><span class="line"> panel.background = element_rect(fill = <span class="string">"transparent"</span>,colour = NA),</span><br><span class="line"> plot.background = element_rect(fill = <span class="string">"transparent"</span>,colour = NA))</span><br></pre></td></tr></table></figure></p>
<p>Create the graphs :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">p1 &lt;- scatterPlot <span class="comment"># see previous sections for the scatterPlot</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot of the x variable</span></span><br><span class="line">p2 &lt;- ggplot(df2, aes(factor(1), x))+</span><br><span class="line">  geom_boxplot(width=0.3)+coord_flip()+</span><br><span class="line">  transparent_theme</span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot of the y variable</span></span><br><span class="line">p3 &lt;- ggplot(df2, aes(factor(1), y))+</span><br><span class="line">  geom_boxplot(width=0.3)+</span><br><span class="line">  transparent_theme</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the external graphical elements</span></span><br><span class="line"><span class="comment"># called a "grop" in Grid terminology</span></span><br><span class="line">p2_grob = ggplotGrob(p2)</span><br><span class="line">p3_grob = ggplotGrob(p3)</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="comment"># Insert p2_grob inside the scatter plot</span></span><br><span class="line">xmin &lt;- min(x); xmax &lt;- max(x)</span><br><span class="line">ymin &lt;- min(y); ymax &lt;- max(y)</span><br><span class="line">p1 + annotation_custom(grob = p2_grob, xmin = xmin, xmax = xmax, </span><br><span class="line">                       ymin = ymin-1.5, ymax = ymin+1.5)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-insert-plot-inside-ggplot-data-visualization-1.png" width="384"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Insert p3_grob inside the scatter plot</span></span><br><span class="line">p1 + annotation_custom(grob = p3_grob,</span><br><span class="line">                       xmin = xmin-1.5, xmax = xmin+1.5, </span><br><span class="line">                       ymin = ymin, ymax = ymax)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-insert-plot-inside-ggplot-data-visualization-2.png" width="384"><br><span class="error">If you have a solution to insert, at the same time, both p2_grob and p3_grob inside the scatter plot, please let me a comment. I got some errors trying to do this…</span></p>
<h2 id="Mix_table,_text_and_ggplot2_graphs">Mix table, text and ggplot2 graphs</h2><p>The functions below are required :</p>
<p><ul></ul></p>
<p><li><strong>tableGrob()</strong> [in the package <em>gridExtra</em>] : for adding a data table to a graphic device</li></p>
<p><li><strong>splitTextGrob()</strong> [in the package <em>RGraphics</em>] : for adding a text to a graph</li><br><br><span class="warning">Make sure that the package <strong>RGraphics</strong> is installed.</span><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">library(RGraphics)</span><br><span class="line">library(gridExtra)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Table</span></span><br><span class="line">p1 &lt;- tableGrob(head(ToothGrowth))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Text</span></span><br><span class="line">text &lt;- <span class="string">"ToothGrowth data describes the effect of Vitamin C on tooth growth in Guinea pigs.  Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used."</span></span><br><span class="line">p2 &lt;- splitTextGrob(text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot</span></span><br><span class="line">p3 &lt;- ggplot(df, aes(x=dose, y=len)) + geom_boxplot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Arrange the plots on the same page</span></span><br><span class="line">grid.arrange(p1, p2, p3, ncol=1)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-add-table-add-text-data-visualization-1.png" width="480"></p>
<h2 id="Infos">Infos</h2><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZWFzeS13YXktdG8tbWl4LW11bHRpcGxlLWdyYXBocy1vbi10aGUtc2FtZS1wYWdlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page-r-software-and-data-visualization<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Easy way to mix multiple graphs on the same page - R software and data visualization&lt;/p&gt;
&lt;h2 id=&quot;Install_and_load_required_packages&quot;&gt;Inst
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="multiple" scheme="http://tiramisutes.github.io/tags/multiple/"/>
    
  </entry>
  
  <entry>
    <title>Multiple graphs on one page using ggplot2</title>
    <link href="http://tiramisutes.github.io/2015/10/03/multiple-ggplot2.html"/>
    <id>http://tiramisutes.github.io/2015/10/03/multiple-ggplot2.html</id>
    <published>2015-10-03T02:41:58.000Z</published>
    <updated>2018-09-28T02:38:36.897Z</updated>
    
    <content type="html"><![CDATA[<p>The easy way is to use the multiplot function to put multiple graphs on one page, defined at the bottom of this page. If it isn’t suitable for your needs, you can copy and modify it.</p>
<h2 id="Problem">Problem</h2><p>You want to put multiple graphs on one page.</p>
<h2 id="Solution-1">Solution-1</h2><p>use the multiplot function</p>
<h3 id="plots_and_store">plots and store</h3><p>First, set up the plots and store them, but don’t render them yet. The details of these plots aren’t important; all you need to do is store the plot objects in variables.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This example uses the ChickWeight dataset, which comes with ggplot2</span></span><br><span class="line"><span class="comment"># First plot</span></span><br><span class="line">p1 &lt;- ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet, group=Chick)) +</span><br><span class="line">    geom_line() +</span><br><span class="line">    ggtitle(<span class="string">"Growth curve for individual chicks"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Second plot</span></span><br><span class="line">p2 &lt;- ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet)) +</span><br><span class="line">    geom_point(alpha=.3) +</span><br><span class="line">    geom_smooth(alpha=.2, size=1) +</span><br><span class="line">    ggtitle(<span class="string">"Fitted growth curve per diet"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Third plot</span></span><br><span class="line">p3 &lt;- ggplot(subset(ChickWeight, Time==21), aes(x=weight, colour=Diet)) +</span><br><span class="line">    geom_density() +</span><br><span class="line">    ggtitle(<span class="string">"Final weight, by diet"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fourth plot</span></span><br><span class="line">p4 &lt;- ggplot(subset(ChickWeight, Time==21), aes(x=weight, fill=Diet)) +</span><br><span class="line">    geom_histogram(colour=<span class="string">"black"</span>, binwidth=50) +</span><br><span class="line">    facet_grid(Diet ~ .) +</span><br><span class="line">    ggtitle(<span class="string">"Final weight, by diet"</span>) +</span><br><span class="line">    theme(legend.position=<span class="string">"none"</span>)        <span class="comment"># No legend (redundant in this graph)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="multiplot_function">multiplot function</h3><p>This is the definition of multiplot. It can take any number of plot objects as arguments, or if it can take a list of plot objects passed to plotlist.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Multiple plot function</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)</span></span><br><span class="line"><span class="comment"># - cols:   Number of columns in layout</span></span><br><span class="line"><span class="comment"># - layout: A matrix specifying the layout. If present, 'cols' is ignored.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),</span></span><br><span class="line"><span class="comment"># then plot 1 will go in the upper left, 2 will go in the upper right, and</span></span><br><span class="line"><span class="comment"># 3 will go all the way across the bottom.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">multiplot &lt;- <span class="keyword">function</span>(..., plotlist=NULL, file, cols=1, layout=NULL) &#123;</span><br><span class="line">  library(grid)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Make a list from the ... arguments and plotlist</span></span><br><span class="line">  plots &lt;- c(list(...), plotlist)</span><br><span class="line"></span><br><span class="line">  numPlots = length(plots)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># If layout is NULL, then use 'cols' to determine layout</span></span><br><span class="line">  <span class="keyword">if</span> (is.null(layout)) &#123;</span><br><span class="line">    <span class="comment"># Make the panel</span></span><br><span class="line">    <span class="comment"># ncol: Number of columns of plots</span></span><br><span class="line">    <span class="comment"># nrow: Number of rows needed, calculated from # of cols</span></span><br><span class="line">    layout &lt;- matrix(seq(1, cols * ceiling(numPlots/cols)),</span><br><span class="line">                    ncol = cols, nrow = ceiling(numPlots/cols))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> (numPlots==1) &#123;</span><br><span class="line">    <span class="built_in">print</span>(plots[[1]])</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment"># Set up the page</span></span><br><span class="line">    grid.newpage()</span><br><span class="line">    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Make each plot, in the correct location</span></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> 1:numPlots) &#123;</span><br><span class="line">      <span class="comment"># Get the i,j matrix positions of the regions that contain this subplot</span></span><br><span class="line">      matchidx &lt;- as.data.frame(<span class="built_in">which</span>(layout == i, arr.ind = TRUE))</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(plots[[i]], vp = viewport(layout.pos.row = matchidx<span class="variable">$row</span>,</span><br><span class="line">                                      layout.pos.col = matchidx<span class="variable">$col</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="multiplot">multiplot</h3><p>Once the plot objects are set up, we can render them with multiplot. This will make two columns of graphs:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">multiplot(p1, p2, p3, p4, cols=2)</span><br><span class="line"><span class="comment">#&gt; Loading required package: grid</span></span><br><span class="line"><span class="comment">#&gt; geom_smooth: method="auto" and size of largest group is &lt;1000, so using loess. Use 'method = x' to change the smoothing method.</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-3-1.png" alt=""></p>
<h2 id="Solution-2">Solution-2</h2><p>facet_grid<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(mtcars, aes(mpg, wt)) + geom_point()</span><br><span class="line"><span class="comment"># With one variable</span></span><br><span class="line">p + facet_grid(. ~ cyl)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/facet_grid-2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># With two variables</span></span><br><span class="line">p + facet_grid(vs ~ am)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/facet_grid-6.png" alt=""></p>
<h2 id="Solution-3">Solution-3</h2><p>grid.arrange<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">grid.arrange(p1, p2, p3, p4, ncol=2, </span><br><span class="line">             main=<span class="string">"Multiple plots on the same page"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-3-1.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;The easy way is to use the multiplot function to put multiple graphs on one page, defined at the bottom of this page. If it isn’t suitabl
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="multiple" scheme="http://tiramisutes.github.io/tags/multiple/"/>
    
  </entry>
  
  <entry>
    <title>quick start guide of ggplot2 line plot  - R software and data visualization</title>
    <link href="http://tiramisutes.github.io/2015/09/21/line-ggplots.html"/>
    <id>http://tiramisutes.github.io/2015/09/21/line-ggplots.html</id>
    <published>2015-09-21T06:29:22.000Z</published>
    <updated>2015-09-26T01:22:24.000Z</updated>
    
    <content type="html"><![CDATA[<p></p><p>This <strong>R tutorial</strong> describes how to create <strong>line plots</strong> using <strong>R software</strong> and <strong>ggplot2</strong> package.</p><p></p>
<p></p><p>In a line graph, observations are ordered by x value and connected.</p><p></p>
<p></p><p>The functions <strong>geom_line()</strong>, <strong>geom_step()</strong>, or <strong>geom_path()</strong> can be used.</p><p></p>
<p></p><p>x value (for x axis) can be :</p><p></p>
<p><ul></ul></p>
<p><li>date : for a time series data</li></p>
<p><li>texts</li></p>
<p><li>discrete numeric values</li></p>
<p><li>continuous numeric values</li><br></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-logo-data-visualization-1.png" width="384"></p><p></p>
<p><div id="basic-line-plots" class="section level1"></div></p>
<p></p><h1>Basic line plots</h1><p></p>
<p><div id="data" class="section level2"></div></p>
<p></p><h2>Data</h2><p></p>
<p></p><p>Data derived from <em>ToothGrowth</em> data sets are used. ToothGrowth describes the effect of Vitamin C on tooth growth in Guinea pigs.</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df &lt;- data.frame(dose=c(<span class="string">"D0.5"</span>, <span class="string">"D1"</span>, <span class="string">"D2"</span>),</span><br><span class="line">                len=c(4.2, 10, 29.5))</span><br><span class="line"></span><br><span class="line">head(df)</span><br><span class="line"><span class="comment">##   dose  len</span></span><br><span class="line"><span class="comment">## 1 D0.5  4.2</span></span><br><span class="line"><span class="comment">## 2   D1 10.0</span></span><br><span class="line"><span class="comment">## 3   D2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<p><ul></ul></p>
<p><li><em>len</em> : Tooth length<br></li></p>
<p><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li><br><br></p>
<p><div id="create-line-plots-with-points" class="section level2"></div></p>
<p></p><h2>Create line plots with points</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Basic line plot with points</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"># Change the line type</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(linetype = &quot;dashed&quot;)+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"># Change the color</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(color=&quot;red&quot;)+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-3.png" width="240"></p><p></p>
<p></p><p>Read more on line types : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS10eXBlcy1ob3ctdG8tY2hhbmdlLWxpbmUtdHlwZXMtb2YtYS1ncmFwaC1pbi1yLXNvZnR3YXJl" title="http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software">ggplot2 line types<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><p>You can add an arrow to the line using the <em>grid</em> package :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(grid)</span><br><span class="line"><span class="comment"># Add an arrow</span></span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(arrow = arrow())+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a closed arrow to the end of the line</span></span><br><span class="line">myarrow=arrow(angle = 15, ends = <span class="string">"both"</span>, <span class="built_in">type</span> = <span class="string">"closed"</span>)</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(arrow=myarrow)+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-add-arrow-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-add-arrow-data-visualization-2.png" width="240"></p><p></p>
<p></p><p>Observations can be also connected using the functions <strong>geom_step()</strong> or <strong>geom_path()</strong> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_step()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_path()+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-geom-step-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-geom-step-data-visualization-2.png" width="240"></p><br><br><p></p>
<p><div class="block"></div></p>
<p><ul></ul></p>
<p><li><strong>geom_line</strong> : Connecting observations, ordered by x value</li></p>
<p><li><strong>geom_path()</strong> : Observations are connected in original order</li></p>
<p><li><strong>geom_step</strong> : Connecting observations by stairs</li><br><br><br><br></p>
<p><div id="line-plot-with-multiple-groups" class="section level1"></div></p>
<p></p><h1>Line plot with multiple groups</h1><p></p>
<p><div id="data-1" class="section level2"></div></p>
<p></p><h2>Data</h2><p></p>
<p></p><p>Data derived from <em>ToothGrowth</em> data sets are used. ToothGrowth describes the effect of Vitamin C on tooth growth in Guinea pigs. Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;- data.frame(supp=rep(c(<span class="string">"VC"</span>, <span class="string">"OJ"</span>), each=3),</span><br><span class="line">                dose=rep(c(<span class="string">"D0.5"</span>, <span class="string">"D1"</span>, <span class="string">"D2"</span>),2),</span><br><span class="line">                len=c(6.8, 15, 33, 4.2, 10, 29.5))</span><br><span class="line"></span><br><span class="line">head(df2)</span><br><span class="line"><span class="comment">##   supp dose  len</span></span><br><span class="line"><span class="comment">## 1   VC D0.5  6.8</span></span><br><span class="line"><span class="comment">## 2   VC   D1 15.0</span></span><br><span class="line"><span class="comment">## 3   VC   D2 33.0</span></span><br><span class="line"><span class="comment">## 4   OJ D0.5  4.2</span></span><br><span class="line"><span class="comment">## 5   OJ   D1 10.0</span></span><br><span class="line"><span class="comment">## 6   OJ   D2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<p><ul></ul></p>
<p><li><em>len</em> : Tooth length<br></li></p>
<p><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li></p>
<p><li><em>supp</em> : Supplement type (VC or OJ)</li><br><br></p>
<p><div id="create-line-plots" class="section level2"></div></p>
<p></p><h2>Create line plots</h2><p></p>
<p></p><p>In the graphs below, line types, colors and sizes are the same for the two groups :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Line plot with multiple groups</span></span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change line types</span></span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(linetype=<span class="string">"dashed"</span>, color=<span class="string">"blue"</span>, size=1.2)+</span><br><span class="line">  geom_point(color=<span class="string">"red"</span>, size=3)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-data-visualization-2.png" width="240"></p><br><p></p>
<p><div id="change-line-types-by-groups" class="section level2"></div></p>
<p></p><h2>Change line types by groups</h2><p></p>
<p></p><p>In the graphs below, line types and point shapes are controlled automatically by the levels of the variable <em>supp</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change line types by groups (supp)</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change line types and point shapes</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point(aes(shape=supp)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-change-line-type-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-change-line-type-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>It is also possible to change manually the line types using the function <strong>scale_linetype_manual()</strong>.</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set line types manually</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point()+</span><br><span class="line">  scale_linetype_manual(values=c(<span class="string">"twodash"</span>, <span class="string">"dotted"</span>))</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-manual-scale-data-visualization-1.png" width="288"></p><p></p>
<p></p><p>You can read more on line types here : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS10eXBlcy1ob3ctdG8tY2hhbmdlLWxpbmUtdHlwZXMtb2YtYS1ncmFwaC1pbi1yLXNvZnR3YXJl" title="http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software">ggplot2 line types<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><p><span class="warning">If you want to change also point shapes, read this article : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItcG9pbnQtc2hhcGVz" title="http://www.sthda.com/english/wiki/ggplot2-point-shapes">ggplot2 point shapes<i class="fa fa-external-link"></i></span></span></p><br><p></p>
<p><div id="change-line-colors-by-groups" class="section level2"></div></p>
<p></p><h2>Change line colors by groups</h2><p></p>
<p></p><p>Line colors are controlled automatically by the levels of the variable <em>supp</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p&lt;-ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(color=supp))+</span><br><span class="line">  geom_point(aes(color=supp))</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-change-line-color-data-visualization-1.png" width="240"></p><p></p>
<p></p><p>It is also possible to <em>change manually line colors</em> using the functions :</p><p></p>
<p><ul></ul></p>
<p><li><em>scale_color_manual()</em> : to use custom colors</li></p>
<p><li><em>scale_color_brewer()</em> : to use color palettes from <em>RColorBrewer</em> package</li></p>
<p><li><em>scale_color_grey()</em> : to use grey color palettes</li><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use custom color palettes</span></span><br><span class="line">p+scale_color_manual(values=c(<span class="string">"#999999"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use brewer color palettes</span></span><br><span class="line">p+scale_color_brewer(palette=<span class="string">"Dark2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use grey scale</span></span><br><span class="line">p + scale_color_grey() + theme_classic()</span><br></pre></td></tr></table></figure></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-3.png" width="240"></p><p></p>
<p></p><p>Read more on ggplot2 colors here : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItY29sb3JzLWhvdy10by1jaGFuZ2UtY29sb3JzLWF1dG9tYXRpY2FsbHktYW5kLW1hbnVhbGx5" title="http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually">ggplot2 colors<i class="fa fa-external-link"></i></span></p><br><br><p></p>
<p><div id="change-the-legend-position" class="section level1"></div></p>
<p></p><h1>Change the legend position</h1><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- p + scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br><span class="line"></span><br><span class="line">p + theme(legend.position=<span class="string">"top"</span>)</span><br><span class="line"></span><br><span class="line">p + theme(legend.position=<span class="string">"bottom"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove legend</span></span><br><span class="line">p + theme(legend.position=<span class="string">"none"</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-3.png" width="240"></p><p></p>
<p></p><p><span class="success">The allowed values for the arguments <strong>legend.position</strong> are : “left”,”top”, “right”, “bottom”.</span></p><p></p>
<p></p><p>Read more on ggplot legend : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGVnZW5kLWVhc3ktc3RlcHMtdG8tY2hhbmdlLXRoZS1wb3NpdGlvbi1hbmQtdGhlLWFwcGVhcmFuY2Utb2YtYS1ncmFwaC1sZWdlbmQtaW4tci1zb2Z0d2FyZQ==" title="http://www.sthda.com/english/wiki/ggplot2-legend-easy-steps-to-change-the-position-and-the-appearance-of-a-graph-legend-in-r-software">ggplot2 legend<i class="fa fa-external-link"></i></span></p><br><p></p>
<p><div id="line-plot-with-a-numeric-x-axis" class="section level1"></div></p>
<p></p><h1>Line plot with a numeric x-axis</h1><p></p>
<p></p><p>If the variable on x-axis is numeric, it can be useful to treat it as a continuous or a factor variable depending on what you want to do :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create some data</span></span><br><span class="line">df2 &lt;- data.frame(supp=rep(c(<span class="string">"VC"</span>, <span class="string">"OJ"</span>), each=3),</span><br><span class="line">                dose=rep(c(<span class="string">"0.5"</span>, <span class="string">"1"</span>, <span class="string">"2"</span>),2),</span><br><span class="line">               len=c(6.8, 15, 33, 4.2, 10, 29.5))</span><br><span class="line">head(df2)</span><br><span class="line"><span class="comment">##   supp dose  len</span></span><br><span class="line"><span class="comment">## 1   VC  0.5  6.8</span></span><br><span class="line"><span class="comment">## 2   VC    1 15.0</span></span><br><span class="line"><span class="comment">## 3   VC    2 33.0</span></span><br><span class="line"><span class="comment">## 4   OJ  0.5  4.2</span></span><br><span class="line"><span class="comment">## 5   OJ    1 10.0</span></span><br><span class="line"><span class="comment">## 6   OJ    2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x axis treated as continuous variable</span></span><br><span class="line">df2<span class="variable">$dose</span> &lt;- as.numeric(as.vector(df2<span class="variable">$dose</span>))</span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp, color=supp)) +</span><br><span class="line">  geom_line() + geom_point()+</span><br><span class="line">  scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Axis treated as discrete variable</span></span><br><span class="line">df2<span class="variable">$dose</span>&lt;-as.factor(df2<span class="variable">$dose</span>)</span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp, color=supp)) +</span><br><span class="line">  geom_line() + geom_point()+</span><br><span class="line">  scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br></pre></td></tr></table></figure>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-numeric-x-axis-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-numeric-x-axis-data-visualization-2.png" width="240"></p><br><p></p>
<p><div id="line-plot-with-dates-on-x-axis" class="section level1"></div></p>
<p></p><h1>Line plot with dates on x-axis</h1><p></p>
<p></p><p><em>economics</em> time series data sets are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">head(economics)</span><br><span class="line">        date   pce    pop psavert uempmed unemploy</span><br><span class="line"><span class="comment">## 1 1967-06-30 507.8 198712     9.8     4.5     2944</span></span><br><span class="line"><span class="comment">## 2 1967-07-31 510.9 198911     9.8     4.7     2945</span></span><br><span class="line"><span class="comment">## 3 1967-08-31 516.7 199113     9.0     4.6     2958</span></span><br><span class="line"><span class="comment">## 4 1967-09-30 513.3 199311     9.8     4.9     3143</span></span><br><span class="line"><span class="comment">## 5 1967-10-31 518.5 199498     9.7     4.7     3066</span></span><br><span class="line"><span class="comment">## 6 1967-11-30 526.2 199657     9.4     4.8     3018</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p>Plots :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Basic line plot</span></span><br><span class="line">ggplot(data=economics, aes(x=date, y=pop))+</span><br><span class="line">  geom_line()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot a subset of the data</span></span><br><span class="line">ggplot(data=subset(economics, date &amp;gt; as.Date(<span class="string">"2006-1-1"</span>)), </span><br><span class="line">       aes(x=date, y=pop))+geom_line()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>Change line size :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change line size</span></span><br><span class="line">ggplot(data=economics, aes(x=date, y=pop, size=unemploy/pop))+</span><br><span class="line">  geom_line()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-line-size-data-visualization-1.png" width="384"></p><br><p></p>
<p><div id="line-graph-with-error-bars" class="section level1"></div></p>
<p></p><h1>Line graph with error bars</h1><p></p>
<p></p><p>The function below will be used to calculate the mean and the standard deviation, for the variable of interest, in each group :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Function to calculate the mean and the standard deviation</span></span><br><span class="line">  <span class="comment"># for each group</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># data : a data frame</span></span><br><span class="line"><span class="comment"># varname : the name of a column containing the variable</span></span><br><span class="line">  <span class="comment">#to be summariezed</span></span><br><span class="line"><span class="comment"># groupnames : vector of column names to be used as</span></span><br><span class="line">  <span class="comment"># grouping variables</span></span><br><span class="line">data_summary &lt;- <span class="keyword">function</span>(data, varname, groupnames)&#123;</span><br><span class="line">  require(plyr)</span><br><span class="line">  summary_func &lt;- <span class="keyword">function</span>(x, col)&#123;</span><br><span class="line">    c(mean = mean(x[[col]], na.rm=TRUE),</span><br><span class="line">      sd = sd(x[[col]], na.rm=TRUE))</span><br><span class="line">  &#125;</span><br><span class="line">  data_sum&lt;-ddply(data, groupnames, .fun=summary_func,</span><br><span class="line">                  varname)</span><br><span class="line">  data_sum &lt;- rename(data_sum, c(<span class="string">"mean"</span> = varname))</span><br><span class="line"> <span class="built_in">return</span>(data_sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><p>Summarize the data :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df3 &lt;- data_summary(ToothGrowth, varname=<span class="string">"len"</span>, </span><br><span class="line">                    groupnames=c(<span class="string">"supp"</span>, <span class="string">"dose"</span>))</span><br><span class="line">head(df3)</span><br><span class="line"><span class="comment">##   supp dose   len       sd</span></span><br><span class="line"><span class="comment">## 1   OJ  0.5 13.23 4.459709</span></span><br><span class="line"><span class="comment">## 2   OJ  1.0 22.70 3.910953</span></span><br><span class="line"><span class="comment">## 3   OJ  2.0 26.06 2.655058</span></span><br><span class="line"><span class="comment">## 4   VC  0.5  7.98 2.746634</span></span><br><span class="line"><span class="comment">## 5   VC  1.0 16.77 2.515309</span></span><br><span class="line"><span class="comment">## 6   VC  2.0 26.14 4.797731</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p>The function <strong>geom_errorbar()</strong> can be used to produce a line graph with error bars :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Standard deviation of the mean</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1) +</span><br><span class="line">    geom_line() + geom_point()+</span><br><span class="line">   scale_color_brewer(palette=<span class="string">"Paired"</span>)+theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use position_dodge to move overlapped errorbars horizontally</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line() + geom_point()+</span><br><span class="line">   scale_color_brewer(palette=<span class="string">"Paired"</span>)+theme_minimal()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-with-error-bar-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-with-error-bar-data-visualization-2.png" width="259.2"></p><br><p></p>
<p><div id="customized-line-graphs" class="section level1"></div></p>
<p></p><h1>Customized line graphs</h1><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Simple line plot</span></span><br><span class="line"><span class="comment"># Change point shapes and line types by groups</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, shape=supp, linetype=supp))+ </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line() +</span><br><span class="line">    geom_point()+</span><br><span class="line">    labs(title=<span class="string">"Plot of lengthby dose"</span>,x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">    theme_classic()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change color by groups</span></span><br><span class="line"><span class="comment"># Add error bars</span></span><br><span class="line">p &lt;- ggplot(df3, aes(x=dose, y=len,  color=supp))+ </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line(aes(linetype=supp)) + </span><br><span class="line">    geom_point(aes(shape=supp))+</span><br><span class="line">    labs(title=<span class="string">"Plot of lengthby dose"</span>,x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">    theme_classic()</span><br><span class="line"></span><br><span class="line">p + theme_classic() + scale_color_manual(values=c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;))</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-line-graph-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-line-graph-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>Change colors manually :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p + scale_color_brewer(palette=<span class="string">"Paired"</span>) + theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Greens</span></span><br><span class="line">p + scale_color_brewer(palette=<span class="string">"Greens"</span>) + theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reds</span></span><br><span class="line">p + scale_color_brewer(palette=<span class="string">"Reds"</span>) + theme_minimal()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-2.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-3.png" width="259.2"></p><p></p>
<p></p><h1>Infos</h1><p></p>
<p></p><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span></p><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS1wbG90LXF1aWNrLXN0YXJ0LWd1aWRlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;This &lt;strong&gt;R tutorial&lt;/strong&gt; describes how to create &lt;strong&gt;line plots&lt;/strong&gt; using &lt;strong&gt;R software&lt;/strong&gt; and &lt;strong
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="error_bars" scheme="http://tiramisutes.github.io/tags/error-bars/"/>
    
  </entry>
  
  <entry>
    <title>ggplot2 error bars (finished)-Quick start guide - R software and data visualization</title>
    <link href="http://tiramisutes.github.io/2015/09/21/ggplot2-error-bars.html"/>
    <id>http://tiramisutes.github.io/2015/09/21/ggplot2-error-bars.html</id>
    <published>2015-09-21T05:13:36.000Z</published>
    <updated>2015-10-09T02:33:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>This <strong>tutorial</strong> describes how to create a <strong>graph</strong> with <strong>error bars</strong> using <strong>R software</strong> and <strong>ggplot2</strong> package. There are different types of <em>error bars</em> which can be created using the functions below :</p><br><ul><br><li>geom_errorbar()</li><br><li>geom_linerange()</li><br><li>geom_pointrange()</li><br><li>geom_crossbar()</li><br><li>geom_errorbarh()</li><br></ul><br><h1>Add error bars to a bar and line plots</h1><br><h2>Prepare the data</h2><br><p><em>ToothGrowth</em> data is used. It describes the effect of Vitamin C on tooth growth in Guinea pigs. Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">df &lt;- ToothGrowth</span><br><span class="line">df<span class="variable">$dose</span> &lt;- as.factor(df<span class="variable">$dose</span>)</span><br><span class="line">head(df)</span><br><span class="line">   len supp dose</span><br><span class="line">1  4.2   VC  0.5</span><br><span class="line">2 11.5   VC  0.5</span><br><span class="line">3  7.3   VC  0.5</span><br><span class="line">4  5.8   VC  0.5</span><br><span class="line">5  6.4   VC  0.5</span><br><span class="line">6 10.0   VC  0.5</span><br></pre></td></tr></table></figure><br><br><li><em>len</em> : Tooth length<br></li><br><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li><br><li><em>supp</em> : Supplement type (VC or OJ)</li><br><p>In the example below, we’ll plot the mean value of Tooth length in each group. The standard deviation is used to draw the error bars on the graph.</p><br><p>First, the helper function below will be used to calculate the mean and the standard deviation, for the variable of interest, in each group :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Function to calculate the mean and the standard deviation</span></span><br><span class="line">  <span class="comment"># for each group</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># data : a data frame</span></span><br><span class="line"><span class="comment"># varname : the name of a column containing the variable</span></span><br><span class="line">  <span class="comment">#to be summariezed</span></span><br><span class="line"><span class="comment"># groupnames : vector of column names to be used as</span></span><br><span class="line">  <span class="comment"># grouping variables</span></span><br><span class="line">data_summary &lt;- <span class="keyword">function</span>(data, varname, groupnames)&#123;</span><br><span class="line">  require(plyr)</span><br><span class="line">  summary_func &lt;- <span class="keyword">function</span>(x, col)&#123;</span><br><span class="line">    c(mean = mean(x[[col]], na.rm=TRUE),</span><br><span class="line">      sd = sd(x[[col]], na.rm=TRUE))</span><br><span class="line">  &#125;</span><br><span class="line">  data_sum&lt;-ddply(data, groupnames, .fun=summary_func,</span><br><span class="line">                  varname)</span><br><span class="line">  data_sum &lt;- rename(data_sum, c(<span class="string">"mean"</span> = varname))</span><br><span class="line"> <span class="built_in">return</span>(data_sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br><p>Summarize the data :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;- data_summary(ToothGrowth, varname=<span class="string">"len"</span>, </span><br><span class="line">                    groupnames=c(<span class="string">"supp"</span>, <span class="string">"dose"</span>))</span><br><span class="line"><span class="comment"># Convert dose to a factor variable</span></span><br><span class="line">df2<span class="variable">$dose</span>=as.factor(df2<span class="variable">$dose</span>)</span><br><span class="line">head(df2)</span><br><span class="line">   supp dose   len       sd</span><br><span class="line">1   OJ  0.5 13.23 4.459709</span><br><span class="line">2   OJ    1 22.70 3.910953</span><br><span class="line">3   OJ    2 26.06 2.655058</span><br><span class="line">4   VC  0.5  7.98 2.746634</span><br><span class="line">5   VC    1 16.77 2.515309</span><br><span class="line">6   VC    2 26.14 4.797731</span><br></pre></td></tr></table></figure><br><br><h2>Barplot with error bars</h2><br><p>The function <strong>geom_errorbar()</strong> can be used to produce the error bars :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># Default bar plot</span></span><br><span class="line">p&lt;- ggplot(df2, aes(x=dose, y=len, fill=supp)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, color=<span class="string">"black"</span>, </span><br><span class="line">           position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(.9)) </span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finished bar plot</span></span><br><span class="line">p+labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">   theme_classic() +</span><br><span class="line">   scale_fill_manual(values=c(<span class="string">'#999999'</span>,<span class="string">'#E69F00'</span>))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-barplot-data-visualization-1.png" width="359.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-barplot-data-visualization-2.png" width="359.2"></p><br>Note that, you can chose to keep only the upper error bars<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keep only upper error bars</span></span><br><span class="line"> ggplot(df2, aes(x=dose, y=len, fill=supp)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, color=<span class="string">"black"</span>, position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=len, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(.9))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-upper-error-bars-barplot-data-visualization-1.png" width="336"></p><br><p>Read more on ggplot2 bar graphs : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItYmFycGxvdHMtcXVpY2stc3RhcnQtZ3VpZGUtci1zb2Z0d2FyZS1hbmQtZGF0YS12aXN1YWxpemF0aW9u" title="http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization">ggplot2 bar graphs<i class="fa fa-external-link"></i></span></p><br><h2>Line plot with error bars</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default line plot</span></span><br><span class="line">p&lt;- ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">  geom_line() +</span><br><span class="line">  geom_point()+</span><br><span class="line">  geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(0.05))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finished line plot</span></span><br><span class="line">p+labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">   theme_classic() +</span><br><span class="line">   scale_color_manual(values=c(<span class="string">'#999999'</span>,<span class="string">'#E69F00'</span>))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-line-plot-barplot-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-line-plot-barplot-data-visualization-2.png" width="259.2"></p><br><p><span class="warning">You can also use the functions <strong>geom_pointrange()</strong> or <strong>geom_linerange()</strong> instead of using <strong>geom_errorbar()</strong></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use geom_pointrange</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">geom_pointrange(aes(ymin=len-sd, ymax=len+sd))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use geom_line()+geom_pointrange()</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_pointrange(aes(ymin=len-sd, ymax=len+sd))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-point-range-barplot-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-point-range-barplot-data-visualization-2.png" width="240"></p><br><p>Read more on ggplot2 line plots : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS1wbG90LXF1aWNrLXN0YXJ0LWd1aWRlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 line plots<i class="fa fa-external-link"></i></span></p><br><h1>Dot plot with mean point and error bars</h1><br><p>The functions <strong>geom_dotplot()</strong> and <strong>stat_summary()</strong> are used :</p><br><p>The mean +/- SD can be added as a <em>crossbar</em> , a <strong>error bar</strong> or a <em>pointrange</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(df, aes(x=dose, y=len)) + </span><br><span class="line">    geom_dotplot(binaxis=<span class="string">'y'</span>, stackdir=<span class="string">'center'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># use geom_crossbar()</span></span><br><span class="line">p + stat_summary(fun.data=<span class="string">"mean_sdl"</span>, mult=1, </span><br><span class="line">                 geom=<span class="string">"crossbar"</span>, width=0.5)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use geom_errorbar()</span></span><br><span class="line">p + stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">        geom=<span class="string">"errorbar"</span>, color=<span class="string">"red"</span>, width=0.2) +</span><br><span class="line">  stat_summary(fun.y=mean, geom=<span class="string">"point"</span>, color=<span class="string">"red"</span>)</span><br><span class="line">   </span><br><span class="line"><span class="comment"># Use geom_pointrange()</span></span><br><span class="line">p + stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">                 geom=<span class="string">"pointrange"</span>, color=<span class="string">"red"</span>)</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-1.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-2.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-3.png" width="192"></p><br><p>Read more on ggplot2 dot plots : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZG90LXBsb3QtcXVpY2stc3RhcnQtZ3VpZGUtci1zb2Z0d2FyZS1hbmQtZGF0YS12aXN1YWxpemF0aW9u" title="http://www.sthda.com/english/wiki/ggplot2-dot-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 dot plot<i class="fa fa-external-link"></i></span></p><br><h1>Infos</h1><br><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span></p>

<p>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZXJyb3ItYmFycy1xdWljay1zdGFydC1ndWlkZS1yLXNvZnR3YXJlLWFuZC1kYXRhLXZpc3VhbGl6YXRpb24=" title="http://www.sthda.com/english/wiki/ggplot2-error-bars-quick-start-guide-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-error-bars-quick-start-guide-r-software-and-data-visualization<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This &lt;strong&gt;tutorial&lt;/strong&gt; describes how to create a &lt;strong&gt;graph&lt;/strong&gt; with &lt;strong&gt;error bars&lt;/strong&gt; using &lt;strong&gt;R software
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="error_bars" scheme="http://tiramisutes.github.io/tags/error-bars/"/>
    
  </entry>
  
  <entry>
    <title>CRISPR/Cas9</title>
    <link href="http://tiramisutes.github.io/2015/09/13/CRISPR-Cas9.html"/>
    <id>http://tiramisutes.github.io/2015/09/13/CRISPR-Cas9.html</id>
    <published>2015-09-13T01:26:55.000Z</published>
    <updated>2018-09-28T02:32:02.855Z</updated>
    
    <content type="html"><![CDATA[<p>CRISPR/Cas9 gene editing technology has revolutionized the field of genome modification. This system is based on two key components that form a complex: Cas9 endonuclease and a target-specific RNA (single guide RNA or sgRNA) that guides Cas9 to the genomic DNA target site. Targeting to a particular genomic locus is solely mediated by the sgRNA.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cris.jpg" alt=""></p>
<h2 id="CRISPR/Cas9_简介">CRISPR/Cas9 简介</h2><p>细菌（bacteria）和古细菌（archaea）都有一套防御机制抵御这种外来的侵入性因子，这种防御机制就是在成簇的、有规律间隔的多次重复短片段（clustered regularly interspaced short palindromic repeat, CRISPR）的基础上建立起来的适应性免疫系统（adaptive immune system）。<br>CRISPR系统能够将各种外源的病毒或质粒DNA短片段”集中”到细胞基因组里某个特定的重复片段区域上，将这些外源DNA当作细胞曾经经受过外源DNA入侵的一种记忆给储存起来。然后这段DNA会转录生成CRISPR前体RNA（precursor CRISPR RNA），前体RNA生成之后会被切割成一段一段的重复RNA片段，这些小RNA分子就是成熟的CRISPR RNA（crRNA）。然后crRNA会招募CRISPR相关蛋白（CRISPR-associated proteins, Cas）和tracrRNA与各种被细胞记住的外源的入侵DNA或mRNA片段结合，将它们彻底摧毁。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/FA_Cas9_Fig1_Cas9InVivo.png" alt=""></p>
<h2 id="CRISPR/Cas9发现史">CRISPR/Cas9发现史</h2><p>1987年，日本人在大肠杆菌中发现有串联间隔重复序列，后来的研究发现，这种重复序列广泛存在于细菌和古细菌中。<br>2002年，正式命名为CRISPR(Clustered regulatory interspaced short palindromic repeats)。<br>2005年，三个研究组同时发现间隔序列和侵染细菌的病毒或phage高度同源。从而推测，这一系统可能是类似于siRNA一样，是细菌抵抗Phage的一种机理。<br>2007年，Science发表文章，证明细菌可能利用CRSPR系统对抗噬菌体入侵，并解释细菌抵抗外界入侵的大致流程，Cas位点编码多个核酸酶和解旋酶，他们把入侵的DNA切割，整合到CRISPR的重复序列中，形成记忆。当再次遭到入侵时，转录出RNA，Cas蛋白复合物利用这些和入侵的DNA同源的RNA去切割摧毁外源的DNA。<br>2012年，Jennifer A. Doudna和Emmanuelle Charpentier的这篇Science发现了一个比较简单的CRISPR（TypeII）系统的机理。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Genloci%20Classic%20CRISPR-Cas9%20protocol.jpg" alt=""></p>
<h2 id="CRISPR/Cas9_type_II_作用机制">CRISPR/Cas9 type II 作用机制</h2><h3 id="相关术语">相关术语</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/FA_Cas9_GenomeEditingGlossary.png" alt=""><br>CRISPR–Cas系统也称作2型系统（type II systems），如图所示。Cas9内切酶在向导RNA的指引下能够对各种入侵的外源DNA分子进行定点切割，不过主要识别的还是保守的间隔相邻基序（proto-spacer adjacent motifs，PAM基序）。如果要形成一个有功能的DNA切割复合体，还需要另外两个RNA分子的帮助，它们就是CRISPR RNA (crRNA)和反式作用CRISPR RNA（trans -acting CRISPR RNA, tracrRNA)。不过最近有研究发现，这两种RNA可以被”改装”成一个向导RNA（single-guide RNA, sgRNA）。tracrRNA刚好与crRNA的小片段互补，同时它们还是RNA特异性的宿主核糖核酸酶RNase III的底物。经过RNase III的切割之后，这一对互补的RNA（其中包括一条42bp的crRNA和一条75bp的tracrRNA）就可以充当Cas9因子的向导，也就是说，tracrRNA分子能够帮助Cas9-crRNA复合体在细胞复杂的DNA环境中精准地定位到入侵的DNA序列上，这个sgRNA足以帮助Cas9内切酶对DNA进行定点切割,在完整基因组上的特定位点完成切割反应后细胞通常会通过两种方式对发生双链断裂的DNA进行修复，这两种方式分别是同源重组修复机制（homologous recombination, HR）和非同源末端连接修复机制（non-homologous end joining, NHEJ），不过在修复的过程中细胞有可能会对修复位点进行修饰，或者插入新的遗传信息。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crispr-process.png" width="1024" height="768"></p>
<h3 id="图例解释">图例解释</h3><p>The type II RNA-mediated CRISPR/Cas immune pathway. The expression and interference steps are represented in the drawing. The type II CRISPR/Cas loci are composed of an operon of four genes (blue) encoding the proteins Cas9, Cas1, Cas2 and Csn2, a CRISPR array consisting of a leader sequence followed by identical repeats (black rectangles) interspersed with unique genome-targeting spacers (colored diamonds) and a sequence encoding the trans-activating tracrRNA (red). Represented here is the type II CRISPR/Cas locus of S. pyogenes SF370 (Accession number NC_002737) (4). Experimentally confirmed promoters and transcriptional terminator in this locus are indicated (4). The CRISPR array is transcribed as a precursor CRISPR RNA (pre-crRNA) molecule that undergoes a maturation process specific to the type II systems (4). In S. pyogenes SF370, tracrRNA is transcribed as two primary transcripts of 171 and 89 nt in length that have complementarity to each repeat of the pre-crRNA. The first processing event involves pairing of tracrRNA to pre-crRNA, forming a duplex RNA that is recognized and cleaved by the housekeeping endoribonuclease RNase III (orange) in the presence of the Cas9 protein. RNase III-mediated cleavage of the duplex RNA generates a 75-nt processed tracrRNA and a 66-nt intermediate crRNAs consisting of a central region containing a sequence of one spacer, flanked by portions of the repeat sequence. A second processing event, mediated by unknown ribonuclease(s), leads to the formation of mature crRNAs of 39 to 42 nt in length consisting of 5’-terminal spacer-derived guide sequence and repeat-derived 3’-terminal sequence. Following the first and second processing events, mature tracrRNA remains paired to the mature crRNAs and bound to the Cas9 protein. In this ternary complex, the dual tracrRNA:crRNA structure acts as guide RNA that directs the endonuclease Cas9 to the cognate target DNA. Target recognition by the Cas9-tracrRNA:crRNA complex is initiated by scanning the invading DNA molecule for homology between the protospacer sequence in the target DNA and the spacer-derived sequence in the crRNA. In addition to the DNA protospacer-crRNA spacer complementarity, DNA targeting requires the presence of a short motif (NGG, where N can be any nucleotide) adjacent to the protospacer (protospacer adjacent motif - PAM). Following pairing between the dual-RNA and the protospacer sequence, an R-loop is formed and Cas9 subsequently introduces a double-stranded break (DSB) in the DNA. Cleavage of target DNA by Cas9 requires two catalytic domains in the protein. At a specific site relative to the PAM, the HNH domain cleaves the complementary strand of the DNA while the RuvC-like domain cleaves the noncomplementary strand.</p>
<h3 id="关键点注释">关键点注释</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5端是来源于spacer的序列，3端是来源于重复端（repeat）的序列，二者共同组成了39到42nt的成熟crRNAs，其中的3端重复端部分序列</span><br><span class="line">与成熟的tracrRNAs部分互补配对。</span><br><span class="line">tracrRNA:crRNA形成的二元结构招募Cas9形成Cas9-tracrRNA:crRNA三元复合体，开始扫描入侵的DNA，识别与成熟crRNA来源于5端</span><br><span class="line">的spacer序列互补的区段.</span><br><span class="line">PAM即为NGG序列，存在与入侵DNA也就是CRISPR/Cas9系统所要去切割的双链DNA上，对应于CRISPR/Cas9的crRNA上就是3端的CCN。</span><br><span class="line">参与三元复合体Cas9-tracrRNA:crRNA与目标DNA的识别.</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crRNA-tracRNA.png" width="1024" height="768"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Schematic representation of tracrRNA, crRNA-sp2, and protospacer 2 DNA sequences. Regions of crRNA </span><br><span class="line">complementarity to tracrRNA (orange) and the protospacer DNA (yellow) are represented. The PAM </span><br><span class="line">sequence is shown <span class="keyword">in</span> gray; cleavage sites mapped <span class="keyword">in</span> (C)and (D) are represented by blue arrows (C),</span><br><span class="line"> a red arrow [(D), complementary strand], and a red line [(D), noncomplementary strand].</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crispr.jpg" alt=""><br>（A）Cas9蛋白需要crRNA和tracrRNA的共同帮助才能识别入侵的外来DNA分子，与之结合并将其降解。因为crRNA中的向导链部分可以与外源DNA的一条链互补并结合形成R环结构。在被识别区域两端的DNA基序也起到了非常重要的作用，它们可以帮助DNA链结旋打开双链，有利于crRNA链侵入。然后靶标DNA会在Cas9蛋白两个核酶结构域的作用下被切断。（B）级联反应复合体里含有一个crRNA，可是却最多携带了5种不同的Cas蛋白。所以它能够持续不断地招募核酶和解旋酶Cas3蛋白，不停歇地将入侵的外源DNA打开并切断。<br>Cas9蛋白能够凭借分子内的两个核酸酶结构域切割靶标DNA分子，形成平末端产物，其中每一个结构域负责切割靶标DNA分子R环状（R-loop）结构中的一条DNA链，具体来说，就是一个HNH核酶结构域负责切割与crRNA互补配对的那一条DNA链，RuvC核酶结构域负责切割另外一条DNA链。Jinek等人发现这种切割的效率非常高，而且不论靶标DNA分子是松弛型的，还是紧密的超螺旋型的都可以被毫不费力地被切割开，说明Cas9蛋白在细胞里是循环使用的，这样能保证在第一时间将所有来犯的入侵者全都消灭掉。</p>
<h2 id="Choosing_a_Target_Sequence_for_CRISPR/Cas9_Gene_Editing">Choosing a Target Sequence for CRISPR/Cas9 Gene Editing</h2><p>CRISPR/Cas9 gene targeting requires a custom single guide RNA (sgRNA) that contains a targeting sequence (crRNA sequence) and a Cas9 nuclease-recruiting sequence (tracrRNA). The crRNA region (shown in red below) is a 20-nucleotide sequence that is homologous to a region in your gene of interest and will direct Cas9 nuclease activity.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/xxclt_ibcGetAttachment.gif" alt=""></p>
<p>Selecting an appropriate DNA target sequence</p>
<p>Use the following guidelines to select a genomic DNA region that corresponds to the crRNA sequence of the sgRNA:</p>
<p>The 3′ end of the DNA target sequence must have a proto-spacer adjacent motif (PAM) sequence (5′-NGG-3′). The 20 nucleotides upstream of the PAM sequence will be your targeting sequence (crRNA) and Cas9 nuclease will cleave approximately 3 bases upstream of the PAM.<br>The PAM sequence itself is absolutely required for cleavage, but it is NOT part of the sgRNA sequence and therefore should not be included in the sgRNA.<br>The target sequence can be on either DNA strand.<br>There are online tools (e.g., <span class="exturl" data-url="aHR0cDovL2NyaXNwci5taXQuZWR1Lw==" title="http://crispr.mit.edu/">http://crispr.mit.edu/<i class="fa fa-external-link"></i></span> or <span class="exturl" data-url="aHR0cHM6Ly9jaG9wY2hvcC5yYy5mYXMuaGFydmFyZC5lZHUv" title="https://chopchop.rc.fas.harvard.edu/">https://chopchop.rc.fas.harvard.edu/<i class="fa fa-external-link"></i></span>) that detect PAM sequences and list possible crRNA sequences within a specific DNA region. These algorithms also predict off-target effects in different organisms, allowing you to choose the most specific crRNA.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/xxclt_ib.gif" alt=""></p>
<h2 id="CRISPR/Cas9-sgRNA设计工具">CRISPR/Cas9-sgRNA设计工具</h2><p><i class="fa fa-database"></i>模式生物(Model Organism)</p>
<ol>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5lLWNyaXNwLm9yZy9FLUNSSVNQLw==" title="http://www.e-crisp.org/E-CRISP/">http://www.e-crisp.org/E-CRISP/<i class="fa fa-external-link"></i></span> currently the best online solution (Recommended).</li>
<li><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmZseWNyaXNwci5tb2xiaW8ud2lzYy5lZHUvdGFyZ2V0RmluZGVyLw==" title="http://tools.flycrispr.molbio.wisc.edu/targetFinder/">http://tools.flycrispr.molbio.wisc.edu/targetFinder/<i class="fa fa-external-link"></i></span>  a simple drosophila focused tool.</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci5taXQuZWR1Lw==" title="http://crispr.mit.edu/">http://crispr.mit.edu/<i class="fa fa-external-link"></i></span>  MIT’s online CRISPR tool is a little slow, but pretty decent if they support your genome of interest.</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci51LXBzdWQuZnIv" title="http://crispr.u-psud.fr/">http://crispr.u-psud.fr/<i class="fa fa-external-link"></i></span>  simple but effective, supports analysis of any sequence for target-sites.</li>
<li><span class="exturl" data-url="aHR0cDovL3ppZml0LnBhcnRuZXJzLm9yZy9aaUZpVC8=" title="http://zifit.partners.org/ZiFiT/">http://zifit.partners.org/ZiFiT/<i class="fa fa-external-link"></i></span>  another simple but effective solution.</li>
</ol>
<p><i class="fa fa-database"></i>模式生物+部分非模式生物(Model Organism AND Some non-model organisms)</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9jcmlzcHIuZGJjbHMuanAv" title="https://crispr.dbcls.jp/">https://crispr.dbcls.jp/<i class="fa fa-external-link"></i></span> Rational design of CRISPR/Cas target.</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5yZ2Vub21lLm5ldC9jYXMtb2ZmaW5kZXIv" title="http://www.rgenome.net/cas-offinder/">http://www.rgenome.net/cas-offinder/<i class="fa fa-external-link"></i></span> select genomes only, but allows for alternative Cas9 species.</li>
<li><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmZseWNyaXNwci5tb2xiaW8ud2lzYy5lZHUvdGFyZ2V0RmluZGVyLw==" title="http://tools.flycrispr.molbio.wisc.edu/targetFinder/">http://tools.flycrispr.molbio.wisc.edu/targetFinder/<i class="fa fa-external-link"></i></span> a simple drosophila focused tool.</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9zc2ZpbmRlci8=" title="https://code.google.com/p/ssfinder/">https://code.google.com/p/ssfinder/<i class="fa fa-external-link"></i></span> (SSFinder) a simple but effective tool, it will likely be slow for large genomes.</li>
<li><span class="exturl" data-url="aHR0cDovL2FyZXAubWVkLmhhcnZhcmQuZWR1L0Nhc0ZpbmRlci8=" title="http://arep.med.harvard.edu/CasFinder/">CasFinder<i class="fa fa-external-link"></i></span>: Flexible algorithm for identifying specific Cas9 targets in genomes</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci5oemF1LmVkdS5jbi9DUklTUFIyL2hlbHAucGhw" title="http://crispr.hzau.edu.cn/CRISPR2/help.php">http://crispr.hzau.edu.cn/CRISPR2/help.php<i class="fa fa-external-link"></i></span></li>
</ol>
<p><i class="fa fa-database"></i>可自己提供基因组的程序(use yourself genome data)</p>
<ol>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5yZ2Vub21lLm5ldC9jYXMtZGVzaWduZXIvcG9ydGFibGU=" title="http://www.rgenome.net/cas-designer/portable">Cas-Designer<i class="fa fa-external-link"></i></span>: provides all possible RGEN targets in the given input sequence</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5iaW9vdG9vbHMuY29tL2NvbC5qc3A/aWQ9MTQz" title="http://www.biootools.com/col.jsp?id=143">sgRNAcas9<i class="fa fa-external-link"></i></span>: A software package for designing CRISPR sgRNA and evaluating potential off-target cleavagesites</li>
</ol>
<h2 id="CRISPR/Cas9存在的问题暨避免措施">CRISPR/Cas9存在的问题暨避免措施</h2><h3 id="Predicting_sgRNA_Efficacy">Predicting sgRNA Efficacy</h3><p>We have recently examined sequence features that enhance on-target activity of sgRNAs by creating all possible sgRNAs for a panel of genes and assessing, by flow cytometry, which sequences led to complete protein knockout (1). Some sequences worked better than others, and we also saw that variations in the protospacer-adjacent motif (PAM) led to differences in activity: specifically, CGGT tended to serve as a better PAM than the canonical NGG sequence. By examining the nucleotide features of the most-active sgRNAs from a set of 1,841 sgRNAs, we derived scoring rules and built a website implementation of these rules to design sgRNAs against genes of interest, available here: <span class="exturl" data-url="aHR0cDovL3d3dy5icm9hZGluc3RpdHV0ZS5vcmcvcm5haS9wdWJsaWMvYW5hbHlzaXMtdG9vbHMvc2dybmEtZGVzaWdu" title="http://www.broadinstitute.org/rnai/public/analysis-tools/sgrna-design">http://www.broadinstitute.org/rnai/public/analysis-tools/sgrna-design<i class="fa fa-external-link"></i></span>.</p>
<p>Once sgRNA sequences most-likely to give high activity are identified, some filtering can be used to further winnow down a list. For example, basic features of the target gene can be used to eliminate some sgRNAs, such as those that target near the C’ terminus of a protein, as frameshifts are less-likely to be deleterious if most of the protein has already been translated. While every protein will be different, it seems reasonable that target sites in the first half of a protein will likely lead to a functional knockout. Indeed, for some of the genes we examined, even targets very close to the C’ terminus disrupted expression. Certainly, for any gene of interest, it would be unwise to make conclusions on the basis of the activity of a single sgRNA, and thus diversity of target sites across a gene should be examined.</p>
<h3 id="Avoiding_Off-target_Sites">Avoiding Off-target Sites</h3><p>The off-target activity of sgRNAs is important to consider. Several papers have reached far-different conclusions regarding the extent of these effects, and certainly at least one reason for these observed differences is the expression levels of Cas9 and sgRNA used in these studies (2,3). Additionally, the ability to predict off-target sites in the genome is still in its infancy. While the basic landscape of mismatches that can lead to cutting has been established, and can be used to identify sites that are likely to give rise to an off-target effect, as yet there is not enough data to fully predict which sites will and will not show appreciable levels of modification. To further confound matters, it has recently been shown that bulges in either the RNA or DNA – that is, non-symmetrical basepairing of the strands – can give rise to off-target activity (4). Predicting such basepairing interactions is far-more computationally intensive, and thus existing algorithms ignore these potential off-target sites.</p>
<p>Importantly, recent whole-genome sequencing of cells modified by CRISPR indicates that the consequences of off-target activity, at least for the experimental conditions used, led to no detectable mutations (5). Indeed, when working with single-cell clones, the authors note that “clonal heterogeneity may represent a more serious obstacle to the generation of truly isogenic cell lines than nuclease-mediated off-target effects.” Further, several genetic screens using genome-wide libraries have shown high concordance between different sequences targeting the same gene, suggesting that off-target effects did not overwhelm true signal in these assays (6-8). Again, the experimental strategy is clear: for any gene of interest, one should require that multiple sgRNAs of different sequence give rise to the same phenotype in order to conclude that the phenotype is due to an on-target effect.</p>
<h3 id="How_Can_It_Go_Wrong?">How Can It Go Wrong?</h3><p>Even with optimized on-target design, and proper avoidance of off-target effects both explicitly when designing sgRNAs and experimentally by the use of multiple sgRNAs, it is apparent that not all genes are equally amenable to targeting in all cellular contexts. One major reason is the chromatin state of a target site. For genes that are in more restricted chromatin or, potentially, different locations in the nucleus, Cas9 will be less effective at finding the target (9). Achieving biallelic knockout of such a gene in a high percentage of target cells might therefore not be practical. Here, single cell-cloning might be necessary, and complementary technologies such as RNAi may be a better experimental choice (while still relying, of course, on multiple different sequences of small RNA to interpret a phenotype!)</p>
<p>In sum, selection of sgRNAs for an experiment needs to balance maximizing on-target activity while minimizing off-target activity, which sounds obvious but can often require difficult decisions. For example, would it be better to use a less-active sgRNA that targets a truly unique site in the genome, or a more-active sgRNA with one additional target site in a region of the genome with no known function? For the creation of stable cell models that are to be used for long-term study, the former may be the better choice. For a genome-wide library to conduct genetic screens, however, a library composed of the latter would likely be more effective, so long as care is taken in the interpretation of results by requiring multiple sequences targeting a gene to score in order to call that gene as a hit. Indeed, existing genome-wide libraries have not taken into account on-target activity, and new libraries will surely incorporate such design rules in the near future.</p>
<p>This is exciting time for functional genomics, with an ever-expanding list of tools to probe gene function. The best tools are only as good as the person using them, and the proper use of CRISPR technology will always depend on careful experimental design, execution, and analysis.</p>
<h2 id="CRISPR/Cas9:_Planning_Your_Experiment">CRISPR/Cas9: Planning Your Experiment</h2><h3 id="How_do_I_get_started?">How do I get started?</h3><p>CRISPR (Clustered Regularly Interspaced Short Palindromic Repeats) genome editing is a popular new technology that uses a short RNA (gRNA) to guide a nuclease (generally, Cas9) to a DNA target. The technology has been quickly adopted due to its advantages, like speed, cost, efficiency, and ease of implementation, over protein-based targeting methods (zinc fingers and TALENs). This experimental guide is meant to provide a broad overview of the major steps and considerations in setting up a CRISPR experiment. With all genome engineering technologies, it is recommended that the user performs due diligence regarding off-target effects.</p>
<p>Before getting started, familiarize yourself with the science behind CRISPR at our <a href="/crispr/guide/">CRISPR Science Guide</a>. You can also find more information from <span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvdG9waWMvY3Jpc3By" title="http://blog.addgene.org/topic/crispr">our blog<i class="fa fa-external-link"></i></span> and our list of <a href="/crispr/reference/#forums">CRISPR forums and FAQs</a>.</p>
<h3 id="Experimental_Design">Experimental Design</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/CRISPRweb.png" width="1024" height="768"></p>
<p>1.Choose a CRISPR system</p>
<ul>
<li><p>What do you want to use CRISPR for? Common uses of CRISPR are:</p>
<ul>
<li>Gene disruption (via insertion or deletion)</li>
<li>Activation or repression of gene expression</li>
<li>You can find more information about <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvZ3VpZGUvI0Rpc3J1cHQ=" title="http://www.addgene.org/crispr/guide/#Disrupt">CRISPR uses<i class="fa fa-external-link"></i></span> in our CRISPR guide or <a href="/CRISPR/">browse CRISPR plasmids</a> by function.</li>
</ul>
</li>
<li><p>What system will you be using CRISPR in?</p>
<ul>
<li>You can browse <a href="/crispr/#modelorg">CRISPR plasmids by model organism</a> or browse <a href="/crispr/">CRISPR plasmids by function.</a></li>
</ul>
</li>
<li><p>Once you know what you want to do and what system you want to use, you can design your gRNA.</p>
</li>
</ul>
<p>2.Design a gRNA for your genome target</p>
<p>As versatile as the Cas9 protein is, it requires the specificity of a gRNA to guide it to the desired genome target. Choosing an appropriate target sequence in the genomic DNA is a very important step in designing your experiment.</p>
<p>Important characteristics of a genome target are:</p>
<ul>
<li>~20 nucleotides in length</li>
<li>Followed (or preceded) by the appropriate Protospacer Adjacent Motif (PAM) sequence in the genomic DNA</li>
</ul>
<p>The PAM will vary depending on the bacterial species the Cas9 was derived from. The Cas9 and gRNA have to be from the same bacterial species. Read more about <a href="/crispr/guide/#PAM">PAM sequences</a>.<br>The majority of the CRISPR plasmids in Addgene’s collection are from the bacteria S. pyogenes unless otherwise noted.<br>gRNAs:</p>
<ul>
<li>should not contain the PAM sequence</li>
<li>can be on either strand of the genomic DNA</li>
</ul>
<p>For genomic disruptions (via Insertions/Deletions or InDels), the gRNA should be targeted closer to the N-terminus of a protein coding region to increase the likelihood of gene disruption.<br>For genome editing or modification, the gRNA target site will be limited to the desired location of the edit or modification.</p>
<ul>
<li>should be designed using bioinformatics software to minimize off-target effects</li>
</ul>
<p>A gRNA sequence can potentially appear in multiple places in the genome.</p>
<p>While we offer <a href="/crispr/validated-grnas/">validated gRNAs</a>, there are a <a href="/crispr/reference/#software">number of software tools</a> available to help you choose/design target sequences, as well as lists of bioinformatically determined (but not experimentally validated) unique gRNAs for different genes in different species.</p>
<p>Looking for more help?</p>
<p><span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvaG93LXRvLWRlc2lnbi15b3VyLWdybmEtZm9yLWNyaXNwci1nZW5vbWUtZWRpdGluZw==" title="http://blog.addgene.org/how-to-design-your-grna-for-crispr-genome-editing">From our blog<i class="fa fa-external-link"></i></span>, John Doench and Ella Hartenian (Broad Institute) give practical advice for using CRISPRs, as well as designing your gRNA and introducing it into cells.<br>Additionally, we have <a href="/crispr/reference/#protocols">gRNA design protocols</a> from our CRISPR depositors and links to <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvcmVmZXJlbmNlLyNmb3J1bXM=" title="http://www.addgene.org/crispr/reference/#forums">CRISPR discussion groups.<i class="fa fa-external-link"></i></span></p>
<p>Once you have your genomic target identified and gRNA designed, you can synthesize the oligos for your gRNA and find an <a href="/crispr/empty-grna-vectors/">empty gRNA vector</a>, or browse our selection of <a href="/crispr/validated-grnas/">validated gRNAs</a>.</p>
<ol>
<li>Clone the gRNA into a plasmid</li>
</ol>
<p>If you are using one of our validated gRNA plasmids, you can skip this step.</p>
<p>If you have to clone your gRNA into your CRISPR plasmid:</p>
<ul>
<li>Depositor plasmids may have <a href="/crispr/reference/#protocols">specific cloning guides</a> in their protocols.  </li>
<li>For a general overview of cloning, review our <a href="/plasmid-reference/index/">molecular biology tools and references</a>.</li>
</ul>
<p>After cloning, sequence verify your final plasmid product. Some depositor tools are designed so that a test digest can verify a successful insertion.</p>
<ol>
<li>Deliver your CRISPR components</li>
</ol>
<p>Each model system will have its best practices for efficient delivery of CRISPR components. CRISPR depositors have submitted protocols for a few model organisms like nematode, fly, and zebrafish.</p>
<p>If you will be working in mammalian cell culture, some common mammalian DNA delivery methods are: </p>
<p>Mammalian Cell Line DNA Delivery<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/deliver.png" alt=""><br><em>This table is not inclusive of all methods and the user will want to <span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3B1Ym1lZD90ZXJtPWNyaXNwcg==" title="http://www.ncbi.nlm.nih.gov/pubmed?term=crispr">review the current literature<i class="fa fa-external-link"></i></span> about their preferred model.</em></p>
<ol>
<li>Evaluate outcome</li>
</ol>
<p>If CRISPR is being used for genome modification, the modification has to be evaluated after delivery of CRISPR components.</p>
<ul>
<li>Design PCR (polymerase chain reaction) primers and amplify genomic region of modification.</li>
</ul>
<p>PCR is a method for making a copy of a piece of DNA.<br>There are many software tools available on the web for primer design. Example: <span class="exturl" data-url="aHR0cHM6Ly93d3cuaWR0ZG5hLmNvbS9wYWdlcy9zY2l0b29scy9zY2l0b29scy0tLW9saWdvLWFuYWx5c2lzLWFuZC1wcmltZXItZGVzaWduLXRvb2xz" title="https://www.idtdna.com/pages/scitools/scitools---oligo-analysis-and-primer-design-tools">IDT Web Tools<i class="fa fa-external-link"></i></span><br>View our walk-through of a basic <a href="/plasmid-protocols/pcr/">PCR reaction and the required reagents</a>.</p>
<ul>
<li>Two popular methods to assess genomic alteration from a PCR product are:</li>
</ul>
<p>Endonuclease mismatch detection assay<br><span class="exturl" data-url="aHR0cHM6Ly93d3cubmViLmNvbS9hcHBsaWNhdGlvbnMvY2xvbmluZy1hbmQtc3ludGhldGljLWJpb2xvZ3kvZ2Vub21lLWVkaXRpbmcvbWVhc3VyaW5nLXRhcmdldGluZy1lZmZpY2llbmN5LXdpdGgtdGhlLXQ3LWVuZG9udWNsZWFzZS1pLWFzc2F5" title="https://www.neb.com/applications/cloning-and-synthetic-biology/genome-editing/measuring-targeting-efficiency-with-the-t7-endonuclease-i-assay">NEB<i class="fa fa-external-link"></i></span> provides a graphical overview of the assay.<br>Sequence verification<br>Find tips for sequencing analysis and troubleshooting at our <span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvNi10aXBzLWZvci1hbmFseXppbmctYW5kLXRyb3VibGVzaG9vdGluZy1kbmEtc2VxdWVuY2luZy1yZXN1bHRz" title="http://blog.addgene.org/6-tips-for-analyzing-and-troubleshooting-dna-sequencing-results">blog<i class="fa fa-external-link"></i></span>.</p>
<h2 id="CRISPR-Cas9_FAQs_Answered!">CRISPR-Cas9 FAQs Answered!</h2><h3 id="Designing_Your_CRISPR_Genome_Editing_Experiment">Designing Your CRISPR Genome Editing Experiment</h3><p><strong>Q1:&nbsp;Should I use wildtype or double nickase for my CRISPR genome engineering experiments?</strong><br><strong>A1:&nbsp;</strong><span>When assessing which nickase type to use for your CRISPR genome engineering experiments, consider that wildtype Cas9 with optimized chimeric gRNA has high efficiency but has been shown to have off-target effects. ‘Double nickase’ is a new system, developed by the Zhang lab, which has comparable efficiency to the optimized chimeric design but with better accuracy (in other words, lower off-target effect.<br>The double nickase system is based on the Cas9 D10A nickase described in&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzNzk1NDExL2ZpZ3VyZS9GNC8=" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3795411/figure/F4/">Figure 4<i class="fa fa-external-link"></i></span>&nbsp;of the Cong, et. al, 2013 Science paper. For example, if you want to use double nickase, you could express two spacers and use&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy80MjMzNS8=" title="http://www.addgene.org/42335/">PX335<i class="fa fa-external-link"></i></span>&nbsp;to express the Cas9n (nickase).<br>The concept of the double nickase system is that you can express two different chimeric gRNAs with the Cas9 nickase which will together introduce cleavage of the target site with efficiency similar to using a single chimeric gRNA. At the same time, the off-target effects are reduced because the Cas9 nickase doesn’t have the ability to induce double-stranded breaks like the wildtype Cas9 does. There are a few references for the double nickase system, including&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5jZWxsLmNvbS9hYnN0cmFjdC9TMDA5Mi04Njc0KDEzKTAxMDE1LTU=" title="http://www.cell.com/abstract/S0092-8674(13)01015-5">one recently from the Zhang group<i class="fa fa-external-link"></i></span>.<br>Learn more <span class="exturl" data-url="aHR0cHM6Ly93d3cuYWRkZ2VuZS5vcmcvQ1JJU1BSL2d1aWRlLyNOaWNrYXNl" title="https://www.addgene.org/CRISPR/guide/#Nickase">here<i class="fa fa-external-link"></i></span>.<br><strong>Q2:&nbsp;When designing oligos for cloning my target sequence into a backbone that uses the human U6 promoterto drive expression, is it necessary to add a G nucleotide to the start of my target sequence?</strong><br><strong style="font-size: inherit;">A2:&nbsp;</strong>The human U6 promoter prefers a ‘G’ at the transcription start site to have high expression, so adding this G couldhelp with expression, though it is possible for the plasmid to still express without the G. Because the G is only one base, the Zhang lab usually adds it when they order the oligo. If your spacer sequence starts with a ‘G’, you naturally have one and do not need to add an additional ‘G’.<br><strong>Q3:&nbsp;What is the maximum amount of DNA that can be inserted into the genome using CRISPR/Cas forHomologous Recombination (HR)? How long should the homology arms be for efficient recombination?</strong><br><strong>A3:&nbsp;</strong>The most we’ve tried to insert so far has been 1kb. We used homology arms that were 800bp long.</span></p>
<h3 id="Tips_for_Using_CRISPR-Cas9_at_the_Lab_Bench">Tips for Using CRISPR-Cas9 at the Lab Bench</h3><p><strong>Q4:&nbsp;After the introduction of a mutation into the genome, how can cells with that mutation be selected/screened?</strong><br><strong>A4:</strong>&nbsp;Before starting your experiment, consider co-transfecting with GFP. This allows you to sort for GFP-positive cells and to enrich for those cells that were positively transfected. Alternatively, you can use a selection marker to select transfected cells (for example, plasmid with a puromycin resistance cassette, such as&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy80ODEzOS8=" title="http://www.addgene.org/48139/">PX459<i class="fa fa-external-link"></i></span>). After you co-transfect the CRISPR/Cas system with your homologous recombination (HR) template, you could then:</p>
<ul>
<li>Confirm your HR by doing Restriction Fragment Length Polymorphism (RFLP) (<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzNzk1NDExL2ZpZ3VyZS9GNC8=" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3795411/figure/F4/">see Figure 4<i class="fa fa-external-link"></i></span>&nbsp;of the Cong, et. al, 2013 Science paper).</li>
<li>If you detect positive HR, isolate single-cell colonies, grow them up, then perform individual genotyping (using Sanger sequencing, for example) on each colony in order to screen for positive ones.&nbsp;</li>
<li>If your HR template has a selection marker such as puromycin, you can (also) select for the positive colonies by puromycin selection. You could then confirm this purification by performing a genotyping assay (such as Sanger sequencing).<br><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MwMDkyODY3NDEzMDA0Njc0" title="http://www.sciencedirect.com/science/article/pii/S0092867413004674">Click here<i class="fa fa-external-link"></i></span>for a useful reference.</li>
</ul>
<h3 id="More_FAQS,_CRISPR_Protocols,_and_gRNA_Design_Tools">More FAQS, CRISPR Protocols, and gRNA Design Tools</h3><p><em><strong>Need more questions answered about CRISPRs?</strong></em></p>
<ul>
<li>Check out the <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvemhhbmcvRkFRLw==" title="http://www.addgene.org/crispr/zhang/FAQ/">full list of 16 FAQs answered by Le Cong<i class="fa fa-external-link"></i></span></li>
<li>Read Addgene’s <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvZ3VpZGUv" title="http://www.addgene.org/CRISPR/guide/">CRISPR guide for background information<i class="fa fa-external-link"></i></span>&nbsp;on CRISPR/Cas9 systems</li>
<li>Peruse the most recent genome editing review articles, such as: Sander JD &amp; Joung JK, <em><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3Zhb3AvbmN1cnJlbnQvcGRmL25idC4yODQyLnBkZg==" title="http://www.nature.com/nbt/journal/vaop/ncurrent/pdf/nbt.2842.pdf">Nature Biotech<i class="fa fa-external-link"></i></span>, </em>2 March 2014.</li>
<li>Or browse the <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvI0FydGljbGU=" title="http://www.addgene.org/CRISPR/#Article">articles related to the most frequently requested CRISPR<i class="fa fa-external-link"></i></span> plasmids at Addgene<br><em><strong>Find protocols and gRNA design tools:</strong></em></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvcmVmZXJlbmNlLyNwcm90b2NvbHM=" title="http://www.addgene.org/CRISPR/reference/#protocols">List of CRISPR protocols<i class="fa fa-external-link"></i></span> developed by a variety of labs and optimized for specific plasmids</li>
<li>Links to different <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvcmVmZXJlbmNlLyNnUk5B" title="http://www.addgene.org/CRISPR/reference/#gRNA">software to help you identify your gRNA<i class="fa fa-external-link"></i></span> target sequences</li>
</ul>
<h2 id="CRISPR/Cas9_文献">CRISPR/Cas9 文献</h2><ul>
<li><span class="exturl" data-url="aHR0cDovL29ubGluZWRpZ2VkaXRpb25zLmNvbS9wdWJsaWNhdGlvbi9mcmFtZS5waHA/aT0yMjMzMjI=" title="http://onlinedigeditions.com/publication/frame.php?i=223322">Cell Press Selections: CRISPR/Cas9<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlbWFnLm9yZy9jb250ZW50LzMzNy82MDk2LzgwOA==" title="http://www.sciencemag.org/content/337/6096/808">Science：A Swiss Army Knife of Immunity<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlbWFnLm9yZy9jb250ZW50LzMzNy82MDk2LzgxNi5sb25n" title="http://www.sciencemag.org/content/337/6096/816.long">Science：A Programmable Dual-RNA–Guided DNA Endonuclease in Adaptive Bacterial Immunity<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3YzMS9uOC9mdWxsL25idC4yNjU1Lmh0bWwjcmVmMw==" title="http://www.nature.com/nbt/journal/v31/n8/full/nbt.2655.html#ref3">Nature：Targeted mutagenesis in the model plant Nicotiana benthamiana using Cas9 RNA-guided endonuclease<i class="fa fa-external-link"></i></span></li>
</ul>
<h2 id="CRISPR/Cas9_科幻之力">CRISPR/Cas9 科幻之力</h2><p>◆ 自我复制<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/5bfd74f6187e5b0020435c06d8060826.jpg" alt=""></p>
<p>◆ 改变孟德尔遗传规律，改变整个种群<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/nature_crispr_gene_drive.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CRISPR/Cas9 gene editing technology has revolutionized the field of genome modification. This system is based on two key components that 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="CRISPR/Cas9" scheme="http://tiramisutes.github.io/tags/CRISPR-Cas9/"/>
    
  </entry>
  
  <entry>
    <title>Error bars (basic)</title>
    <link href="http://tiramisutes.github.io/2015/08/22/error-bars.html"/>
    <id>http://tiramisutes.github.io/2015/08/22/error-bars.html</id>
    <published>2015-08-22T10:00:06.000Z</published>
    <updated>2018-09-28T02:33:32.465Z</updated>
    
    <content type="html"><![CDATA[<p>Error bars are a graphical representation of the variability of data and are used on graphs to indicate the error, or uncertainty in a reported measurement. They give a general idea of how precise a measurement is, or conversely, how far from the reported value the true (error free) value might be. Error bars often represent one standard deviation of uncertainty, one standard error, or a certain confidence interval (e.g., a 95% interval). </p>
<h3 id="Add_error_bar_used_R">Add error bar used R</h3><p>loading data<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot(mpg~disp,data=mtcars)</span><br></pre></td></tr></table></figure></p>
<h3 id="verticality_error_bars">verticality error bars</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">arrows(x0=mtcars<span class="variable">$disp</span>,</span><br><span class="line">       y0=mtcars<span class="variable">$mpg</span>*0.95,</span><br><span class="line">       x1=mtcars<span class="variable">$disp</span>,</span><br><span class="line">       y1=mtcars<span class="variable">$mpg</span>*1.05,</span><br><span class="line">       angle=90,</span><br><span class="line">       code=3,      <span class="comment">#drawing an arrowhead at both ends</span></span><br><span class="line">       length=0.04,</span><br><span class="line">       lwd=0.4)</span><br></pre></td></tr></table></figure>
<p>结果如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot.png" alt=""></p>
<h3 id="horizontal_error_bars">horizontal error bars</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">arrows(x0=mtcars<span class="variable">$disp</span>*0.95,</span><br><span class="line">       y0=mtcars<span class="variable">$mpg</span>,</span><br><span class="line">       x1=mtcars<span class="variable">$disp</span>*1.05,</span><br><span class="line">       y1=mtcars<span class="variable">$mpg</span>,</span><br><span class="line">       angle=90,</span><br><span class="line">       code=3,</span><br><span class="line">       length=0.04,</span><br><span class="line">       lwd=0.4)</span><br></pre></td></tr></table></figure>
<p>结果如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot01.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Error bars are a graphical representation of the variability of data and are used on graphs to indicate the error, or uncertainty in a re
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="error_bars" scheme="http://tiramisutes.github.io/tags/error-bars/"/>
    
  </entry>
  
  <entry>
    <title>Linux环境变量</title>
    <link href="http://tiramisutes.github.io/2015/08/22/etc.html"/>
    <id>http://tiramisutes.github.io/2015/08/22/etc.html</id>
    <published>2015-08-22T08:23:25.000Z</published>
    <updated>2015-08-22T09:16:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="常见的环境变量">常见的环境变量</h2><p>对于PATH和HOME等环境变量大家都不陌生。除此之外，还有下面一些常见环境变量。<br>◆ HISTSIZE是指保存历史命令记录的条数。<br>◆ LOGNAME是指当前用户的登录名。<br>◆ HOSTNAME是指主机的名称，许多应用程序如果要用到主机名的话，通常是从这个环境变量中来取得的。<br>◆ SHELL是指当前用户用的是哪种Shell。<br>◆ LANG/LANGUGE是和语言相关的环境变量，使用多种语言的用户可以修改此环境变量。<br>◆ MAIL是指当前用户的邮件存放目录。<br>◆ PS1是基本提示符，对于root用户是#，对于普通用户是$。PS2是附属提示符，默认是”&gt;”。可以通过修改此环境变量来修改当前的命令符，比如下列命令会将提示符修改成字符串”Hello,My NewPrompt “。</p>
<p>除了这些常见的环境变量，许多应用程序在安装时也会增加一些环境变量，比如使用Java就要设置JAVA_HOME和CLASSPATH等</p>
<h2 id="定制环境变量">定制环境变量</h2><p>环境变量是和Shell紧密相关的，用户登录系统后就启动了一个Shell。对于Linux来说一般是bash，但也可以重新设定或切换到其它的 Shell。环境变量是通过Shell命令来设置的，设置好的环境变量又可以被所有当前用户所运行的程序所使用。对于bash这个Shell程序来说，可 以通过变量名来访问相应的环境变量，通过export来设置环境变量。下面通过几个实例来说明。<br>1、显示环境变量HOME<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HOME</span> </span><br><span class="line">/home/terry</span><br></pre></td></tr></table></figure></p>
<p>2、设置一个新的环境变量WELCOME<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> WELCOME=<span class="string">"Hello!"</span> </span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$WELCOME</span> </span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure></p>
<p>3、使用env命令显示所有的环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ env </span><br><span class="line">HOSTNAME=terry.mykms.org </span><br><span class="line">PVM_RSH=/usr/bin/rsh </span><br><span class="line">SHELL=/bin/bash </span><br><span class="line">TERM=xterm</span><br><span class="line">HISTSIZE=1000 </span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>4、使用set命令显示所有本地定义的Shell变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> </span><br><span class="line">BASH=/bin/bash </span><br><span class="line">BASH_VERSINFO=([0]=<span class="string">"2"</span>[1]=<span class="string">"05b"</span>[2]=<span class="string">"0"</span>[3]=<span class="string">"1"</span>[4]=<span class="string">"release"</span>[5]=<span class="string">"i386-redhat-linux-gnu"</span>) </span><br><span class="line">BASH_VERSION=<span class="string">'2.05b.0(1)-release'</span> </span><br><span class="line">COLORS=/etc/DIR_COLORS.xterm </span><br><span class="line">COLUMNS=80 </span><br><span class="line">DIRSTACK=() </span><br><span class="line">DISPLAY=:0.0 </span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>5、使用unset 命令来清除环境变量<br>set可以设置某个环境变量的值。清除环境变量的值用unset命令。如果未指定值，则该变量值将被设为NULL。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> TEST=<span class="string">"Test..."</span> <span class="comment">#增加一个环境变量TEST </span></span><br><span class="line">$ env|grep TEST <span class="comment">#此命令有输入，证明环境变量TEST已经存在了 </span></span><br><span class="line">TEST=Test... </span><br><span class="line">$ <span class="built_in">unset</span> <span class="variable">$TEST</span> <span class="comment">#删除环境变量TEST </span></span><br><span class="line">$ env|grep TEST <span class="comment">#此命令没有输出，证明环境变量TEST已经存在了</span></span><br></pre></td></tr></table></figure></p>
<p>6、使用readonly 命令设置只读变量<br>如果使用了readonly命令的话，变量就不可以被修改或清除了。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> TEST=<span class="string">"Test..."</span> <span class="comment">#增加一个环境变量TEST </span></span><br><span class="line">$ <span class="built_in">readonly</span> TEST <span class="comment">#将环境变量TEST设为只读 </span></span><br><span class="line">$ <span class="built_in">unset</span> TEST <span class="comment">#会发现此变量不能被删除 </span></span><br><span class="line">-bash: <span class="built_in">unset</span>: TEST: cannot <span class="built_in">unset</span>: <span class="built_in">readonly</span> variable </span><br><span class="line">$ TEST=<span class="string">"New"</span> <span class="comment">#会发现此也变量不能被修改 </span></span><br><span class="line">-bash: TEST: <span class="built_in">readonly</span> variable</span><br></pre></td></tr></table></figure></p>
<h2 id="环境变量PATH">环境变量PATH</h2><p>which, 它用来查找某个命令的绝对路径<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># which rmdir</span></span><br><span class="line">/bin/rmdir</span><br><span class="line">[root@localhost ~]<span class="comment"># which rm</span></span><br><span class="line"><span class="built_in">alias</span> rm=<span class="string">'rm -i'</span></span><br><span class="line">        /bin/rm</span><br><span class="line">[root@localhost ~]<span class="comment"># which ls</span></span><br><span class="line"><span class="built_in">alias</span> ls=<span class="string">'ls --color=auto'</span></span><br><span class="line">        /bin/ls</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;常见的环境变量&quot;&gt;常见的环境变量&lt;/h2&gt;&lt;p&gt;对于PATH和HOME等环境变量大家都不陌生。除此之外，还有下面一些常见环境变量。&lt;br&gt;◆ HISTSIZE是指保存历史命令记录的条数。&lt;br&gt;◆ LOGNAME是指当前用户的登录名。&lt;br&gt;◆ HOSTNAME是
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://tiramisutes.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>AWK程序设计语言</title>
    <link href="http://tiramisutes.github.io/2015/08/22/awk2.html"/>
    <id>http://tiramisutes.github.io/2015/08/22/awk2.html</id>
    <published>2015-08-22T05:48:08.000Z</published>
    <updated>2018-09-28T02:29:35.533Z</updated>
    
    <content type="html"><![CDATA[<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk2.png" width="590" height="400"></p><p></p>
<h2 id="一-_AWK入门指南">一. AWK入门指南</h2><p>Awk是一种便于使用且表达能力强的程序设计语言，可应用于各种计算和数据处理任务。本章是个入门指南，让你能够尽快地开始编写你自己的程序。第二章将描述整个语言，而剩下的章节将向你展示如何使用Awk来解决许多不同方面的问题。纵观全书，我们尽量选择了一些对你有用、有趣并且有指导意义的实例。</p>
<h3 id="1-1_起步">1.1 起步</h3><p>有用的awk程序往往很简短，仅仅一两行。假设你有一个名为 emp.data 的文件，其中包含员工的姓名、薪资（美元/小时）以及小时数，一个员工一行数据，如下所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth	4.00	0</span><br><span class="line">Dan	3.75	0</span><br><span class="line">kathy	4.00	10</span><br><span class="line">Mark	5.00	20</span><br><span class="line">Mary	5.50	22</span><br><span class="line">Susie	4.25	18</span><br></pre></td></tr></table></figure></p>
<p>现在你想打印出工作时间超过零小时的员工的姓名和工资（薪资乘以时间）。这种任务对于awk来说就是小菜一碟。输入这个命令行就可以了：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 &gt;0 &#123; print $1, $2 * $3 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>你应该会得到如下输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br></pre></td></tr></table></figure></p>
<p>该命令行告诉系统执行引号内的awk程序，从输入文件 emp.data 获取程序所需的数据。引号内的部分是个完整的awk程序，包含单个模式-动作语句。模式 $3&gt;0 用于匹配第三列大于0的输入行，动作:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印每个匹配行的第一个字段以及第二第三字段的乘积。</p>
<p>如果你想打印出还没工作过的员工的姓名，则输入命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>这里，模式 $3 == 0 匹配第三个字段等于0的行，动作:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印该行的第一个字段。</p>
<p>当你阅读本书时，应该尝试执行与修改示例程序。大多数程序都很简短，所以你能快速理解awk是如何工作的。在Unix系统上，以上两个事务在终端里看起来是这样的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'$3 &gt; 0 &#123; print $1, $2 * $3 &#125;'</span> emp.data</span><br><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br><span class="line">$ awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> emp.data</span><br><span class="line">Beth</span><br><span class="line">Dan</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p>
<p>行首的 $ 是系统提示符，也许在你的机器上不一样。</p>
<p>AWK程序的结构</p>
<p>让我们回头看一下到底发生了什么事情。上述的命令行中，引号之间的部分是awk编程语言写就的程序。本章中的每个awk程序都是一个或多个模式-动作语句的序列：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern &#123; action &#125;</span><br><span class="line">pattern &#123; action &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>awk的基本操作是一行一行地扫描输入，搜索匹配任意程序中模式的行。词语”匹配”的准确意义是视具体的模式而言，对于模式 $3 &gt;0 来说，意思是”条件为真”。</p>
<p>每个模式依次测试每个输入行。对于匹配到行的模式，其对应的动作（也许包含多步）得到执行，然后读取下一行并继续匹配，直到所有的输入读取完毕。</p>
<p>上面的程序都是模式与动作的典型示例。:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> == 0 &#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>是单个模式-动作语句；对于第三个字段为0的每行，打印其第一个字段。</p>
<p>模式-动作语句中的模式或动作（但不是同时两者）都可以省略。如果某个模式没有动作，例如：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> == 0</span><br></pre></td></tr></table></figure></p>
<p>那么模式匹配到的每一行（即，对于该行，条件为真）都会被打印出来。该程序会打印 emp.data 文件中第三个字段为0的两行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Beth 4.00 0</span><br><span class="line">Dan 3.75 0</span><br></pre></td></tr></table></figure></p>
<p>如果有个没有模式的动作，例如：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>那么这种情况下的动作会打印每个输入行的第一列。</p>
<p>由于模式和动作两者任一都是可选的，所以需要使用大括号包围动作以区分于其他模式。</p>
<p>执行AWK程序</p>
<p>执行awk程序的方式有多种。你可以输入如下形式的命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'program'</span> input files</span><br></pre></td></tr></table></figure></p>
<p>从而在每个指定的输入文件上执行这个program。例如，你可以输入：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> file1 file2</span><br></pre></td></tr></table></figure></p>
<p>打印file1和file2文件中第三个字段为0的每一行的第一个字段。</p>
<p>你可以省略命令行中的输入文件，仅输入：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'program'</span></span><br></pre></td></tr></table></figure></p>
<p>这种情况下，awk会将program应用于你在终端中接着输入的任意数据行，直到你输入一个文件结束信号（Unix系统上为control-d）。如下是Unix系统的一个会话示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span></span><br><span class="line">Beth 4.00 0</span><br><span class="line">Beth</span><br><span class="line"></span><br><span class="line">Dan 3.75 0</span><br><span class="line">Dan</span><br><span class="line"></span><br><span class="line">Kathy 3.75 10</span><br><span class="line">Kathy 3.75 0</span><br><span class="line">Kathy</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>加粗的字符是计算机打印的。</p>
<p>这个动作非常便于尝试awk：输入你的程序，然后输入数据，观察发生了什么。我们再次鼓励你尝试这些示例并进行改动。</p>
<p>注意命令行中的程序是用单引号包围着的。这会防止shell解释程序中 $ 这样的字符，也允许程序的长度超过一行。</p>
<p>当程序比较短小（几行的长度）的时候，这种约定会很方便。然而，如果程序较长，将程序写到一个单独的文件中会更加方便。假设存在程序 progfile ，输入命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -f progfile     optional list of input files</span><br></pre></td></tr></table></figure></p>
<p>其中 -f 选项指示awk从指定文件中获取程序。可以使用任意文件名替换 progfile 。</p>
<p>错误</p>
<p>如果你的awk程序存在错误，awk会给你一段诊断信息。例如，如果你打错了大括号，如下所示：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 [ print $1 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>你会得到如下信息：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk: syntax error at <span class="built_in">source</span> line 1</span><br><span class="line">context is</span><br><span class="line"><span class="variable">$3</span> == 0 &gt;&gt;&gt; [ &lt;&lt;&lt;</span><br><span class="line">extra &#125;</span><br><span class="line">missing ]</span><br><span class="line">awk: bailing out at <span class="built_in">source</span> line 1</span><br></pre></td></tr></table></figure></p>
<p>“Syntax error”意味着在 &gt;&gt;&gt; &lt;&lt;&lt; 标记的地方检测到语法错误。”Bailing out”意味着没有试图恢复。有时你会得到更多的帮助-关于错误是什么，比如大括号或括弧不匹配。</p>
<p>因为存在句法错误，awk就不会尝试执行这个程序。然而，有些错误，直到你的程序被执行才会检测出来。例如，如果你试图用零去除某个数，awk会在这个除法的地方停止处理并报告输入行的行号以及在程序中的行号（这话是什么意思？难道输入行的行号是忽略空行后的行号？）。</p>
<h3 id="1-2_简单输出">1.2 简单输出</h3><p>这一节接下来的部分包含了一些短小，典型的awk程序，基于操纵上文中提到的 emp.data 文件. 我们会简单的解释程序在做什么，但这些例子主要是为了介绍 awk 中常见的一些简单有用的操作 – 打印字段, 选择输入, 转换数据. 我们并 没有展现 awk 程序能做的所有事情, 也并不打算深入的去探讨例子中的一些细节. 但在你读完这一节之后, 你将能够完成一些简单的任务, 并且你将发现在阅读后 面章节的时候会变的容易的多.</p>
<p>我们通常只会列出程序部分, 而不是整个命令行. 在任何情况下, 程序都可以用 引号包含起来放到 awk 命令的地一个参数中运行, 就像上文中展示的那样, 或者 把它放到一个文件中使用 awk 的 -f 参数调用它.</p>
<p>在 awk 中仅仅只有两种数据类型: 数值 和 字符构成的字符串. emp.data 是 一个包含这类信息的典型文件 – 混合了被空格和(或)制表符分割的数字和词语.</p>
<p>Awk 程序一次从输入文件的中读取一行内容并把它分割成一个个字段, 通常默认 情况下, 一个字段是一个不包含任何空格或制表符的连续字符序列. 当前输入的 行中的地一个字段被称做 $1, 第二个是 $2, 以此类推. 整个行的内容被定 义为 $0. 每一行的字段数量可以不同.</p>
<p>通常, 我们要做的仅仅只是打印出每一行中的某些字段, 也许还要做一些计算. 这一节的程序基本上都是这种形式.</p>
<p>打印每一行</p>
<p>如果一个动作没有任何模式, 这个动作会对所有输入的行进行操作. print 语 句用来打印(输出)当前输入的行, 所以程序</p>
<p>{ print }<br>会输出所有输入的内容到标准输出. 由于 $0 表示整行,</p>
<p>{ print $0 }<br>也会做一样的事情.</p>
<p>打印特定字段</p>
<p>使用一个 print 语句可以在同一行中输出不止一个字段. 下面的程序输出了每 行输入中的第一和第三个字段<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>使用 emp.data 作为输入, 它将会得到<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 0</span><br><span class="line">Dan 0</span><br><span class="line">Kathy 10</span><br><span class="line">Mark 20</span><br><span class="line">Mary 22</span><br><span class="line">Susie 18</span><br></pre></td></tr></table></figure></p>
<p>在 print 语句中被逗号分割的表达式, 在默认情况下他们将会用一个空格分割 来输出. 每一行 print 生成的内容都会以一个换行符作为结束. 但这些默认行 为都可以自定义; 我们将在第二章中介绍具体的方法.</p>
<p>NF, 字段数量</p>
<p>很显然你可能会发现你总是需要通过 $1, $2 这样来指定不同的字段, 但任何表 达式都可以使用在$之后来表达一个字段的序号; 表达式会被求值并用于表示字段 序号. Awk会对当前输入的行有多少个字段进行计数, 并且将当前行的字段数量存 储在一个内建的称作 NF 的变量中. 因此, 下面的程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> NF, <span class="variable">$1</span>, <span class="variable">$NF</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>会依次打印出每一行的字段数量, 第一个字段的值, 最后一个字段的值.</p>
<p>计算和打印</p>
<p>你也可以对字段的值进行计算后再打印出来. 下面的程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>是一个典型的例子. 它会打印出姓名和员工的合计支出(以小时计算):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 0</span><br><span class="line">Dan 0</span><br><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br></pre></td></tr></table></figure></p>
<p>我们马上就会学到怎么让这个输出看起来更漂亮.</p>
<p>打印行号</p>
<p>Awk提供了另一个内建变量, 叫做 NR, 它会存储当前已经读取了多少行的计数. 我们可以使用 NR 和 $0 给 emp.data 的没一行加上行号:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> NR, <span class="variable">$0</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印的输出看起来会是这样:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 Beth   4.00     0</span><br><span class="line">2 Dan    3.75     0</span><br><span class="line">3 Kathy  4.00    10</span><br><span class="line">4 Mark   5.00    20</span><br><span class="line">5 Mary   5.50    22</span><br><span class="line">6 Susie  4.25   1 8</span><br></pre></td></tr></table></figure></p>
<p>在输出中添加内容</p>
<p>你当然也可以在字段中间或者计算的值中间打印输出想要的内容:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="string">"total pay for"</span>, <span class="variable">$1</span>, <span class="string">"is"</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">total pay <span class="keyword">for</span> Beth is 0</span><br><span class="line">total pay <span class="keyword">for</span> Dan is 0</span><br><span class="line">total pay <span class="keyword">for</span> Kathy is 40</span><br><span class="line">total pay <span class="keyword">for</span> Mark is 100</span><br><span class="line">total pay <span class="keyword">for</span> Mary is 121</span><br><span class="line">total pay <span class="keyword">for</span> Susie is 76.5</span><br></pre></td></tr></table></figure></p>
<p>在打印语句中, 双引号内的文字将会在字段和计算的值中插入输出.</p>
<h3 id="1-3_高级输出">1.3 高级输出</h3><p>print 语句可用于快速而简单的输出。若要严格按照你所想的格式化输出，则需要使用 printf 语句。正如我将在2.4节所见， printf 几乎可以产生任何形式的输出，但在本节中，我们仅展示其部分功能。</p>
<p>字段排队</p>
<p>printf 语句的形式如下：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(format, value1, value2, ..., valuen)</span><br></pre></td></tr></table></figure></p>
<p>其中 format 是字符串，包含要逐字打印的文本，穿插着 format 之后的每个值该如何打印的规格(specification)。一个规格是一个 % 符，后面跟着一些字符，用来控制一个 value 的格式。第一个规格说明如何打印 value1 ，第二个说明如何打印 value2 ，… 。因此，有多少 value 要打印，在 format 中就要有多少个 % 规格。</p>
<p>这里有个程序使用 printf 打印每位员工的总薪酬：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">printf</span>(<span class="string">"total pay for %s is $%.2f\n"</span>, <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>printf 语句中的规格字符串包含两个 % 规格。第一个是 %s ，说明以字符串的方式打印第一个值 $1 。第二个是 %.2f ，说明以数字的方式打印第二个值 $2*$3 ，并保留小数点后面两位。规格字符串中其他东西，包括美元符号，仅逐字打印。字符串尾部的 \n 代表开始新的一行，使得后续输出将从下一行开始。以 emp.data 为输入，该程序产生：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">total pay <span class="keyword">for</span> Beth is <span class="variable">$0</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Dan is <span class="variable">$0</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Kathy is <span class="variable">$40</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Mark is <span class="variable">$100</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Mary is <span class="variable">$121</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Susie is <span class="variable">$76</span>.50</span><br></pre></td></tr></table></figure></p>
<p>printf 不会自动产生空格或者新的行，必须是你自己来创建，所以不要忘了 \n 。</p>
<p>另一个程序是打印每位员工的姓名与薪酬：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">printf</span>(<span class="string">"%-8s $%6.2f\n"</span>, <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>第一个规格 %-8s 将一个姓名以字符串形式在8个字符宽度的字段中左对齐输出。第二个规格 %6.2f 将薪酬以数字的形式，保留小数点后两位，在6个字符宽度的字段中输出。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth     $  0.00</span><br><span class="line">Dan      $  0.00</span><br><span class="line">Kathy    $ 40.00</span><br><span class="line">Mark     <span class="variable">$100</span>.00</span><br><span class="line">Mary     <span class="variable">$121</span>.00</span><br><span class="line">Susie    $ 76.50</span><br></pre></td></tr></table></figure></p>
<p>之后我们将展示更多的 printf 示例。一切精彩尽在2.4小节。</p>
<p>排序输出</p>
<p>假设你想打印每位员工的所有数据，包括他或她的薪酬，并以薪酬递增的方式进行排序输出。最简单的方式是使用awk将每位员工的总薪酬置于其记录之前，然后利用一个排序程序来处理awk的输出。Unix上，命令行如下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123; printf("%6.2f    %s\n", $2 * $3, $0) &#125;'</span> emp.data | sort</span><br></pre></td></tr></table></figure></p>
<p>将awk的输出通过管道传给 sort 命令，输出为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  0.00    Beth  4.00 0</span><br><span class="line">  0.00    Dan   3.75 0</span><br><span class="line"> 40.00    Kathy 4.00 10</span><br><span class="line"> 76.50    Susie 4.25 18</span><br><span class="line">100.00    Mark  5.00 20</span><br><span class="line">121.00    Mary  5.50 22</span><br></pre></td></tr></table></figure></p>
<h3 id="1-4_选择">1.4 选择</h3><p>Awk的模式适合用于为进一步的处理从输入中选择相关的数据行。由于不带动作的模式会打印所有匹配模式的行，所以很多awk程序仅包含一个模式。本节将给出一些有用的模式示例。</p>
<p>通过对比选择</p>
<p>这个程序使用一个对比模式来选择每小时赚5美元或更多的员工记录，也就是，第二个字段大于等于5的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 5</span><br></pre></td></tr></table></figure></p>
<p>从 emp.data 中选出这些行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br></pre></td></tr></table></figure></p>
<p>通过计算选择</p>
<p>程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> * <span class="variable">$3</span> &gt; 50 &#123; <span class="built_in">printf</span>(<span class="string">"$%.2f for %s\n"</span>, <span class="variable">$2</span> * <span class="variable">$3</span>, <span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印出总薪资超过50美元的员工的薪酬。</p>
<p>通过文本内容选择</p>
<p>除了数值测试，你还可以选择包含特定单词或短语的输入行。这个程序会打印所有第一个字段为 Susie 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$1</span> == <span class="string">"Susie"</span></span><br></pre></td></tr></table></figure></p>
<p>操作符 == 用于测试相等性。你也可以使用称为 正则表达式 的模式查找包含任意字母组合，单词或短语的文本。这个程序打印任意位置包含 Susie 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Susie/</span><br></pre></td></tr></table></figure></p>
<p>输出为这一行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>正则表达式可用于指定复杂的多的模式；2.1节将会有全面的论述。</p>
<p>模式组合</p>
<p>可以使用括号和逻辑操作符与 &amp;&amp; ， 或 || ， 以及非 ! 对模式进行组合。程序:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 4 || <span class="variable">$3</span> &gt;= 20</span><br></pre></td></tr></table></figure></p>
<p>会打印 $2 (第二个字段) 大于等于 4 或者 $3 (第三个字段) 大于等于 20 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Beth    4.00    0</span><br><span class="line">kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>两个条件都满足的行仅打印一次。与如下包含两个模式程序相比：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 4</span><br><span class="line"><span class="variable">$3</span> &gt;= 20</span><br></pre></td></tr></table></figure></p>
<p>如果某个输入行两个条件都满足，这个程序会打印它两遍：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Beth    4.00    0</span><br><span class="line">Kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>注意如下程序:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!(<span class="variable">$2</span> &lt; 4 &amp;&amp; <span class="variable">$3</span> &lt; 20)</span><br></pre></td></tr></table></figure></p>
<p>会打印极不满足 $2 小于4也不满足 $3 小于20的行；这个条件与上面第一个模式组合等价，虽然也许可读性差了点。</p>
<p>数据验证</p>
<p>实际的数据中总是会存在错误的。在数据验证-检查数据的值是否合理以及格式是否正确-方面，Awk是个优秀的工具。</p>
<p>数据验证本质上是否定的：不是打印具备期望属性的行，而是打印可疑的行。如下程序使用对比模式 将5个数据合理性测试应用于 emp.data 的每一行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NF != 3     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"number of fields is not equal to 3"</span> &#125;</span><br><span class="line"><span class="variable">$2</span> &lt; 3.35   &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"rate is below minimum wage"</span> &#125;</span><br><span class="line"><span class="variable">$2</span> &gt; 10     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"rate exceeds <span class="variable">$10</span> per hour"</span> &#125;</span><br><span class="line"><span class="variable">$3</span> &lt; 0      &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"negative hours worked"</span> &#125;</span><br><span class="line"><span class="variable">$3</span> &gt; 60     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"too many hours worked"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>如果没有错误，则没有输出。</p>
<p>BEGIN与END</p>
<p>特殊模式 BEGIN 用于匹配第一个输入文件的第一行之前的位置， END 则用于匹配处理过的最后一个文件的最后一行之后的位置。这个程序使用 BEGIN 来输出一个标题：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BEGIN &#123; <span class="built_in">print</span> <span class="string">"Name    RATE    HOURS"</span>; <span class="built_in">print</span> <span class="string">""</span>&#125;</span><br><span class="line">      &#123; <span class="built_in">print</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出为：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME    RATE    HOURS</span><br><span class="line"></span><br><span class="line">Beth    4.00    0</span><br><span class="line">Dan     3.75    0</span><br><span class="line"></span><br><span class="line">Kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>程序的动作部分你可以在一行上放多个语句，不过要使用分号进行分隔。注意 普通的 print 是打印当前输入行，与之不同的是 print “” 会打印一个空行。</p>
<h3 id="1-5_使用AWK进行计算">1.5 使用AWK进行计算</h3><p>一个动作就是一个以新行或者分号分隔的语句序列。你已经见过一些其动作仅是单个 print 语句的例子。本节将提供一些执行简单的数值以及字符串计算的语句示例。在这些语句中，你不仅可以使用像 NF 这样的内置变量，还可以创建自己的变量用于计算、存储数据诸如此类的操作。awk中，用户创建的变量不需要声明。</p>
<h4 id="计数">计数</h4><p>这个程序使用一个变量 emp 来统计工作超过15个小时的员工的数目：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> &gt; 15 &#123; emp = emp + 1 &#125;</span><br><span class="line">END     &#123; <span class="built_in">print</span> emp, <span class="string">"employees worked more than 15 hours"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>对于第三个字段超过15的每行， emp 的前一个值加1。以 emp.data 为输入，该程序产生：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 employees worked more than 15 hours</span><br></pre></td></tr></table></figure></p>
<p>用作数字的awk变量的默认初始值为0，所以我们不需要初始化 emp 。</p>
<h4 id="求和与平均值">求和与平均值</h4><p>为计算员工的数目，我们可以使用内置变量 NR ，它保存着到目前位置读取的行数；在所有输入的结尾它的值就是所读的所有行数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"employees"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出为：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6 employees</span><br></pre></td></tr></table></figure></p>
<p>如下是一个使用 NR 来计算薪酬均值的程序：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    &#123; pay = pay + <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"employees"</span></span><br><span class="line">      <span class="built_in">print</span> <span class="string">"total pay is"</span>, pay</span><br><span class="line">      <span class="built_in">print</span> <span class="string">"average pay is"</span>, pay/NR</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>第一个动作累计所有员工的总薪酬。 END 动作打印出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6 employees</span><br><span class="line">total pay is 337.5</span><br><span class="line">average pay is 56.25</span><br></pre></td></tr></table></figure></p>
<p>很明显， printf 可用来产生更简洁的输出。并且该程序也有个潜在的错误：在某种不太可能发生的情况下， NR 等于0，那么程序会试图执行零除，从而产生错误信息。</p>
<h4 id="处理文本">处理文本</h4><p>awk的优势之一是能像大多数语言处理数字一样方便地处理字符串。awk变量可以保存数字也可以保存字符串。这个程序会找出时薪最高的员工：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt; maxrate &#123; maxrate = <span class="variable">$2</span>; maxemp = <span class="variable">$1</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> <span class="string">"highest hourly rate:"</span>, maxrate, <span class="string">"for"</span>, maxemp &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highest hourly rate: 5.50 <span class="keyword">for</span> Mary</span><br></pre></td></tr></table></figure></p>
<p>这个程序中，变量 maxrate 保存着一个数值，而变量 maxemp 则是保存着一个字符串。（如果有几个员工都有着相同的最大时薪，该程序则只找出第一个。）</p>
<h4 id="字符串连接">字符串连接</h4><p>可以合并老字符串来创建新字符串。这种操作称为 连接（concatenation） 。程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    &#123; names = names <span class="variable">$1</span> <span class="string">" "</span>&#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> names &#125;</span><br></pre></td></tr></table></figure></p>
<p>通过将每个姓名和一个空格附加到变量 names 的前一个值， 来将所有员工的姓名收集进单个字符串中。最后 END 动作打印出 names 的值：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Beth Dan Kathy Mark Mary Susie</span><br></pre></td></tr></table></figure></p>
<p>awk程序中，连接操作的表现形式是将字符串值一个接一个地写出来。对于每个输入行，程序的第一个语句先连接三个字符串： names 的前一个值、当前行的第一个字段以及一个空格，然后将得到的字符串赋值给 names 。因此，读取所有的输入行之后， names 就是个字符串，包含所有员工的姓名，每个姓名后面跟着一个空格。用于保存字符串的变量的默认初始值是空字符串(也就是说该字符串包含零个字符)，因此这个程序中的 names 不需要显式初始化。</p>
<h4 id="打印最后一个输入行">打印最后一个输入行</h4><p>虽然在 END 动作中 NR 还保留着它的值，但 $0 没有。程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    &#123; last = <span class="variable">$0</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> last &#125;</span><br></pre></td></tr></table></figure></p>
<p>是打印最后一个输入行的一种方式：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<h4 id="内置函数">内置函数</h4><p>我们已看到awk提供了内置变量来保存某些频繁使用的数量，比如：字段的数量和输入行的数量。类似地，也有内置函数用来计算其他有用的数值。除了平方根、对数、随机数诸如此类的算术函数，也有操作文本的函数。其中之一是 length ，计算一个字符串中的字符数量。例如，这个程序会计算每个人的姓名的长度：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, length(<span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>结果：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 4</span><br><span class="line">Dan 3</span><br><span class="line">Kathy 5</span><br><span class="line">Mark 4</span><br><span class="line">Mary 4</span><br><span class="line">Susie 5</span><br></pre></td></tr></table></figure></p>
<h4 id="行、单词以及字符的计数">行、单词以及字符的计数</h4><p>这个程序使用了 length 、 NF 、以及 NR 来统计输入中行、单词以及字符的数量。为了简便，我们将每个字段看作一个单词。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    &#123; nc = nc + length(<span class="variable">$0</span>) + 1</span><br><span class="line">      nw = nw + NF</span><br><span class="line">    &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"lines,"</span>, nw, <span class="string">"words,"</span>, nc, <span class="string">"characters"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>文件 emp.data 有:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6 lines, 18 words, 77 characters</span><br></pre></td></tr></table></figure></p>
<p>$0 并不包含每个输入行的末尾的换行符，所以我们要另外加个1。</p>
<h3 id="1-6_控制语句">1.6 控制语句</h3><p>Awk为选择提供了一个 if-else 语句，以及为循环提供了几个语句，所以都效仿C语言中对应的控制语句。它们仅可以在动作中使用。</p>
<p>if-else语句</p>
<p>如下程序将计算时薪超过6美元的员工的总薪酬与平均薪酬。它使用一个 if 来防范计算平均薪酬时的零除问题。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt; 6 &#123; n = n + 1; pay = pay + <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br><span class="line">END    &#123; <span class="keyword">if</span> (n &gt; 0)</span><br><span class="line">            <span class="built_in">print</span> n, <span class="string">"employees, total pay is"</span>, pay,</span><br><span class="line">                     <span class="string">"average pay is"</span>, pay/n</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">             <span class="built_in">print</span> <span class="string">"no employees are paid more than <span class="variable">$6</span>/hour"</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p>
<p>emp.data 的输出是：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">no employees are paid more than <span class="variable">$6</span>/hour</span><br></pre></td></tr></table></figure></p>
<p>if-else 语句中，if 后的条件会被计算。如果为真，执行第一个 print 语句。否则，执行第二个 print 语句。注意我们可以使用一个逗号将一个长语句截断为多行来书写。</p>
<p>while语句</p>
<p>一个 while 语句有一个条件和一个执行体。条件为真时执行体中的语句会被重复执行。这个程序使用公式 [Math Processing Error]</p>
<p>来演示以特定的利率投资一定量的钱，其数值是如何随着年数增长的。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># interest1 - 计算复利</span></span><br><span class="line"><span class="comment">#   输入: 钱数    利率    年数</span></span><br><span class="line"><span class="comment">#   输出: 复利值</span></span><br><span class="line"></span><br><span class="line">&#123;   i = 1</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= <span class="variable">$3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t%.2f\n"</span>, <span class="variable">$1</span> * (1 + <span class="variable">$2</span>) ^ i)</span><br><span class="line">        i = i + 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>条件是 while 后括弧包围的表达式；循环体是条件后大括号包围的两个表达式。 printf 规格字符串中的 \t 代表制表符； ^ 是指数操作符。从 # 开始到行尾的文本是注释，会被awk忽略，但能帮助程序的读者理解程序做的事情。</p>
<p>你可以为这程序输入三个一组的数字，看看不一样的钱数、利率、以及年数会产生什么。例如，如下事务演示了1000美元，利率为6%与12%，5年的复利分别是如何增长的：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ awk -f interest1</span><br><span class="line">1000 .06 5</span><br><span class="line">        1060.00</span><br><span class="line">        1123.60</span><br><span class="line">        1191.02</span><br><span class="line">        1262.48</span><br><span class="line">        1338.23</span><br><span class="line">1000 .12 5</span><br><span class="line">        1120.00</span><br><span class="line">        1254.40</span><br><span class="line">        1404.93</span><br><span class="line">        1573.52</span><br><span class="line">        1762.34</span><br></pre></td></tr></table></figure></p>
<p>for语句</p>
<p>另一个语句， for ，将大多数循环都包含的初始化、测试、以及自增压缩成一行。如下是之前利息计算的 for 版本：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># interest1 - 计算复利</span></span><br><span class="line"><span class="comment">#   输入: 钱数    利率    年数</span></span><br><span class="line"><span class="comment">#   输出: 每年末的复利</span></span><br><span class="line"></span><br><span class="line">&#123; <span class="keyword">for</span> (i = 1; i &lt;= <span class="variable">$3</span>; i = i + 1)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\t%.2f\n"</span>, <span class="variable">$1</span> * (1 + <span class="variable">$2</span>) ^ i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>初始化 i = 1 只执行一次。接下来，测试条件 i &lt;= $3 ；如果为真，则执行循环体的 printf 语句。循环体执行结束后执行自增 i = i + 1 ，接着由另一次条件测试开始下一个循环迭代。代码更加紧凑，并且由于循环体仅是一条语句，所以不需要大括号来包围它。</p>
<h3 id="1-7_数组">1.7 数组</h3><p>awk为存储一组相关的值提供了数组。虽然数组给予了awk很强的能力，但在这里我们仅展示一个简单的例子。如下程序将按行逆序打印输入。第一个动作将输入行存为数组 line 的连续元素；即第一行放在 line[1] ，第二行放在 line[2] , 依次继续。 END 动作使用一个 while 语句从后往前打印数组中的输入行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 反转 - 按行逆序打印输入</span></span><br><span class="line"></span><br><span class="line">    &#123; line[NR] = <span class="variable">$0</span> &#125;  <span class="comment"># 记下每个输入行</span></span><br><span class="line"></span><br><span class="line">END &#123; i = NR           <span class="comment"># 逆序打印</span></span><br><span class="line">      <span class="keyword">while</span> (i &gt; 0) &#123;</span><br><span class="line">        <span class="built_in">print</span> line[i]</span><br><span class="line">        i = i - 1</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>以 emp.data 为输入，输出为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Susie    4.25   18</span><br><span class="line">Mary     5.50   22</span><br><span class="line">Mark     5.00   20</span><br><span class="line">Kathy    4.00   10</span><br><span class="line">Dan      3.75   0</span><br><span class="line">Beth     4.00   0</span><br></pre></td></tr></table></figure></p>
<p>如下是使用 for 语句实现的相同示例：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 反转 - 按行逆序打印输入</span></span><br><span class="line"></span><br><span class="line">    &#123; line[NR] = <span class="variable">$0</span> &#125;   <span class="comment"># 记下每个输入行</span></span><br><span class="line"></span><br><span class="line">END &#123; <span class="keyword">for</span> (i = NR; i &gt; 0; i = i - 1)</span><br><span class="line">        <span class="built_in">print</span> line[i]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="二-_AWK语言详解">二. AWK语言详解</h2><p>本章将主要通过示例来解释构成awk程序的概念。因为这是对语言的全面描述，材料会很详细，因此我们推荐你浏览略读，需要的时候再回来核对细节。</p>
<p>最简单的awk程序就是一个模式-动作语句的序列：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern    &#123; action &#125;</span><br><span class="line">pattern    &#123; action &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>某些语句中，可能没有模式；另一些语句中，可能没有动作及其大括号。awk检查你的程序以确认不存在语法错误后，一次读取一行输入，并对每一行按序处理模式。对于每个匹配到当前输入行的模式，执行其关联的动作。不存在模式，则匹配每个输入行，因此没有模式的每个动作对于每个输入行都要执行。一个仅包含模式的模式-动作语句将打印匹配该模式的每个输入行。本章的大部分内容中，名词”输入行(input-line)”和”记录(record)” 是同义的。2.5小节中，我们将讨论多行记录，即一个记录包含多行输入。</p>
<p>本章的第一节将详细描述模式。第二节通过表达式、赋值以及控制语句来描述动作。剩下的章节覆盖函数定义，输出，输入，以及awk程序如何调用其他程序等内容。多数章节包含了主要特性的概要。</p>
<p>输入文件 countries</p>
<p>本章中，我们使用一个名为 countries 的文件作为许多awk程序的输入。文件的每行包含一个国家的名字，以千平方英里为单位的面积，以百万为单位的人口数，以及属于哪个洲。数据是1984年的，苏联(USSR)被武断地归入了亚洲。文件中，四列数据以制表符tab分隔；以单个空格将 North 、 South 与 America 分隔开。</p>
<p>文件 countries 包含如下数据行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USSR    8649    275     Asia</span><br><span class="line">Canada  3852    25      North America</span><br><span class="line">China   3705    1032    Asia</span><br><span class="line">USA     3615    237     North America</span><br><span class="line">Brazil  3286    134     South America</span><br><span class="line">India   1267    746     Asia</span><br><span class="line">Mexico  762     78      North America</span><br><span class="line">France  211     55      Europe</span><br><span class="line">Japan   144     120     Asia</span><br><span class="line">Germany 96      61      Europe</span><br><span class="line">England 94      56      Europe</span><br></pre></td></tr></table></figure></p>
<p>本章的其余部分，如果没有明确说明输入文件，那么就是使用文件 countries 。</p>
<p>程序的格式</p>
<p>模式-动作语句以及动作中的语句通常以换行分隔，如果它们以分号分隔，则多个语句可以出现在一行中。分号可以放在任意语句的尾部。</p>
<p>动作的开大括号必须与其对应的模式处于同一行；动作的其余部分，包括闭大括号，则可以出现接下来的行中。</p>
<p>空行会被忽略；一般为了提高程序的可读性会在语句的前面或者后面插入空行。在操作符和操作数的两边插入空格和制表符也是为了提高可读性。</p>
<p>任意行的末尾可能会有注释。注释以符号 # 开始，结束于行尾，就像这样<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$3</span> &#125;        <span class="comment"># print country name and population</span></span><br></pre></td></tr></table></figure></p>
<p>长语句可以跨越多行，但要在断行的地方加入一个反斜杠和一个换行符：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> \</span><br><span class="line">                <span class="variable">$1</span>,             <span class="comment"># country name</span></span><br><span class="line">                <span class="variable">$2</span>,             <span class="comment"># area in thousands of square miles</span></span><br><span class="line">                <span class="variable">$3</span> &#125;    <span class="comment"># population in millions</span></span><br></pre></td></tr></table></figure></p>
<p>如上例所示，语句也可以逗号断行，在每个断行的末尾也可以加入注释。</p>
<p>本书中，我们使用了多种格式风格，部分是为了说明相异之处，部分是为了避免程序占用太多的行空间。类似于本章中的简短程序，格式并不是很重要，但一致性与可读性可以帮助更长的程序保持可控。</p>
<h3 id="2-1_模式">2.1 模式</h3><p>模式控制着动作的执行：模式匹配，其关联的动作则执行。本节将描述6种模式及其匹配条件。</p>
<p>模式摘要</p>
<ol>
<li>BEGIN { 语句 }<br>在读取任何输入前执行一次 语句</li>
<li>END { 语句 }<br>读取所有输入之后执行一次 语句</li>
<li>表达式 { 语句 }<br>对于 表达式 为真（即，非零或非空）的行，执行 语句</li>
<li>/正则表达式/ { 语句 }<br>如果输入行包含字符串与 正则表达式 相匹配，则执行 语句</li>
<li>组合模式 { 语句 }<br>一个 组合模式 通过与（&amp;&amp;），或（||），非（|），以及括弧来组合多个表达式；对于组合模式为真的每个输入行，执行 语句</li>
<li>模式1，模式2 { 语句 }<br>范围模式(range pattern)匹配从与 模式1 相匹配的行到与 模式2 相匹配的行（包含该行）之间的所有行，对于这些输入行，执行 语句 。<br>BEGIN和END不与其他模式组合。范围模式不可以是任何其他模式的一部分。BEGIN和END是仅有的必须搭配动作的模式。</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk2.png&quot; width=&quot;590&quot; height=&quot;400&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;一-_
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>常用生物信息在线工具</title>
    <link href="http://tiramisutes.github.io/2015/08/05/bio-online.html"/>
    <id>http://tiramisutes.github.io/2015/08/05/bio-online.html</id>
    <published>2015-08-05T11:19:40.000Z</published>
    <updated>2023-02-10T01:54:53.211Z</updated>
    
    <content type="html"><![CDATA[<p><i class="fa fa-volume-control-phone" aria-hidden="true"></i><strong>声明：本文所列工具均为较为初级的生物信息分析，只用于简单的分析过程，更加优秀的工具和准确的分析结果我也在不懈寻找中，同样也欢迎大家留言提供，一个分析结果最好是能够综合不同方式所得结果。</strong><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bioinfo3.png" alt=""><br><a id="more"></a></p>
<h3 id="韦恩图">韦恩图</h3><p><span class="exturl" data-url="aHR0cDovL2Jpb2luZm9ncC5jbmIuY3NpYy5lcy90b29scy92ZW5ueS9pbmRleC5odG1s" title="http://bioinfogp.cnb.csic.es/tools/venny/index.html">Venny2.0<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ven.png" alt=""></p>
<h3 id="升级版韦恩图">升级版韦恩图</h3><p><span class="exturl" data-url="aHR0cDovL2p2ZW5uLnRvdWxvdXNlLmlucmEuZnIvYXBwL2V4YW1wbGUuaHRtbA==" title="http://jvenn.toulouse.inra.fr/app/example.html">jvenn: 可做到6个<i class="fa fa-external-link"></i></span><br><img src="https://i.imgur.com/8ZGkYUr.png" alt=""></p>
<h3 id="基因预测">基因预测</h3><p><span class="exturl" data-url="aHR0cDovL2xpbnV4MS5zb2Z0YmVycnkuY29tL2JlcnJ5LnBodG1sP3RvcGljPWZnZW5lc2gmZ3JvdXA9cHJvZ3JhbXMmc3ViZ3JvdXA9Z2ZpbmQ=" title="http://linux1.softberry.com/berry.phtml?topic=fgenesh&group=programs&subgroup=gfind">FGENESH<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fgenesh.png" alt=""></p>
<h3 id="phylogenetic">phylogenetic</h3><p><span class="exturl" data-url="aHR0cDovL2l0b2wuZW1ibC5kZS9pbmRleC5zaHRtbA==" title="http://itol.embl.de/index.shtml"> iTOL<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/itol.png" alt=""><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXZvbGdlbml1cy5pbmZvL2V2b2x2aWV3Lw==" title="https://www.evolgenius.info/evolview/">Evolview v3<i class="fa fa-external-link"></i></span><br><img src="/images/evo.png" alt=""></p>
<h3 id="在线构建进化树">在线构建进化树</h3><p><span class="exturl" data-url="aHR0cDovL2lxdHJlZS5jaWJpdi51bml2aWUuYWMuYXQv" title="http://iqtree.cibiv.univie.ac.at/">IQTREE Web Server: Fast and accurate phylogenetic trees under maximum likelihood<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/IQ-TREE.png" alt=""></p>
<h3 id="启动子区预测">启动子区预测</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3ctYmltYXMuY2l0Lm5paC5nb3YvbW9sYmlvL3Byb3NjYW4v" title="https://www-bimas.cit.nih.gov/molbio/proscan/">Promoter Scan<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/promot.png" alt=""></p>
<h3 id="蛋白质一级结构分析">蛋白质一级结构分析</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cucHJlZGljdHByb3RlaW4ub3JnL2hvbWU=" title="https://www.predictprotein.org/home">PredictProte<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/predictprotein.png" alt=""><br><span class="exturl" data-url="aHR0cDovL3dlYi5leHBhc3kub3JnL3Byb3RwYXJhbS8=" title="http://web.expasy.org/protparam/">ExPASy-ProtParam tool<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/protparam.png" alt=""></p>
<h3 id="蛋白质磷酸化位点">蛋白质磷酸化位点</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5jYnMuZHR1LmRrL3NlcnZpY2VzL05ldFBob3Mv" title="http://www.cbs.dtu.dk/services/NetPhos/">NetPhos 2.0<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/NetPhos.png" alt=""></p>
<h3 id="信号肽">信号肽</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5jYnMuZHR1LmRrL3NlcnZpY2VzL1NpZ25hbFAv" title="http://www.cbs.dtu.dk/services/SignalP/">SignalP<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/signalip.png" alt=""></p>
<h3 id="跨膜结构域">跨膜结构域</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5jYnMuZHR1LmRrL3NlcnZpY2VzL1RNSE1NLw==" title="http://www.cbs.dtu.dk/services/TMHMM/">TMHMM Server v. 2.0<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/tmhmm.png" alt=""></p>
<h3 id="蛋白质亚细胞定位">蛋白质亚细胞定位</h3><p><span class="exturl" data-url="aHR0cHM6Ly9zZXJ2aWNlcy5oZWFsdGh0ZWNoLmR0dS5kay9zZXJ2aWNlLnBocD9UYXJnZXRQLTIuMA==" title="https://services.healthtech.dtu.dk/service.php?TargetP-2.0">TargetP (Subcellular location of proteins: mitochondrial, chloroplastic, secretory pathway, or other)<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/%E4%BA%9A%E7%BB%86%E8%83%9E.png" alt=""><br><span class="exturl" data-url="aHR0cHM6Ly9zZXJ2aWNlcy5oZWFsdGh0ZWNoLmR0dS5kay9zZXJ2aWNlcy9EZWVwTG9jLTIuMC8=" title="https://services.healthtech.dtu.dk/services/DeepLoc-2.0/">DeepLoc (Prediction of eukaryotic protein subcellular localization using deep learning)<i class="fa fa-external-link"></i></span><br><img src="/images/deeploc.png" alt=""></p>
<h3 id="蛋白质二级结构分析">蛋白质二级结构分析</h3><p><span class="exturl" data-url="aHR0cHM6Ly9ucHNhLXByYWJpLmliY3AuZnIvY2dpLWJpbi9ucHNhX2F1dG9tYXQucGw/cGFnZT1ucHNhX3NvcG1hLmh0bWw=" title="https://npsa-prabi.ibcp.fr/cgi-bin/npsa_automat.pl?page=npsa_sopma.html">SOPMA<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sopma.png" alt=""></p>
<h3 id="蛋白质三级结构预测">蛋白质三级结构预测</h3><p><span class="exturl" data-url="aHR0cDovL3N3aXNzbW9kZWwuZXhwYXN5Lm9yZy9pbnRlcmFjdGl2ZQ==" title="http://swissmodel.expasy.org/interactive">SWISS-MODEL<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/SWISS-MODEL.png" alt=""></p>
<h3 id="短序列拼接">短序列拼接</h3><p><span class="exturl" data-url="aHR0cDovL2RvdWEucHJhYmkuZnIvc29mdHdhcmUvY2FwMw==" title="http://doua.prabi.fr/software/cap3">Cap3<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cap3.png" alt=""></p>
<h3 id="多序列比对相似性展示">多序列比对相似性展示</h3><p><span class="exturl" data-url="aHR0cDovL2NvdHRvbi5oemF1LmVkdS5jbi9FTi90b29scy9CaW9FUkNQL3NpbWl0cml4LnBocA==" title="http://cotton.hzau.edu.cn/EN/tools/BioERCP/simitrix.php">SimiTriX-SimiTetra<i class="fa fa-external-link"></i></span> 和<br><span class="exturl" data-url="aHR0cHM6Ly93d3cudGVybmFyeXBsb3QuY29tLw==" title="https://www.ternaryplot.com/">Ternary plot<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/3wei.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/4wei.png" alt=""></p>
<h3 id="多序列比对可视化">多序列比对可视化</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZWJpLmFjLnVrL1Rvb2xzL21zYS9tdmlldy8=" title="https://www.ebi.ac.uk/Tools/msa/mview/">MView: A multiple alignment viewer<i class="fa fa-external-link"></i></span><br>or<br><span class="exturl" data-url="aHR0cDovL3d3dy5hbGlnbm1lbnR2aWV3ZXIub3JnLw==" title="http://www.alignmentviewer.org/">AlignmentViewer<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aln1.jpg" alt=""></p>
<h3 id="过滤多序列比对结果">过滤多序列比对结果</h3><p><span class="exturl" data-url="aHR0cDovL2d1aWRhbmNlLnRhdS5hYy5pbC92ZXIyLw==" title="http://guidance.tau.ac.il/ver2/">GUIDANCE2 Server: Server for alignment confidence score<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/gtree.png" alt=""></p>
<h3 id="绘制GO注释结果">绘制GO注释结果</h3><p><span class="exturl" data-url="aHR0cDovL3dlZ28uZ2Vub21pY3Mub3JnLmNuLw==" title="http://wego.genomics.org.cn/">WEGO：Web Gene Ontology Annotation Plotting<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/wego.png" alt=""></p>
<h3 id="蛋白质">蛋白质</h3><p><span class="exturl" data-url="aHR0cDovL3BmYW0ueGZhbS5vcmcvc2VhcmNoI3RhYnZpZXc9dGFiMQ==" title="http://pfam.xfam.org/search#tabview=tab1">Pfam database<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL21lbWUtc3VpdGUub3JnL3Rvb2xzL21lbWU=" title="http://meme-suite.org/tools/meme">meme:Multiple Em for Motif Elicitation<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3NtYXJ0LmVtYmwtaGVpZGVsYmVyZy5kZS9zbWFydC9qb2Jfc3RhdHVzLnBsP2pvYmlkPTIyMDI0OTk5MTMyMTk3NzE0ODE2OTk4MjBUdUpDTEFuaHlm" title="http://smart.embl-heidelberg.de/smart/job_status.pl?jobid=2202499913219771481699820TuJCLAnhyf">SMART<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9TdHJ1Y3R1cmUvY2RkL3dycHNiLmNnaQ==" title="https://www.ncbi.nlm.nih.gov/Structure/cdd/wrpsb.cgi">Conserved Domains within a protein or coding nucleotide sequence<i class="fa fa-external-link"></i></span></p>
<blockquote>
<p><strong>模体(motif)</strong><br>属于蛋白质的超二级结构，由2个或2个以上具有二级结构的的肽段，在空间上相互接近，形成一个特殊的空间构象，并发挥专一的功能。一种类型的模体总有其特征性的氨基酸序列。<br>模体是二级结构有规律的组合。例如螺旋-环-螺旋，贝塔折叠的组合、阿而法螺旋组合等。再比如亮氨酸拉链、锌指结构都是典型的模体，它们执行一定的功能，即模体即是结构的单位，又是功能单位，他们可直接作为结构域和三级结构的建筑块。某些蛋白质因子与DNA大沟结合的部位靠的就是某些特异的模体。<br><strong>结构域（domain）</strong><br>是指在较大的分子（主要指蛋白质也包括核酸分子）中形成的某些在空间上可以辨别的结构，往往是球状压缩区或纤维状压缩区。它们也既是结构单位，又是功能单位。例如免疫球蛋白的功能区就是结构域。</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Pfam.png" alt=""></p>
<h3 id="基因组杂合性评估">基因组杂合性评估</h3><p><span class="exturl" data-url="aHR0cDovL3FiLmNzaGwuZWR1L2dlbm9tZXNjb3BlL2FuYWx5c2lzLnBocD9jb2RlPWV4YW1wbGUy" title="http://qb.cshl.edu/genomescope/analysis.php?code=example2">GenomeScope：Estimate genome heterozygosity, repeat content, and size from sequencing reads using a kmer-based statistical approach<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/GenomeScope.png" alt=""></p>
<h3 id="circos图">circos图</h3><p><strong><span class="exturl" data-url="aHR0cDovL21rd2ViLmJjZ3NjLmNhL3RhYmxldmlld2VyL3Zpc3VhbGl6ZS8=" title="http://mkweb.bcgsc.ca/tableviewer/visualize/">CIRCOS<i class="fa fa-external-link"></i></span></strong>可以用来画基因组数据的环状图，也可以用来绘制其它数据的相关环状图。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/circos-table-01%20%281%29.png" alt=""><br><strong>1. 需要注意的是上传数据格式为空格或tab分隔的txt格式纯文本列表文件，值均为非负整数，若存在缺失值，用“-”线代替，若有小数，每一个单元格乘以某一值(如1000)，化为整数，且每个单元格中只能有数字，其他任何符号都不行，除了缺失的“-”，(1555，而不是1,555)；</strong><br><strong>2. 在线版只能绘制75阶方阵数据，若需要绘制较复杂的请下载<span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2Evc29mdHdhcmUvZG93bmxvYWQvY2lyY29z" title="http://www.circos.ca/software/download/circos">Circos<i class="fa fa-external-link"></i></span> and use the <span class="exturl" data-url="aHR0cDovL3d3dy5jaXJjb3MuY2EvZG9jdW1lbnRhdGlvbi90dXRvcmlhbHMvdXRpbGl0aWVzL3Zpc3VhbGl6aW5nX3RhYmxlcy8=" title="http://www.circos.ca/documentation/tutorials/utilities/visualizing_tables/">tableviewer tool。<i class="fa fa-external-link"></i></span></strong><br><strong>3. 每一个标签所对应半圈的总长度为这一标签所对应的所有值的和，不同半圈间连线表示这两标签所表示的值。</strong></p>
<h3 id="元数据可视化">元数据可视化</h3><p><span class="exturl" data-url="aHR0cDovLzEyMS4yNDEuMTg0LjIzMy93ZWJpZ2xvby9pbmRleC5waHA=" title="http://121.241.184.233/webigloo/index.php">Web-Igloo：Interactively visualizing multivariate data without feature decomposition<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/welogo.png" alt=""><br><strong>需要数据和元数据两个文件</strong>,实例数据结构如下：<br>数据(Select data file (Tab delimited))</p>
<p><blockquote>Samples    Palmitic    Palmitoleic    Stearic    Oleic    Linoleic    Linolenic    Arachidic    Eicosenoic<br>S1    1075    75    226    7823    672    36    60    29<br>S2    1088    73    224    7709    781    31    61    29<br>S3    911    54    246    8113    549    31    63    29<br>S4    966    57    240    7952    619    50    78    35<br>S5    1051    67    259    7771    672    50    80    46<br>S6    911    49    268    7924    678    51    70    44<br>S7    922    66    264    7990    618    49    56    29<br>S8    1100    61    235    7728    734    39    64    35<br>S9    1082    60    239    7745    709    46    83    33<br>S10    1037    55    213    7944    633    26    52    30<br>S11    1051    35    219    7978    605    21    65    24<br>S12    1036    59    235    7868    661    30    62    44<br></blockquote><br>元数据（Select metadata (Tab delimited)）</p>
<p><blockquote>Samples    Geography<br>S1    N<br>S2    N<br>S3    N<br>S4    NA<br>S5    NA<br>S6    NA<br>S7    NAp<br>S8    NAp<br>S9    NAp<br>S10    NApulia<br>S11    NApulia<br>S12    NApulia<br></blockquote></p>
<h3 id="基因结构展示">基因结构展示</h3><p><span class="exturl" data-url="aHR0cDovL2dzZHMuY2JpLnBrdS5lZHUuY24vaW5kZXgucGhw" title="http://gsds.cbi.pku.edu.cn/index.php">GSDS2.0: Gene Structure Display Server<i class="fa fa-external-link"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/GSDS.png" alt=""><br><span class="exturl" data-url="aHR0cDovL2dlbm9tZXRvb2xzLm9yZy9jZ2ktYmluL2Fubm90YXRpb25za2V0Y2hfZGVtby5jZ2k=" title="http://genometools.org/cgi-bin/annotationsketch_demo.cgi">AnnotationSketch<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/callbacks.png" alt=""></p>
<h3 id="外显子-内含子结构">外显子-内含子结构</h3><p><span class="exturl" data-url="aHR0cDovL3dvcm13ZWIub3JnL2V4b25pbnRyb24=" title="http://wormweb.org/exonintron">Exon-Intron Graphic Maker<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3Byb3NpdGUuZXhwYXN5Lm9yZy9jZ2ktYmluL3Byb3NpdGUvbXlkb21haW5zLw==" title="http://prosite.expasy.org/cgi-bin/prosite/mydomains/">MyDomains<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2RvbWFpbmRyYXcuaW1iLnVxLmVkdS5hdS4v" title="http://domaindraw.imb.uq.edu.au./">DomainDraw draws <i class="fa fa-external-link"></i></span></p>
<h3 id="蛋白突变位点注释">蛋白突变位点注释</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5jYmlvcG9ydGFsLm9yZy9tdXRhdGlvbl9tYXBwZXIuanNw" title="http://www.cbioportal.org/mutation_mapper.jsp">MutationMapper: interprets mutations with protein annotations<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/M.png" alt=""></p>
<h3 id="regulatory_genes_分析">regulatory genes 分析</h3><p><strong>Transcription factors, transcription regulators, and chromatin regulators, collectively referred to as regulatory genes.</strong><br><span class="exturl" data-url="aHR0cDovL3BsYW50Z3JuLm5vYmxlLm9yZy9QbGFudFRGY2F0Lw==" title="http://plantgrn.noble.org/PlantTFcat/">PlantTFcat: An Online Plant Transcription Factor and Transcriptional Regulator Categorization and Analysis Tool<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PlantTF.jpg" alt=""></p>
<h3 id="密码子偏好性_(Codon_Optimization)">密码子偏好性 (Codon Optimization)</h3><p><span class="exturl" data-url="aHR0cDovL2Nvb2wuc3luY3RpLm9yZy9zZXR1cF9pbnB1dF9zZXF1ZW5jZV9jcmVhdGVfd2YxLnBocD8=" title="Codon Optimization On-Line (COOL)">Codon Optimization On-Line (COOL)<i class="fa fa-external-link"></i></span><br><img src="http://cool.syncti.org/images/Aminoacids_table.svg" alt=""><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuaWR0ZG5hLmNvbS9Db2Rvbk9wdA==" title="https://www.idtdna.com/CodonOpt">Codon Optimization Tool：Integrated DNA Technologies<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/mimazi.jpg" alt=""></p>
<h3 id="序列格式转换(Sequence_Format_Conversion)">序列格式转换(Sequence Format Conversion)</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZWJpLmFjLnVrL1Rvb2xzL3NmYy9lbWJvc3Nfc2VxcmV0Lw==" title="https://www.ebi.ac.uk/Tools/sfc/emboss_seqret/">EMBOSS Seqret<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/seqret.png" alt=""></p>
<h3 id="真菌效应蛋白预测">真菌效应蛋白预测</h3><p><span class="exturl" data-url="aHR0cDovL2VmZmVjdG9ycC5jc2lyby5hdS8=" title="http://effectorp.csiro.au/">EffectorP: predicting fungal effector proteins from secretomes using machine learning<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fungal.png" alt=""></p>
<h3 id="BLAST结果可视化">BLAST结果可视化</h3><p><span class="exturl" data-url="aHR0cDovL2thYmxhbW1vLndhc211dGhsYWIub3JnLw==" title="http://kablammo.wasmuthlab.org/">kablammo: Visualize your BLAST results<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/blast.png" alt=""><br>or<br><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmJhdC5pbmZzcGlyZS5vcmcvY2lyY29sZXR0by8=" title="http://tools.bat.infspire.org/circoletto/">Circoletto<i class="fa fa-external-link"></i></span><br><img src="http://bat.infspire.org/tools/circoletto/circoletto.png" alt=""></p>
<h3 id="植物基因家族分类和富集分析">植物基因家族分类和富集分析</h3><p><span class="exturl" data-url="aHR0cDovL21hbmRhZGlsYWIud2ViZmFjdGlvbmFsLmNvbS9ob21lLw==" title="http://mandadilab.webfactional.com/home/">GenFam: Gene Family based classification and enrichment analysis<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/geneFam.png" alt=""></p>
<h3 id="生物类文件格式转换">生物类文件格式转换</h3><p><span class="exturl" data-url="aHR0cDovL3NlcXVlbmNlY29udmVyc2lvbi5idWdhY28uY29tL2NvbnZlcnRlci9iaW9sb2d5L3NlcXVlbmNlcy9nZW5iYW5rX3RvX2Zhc3RhLnBocA==" title="http://sequenceconversion.bugaco.com/converter/biology/sequences/genbank_to_fasta.php">Sequence conversion<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/seqcov.png" alt=""></p>
<h3 id="Plant-Specific_Myristoylation_Predictor">Plant-Specific Myristoylation Predictor</h3><p><span class="exturl" data-url="aHR0cDovL3BsYW50c3AuZ2Vub21pY3MucHVyZHVlLmVkdS9teXJpc3QuaHRtbA==" title="http://plantsp.genomics.purdue.edu/myrist.html">Plant-Specific Myristoylation Predictor<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Myp.png" alt=""></p>
<h3 id="启动子元件预测">启动子元件预测</h3><p><span class="exturl" data-url="aHR0cDovL2Jpb2luZm9ybWF0aWNzLnBzYi51Z2VudC5iZS93ZWJ0b29scy9wbGFudGNhcmUvaHRtbC8=" title="http://bioinformatics.psb.ugent.be/webtools/plantcare/html/">Plant CARE: Search for CARE<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/motif.png" alt=""></p>
<h3 id="植物启动子/转录因子分析">植物启动子/转录因子分析</h3><p><span class="exturl" data-url="aHR0cDovL3BsYW50cGFuLml0cHMubmNrdS5lZHUudHcv" title="http://plantpan.itps.ncku.edu.tw/">PlantPAN 3.0<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plantpan.png" alt=""></p>
<h3 id="转录组分析">转录组分析</h3><p><span class="exturl" data-url="aHR0cDovL2Jpb2luZm9ybWF0aWNzLnNkc3RhdGUuZWR1L2lkZXAv" title="http://bioinformatics.sdstate.edu/idep/">iDEP<i class="fa fa-external-link"></i></span><br><img src="/images/iDEP.png" alt=""></p>
<h3 id="简并引物设计">简并引物设计</h3><p><span class="exturl" data-url="aHR0cHM6Ly9iaWJpc2Vydi5jZWJpdGVjLnVuaS1iaWVsZWZlbGQuZGUvZ2VuZWZpc2hlcjI=" title="https://bibiserv.cebitec.uni-bielefeld.de/genefisher2">Genefisher 2<i class="fa fa-external-link"></i></span><br><img src="/images/Genefisher2.png" alt=""></p>
<h3 id="词云_wordcloud">词云 wordcloud</h3><p><span class="exturl" data-url="aHR0cHM6Ly9tb25rZXlsZWFybi5jb20vd29yZC1jbG91ZA==" title="https://monkeylearn.com/word-cloud">WordCloud Generator<i class="fa fa-external-link"></i></span><br><img src="/images/word-cloud.png" alt=""><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZXdvcmRjbG91ZGdlbmVyYXRvci5jb20vZ2VuZXJhdGV3b3JkY2xvdWQ=" title="https://www.freewordcloudgenerator.com/generatewordcloud">Free Word Cloud Generator<i class="fa fa-external-link"></i></span><br><img src="/images/generatewordcloud.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;i class=&quot;fa fa-volume-control-phone&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;strong&gt;声明：本文所列工具均为较为初级的生物信息分析，只用于简单的分析过程，更加优秀的工具和准确的分析结果我也在不懈寻找中，同样也欢迎大家留言提供，一个分析结果最好是能够综合不同方式所得结果。&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bioinfo3.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="bio-online" scheme="http://tiramisutes.github.io/tags/bio-online/"/>
    
  </entry>
  
  <entry>
    <title>firewall</title>
    <link href="http://tiramisutes.github.io/2015/08/02/firewall.html"/>
    <id>http://tiramisutes.github.io/2015/08/02/firewall.html</id>
    <published>2015-08-02T06:18:15.000Z</published>
    <updated>2018-09-28T02:34:38.521Z</updated>
    
    <content type="html"><![CDATA[<h3 id="受到管制的中国互联网">受到管制的中国互联网</h3><p>中国对其互联网内容有着严格的管制，设置了名为”防火长城”的屏蔽系统来阻止用户与外面的世界自由地互动。想要从中国访问自由的、不受管制的互联网，你需要绕开长城防火墙，在中国，上网就是如此之难。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fire1.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fire2.JPG" alt=""></p>
<h3 id="测试网站是否被墙">测试网站是否被墙</h3><p><li><span class="exturl" data-url="aHR0cDovL3d3dy53ZWJzaXRlcHVsc2UuY29tL2hlbHAvdGVzdHRvb2xzLmNoaW5hLXRlc3QuaHRtbA==" title="http://www.websitepulse.com/help/testtools.china-test.html">websitepulse.com<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly96aC5ncmVhdGZpcmUub3JnL3Rlc3Q/dXJsPQ==" title="https://zh.greatfire.org/test?url=">greatfire.org<i class="fa fa-external-link"></i></span></li></p>
<h3 id="翻墙必备">翻墙必备</h3><p><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29sZGVuZnJvZy5jb20vdnlwcnZwbg==" title="https://www.goldenfrog.com/vyprvpn">VyprVPN<i class="fa fa-external-link"></i></span> ，有500M的免费流量，抗墙能力强，特别是安卓等移动设备。<strong><span style="color:#ff0000;">Vyprvpn为中国用户提供多一倍的免费数据流量</span></strong>，可<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29sZGVuZnJvZy5jaC9DTi92eXBydnBuL2dyZWF0LWZpcmV3YWxsLWZyZWUtdnBuLXNlcnZpY2U/b2ZmZXJfaWQ9OTAmYW1wO2FmZl9pZD0yMTQ3JmFtcDt1cmxfaWQ9NDcmYW1wO3Byb2Nlc3NlZD0xIw==" title="https://www.goldenfrog.ch/CN/vyprvpn/great-firewall-free-vpn-service?offer_id=90&amp;aff_id=2147&amp;url_id=47&amp;processed=1#">在此下载<i class="fa fa-external-link"></i></span>（中文页面），在推荐的这个入口注册账号才有多一倍的免费流量，下载手机客户端，用注册的账号登录即可。安卓下的vyprvpn可启用专用协议对抗中国的网络封锁，不可错过。 <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xQjlpckZjZy13ZGhjNzBsaGNCQldYNUpaZkN6cVU0ZDcza25RLXoyR2kxZy9wdWI=" title="https://docs.google.com/document/d/1B9irFcg-wdhc70lhcBBWX5JZfCzqU4d73knQ-z2Gi1g/pub">专供中国用户：安装及使用疑难问题解答。<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lpbmdodW9jaG8vZmlyZWZseS1wcm94eQ==" title="https://github.com/yinghuocho/firefly-proxy">萤火虫代理<i class="fa fa-external-link"></i></span> 开源翻墙工具，支持多平台。</li></p>
<p><li> <span class="exturl" data-url="aHR0cHM6Ly93d3cuZ2V0bGFudGVybi5vcmcv" title="https://www.getlantern.org/">Lantern<i class="fa fa-external-link"></i></span> 用私有网络分享节点，可以一试。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3dvd2xlZ2FjeS5tbC8=" title="http://wowlegacy.ml/">WoW Legacy<i class="fa fa-external-link"></i></span> 翻牆瀏覽器WowLegacy，基於Goagent重新開發，可一鍵翻牆。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy52cG5nYXRlLm5ldC9jbi8=" title="http://www.vpngate.net/cn/">VPN Gate<i class="fa fa-external-link"></i></span>  由全世界志愿者提供的公共 VPN 服务器获得自由访问互联网。VPNgate的开发者引入了一项新技术：P2P中继。简单来说，如果墙内有人连上了墙外志愿者提供的VPNgate服务器，那么他就自动成为了服务器，其他墙内的人就可以通过连上他来翻墙。（<span class="exturl" data-url="aHR0cDovL3d3dy5jaGluYWdmdy5vcmcvMjAxNS8wMi92cG5nYXRlcDJwLmh0bWw=" title="http://www.chinagfw.org/2015/02/vpngatep2p.html">安装<i class="fa fa-external-link"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy52cG5nYXRlLm5ldC9jbi9kb3dubG9hZC5hc3B4" title="http://www.vpngate.net/cn/download.aspx">下载<i class="fa fa-external-link"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy5jaGluYWdmdy5vcmcvMjAxNC8wNS8yMDE0NS5odG1s" title="http://www.chinagfw.org/2014/05/20145.html">使用经验<i class="fa fa-external-link"></i></span>）</li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tLzVua3Qtc2o3eC1jYzJoL3poLmh0bWw=" title="https://s3.amazonaws.com/5nkt-sj7x-cc2h/zh.html">赛风<i class="fa fa-external-link"></i></span> （<span class="exturl" data-url="aHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tLzVua3Qtc2o3eC1jYzJoL3poLmh0bWw=" title="https://s3.amazonaws.com/5nkt-sj7x-cc2h/zh.html">下载<i class="fa fa-external-link"></i></span>）由开放网络基金资助、多伦多大学的公民实验室（Citizen Lab）开发。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy5pc2hhZG93c29ja3MuY29tLw==" title="http://www.ishadowsocks.com/">Shadowsocks<i class="fa fa-external-link"></i></span> 免费账号</li></p>
<h3 id="建议关注">建议关注</h3><p>P2P翻墙项目<span class="exturl" data-url="aHR0cHM6Ly91cHJveHkub3JnLw==" title="https://uproxy.org/">Uproxy<i class="fa fa-external-link"></i></span>的进展，谷歌翻墙利器。</p>
<h3 id="付费方案">付费方案</h3><p><li><span class="exturl" data-url="aHR0cDovL3d3dy5ob25neGluZ2NoYWppYW4uY29tLw==" title="http://www.hongxingchajian.com/">红杏<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/hongxing.png" alt=""></li></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;受到管制的中国互联网&quot;&gt;受到管制的中国互联网&lt;/h3&gt;&lt;p&gt;中国对其互联网内容有着严格的管制，设置了名为”防火长城”的屏蔽系统来阻止用户与外面的世界自由地互动。想要从中国访问自由的、不受管制的互联网，你需要绕开长城防火墙，在中国，上网就是如此之难。&lt;/p&gt;
&lt;p&gt;
    
    </summary>
    
      <category term="Google" scheme="http://tiramisutes.github.io/categories/Google/"/>
    
    
      <category term="firewall" scheme="http://tiramisutes.github.io/tags/firewall/"/>
    
  </entry>
  
  <entry>
    <title>linux命令行精选</title>
    <link href="http://tiramisutes.github.io/2015/08/01/linux-command.html"/>
    <id>http://tiramisutes.github.io/2015/08/01/linux-command.html</id>
    <published>2015-08-01T13:27:15.000Z</published>
    <updated>2018-09-28T02:37:38.708Z</updated>
    
    <content type="html"><![CDATA[<p>致力于收集那些短小精悍的linux命令，欢迎补充！<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/linux_command.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">grep -vf file1 file2 查看两个文件的不同</span><br><span class="line">rename -n <span class="string">"s/-.*//"</span> * 批量前缀重命名</span><br><span class="line">diff &lt;(sort file1.txt) &lt;(sort file2.txt) 比较两个已排序的文件</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `find -name <span class="string">'*_test.rb'</span>` ; <span class="keyword">do</span> mv <span class="variable">$i</span> <span class="variable">$&#123;i%%_test.rb&#125;</span>_spec.rb ; <span class="keyword">done</span> 批量重命名</span><br><span class="line">shred -u -z -n 17 rubricasegreta.txt 安全删除文件</span><br><span class="line">sed -re <span class="string">'/^#/d ; s/#.*$//'</span> 清理注释</span><br><span class="line">ps aux | sort -nk 6 排序按 第6列</span><br><span class="line">convert -density 300x300 input.pdf output.png 把pdf转化成png</span><br><span class="line">:%s/&lt;control-VM&gt;//g 如何在vim清理^M</span><br><span class="line"><span class="built_in">export</span> HISTTIMEFORMAT=<span class="string">'%Y.%m.%d-%T :: '</span> HISTFILESIZE=50000 HISTSIZE=50000 更好地设置bash <span class="built_in">history</span></span><br><span class="line">/^\([2-9]\d*\|1\d+\) vim 中查找比 1 大的数</span><br><span class="line">tar cvfz dir_name.tgz dir/ 如何tar gz 一个目录</span><br><span class="line">pv file1 &gt; file2 带进度条的复制文件</span><br><span class="line">gs -dNOPAUSE -sDEVICE=jpeg -r144 -sOutputFile=p%03d.jpg file.pdf 使用Ghostscript转换PDF为JPEG</span><br><span class="line">find . -iname <span class="string">"*.jpg"</span> -<span class="built_in">printf</span> <span class="string">'&lt;img src="%f" title="%f"&gt;\n'</span> &gt; gallery.html 创建一个html相册</span><br><span class="line">sed -i &lt;start&gt;,&lt;end&gt;d &lt;filename&gt; 从一个文件删除一个范围内的行</span><br><span class="line">sed <span class="string">'/^$/d'</span> file &gt;newfile 清除文件中的空行</span><br><span class="line">awk <span class="string">'&#123;print NR": "$0; for(i=1;i&lt;=NF;++i)print "\t"i": "$i&#125;'</span> 分析列</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'wget url'</span> | at 01:00 定时启动wget下载</span><br><span class="line">awk -F<span class="string">'^"|", "|"$'</span> <span class="string">'&#123; print $2,$3,$4 &#125;'</span> file.csv 用 awk 解析.csv</span><br><span class="line">find -<span class="built_in">type</span> f -<span class="built_in">exec</span> mv &#123;&#125; . \; 将子目录的所有内容都移动到当前目录</span><br><span class="line">sed -i <span class="string">'s/\s\+$//'</span> &lt;file&gt; 删除文件中每行末尾的空格</span><br><span class="line">ls -al | sort +4n 按大小排序</span><br><span class="line">sort file1 file2 | uniq -d 求交集</span><br><span class="line">wget -r -nd -q -A <span class="string">"*.ext"</span> http://www.example.org/   抓去一个网页的所有特定扩展名的文件</span><br><span class="line">awk <span class="string">'&#123;s+=$1&#125;END&#123;print s&#125;'</span>   列求和</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;致力于收集那些短小精悍的linux命令，欢迎补充！&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/linux_command.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;figur
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="linux_command" scheme="http://tiramisutes.github.io/tags/linux-command/"/>
    
  </entry>
  
  <entry>
    <title>rss制作</title>
    <link href="http://tiramisutes.github.io/2015/08/01/rss.html"/>
    <id>http://tiramisutes.github.io/2015/08/01/rss.html</id>
    <published>2015-08-01T02:34:40.000Z</published>
    <updated>2018-09-28T02:43:39.561Z</updated>
    
    <content type="html"><![CDATA[<p>它非常小巧，仅仅加了一种能自动生成种子的功能。用户只需提供需要处理的URL地址，<span class="exturl" data-url="aHR0cHM6Ly9mZWVkaXR5LmNvbS8=" title="https://feedity.com/">Feedityl<i class="fa fa-external-link"></i></span>会提供起始终止的选项模块，这样它就能输出选定的内容。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/rss.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;它非常小巧，仅仅加了一种能自动生成种子的功能。用户只需提供需要处理的URL地址，&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9mZWVkaXR5LmNvbS8=&quot; title=&quot;https://feedity.com/&quot;&gt;Feedity
    
    </summary>
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/categories/Hexo/"/>
    
    
      <category term="rss" scheme="http://tiramisutes.github.io/tags/rss/"/>
    
  </entry>
  
  <entry>
    <title>杂志图表的经典用色</title>
    <link href="http://tiramisutes.github.io/2015/07/31/color.html"/>
    <id>http://tiramisutes.github.io/2015/07/31/color.html</id>
    <published>2015-07-31T15:07:34.000Z</published>
    <updated>2018-09-28T02:31:48.842Z</updated>
    
    <content type="html"><![CDATA[<h3 id="《经济学人》常用的藏青色">《经济学人》常用的藏青色</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c77d81fg214.jpg" alt=""></p>
<p>经济学人上的图表，基本只用这一个颜色，或加上一些深浅明暗变化，再就是左上角的小红块，成为经济学人图表的招牌样式。罗兰贝格也非常爱用这个色，有时也配合橙色使用。各类提供专业服务的网站也多爱用此色。</p>
<p>风格就是这样，即使很单调，只要你坚持，也会成为自己的风格，别人也会认同。所谓以不变应万变，变得太多反而难以把握。</p>
<h3 id="《商业周刊》常用的蓝红组合">《商业周刊》常用的蓝红组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c74bcadg215.jpg" alt=""></p>
<p>早年的商业周刊上的图表，几乎都使用这个颜色组合，基本成为商业周刊图表的招牌标志了，应该是来源于其VI系统。不过今年来好像很有些变化，更加轻快明亮。</p>
<h3 id="《华尔街日报》常用的黑白灰">《华尔街日报》常用的黑白灰</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7989a1g214.jpg" alt=""><br>HSJ是一份报纸，所以图表多是黑白的，但就是这种黑白灰的组合，做出的图表仍然可以非常专业，配色也非常容易。</p>
<h3 id="使用同一颜色的不同深浅">使用同一颜色的不同深浅</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c75dafag215.jpg" alt=""></p>
<p>如果既想使用彩色，又不知道配色理论，可在一个图表内使用同一颜色的不同深浅/明暗。这种方法可以让我们使用丰富的颜色，配色难度也不高，是一种很保险的方法，不会出大问题。当然，最深/最亮的要用于最需要突出的序列。</p>
<h3 id="《FOCUS》常用的一组色">《FOCUS》常用的一组色</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7b0916g213.jpg" alt=""></p>
<p>这组颜色似乎是从组织的LOGO而来，比较亮丽明快，也不错。</p>
<h3 id="设计师珍藏自用颜色：橙＋灰">设计师珍藏自用颜色：橙＋灰</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7ace92g214.jpg" alt=""></p>
<p>我发现，设计师们总喜好把这个颜色组合用于自己的宣传，似乎这样能体现设计师的专业性。如Inmagine、Nordrio的LOGO就是这样。</p>
<h3 id="暗红＋灰组合">暗红＋灰组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7728eeg215.jpg" alt=""></p>
<p>这种红＋灰的组合给人很专业的印象，也经常出现在财经杂志上。</p>
<h3 id="橙＋绿组合">橙＋绿组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7c4e31g213.jpg" alt=""></p>
<p>这种橙＋绿的组合比较亮丽明快，充满活力，也经常出现在财经杂志上。</p>
<h3 id="黑底图表">黑底图表</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7cb5f3g213.jpg" alt=""></p>
<p>最为强烈的黑白对比，总是显得比较专业、高贵，黑底的图表其特点非常明显，但不要学麦肯锡的那一套，有些刺眼，也被它用滥了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;《经济学人》常用的藏青色&quot;&gt;《经济学人》常用的藏青色&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c77d81fg214.jpg&quot; alt=&quot;
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="经典配色" scheme="http://tiramisutes.github.io/tags/%E7%BB%8F%E5%85%B8%E9%85%8D%E8%89%B2/"/>
    
  </entry>
  
  <entry>
    <title>ggplot2 fine drawing using mytheme</title>
    <link href="http://tiramisutes.github.io/2015/07/31/mytheme.html"/>
    <id>http://tiramisutes.github.io/2015/07/31/mytheme.html</id>
    <published>2015-07-31T14:45:06.000Z</published>
    <updated>2018-09-28T02:38:53.071Z</updated>
    
    <content type="html"><![CDATA[<p>ggplot2本身自带了很漂亮的主题格式，如theme_gray和theme_bw。但是在工作用图上，很多时候对图表格式配色字体等均有明文的规定。ggplot2允许我们事先定制好图表样式，我们可以生成如mytheme或者myline这样的有明确配色主题的对象，到时候就可以定制保存图表模板或者格式刷，直接在生成的图表里引用格式刷型的主题配色，就可以快捷方便的更改图表内容，保持风格的统一了。</p>
<h2 id="画图前的准备：自定义ggplot2格式刷">画图前的准备：自定义ggplot2格式刷</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(dplyr)</span><br><span class="line">library(RColorBrewer)</span><br><span class="line">library(tidyr)</span><br><span class="line">library(grid)</span><br><span class="line"><span class="comment">#定义好字体</span></span><br><span class="line">windowsFonts(CA=windowsFont(<span class="string">"Calibri"</span>))</span><br><span class="line"><span class="comment">#事先定制好要加图形的形状、颜色、主题等</span></span><br><span class="line"><span class="comment">#定制主题，要求背景全白，没有边框。然后所有的字体都是某某颜色</span></span><br><span class="line">mytheme&lt;-theme_bw()+theme(legend.position=<span class="string">"right"</span>,</span><br><span class="line">                          panel.border=element_blank(),</span><br><span class="line">                          panel.grid.major=element_line(linetype=<span class="string">"dashed"</span>),</span><br><span class="line">                          panel.grid.minor=element_blank(),</span><br><span class="line">                          plot.title=element_text(size=15,</span><br><span class="line">                                                  colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                  family=<span class="string">"CA"</span>),</span><br><span class="line">                          legend.text=element_text(size=9,colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                   family=<span class="string">"CA"</span>),</span><br><span class="line">                          legend.key=element_blank(),</span><br><span class="line">                          axis.text=element_text(size=10,colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                 family=<span class="string">"CA"</span>),</span><br><span class="line">                          strip.text=element_text(size=12,colour=<span class="string">"#EF0808"</span>,</span><br><span class="line">                                                  family=<span class="string">"CA"</span>),</span><br><span class="line">                          strip.background=element_blank()</span><br><span class="line"></span><br><span class="line">                        )</span><br><span class="line"><span class="comment">#饼图主题</span></span><br><span class="line">pie_theme=mytheme+theme(axis.text=element_blank(),</span><br><span class="line">                        axis.ticks=element_blank(),</span><br><span class="line">                        axis.title=element_blank(),</span><br><span class="line">                        panel.grid.major=element_blank())</span><br><span class="line"><span class="comment">#定制线的大小</span></span><br><span class="line">myline_blue&lt;-geom_line(colour=<span class="string">"#085A9C"</span>,size=2)</span><br><span class="line">myline_red&lt;-geom_line(colour=<span class="string">"#EF0808"</span>,size=2)</span><br><span class="line">myarea=geom_area(colour=NA,fill=<span class="string">"#003087"</span>,alpha=.2)</span><br><span class="line">mypoint=geom_point(size=3,shape=21,colour=<span class="string">"#003087"</span>,fill=<span class="string">"white"</span>)</span><br><span class="line">mybar=geom_bar(fill=<span class="string">"#0C8DC4"</span>,<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br><span class="line"><span class="comment">#然后是配色（主要是图形配色），考虑到样本的多样性，可以事先设定颜色，如3种颜色或7种颜色的组合，如果想要用原来默认主题颜色则这部分注释掉即可</span></span><br><span class="line">mycolour_3&lt;-scale_fill_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>))</span><br><span class="line">mycolour_7&lt;-scale_fill_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>,</span><br><span class="line"><span class="string">"#FFFFE7"</span>,<span class="string">"#FF9418"</span>,<span class="string">"#219431"</span>,<span class="string">"#9C52AD"</span>))</span><br><span class="line">mycolour_line_7&lt;-scale_color_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>,</span><br><span class="line">                                             <span class="string">"#0C8DC4"</span>,<span class="string">"#FF9418"</span>,<span class="string">"#219431"</span>,<span class="string">"#9C52AD"</span>))</span><br><span class="line"><span class="comment">#定制标题</span></span><br><span class="line">mytitle&lt;-labs(title = <span class="string">"hope 实例"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="载入例子数据">载入例子数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">require(ggplot2)</span><br><span class="line">data(diamonds)</span><br><span class="line">set.seed(42)</span><br><span class="line">small &lt;- diamonds[sample(nrow(diamonds), 1000), ]</span><br><span class="line">head(small)</span><br></pre></td></tr></table></figure>
<h3 id="不用自定义格式画图">不用自定义格式画图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot(small)+geom_bar(aes(x=clarity, fill=cut))+coord_polar()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot01.jpeg" alt=""></p>
<h3 id="利用自定义格式画图">利用自定义格式画图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot(small)+geom_bar(aes(x=clarity, fill=cut))+coord_polar()+ mytheme + mytitle</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot.jpeg" alt=""></p>
<h2 id="画图前的准备：数据塑形利器dplyr/tidyr">画图前的准备：数据塑形利器dplyr/tidyr</h2><p>在R里，则是用一些常用的包，如dplyr及tidyr，基本用的都是reshape2+plyr的组合对数据进行重塑再造.</p>
<h3 id="载入数据，数据来源:_股票的成交明细-">载入数据，数据来源: <span class="exturl" data-url="aHR0cDovL3d3dy55dWNlemhlLmNvbS9wcm9kdWN0P25hbWU9dGljay1kYXRhLXB1c2g=" title="http://www.yucezhe.com/product?name=tick-data-push">股票的成交明细.<i class="fa fa-external-link"></i></span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; data&lt;-read.table(<span class="string">"gupiao.txt"</span>,header=TRUE)</span><br><span class="line">&gt; head(data)</span><br><span class="line">     Time Price BuySell Volume     Money</span><br><span class="line">1 9:25:08 18.03    0.00  73520 132557642</span><br><span class="line">2 9:29:59 17.99   -0.04  11034  19857700</span><br><span class="line">3 9:30:09 17.99    0.00  28920  52089378</span><br><span class="line">4 9:30:09 17.99    0.00   9272  16681906</span><br><span class="line">5 9:30:14 17.96   -0.03    556    998913</span><br><span class="line">6 9:30:19 17.96    0.00    873   1567490</span><br><span class="line">&gt; dim(data)</span><br><span class="line">[1] 2345    5</span><br></pre></td></tr></table></figure>
<h3 id="将数据汇总(group_by_&amp;_summarize)_甚至再拆分_(spread)">将数据汇总(group_by &amp; summarize) 甚至再拆分 (spread)</h3><p>示例里面就是把成交记录按照成交Price和BuySell拆分<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; data %&gt;% group_by(Price,BuySell) %&gt;% summarize(Money=sum(Money,na.rm=TRUE)) %&gt;% spread(BuySell,Money)</span><br><span class="line">Source: <span class="built_in">local</span> data frame [46 x 16]</span><br><span class="line"></span><br><span class="line">   Price -0.07 -0.06 -0.05    -0.04   -0.03    -0.02    -0.01        0     0.01</span><br><span class="line">1  17.58    NA    NA    NA       NA      NA       NA 41631769 29645465       NA</span><br><span class="line">2  17.59    NA    NA    NA       NA      NA 17173618 37029276       NA 24179724</span><br><span class="line">3  17.60    NA    NA    NA       NA      NA   318581 42756941 15987562 11197676</span><br><span class="line">4  17.61    NA    NA    NA       NA      NA       NA 58098336 36701330 14999088</span><br><span class="line">5  17.62    NA    NA    NA       NA      NA       NA 32385632 51156365 24341609</span><br><span class="line">6  17.63    NA    NA    NA       NA      NA  5191027 16112558 32054647 23599759</span><br><span class="line">7  17.64    NA    NA    NA 24642084 3725529 14682967  4791698 18864232  4731619</span><br><span class="line">8  17.65    NA    NA    NA       NA 3918096  6003983 16293279 19115145 13177514</span><br><span class="line">9  17.66    NA    NA    NA       NA 5175002       NA 54169855 16671362  7801764</span><br><span class="line">10 17.67    NA    NA    NA       NA      NA 10951987 38090607  8704892  7911066</span><br><span class="line">..   ...   ...   ...   ...      ...     ...      ...      ...      ...      ...</span><br><span class="line">Variables not shown: 0.02 (int), 0.03 (int), 0.04 (int), 0.05 (int), 0.06 (int),</span><br><span class="line">  0.07 (int)</span><br></pre></td></tr></table></figure></p>
<p>然后便可用ggplot等包绘图。</p>
<h2 id="常用图形">常用图形</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">简单柱形图+文本（单一变量） </span><br><span class="line">分面柱形图（facet_wrap/facet_grid) </span><br><span class="line">簇型柱形图(position=<span class="string">"dodge"</span>) </span><br><span class="line">堆积柱形图(需要先添加百分比，再对百分比的变量做柱形图) </span><br><span class="line">饼图、极坐标图 </span><br><span class="line">多重线性图</span><br></pre></td></tr></table></figure>
<p>1)简单柱形图 </p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11.jpeg" alt=""><br>代码组成如下，这里使用格式刷mybar和mytheme，然后用geom_text添加柱形图标签(vjust=1表示在柱形图里面显示)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data1&lt;-diamonds %&gt;% group_by(cut) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line">bar_chart&lt;-ggplot(data1,aes(x=cut,y=avg_price,fill=as.factor(cut)))+</span><br><span class="line">        mybar+mytheme+mytitle+</span><br><span class="line">        geom_text(aes(label=round(avg_price)),vjust=1,colour=<span class="string">"white"</span>)</span><br><span class="line">bar_chart</span><br></pre></td></tr></table></figure></p>
<p>2）带分类的柱形图<br>使用facet_wrap或者facet_grid可以快速绘制相应图形。这也是ggplot2不太支持双坐标的原因：可以快速绘图，就不需要做那么多无用功了。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/22.jpeg" alt=""><br>代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dplyr处理数据</span></span><br><span class="line">data2&lt;-diamonds %&gt;% group_by(cut,color) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line"><span class="comment">#画图，套用设定好的绘图元素</span></span><br><span class="line">ggplot(data2,aes(x=color,y=avg_price))+facet_wrap(~cut,ncol = 2)+</span><br><span class="line">        mybar+mytheme+mytitle</span><br><span class="line"><span class="comment">#在facet_wrap里面，如果加上scales="free"的话，坐标就不一样了。</span></span><br></pre></td></tr></table></figure></p>
<p>3）簇型图<br>制图要点是，对数据作图后，添加geom_bar时，position=”dodge”（分开的）如果去掉这部分，默认是生成堆积图.</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/33.jpeg" alt=""><br>代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data3&lt;-diamonds %&gt;% filter(cut %<span class="keyword">in</span>% c(<span class="string">"Fair"</span>,<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>)) %&gt;%</span><br><span class="line">        group_by(cut,color) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line"><span class="comment">#簇状图</span></span><br><span class="line">簇状柱形图&lt;-ggplot(data3,aes(x=color,y=avg_price,fill=cut))+</span><br><span class="line">        geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,position=<span class="string">"dodge"</span>)+</span><br><span class="line">        mytheme+mytitle+mycolour_3</span><br></pre></td></tr></table></figure>
<p>这里如果想要定义颜色的相应顺序的话，可以使用factor </p>
<p>譬如以下,只是用这行代码对颜色重新定义一下，用levels改变factor顺序，再画图的时候，颜色以及柱子顺序就会跟着改变了。非常方便。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data3<span class="variable">$cut</span>&lt;-factor(data3<span class="variable">$cut</span>,levels=c(<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>,<span class="string">"Fair"</span>))</span><br></pre></td></tr></table></figure></p>
<p>4）百分比堆积图<br>制图前要事先添加一个百分比的数据之后才好作图，这里我们用mutate(percent=n/sum(n))添加该百分比数据。同时去掉position=”dodge”<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/66.jpeg" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data4&lt;-diamonds %&gt;% filter(cut %<span class="keyword">in</span>% c(<span class="string">"Fair"</span>,<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>)) %&gt;%</span><br><span class="line">         count(color,cut) %&gt;% </span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">堆积图&lt;-ggplot(data4,aes(x=color,y=percent,fill=cut))+mytitle+</span><br><span class="line">        geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)+mytheme+mycolour_3</span><br></pre></td></tr></table></figure></p>
<p>当然，也可以做面积图。不过如果数据有缺失，面积图出错几率蛮大的</p>
<p>5）饼图以及极坐标图</p>
<p>在ggplot2里并没有直接画饼图的方法，基本上都是先画出柱形图，再用coord_polar转化为饼图.<br>不指定x轴，直接用geom_bar生成y轴，然后fill=分类颜色，coord_polar直接投影y轴，该方法的好处代码是比较简单：coord_polar(“y”) 。<br>加标签方法请见： <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84OTUyMDc3L3BpZS1wbG90LWdldHRpbmctaXRzLXRleHQtb24tdG9wLW9mLWVhY2gtb3RoZXI=" title="http://stackoverflow.com/questions/8952077/pie-plot-getting-its-text-on-top-of-each-other">http://stackoverflow.com/questions/8952077/pie-plot-getting-its-text-on-top-of-each-other<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/77.jpeg" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data5&lt;-diamonds %&gt;% count(cut) %&gt;% </span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">ggplot(data5,aes(x=factor(1),y=percent,fill=cut))+geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,width=3)+mycolour_7+</span><br><span class="line">        coord_polar(<span class="string">"y"</span>)+pie_theme+mytitle</span><br></pre></td></tr></table></figure></p>
<p>6、折线图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/88.jpeg" alt=""><br>要点是，先做成如A-B-变量这样的二联表，然后，x轴为A，group为b,colour为b<br>下面代码展示了这个处理<br>如果去掉group的话，折线图会不知道怎么去处理数字。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data6&lt;-diamonds %&gt;% count(color,cut) %&gt;% filter(color %<span class="keyword">in</span>% c(<span class="string">"D"</span>,<span class="string">"E"</span>,<span class="string">"F"</span>))%&gt;%</span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">ggplot(data6,aes(x=cut,y=n,group=color,colour=color))+geom_line(size=1.5)+mypoint+</span><br><span class="line">        mycolour_line_7+mytheme+mytitle</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ggplot2本身自带了很漂亮的主题格式，如theme_gray和theme_bw。但是在工作用图上，很多时候对图表格式配色字体等均有明文的规定。ggplot2允许我们事先定制好图表样式，我们可以生成如mytheme或者myline这样的有明确配色主题的对象，到时候就可以定
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="mytheme" scheme="http://tiramisutes.github.io/tags/mytheme/"/>
    
  </entry>
  
  <entry>
    <title>14 个 grep 命令的例子</title>
    <link href="http://tiramisutes.github.io/2015/07/29/grep.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/grep.html</id>
    <published>2015-07-29T14:49:56.000Z</published>
    <updated>2019-07-10T12:34:27.512Z</updated>
    
    <content type="html"><![CDATA[<p>概述：所有的类linux系统都会提供一个名为grep(global regular expression print，全局正则表达式输出)的搜索工具。grep命令在对一个或多个文件的内容进行基于模式的搜索的情况下是非常有用的。模式可以是单个字符、多个字符、单个单词、或者是一个句子。<br>当命令匹配到执行命令时指定的模式时，grep会将包含模式的一行输出，但是并不对原文件内容进行修改。</p>
<p>在本文中，我们将会讨论到14个grep命令的例子。</p>
<h3 id="例1_在文件中查找模式（单词）在/etc/passwd文件中查找单词”linuxtechi”">例1 在文件中查找模式（单词）在/etc/passwd文件中查找单词”linuxtechi”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@Linux-world:~<span class="comment"># grep linuxtechi /etc/passwd</span></span><br><span class="line">linuxtechi:x:1000:1000:linuxtechi,,,:/home/linuxtechi:/bin/bash</span><br><span class="line">root@Linux-world:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h3 id="例2_在多个文件中查找模式。">例2 在多个文件中查找模式。</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep linuxtechi <span class="regexp">/etc/</span>passwd <span class="regexp">/etc/</span>shadow <span class="regexp">/etc/</span>gshadow
<span class="number">2.</span> <span class="regexp">/etc/</span><span class="string">passwd:</span><span class="string">linuxtechi:</span><span class="string">x:</span><span class="number">1000</span>:<span class="number">1000</span>:linuxtechi,,,:<span class="regexp">/home/</span><span class="string">linuxtechi:</span><span class="regexp">/bin/</span>bash
<span class="number">3.</span> <span class="regexp">/etc/</span><span class="string">shadow:</span><span class="string">linuxtechi:</span><span class="string">$6$DdgXjxlM$4flz4JRvefvKp0DG6re:</span><span class="number">16550</span>:<span class="number">0</span>:<span class="number">99999</span>:<span class="number">7</span>:::<span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">adm:</span>*::syslog,linuxtechi
<span class="number">4.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">cdrom:</span>*::linuxtechi
<span class="number">5.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">sudo:</span>*::linuxtechi
<span class="number">6.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">dip:</span>*::linuxtechi
<span class="number">7.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">plugdev:</span>*::linuxtechi
<span class="number">8.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">lpadmin:</span>!::linuxtechi
<span class="number">9.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">linuxtechi:</span>!::
<span class="number">10.</span> <span class="regexp">/etc/</span><span class="string">gshadow:</span><span class="string">sambashare:</span>!::linuxtechi
<span class="number">11.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~#
</code></pre><h3 id="例3_使用-l参数列出包含指定模式的文件的文件名。">例3 使用-l参数列出包含指定模式的文件的文件名。</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -l linuxtechi <span class="regexp">/etc/</span>passwd <span class="regexp">/etc/</span>shadow <span class="regexp">/etc/</span>fstab <span class="regexp">/etc/</span>mtab
<span class="number">2.</span> <span class="regexp">/etc/</span>passwd
<span class="number">3.</span> <span class="regexp">/etc/</span>shadow
<span class="number">4.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~#
</code></pre><h3 id="例4_使用-n参数，在文件中查找指定模式并显示匹配行的行号">例4 使用-n参数，在文件中查找指定模式并显示匹配行的行号</h3><pre><code><span class="number">1</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep -n linuxtechi /etc/passwd</span>
<span class="number">2</span>. <span class="number">39</span><span class="symbol">:linuxtechi</span><span class="symbol">:x</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:linuxtechi</span>,,,<span class="symbol">:/home/linuxtechi</span><span class="symbol">:/bin/bash</span>
<span class="number">3</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment">#</span>
<span class="number">4</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep -n root /etc/passwd /etc/shadow</span>
</code></pre><h3 id="例5_使用-v参数输出不包含指定模式的行输出/etc/passwd文件中所有不含单词”linuxtechi”的行">例5 使用-v参数输出不包含指定模式的行输出/etc/passwd文件中所有不含单词”linuxtechi”的行</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -v linuxtechi <span class="regexp">/etc/</span>passwd
</code></pre><h3 id="例6_使用_^_符号输出所有以某指定模式开头的行Bash脚本将_^_符号视作特殊字符，用于指定一行或者一个单词的开始。例如输出/etc/passes文件中所有以”root”开头的行">例6 使用 ^ 符号输出所有以某指定模式开头的行Bash脚本将 ^ 符号视作特殊字符，用于指定一行或者一个单词的开始。例如输出/etc/passes文件中所有以”root”开头的行</h3><pre><code><span class="number">1</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep ^root /etc/passwd</span>
<span class="number">2</span>. <span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span>
<span class="number">3</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment">#</span>
</code></pre><h3 id="例7_使用_$_符号输出所有以指定模式结尾的行。输出/etc/passwd文件中所有以”bash”结尾的行。">例7 使用 $ 符号输出所有以指定模式结尾的行。输出/etc/passwd文件中所有以”bash”结尾的行。</h3><pre><code><span class="number">1</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep bash$ /etc/passwd</span>
<span class="number">2</span>. <span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span>
<span class="number">3</span>. <span class="symbol">linuxtechi:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:linuxtechi</span>,,,<span class="symbol">:/home/linuxtechi</span><span class="symbol">:/bin/bash</span>
<span class="number">4</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment">#</span>
</code></pre><p>Bash脚本将美元($)符号视作特殊字符，用于指定一行或者一个单词的结尾。</p>
<h3 id="例8_使用_-r_参数递归地查找特定模式">例8 使用 -r 参数递归地查找特定模式</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -r linuxtechi <span class="regexp">/etc/</span>
<span class="number">2.</span> <span class="regexp">/etc/</span><span class="string">subuid:</span><span class="string">linuxtechi:</span><span class="number">100000</span>:<span class="number">65536</span>
<span class="number">3.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">adm:</span><span class="string">x:</span><span class="number">4</span>:syslog,linuxtechi
<span class="number">4.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">cdrom:</span><span class="string">x:</span><span class="number">24</span>:linuxtechi
<span class="number">5.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">sudo:</span><span class="string">x:</span><span class="number">27</span>:linuxtechi
<span class="number">6.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">dip:</span><span class="string">x:</span><span class="number">30</span>:linuxtechi
<span class="number">7.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">plugdev:</span><span class="string">x:</span><span class="number">46</span>:linuxtechi
<span class="number">8.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">lpadmin:</span><span class="string">x:</span><span class="number">115</span>:linuxtechi
<span class="number">9.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">linuxtechi:</span><span class="string">x:</span><span class="number">1000</span>:
<span class="number">10.</span> <span class="regexp">/etc/</span><span class="string">group:</span><span class="string">sambashare:</span><span class="string">x:</span><span class="number">131</span>:linuxtechi
<span class="number">11.</span> <span class="regexp">/etc/</span>passwd-:<span class="string">linuxtechi:</span><span class="string">x:</span><span class="number">1000</span>:<span class="number">1000</span>:linuxtechi,,,:<span class="regexp">/home/</span><span class="string">linuxtechi:</span><span class="regexp">/bin/</span>bash
<span class="number">12.</span> <span class="regexp">/etc/</span><span class="string">passwd:</span><span class="string">linuxtechi:</span><span class="string">x:</span><span class="number">1000</span>:<span class="number">1000</span>:linuxtechi,,,:<span class="regexp">/home/</span><span class="string">linuxtechi:</span><span class="regexp">/bin/</span>bash
<span class="number">13.</span> ............................................................................
</code></pre><p>上面的命令将会递归的在/etc目录中查找”linuxtechi”单词</p>
<h3 id="例9_使用_grep_查找文件中所有的空行">例9 使用 grep 查找文件中所有的空行</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep ^$ <span class="regexp">/etc/</span>shadow
<span class="number">2.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~#
</code></pre><p>由于/etc/shadow文件中没有空行，所以没有任何输出</p>
<h3 id="例10_使用_-i_参数查找模式grep命令的-i参数在查找时忽略字符的大小写。">例10 使用 -i 参数查找模式grep命令的-i参数在查找时忽略字符的大小写。</h3><p>我们来看一个例子，在paswd文件中查找”LinuxTechi”单词。</p>
<pre><code><span class="number">1</span>. nextstep4it<span class="variable">@localhost</span><span class="symbol">:~</span><span class="variable">$ </span>grep -i <span class="constant">LinuxTechi </span>/etc/passwd
<span class="number">2</span>. <span class="symbol">linuxtechi:</span><span class="symbol">x:</span><span class="number">1001</span><span class="symbol">:</span><span class="number">1001</span><span class="symbol">:</span><span class="symbol">:/home/linuxtechi</span><span class="symbol">:/bin/bash</span>
<span class="number">3</span>. nextstep4it<span class="variable">@localhost</span><span class="symbol">:~</span>$
</code></pre><h3 id="例11_使用_-e_参数查找多个模式例如，我想在一条grep命令中查找’linuxtechi’和’root’单词，使用-e参数，我们可以查找多个模式。">例11 使用 -e 参数查找多个模式例如，我想在一条grep命令中查找’linuxtechi’和’root’单词，使用-e参数，我们可以查找多个模式。</h3><pre><code><span class="number">1</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep -e "linuxtechi" -e "root" /etc/passwd</span>
<span class="number">2</span>. <span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span>
<span class="number">3</span>. <span class="symbol">linuxtechi:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:linuxtechi</span>,,,<span class="symbol">:/home/linuxtechi</span><span class="symbol">:/bin/bash</span>
<span class="comment">#或者</span>
<span class="number">4</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># grep -E "(Olfr1413|Olfr1411)" Mus_musculus.GRCm38.75_chr1_genes.txt</span>
<span class="constant">ENSMUSG00000058904 </span>     <span class="constant">Olfr1413</span>
<span class="constant">ENSMUSG00000062497 </span>     <span class="constant">Olfr1411</span>
<span class="comment">#或者</span>
grep <span class="string">'usrquota\|grpquota'</span> /etc/fstab
</code></pre><h3 id="例12_使用_-f_用文件指定待查找的模式首先，在当前目录中创建一个搜索模式文件”grep_pattern”，我想文件中输入的如下内容。">例12 使用 -f 用文件指定待查找的模式首先，在当前目录中创建一个搜索模式文件”grep_pattern”，我想文件中输入的如下内容。</h3><pre><code><span class="number">1</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment"># cat grep_pattern</span>
<span class="number">2</span>. ^linuxtechi
<span class="number">3</span>. root
<span class="number">4</span>. <span class="keyword">false</span><span class="variable">$
</span><span class="number">5</span>. root<span class="variable">@Linux</span>-<span class="symbol">world:</span>~<span class="comment">#</span>
</code></pre><p>现在，试试使用grep_pattern文件进行搜索</p>
<pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -f grep_pattern <span class="regexp">/etc/</span>passwd
</code></pre><h3 id="例13_使用_-c_参数计算模式匹配到的数量继续上面例子，我们在grep命令中使用-c命令计算匹配指定模式的数量">例13 使用 -c 参数计算模式匹配到的数量继续上面例子，我们在grep命令中使用-c命令计算匹配指定模式的数量</h3><pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -c -f grep_pattern <span class="regexp">/etc/</span>passwd
<span class="number">2.</span> <span class="number">22</span>
<span class="number">3.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~#
</code></pre><h3 id="例14_输出匹配指定模式行的前或者后面N行">例14 输出匹配指定模式行的前或者后面N行</h3><p>a)使用-B参数输出匹配行的前4行</p>
<pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -B <span class="number">4</span> <span class="string">"games"</span> <span class="regexp">/etc/</span>passwd
</code></pre><p>b)使用-A参数输出匹配行的后4行</p>
<pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -A <span class="number">4</span> <span class="string">"games"</span> <span class="regexp">/etc/</span>passwd
</code></pre><p>c)使用-C参数输出匹配行的前后各4行</p>
<pre><code><span class="number">1.</span> root<span class="annotation">@Linux</span>-<span class="string">world:</span>~# grep -C <span class="number">4</span> <span class="string">"games"</span> <span class="regexp">/etc/</span>passwd
</code></pre><h3 id="例15_-E参数用扩展的正则表达式">例15 -E参数用扩展的正则表达式</h3><p>列出当前目录下包含 s..s 的文件名，<code>\1</code>为反向引用()中内容，如下例子中等同于s。</p>
<pre><code><span class="keyword">ls</span> | <span class="keyword">grep</span> -E <span class="string">'(s).+\1'</span>
</code></pre><h3 id="例16_组分隔符">例16 组分隔符</h3><p>‘—group-separator=STRING’<br>当使用’-A’, ‘-B’ or ‘-C’时，使用STRING替代默认的组分隔符。</p>
<p>(注：组分隔符表示匹配到的内容的上下文。例如”-A 2”，在某行匹配到时，还将输出后两行，这是一个组。下一次匹配成功时，如果是在该组之后行匹配上的，则这两组中间默认使用”—“分隔)</p>
<p>‘—no-group-separator’<br>当使用’-A’, ‘-B’ or ‘-C’时，不输出任何组分隔符，而是将不同组相邻输出。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;概述：所有的类linux系统都会提供一个名为grep(global regular expression print，全局正则表达式输出)的搜索工具。grep命令在对一个或多个文件的内容进行基于模式的搜索的情况下是非常有用的。模式可以是单个字符、多个字符、单个单词、或者是一
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="grep" scheme="http://tiramisutes.github.io/tags/grep/"/>
    
  </entry>
  
  <entry>
    <title>用于比较两个文件不同的行差集</title>
    <link href="http://tiramisutes.github.io/2015/07/29/perl-diff.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/perl-diff.html</id>
    <published>2015-07-29T14:39:49.000Z</published>
    <updated>2015-07-29T14:41:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>这个脚本用于求两个文件不同的行所构成的差集，即A中存在而B中不存在的行，及B中存在而A中不存在的行.<br>代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl -w</span></span><br><span class="line">use strict;</span><br><span class="line"></span><br><span class="line">my (<span class="variable">$fileA</span>,<span class="variable">$fileB</span>) = @ARGV;</span><br><span class="line"></span><br><span class="line">open A,<span class="string">'&lt;'</span>,<span class="variable">$fileA</span> or die <span class="string">"Unable to open file:<span class="variable">$fileA</span>:$!"</span>;</span><br><span class="line">my %ta;</span><br><span class="line">my <span class="variable">$i</span>; </span><br><span class="line"><span class="keyword">while</span>(&lt;A&gt;)&#123;</span><br><span class="line">  chomp;</span><br><span class="line">  <span class="variable">$ta</span>&#123;<span class="variable">$_</span>&#125; = ++<span class="variable">$i</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close A;</span><br><span class="line"></span><br><span class="line">open B,<span class="string">'&lt;'</span>,<span class="variable">$fileB</span> or die <span class="string">"Unable to open file:<span class="variable">$fileB</span>:$!"</span>;</span><br><span class="line">my @B; </span><br><span class="line"><span class="keyword">while</span>(&lt;B&gt;)&#123;</span><br><span class="line">    chomp;</span><br><span class="line">    unless (defined <span class="variable">$ta</span>&#123;<span class="variable">$_</span>&#125;)&#123;</span><br><span class="line">        push @B,<span class="variable">$_</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$ta</span>&#123;<span class="variable">$_</span>&#125; = 0;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line">close B;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Output diff to different files respectively</span></span><br><span class="line"></span><br><span class="line">open DIFF_A, <span class="string">"&gt;<span class="variable">$fileA</span>.diff"</span> or die <span class="string">"Unable to create diff file for <span class="variable">$fileA</span>:$!"</span>;</span><br><span class="line">my <span class="variable">$countA</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">"Remain in files <span class="variable">$fileA</span>\n"</span>;</span><br><span class="line">my %tt = reverse %ta;</span><br><span class="line"></span><br><span class="line">foreach (keys %tt) &#123;</span><br><span class="line">    <span class="variable">$countA</span> += <span class="variable">$_</span>&gt;0? <span class="built_in">print</span> DIFF_A <span class="variable">$tt</span>&#123;<span class="variable">$_</span>&#125;.<span class="string">"\n"</span>:0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">"<span class="variable">$countA</span> lines\n"</span>;</span><br><span class="line"></span><br><span class="line">close DIFF_A;</span><br><span class="line"></span><br><span class="line">open DIFF_B, <span class="string">"&gt;<span class="variable">$fileB</span>.diff"</span> or die <span class="string">"Unable to create diff file for <span class="variable">$fileB</span>:$!"</span>;</span><br><span class="line">my <span class="variable">$countB</span> = scalar @B; </span><br><span class="line"><span class="built_in">print</span> DIFF_B <span class="variable">$_</span>.<span class="string">"\n"</span> foreach @B; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$countA</span> == 0 and <span class="variable">$countB</span> ==0 )&#123;</span><br><span class="line">    <span class="built_in">print</span> STDOUT <span class="string">"The two files are identical\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close DIFF_B;</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这个脚本用于求两个文件不同的行所构成的差集，即A中存在而B中不存在的行，及B中存在而A中不存在的行.&lt;br&gt;代码：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span clas
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="perl_diff" scheme="http://tiramisutes.github.io/tags/perl-diff/"/>
    
  </entry>
  
  <entry>
    <title>如何向google提交sitemap</title>
    <link href="http://tiramisutes.github.io/2015/07/29/sitemap.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/sitemap.html</id>
    <published>2015-07-29T14:23:44.000Z</published>
    <updated>2018-09-28T02:44:30.451Z</updated>
    
    <content type="html"><![CDATA[<p>Sitemap 可方便管理员通知搜索引擎他们网站上有哪些可供抓取的网页。向google提交自己hexo博客的sitemap有助于让别人更好地通过google搜索到自己的博客。<br>下面来说一下具体步骤:</p>
<h2 id="第一步_生成自己的sitemap文件：xml-sitemaps-">第一步 生成自己的sitemap文件：<span class="exturl" data-url="aHR0cHM6Ly93d3cueG1sLXNpdGVtYXBzLmNvbS8=" title="https://www.xml-sitemaps.com/">xml-sitemaps.<i class="fa fa-external-link"></i></span></h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sitemap.png" alt=""><br>生成后点击红框那下载自己的sitemaps.xml文件<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/sitemap2.png" alt=""></p>
<h2 id="第二步_向google提交你的网页">第二步 向google提交你的网页</h2><p>用自己的google帐号登陆Webmaster Central的网页<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.google.com/webmasters/verification/home?hl=en</span><br></pre></td></tr></table></figure></p>
<p>点击ADD A SITE<br>输入网页url点击continue<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/1.png" alt=""></p>
<h2 id="第三步_google验证网页所有权">第三步 google验证网页所有权</h2><p>进入验证所有权的页面<br>可以选择上传一个html文件到你的网页的方式来验证<br>如下图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/2.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/3.png" alt=""><br>也可以选择其他方法也就是html tag<br>如下图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6.png" alt=""><br>大致的意思就是在主页的head里面加一条meta标签<br>在自己的主页加了google指定的meta标签以后<br>回来此页点击verify按钮即完成验证<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/4.png" alt=""></p>
<h2 id="第四步_google网站站长上传sitemap">第四步 google网站站长上传sitemap</h2><p>点击以下链接<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.google.com/webmasters/tools</span><br></pre></td></tr></table></figure></p>
<p>由于之前在第2步已经向google提交了你的网页<br>所以这里能看到自己网页的缩略图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/5.png" alt=""><br>这里直接点击红色框的部分<br>就会进入site dashboard<br>点击sitemap这一项<br>进入后点击ADD/TEST SITEMAP这个按钮<br>然后输入你的sitemap.xml的link<br>按submit sitemap按钮即可<br>下面就会告诉你有多少个url被indexed</p>
<h2 id="第五步_测试sitemaps">第五步 测试sitemaps</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS93ZWJtYXN0ZXJzL3Rvb2xzL3NpdGVtYXAtZGV0YWlscz9obD1lbiZzaXRlVXJsPWh0dHAlM0ElMkYlMkZ0aXJhbWlzdXRlcy5naXRodWIuaW8lMkYmc2l0ZW1hcFVybD1odHRwJTNBJTJGJTJGdGlyYW1pc3V0ZXMuZ2l0aHViLmlvJTJGc2l0ZW1hcC54bWwmZ3d0UGw9TDNkbFltMWhjM1JsY25NdmRHOXZiSE12YzJsMFpXMWhjQzFzYVhOMFAyaHNQV1Z1Sm5OcGRHVlZjbXc5YUhSMGNEb3ZMM1JwY21GdGFYTjFkR1Z6TG1kcGRHaDFZaTVwYnk4alRVRkpUbDlVUVVJOU1DWkRRVkpFWDFSQlFqMHRNUSUzRCUzRCNDQVJEX1RBQj0tMQ==" title="https://www.google.com/webmasters/tools/sitemap-details?hl=en&siteUrl=http%3A%2F%2Ftiramisutes.github.io%2F&sitemapUrl=http%3A%2F%2Ftiramisutes.github.io%2Fsitemap.xml&gwtPl=L3dlYm1hc3RlcnMvdG9vbHMvc2l0ZW1hcC1saXN0P2hsPWVuJnNpdGVVcmw9aHR0cDovL3RpcmFtaXN1dGVzLmdpdGh1Yi5pby8jTUFJTl9UQUI9MCZDQVJEX1RBQj0tMQ%3D%3D#CARD_TAB=-1">点击 Test Sitemap 进行测试<i class="fa fa-external-link"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/test-sitemaps.png" alt=""><br>测试成功结果如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/test-sitemap2.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sitemap 可方便管理员通知搜索引擎他们网站上有哪些可供抓取的网页。向google提交自己hexo博客的sitemap有助于让别人更好地通过google搜索到自己的博客。&lt;br&gt;下面来说一下具体步骤:&lt;/p&gt;
&lt;h2 id=&quot;第一步_生成自己的sitemap文件：xml
    
    </summary>
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/categories/Hexo/"/>
    
    
      <category term="sitemap" scheme="http://tiramisutes.github.io/tags/sitemap/"/>
    
  </entry>
  
  <entry>
    <title>PCA分析</title>
    <link href="http://tiramisutes.github.io/2015/07/29/PCA.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/PCA.html</id>
    <published>2015-07-29T13:54:45.000Z</published>
    <updated>2018-09-28T02:39:54.295Z</updated>
    
    <content type="html"><![CDATA[<p>主成分分析（PCA）是一种数据降维技巧，它能将大量相关变量转化为一组很少的不相关变量，这些无关变量称为主成分，它们是观测变量的线性组合。如第一主成分为：<br>PC1=a1X1=a2X 2+…+akXk<br>它是k个观测变量的加权组合，对初始变量集的方差解释性最大。第二主成分也是初始变量的线性组合，对方差的解释性排第二，同时与第一主成分正交（不相关）。后面每一个主成分都最大化它对方差的解释程度，同时与之前所有的主成分都正交。<br>PCA分析模型如下图：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PCA.png" alt=""><br>例如如下数据的PCA分析：<br>学生身体4 项指标的主成份分析<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">学生序号	x1身高	x2体重	x3胸围	x4坐高</span><br><span class="line">1	148	41	72	78</span><br><span class="line">2	139	34	71	76</span><br><span class="line">3	160	49	77	86</span><br><span class="line">4	149	36	67	79</span><br><span class="line">5	159	45	80	86</span><br><span class="line">6	142	31	66	76</span><br><span class="line">7	153	43	76	83</span><br><span class="line">8	150	43	77	79</span><br><span class="line">9	151	42	77	80</span><br><span class="line">10	139	31	68	74</span><br><span class="line">11	140	29	64	74</span><br><span class="line">12	161	47	78	84</span><br><span class="line">13	158	49	78	83</span><br><span class="line">14	140	33	67	77</span><br><span class="line">15	137	31	66	73</span><br><span class="line">16	152	35	73	79</span><br><span class="line">17	149	47	82	79</span><br><span class="line">18	145	35	70	77</span><br><span class="line">19	160	47	74	87</span><br><span class="line">20	156	44	78	85</span><br><span class="line">21	151	42	73	82</span><br><span class="line">22	147	38	73	78</span><br><span class="line">23	157	39	68	80</span><br><span class="line">24	147	30	65	75</span><br><span class="line">25	157	48	80	88</span><br><span class="line">26	151	36	74	80</span><br><span class="line">27	144	36	68	76</span><br><span class="line">28	141	30	67	76</span><br><span class="line">29	139	32	68	73</span><br><span class="line">30	148	38	70	78</span><br></pre></td></tr></table></figure></p>
<p>数据读入R软件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; d=read.table(<span class="string">"clipboard"</span>,header=T)</span><br><span class="line">&gt; d</span><br><span class="line">x1身高 x2体重 x3胸围 x4坐高</span><br><span class="line">1 148 41 72 78</span><br><span class="line">2 139 34 71 76</span><br><span class="line">3 160 49 77 86</span><br><span class="line">4 149 36 67 79</span><br><span class="line">5 159 45 80 86</span><br><span class="line">6 142 31 66 76</span><br><span class="line">7 153 43 76 83</span><br><span class="line">8 150 43 77 79</span><br><span class="line">9 151 42 77 80</span><br><span class="line">10 139 31 68 74</span><br><span class="line">11 140 29 64 74</span><br><span class="line">12 161 47 78 84</span><br><span class="line">13 158 49 78 83</span><br><span class="line">14 140 33 67 77</span><br><span class="line">15 137 31 66 73</span><br><span class="line">16 152 35 73 79</span><br><span class="line">17 149 47 82 79</span><br><span class="line">18 145 35 70 77</span><br><span class="line">19 160 47 74 87</span><br><span class="line">20 156 44 78 85</span><br><span class="line">21 151 42 73 82</span><br><span class="line">22 147 38 73 78</span><br><span class="line">23 157 39 68 80</span><br><span class="line">24 147 30 65 75</span><br><span class="line">25 157 48 80 88</span><br><span class="line">26 151 36 74 80</span><br><span class="line">27 144 36 68 76</span><br><span class="line">28 141 30 67 76</span><br><span class="line">29 139 32 68 73</span><br><span class="line">30 148 38 70 78</span><br></pre></td></tr></table></figure>
<p>原始数据标准化<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; sd=scale(d)</span><br></pre></td></tr></table></figure></p>
<p>标准化数据展示<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&gt; sd</span><br><span class="line">x1身高 x2体重 x3胸围 x4坐高</span><br><span class="line">[1,] -0.1366952 0.35602486 -0.04530114 -0.31999814</span><br><span class="line">[2,] -1.3669516 -0.72752905 -0.23944887 -0.78828809</span><br><span class="line">[3,] 1.5036468 1.59437218 0.92543751 1.55316168</span><br><span class="line">[4,] 0.0000000 -0.41794222 -1.01603978 -0.08585316</span><br><span class="line">[5,] 1.3669516 0.97519852 1.50788070 1.55316168</span><br><span class="line">[6,] -0.9568661 -1.19190930 -1.21018751 -0.78828809</span><br><span class="line">[7,] 0.5467806 0.66561169 0.73128978 0.85072675</span><br><span class="line">[8,] 0.1366952 0.66561169 0.92543751 -0.08585316</span><br><span class="line">[9,] 0.2733903 0.51081827 0.92543751 0.14829182</span><br><span class="line">[10,] -1.3669516 -1.19190930 -0.82189205 -1.25657805</span><br><span class="line">[11,] -1.2302564 -1.50149613 -1.59848297 -1.25657805</span><br><span class="line">[12,] 1.6403419 1.28478535 1.11958524 1.08487173</span><br><span class="line">[13,] 1.2302564 1.59437218 1.11958524 0.85072675</span><br><span class="line">[14,] -1.2302564 -0.88232247 -1.01603978 -0.55414311</span><br><span class="line">[15,] -1.6403419 -1.19190930 -1.21018751 -1.49072302</span><br><span class="line">[16,] 0.4100855 -0.57273564 0.14884659 -0.08585316</span><br><span class="line">[17,] 0.0000000 1.28478535 1.89617616 -0.08585316</span><br><span class="line">[18,] -0.5467806 -0.57273564 -0.43359660 -0.55414311</span><br><span class="line">[19,] 1.5036468 1.28478535 0.34299432 1.78730666</span><br><span class="line">[20,] 0.9568661 0.82040510 1.11958524 1.31901671</span><br><span class="line">[21,] 0.2733903 0.51081827 0.14884659 0.61658177</span><br><span class="line">[22,] -0.2733903 -0.10835539 0.14884659 -0.31999814</span><br><span class="line">[23,] 1.0935613 0.04643802 -0.82189205 0.14829182</span><br><span class="line">[24,] -0.2733903 -1.34670271 -1.40433524 -1.02243307</span><br><span class="line">[25,] 1.0935613 1.43957876 1.50788070 2.02145164</span><br><span class="line">[26,] 0.2733903 -0.41794222 0.34299432 0.14829182</span><br><span class="line">[27,] -0.6834758 -0.41794222 -0.82189205 -0.78828809</span><br><span class="line">[28,] -1.0935613 -1.34670271 -1.01603978 -0.78828809</span><br><span class="line">[29,] -1.3669516 -1.03711588 -0.82189205 -1.49072302</span><br><span class="line">[30,] -0.1366952 -0.10835539 -0.43359660 -0.31999814</span><br><span class="line">attr(,<span class="string">"scaled:center"</span>)</span><br><span class="line">x1身高 x2体重 x3胸围 x4坐高 </span><br><span class="line">149.00000 38.70000 72.23333 79.36667 </span><br><span class="line">attr(,<span class="string">"scaled:scale"</span>)</span><br><span class="line">x1身高 x2体重 x3胸围 x4坐高 </span><br><span class="line">7.315548 6.460223 5.150717 4.270858</span><br></pre></td></tr></table></figure></p>
<p>读取标准化数据<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; d=read.table(<span class="string">"clipboard"</span>,header=T)</span><br></pre></td></tr></table></figure></p>
<p>主成分分析<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; pca=princomp(d,cor=T)</span><br></pre></td></tr></table></figure></p>
<p>碎石图<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; screeplot(pca,<span class="built_in">type</span>=<span class="string">"line"</span>,main=<span class="string">"碎石图"</span>,lwd=2)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/PCAs.png" alt=""><br>主成分1贡献率较高</p>
<p>求相关矩阵<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; dcor=cor(d)</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; dcor</span><br><span class="line">               x1身高       x2体重       x3胸围       x4坐高</span><br><span class="line">x1身高 1.0000000 0.8631621 0.7321119 0.9204624</span><br><span class="line">x2体重 0.8631621 1.0000000 0.8965058 0.8827313</span><br><span class="line">x3胸围 0.7321119 0.8965058 1.0000000 0.7828827</span><br><span class="line">x4坐高 0.9204624 0.8827313 0.7828827 1.0000000</span><br></pre></td></tr></table></figure></p>
<p>求相关矩阵的特征向量 特征值<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; deig=eigen(dcor)</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;deig</span><br><span class="line"><span class="variable">$values</span></span><br><span class="line">[1] 3.54109800 0.31338316 0.07940895 0.06610989</span><br><span class="line"><span class="variable">$vectors</span></span><br><span class="line">[,1] [,2] [,3] [,4]</span><br><span class="line">[1,] -0.4969661 0.5432128 -0.4496271 0.5057471</span><br><span class="line">[2,] -0.5145705 -0.2102455 -0.4623300 -0.6908436</span><br><span class="line">[3,] -0.4809007 -0.7246214 0.1751765 0.4614884</span><br><span class="line">[4,] -0.5069285 0.3682941 0.7439083 -0.2323433</span><br></pre></td></tr></table></figure></p>
<p>输出特征值<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; deig<span class="variable">$values</span></span><br><span class="line">[1] 3.54109800 0.31338316 0.07940895 0.06610989</span><br><span class="line">&gt; sumeigv=sum(deig<span class="variable">$values</span>)</span><br><span class="line">&gt; sumeigv</span><br><span class="line">[1] 4</span><br></pre></td></tr></table></figure></p>
<p>求前2个主成分的累积方差贡献率<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; sum(deig<span class="variable">$value</span>[1:2])/4</span><br><span class="line">[1] 0.9636203</span><br><span class="line">&gt; sum(deig<span class="variable">$value</span>[1:1])/4</span><br><span class="line">[1] 0.8852745</span><br></pre></td></tr></table></figure></p>
<p>第一主成份有88.53%的方差贡献率,前两个主成份累计贡献率更高达96.36%,故只需前两个主成份就能很好地概括这组数据.</p>
<p>输出前两个主成分的载荷系数（特征向量）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; pca<span class="variable">$loadings</span>[,1:2]</span><br><span class="line">              Comp.1     Comp.2</span><br><span class="line">x1身高 -0.4969661 0.5432128</span><br><span class="line">x2体重 -0.5145705 -0.2102455</span><br><span class="line">x3胸围 -0.4809007 -0.7246214</span><br><span class="line">x4坐高 -0.5069285 0.3682941</span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line"></span><br><span class="line">z1=-0.4969661 x1+-0.5145705 x2 +-0.4809007x3+-0.5069285x4</span><br><span class="line"></span><br><span class="line">z2=0.5432128 x1+-0.2102455 x2 +-0.7246214x3+0.3682941x4</span><br><span class="line"></span><br><span class="line">z= 3.54109800/4 z1 + 0.31338316/4 z2=0.8852745 z1 +0.07834579 Z2</span><br><span class="line"></span><br><span class="line">=0.8852745(-0.4969661 x1+-0.5145705 x2 +-0.4809007x3+-0.5069285x4)</span><br><span class="line"></span><br><span class="line">+0.07834579 (0.5432128 x1+-0.2102455 x2 +-0.7246214x3+0.3682941x4)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>计算主成分C1和C2的系数b1 和b2：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; deig<span class="variable">$values</span>[1]/4;deig<span class="variable">$values</span>[2]/4</span><br><span class="line">[1] 0.8852745</span><br><span class="line">[1] 0.07834579</span><br></pre></td></tr></table></figure></p>
<p>综合得分函数C 为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C=(b1*C1+b2*C2)/(b1+b2)=0.9187*C1+0.0813*C2</span><br></pre></td></tr></table></figure></p>
<p>输出前2 个主成分的得分<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; s=pca<span class="variable">$scores</span>[,1:2]</span><br></pre></td></tr></table></figure></p>
<p>计算综合得分<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; c=s[1:30,1]*0.918696+s[1:30,2]*0.0813</span><br><span class="line"></span><br><span class="line">&gt; s[1:30,1]</span><br><span class="line">[1] 0.06990950 1.59526340 -2.84793151 0.75996988 -2.73966777 2.10583168</span><br><span class="line">[7] -1.42105591 -0.82583977 -0.93464402 2.36463820 2.83741916 -2.60851224</span><br><span class="line">[13] -2.44253342 1.86630669 2.81347421 0.06392983 -1.55561022 1.07392251</span><br><span class="line">[19] -2.52174212 -2.14072377 -0.79624422 0.28708321 -0.25151075 2.05706032</span><br><span class="line">[25] -3.08596855 -0.16367555 1.37265053 2.16097778 2.40434827 0.50287468</span><br></pre></td></tr></table></figure></p>
<p>输出综合得分信息<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; cbind(s,c)</span><br><span class="line">          Comp.1       Comp.2           c</span><br><span class="line">[1,] 0.06990950 -0.23813701 0.04486504</span><br><span class="line">[2,] 1.59526340 -0.71847399 1.40715017</span><br><span class="line">[3,] -2.84793151 0.38956679 -2.58471151</span><br><span class="line">[4,] 0.75996988 0.80604335 0.76371262</span><br><span class="line">[5,] -2.73966777 0.01718087 -2.51552502</span><br><span class="line">[6,] 2.10583168 0.32284393 1.96086635</span><br><span class="line">[7,] -1.42105591 -0.06053165 -1.31043961</span><br><span class="line">[8,] -0.82583977 -0.78102576 -0.82219309</span><br><span class="line">[9,] -0.93464402 -0.58469242 -0.90618922</span><br><span class="line">[10,] 2.36463820 -0.36532199 2.14268298</span><br><span class="line">[11,] 2.83741916 0.34875841 2.63507969</span><br><span class="line">[12,] -2.60851224 0.21278728 -2.37913015</span><br><span class="line">[13,] -2.44253342 -0.16769496 -2.25757928</span><br><span class="line">[14,] 1.86630669 0.05021384 1.71865087</span><br><span class="line">[15,] 2.81347421 -0.31790107 2.55888214</span><br><span class="line">[16,] 0.06392983 0.20718448 0.07557617</span><br><span class="line">[17,] -1.55561022 -1.70439674 -1.56770034</span><br><span class="line">[18,] 1.07392251 -0.06763418 0.98110965</span><br><span class="line">[19,] -2.52174212 0.97274301 -2.23763039</span><br><span class="line">[20,] -2.14072377 0.02217881 -1.96487123</span><br><span class="line">[21,] -0.79624422 0.16307887 -0.71824807</span><br><span class="line">[22,] 0.28708321 -0.35744666 0.23468178</span><br><span class="line">[23,] -0.25151075 1.25555188 -0.12898555</span><br><span class="line">[24,] 2.05706032 0.78894494 1.95395431</span><br><span class="line">[25,] -3.08596855 -0.05775318 -2.83976229</span><br><span class="line">[26,] -0.16367555 0.04317932 -0.14685759</span><br><span class="line">[27,] 1.37265053 0.02220972 1.26285420</span><br><span class="line">[28,] 2.16097778 0.13733233 1.99644676</span><br><span class="line">[29,] 2.40434827 -0.48613137 2.16934265</span><br><span class="line">[30,] 0.50287468 0.14734317 0.47396795</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p> 排序<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[11,]	2.83741916	0.34875841	2.63507969</span><br><span class="line">[15,]	2.81347421	-0.31790107	2.55888214</span><br><span class="line">[29,]	2.40434827	-0.48613137	2.16934265</span><br><span class="line">[10,]	2.3646382	-0.36532199	2.14268298</span><br><span class="line">[28,]	2.16097778	0.13733233	1.99644676</span><br><span class="line">[6,]	2.10583168	0.32284393	1.96086635</span><br><span class="line">[24,]	2.05706032	0.78894494	1.95395431</span><br><span class="line">[14,]	1.86630669	0.05021384	1.71865087</span><br><span class="line">[2,]	1.5952634	-0.71847399	1.40715017</span><br><span class="line">[27,]	1.37265053	0.02220972	1.2628542</span><br><span class="line">[18,]	1.07392251	-0.06763418	0.98110965</span><br><span class="line">[4,]	0.75996988	0.80604335	0.76371262</span><br><span class="line">[30,]	0.50287468	0.14734317	0.47396795</span><br><span class="line">[22,]	0.28708321	-0.35744666	0.23468178</span><br><span class="line">[16,]	0.06392983	0.20718448	0.07557617</span><br><span class="line">[1,]	0.0699095	-0.23813701	0.04486504</span><br><span class="line">[23,]	-0.25151075	1.25555188	-0.12898555</span><br><span class="line">[26,]	-0.16367555	0.04317932	-0.14685759</span><br><span class="line">[21,]	-0.79624422	0.16307887	-0.71824807</span><br><span class="line">[8,]	-0.82583977	-0.78102576	-0.82219309</span><br><span class="line">[9,]	-0.93464402	-0.58469242	-0.90618922</span><br><span class="line">[7,]	-1.42105591	-0.06053165	-1.31043961</span><br><span class="line">[17,]	-1.55561022	-1.70439674	-1.56770034</span><br><span class="line">[20,]	-2.14072377	0.02217881	-1.96487123</span><br><span class="line">[19,]	-2.52174212	0.97274301	-2.23763039</span><br><span class="line">[13,]	-2.44253342	-0.16769496	-2.25757928</span><br><span class="line">[12,]	-2.60851224	0.21278728	-2.37913015</span><br><span class="line">[5,]	-2.73966777	0.01718087	-2.51552502</span><br><span class="line">[3,]	-2.84793151	0.38956679	-2.58471151</span><br><span class="line">[25,]	-3.08596855	-0.05775318	-2.83976229</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;主成分分析（PCA）是一种数据降维技巧，它能将大量相关变量转化为一组很少的不相关变量，这些无关变量称为主成分，它们是观测变量的线性组合。如第一主成分为：&lt;br&gt;PC1=a1X1=a2X 2+…+akXk&lt;br&gt;它是k个观测变量的加权组合，对初始变量集的方差解释性最大。第二主
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="R_PCA" scheme="http://tiramisutes.github.io/tags/R-PCA/"/>
    
  </entry>
  
  <entry>
    <title>根据一个ID列表文件从一个fasta文件里面挑取符合要求的序列</title>
    <link href="http://tiramisutes.github.io/2015/07/29/perl.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/perl.html</id>
    <published>2015-07-29T05:53:40.000Z</published>
    <updated>2015-07-29T05:57:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>其中一个文件是ID列表，一个ID占一行，另一个文件是fasta格式的序列，一行是&gt;开头的标记，旗下所有行都是该标记的内容，直到下一个&gt;开头的标记</p>
<h3 id="Perl代码：">Perl代码：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl -w </span></span><br><span class="line"><span class="keyword">if</span>( @ARGV != 2  ) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">"Usage: we need two files\n"</span>;</span><br><span class="line">    <span class="built_in">exit</span> 0;</span><br><span class="line">&#125;</span><br><span class="line"> my <span class="variable">$ID</span>=<span class="built_in">shift</span> @ARGV;</span><br><span class="line"> my <span class="variable">$fasta</span>=<span class="built_in">shift</span> @ARGV;</span><br><span class="line"> open FH1,<span class="string">"&lt;<span class="variable">$ID</span>"</span> or die <span class="string">"can not open the file,$!"</span>;</span><br><span class="line"><span class="keyword">while</span> (&lt;FH1&gt;)</span><br><span class="line">&#123;</span><br><span class="line">chomp;</span><br><span class="line"><span class="variable">$hash</span>&#123;<span class="variable">$_</span>&#125;=1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#读取第一个参数，ID列表，每一行的ID都扫描进去hash表</span></span><br><span class="line">open FH2,<span class="string">"<span class="variable">$fasta</span>"</span> or die <span class="string">"can not open the file,$!"</span>;</span><br><span class="line"><span class="keyword">while</span>(defined(<span class="variable">$line</span>=&lt;FH2&gt;))</span><br><span class="line">&#123;</span><br><span class="line">	chomp <span class="variable">$line</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$line</span> =~ /&gt;/)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="variable">$key</span> = (split /\s/,<span class="variable">$line</span>)[0];</span><br><span class="line">	<span class="variable">$key</span> =~ s/&gt;//g;</span><br><span class="line">	<span class="variable">$flag</span> = exists <span class="variable">$hash</span>&#123;<span class="variable">$key</span>&#125;?1:0;</span><br><span class="line">	&#125;<span class="comment">#这个flag是用来控制这个标记下面的序列是否输出</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span> <span class="variable">$line</span>.<span class="string">"\n"</span> <span class="keyword">if</span> <span class="variable">$flag</span> == 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;其中一个文件是ID列表，一个ID占一行，另一个文件是fasta格式的序列，一行是&amp;gt;开头的标记，旗下所有行都是该标记的内容，直到下一个&amp;gt;开头的标记&lt;/p&gt;
&lt;h3 id=&quot;Perl代码：&quot;&gt;Perl代码：&lt;/h3&gt;&lt;figure class=&quot;highlight 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="perl" scheme="http://tiramisutes.github.io/tags/perl/"/>
    
  </entry>
  
  <entry>
    <title>RStudio</title>
    <link href="http://tiramisutes.github.io/2015/07/29/RStudio.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/RStudio.html</id>
    <published>2015-07-29T05:19:30.000Z</published>
    <updated>2018-09-28T02:43:45.390Z</updated>
    
    <content type="html"><![CDATA[<p>RStudio is an integrated development environment (IDE) for R. It includes a console, syntax-highlighting editor that supports direct code execution, as well as tools for plotting, history, debugging and workspace management.</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/RStudio.png" alt=""></p>
<h2 id="Publish_to_RPubs">Publish to RPubs</h2><h3 id="Getting_Started_with_RPubs">Getting Started with RPubs</h3><p>RStudio lets you harness the power of R Markdown to create documents that weave together your writing and the output of your R code. And now, with RPubs, you can publish those documents on the web with the click of a button!</p>
<h3 id="Prerequisites">Prerequisites</h3><p>You’ll need R itself, RStudio (v0.96.230 or later), and the knitr package (v0.5 or later).</p>
<h3 id="Instructions">Instructions</h3><p>In RStudio, create a new R Markdown document by choosing File | New | R Markdown.<br>Click the Knit HTML button in the doc toolbar to preview your document.<br>In the preview window, click the Publish button.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/RPubs.png" alt=""></p>
<h3 id="Results：">Results：</h3><p>Convergence testing<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library(lattice)</span><br><span class="line">library(lme4)</span><br><span class="line">library(blme)</span><br><span class="line">library(reshape2)</span><br><span class="line">library(ggplot2); theme_set(theme_bw())</span><br><span class="line">library(gridExtra)  <span class="comment">## for grid.arrange</span></span><br><span class="line">library(bbmle) <span class="comment">## for slice2D; requires *latest* r-forge version (r121)</span></span><br><span class="line"><span class="built_in">source</span>(<span class="string">"allFit.R"</span>)</span><br></pre></td></tr></table></figure></p>
<p>Load data:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dList &lt;- load(<span class="string">"data.RData"</span>)</span><br></pre></td></tr></table></figure></p>
<p>Spaghetti plot: don’t see much pattern other than (1) general increasing trend; (2) quantized response values (table(dth$Estimate) or unique(dth$Estimate) also show this); (3) skewed residuals<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort(unique(dth<span class="variable">$Estimate</span>))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##  [1]  0.0  0.5  1.0  1.5  2.0  2.5  3.0  4.0  5.0  6.0  7.0  7.5  8.0 10.0</span></span><br><span class="line"><span class="comment">## [15] 12.0 15.0 17.0 20.0 25.0 30.0 35.0 40.0 50.0 60.0 70.0 75.0 90.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(p0 &lt;- ggplot(dth,aes(Actual,Estimate))+geom_point()+</span><br><span class="line">    geom_line(aes(group=factor(pid)))+</span><br><span class="line">    stat_summary(fun.y=mean,geom=<span class="string">"line"</span>,colour=<span class="string">"red"</span>,lwd=2))</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/download.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;RStudio is an integrated development environment (IDE) for R. It includes a console, syntax-highlighting editor that supports direct code
    
    </summary>
    
      <category term="R" scheme="http://tiramisutes.github.io/categories/R/"/>
    
    
      <category term="RStudio_RPubs" scheme="http://tiramisutes.github.io/tags/RStudio-RPubs/"/>
    
  </entry>
  
  <entry>
    <title>全基因组重测序数据分析(Whole genomr Resequencing Analysis)</title>
    <link href="http://tiramisutes.github.io/2015/07/29/resequencing.html"/>
    <id>http://tiramisutes.github.io/2015/07/29/resequencing.html</id>
    <published>2015-07-29T04:56:57.000Z</published>
    <updated>2016-01-07T02:45:21.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介(Introduction)">简介(Introduction)</h2><p>通过高通量测序识别发现de novo的somatic和germ line 突变，结构变异-SNV，包括重排突变（deletioin, duplication 以及copy number variation）以及SNP的座位；针对重排突变和SNP的功能性进行综合分析；我们将分析基因功能（包括miRNA），重组率（Recombination）情况，杂合性缺失（LOH）以及进化选择与mutation之间的关系；以及这些关系将怎样使得在disease（cancer）genome中的mutation产生对应的易感机制和功能。我们将在基因组学以及比较基因组学，群体遗传学综合层面上深入探索疾病基因组和癌症基因组。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_fda7838fd16452f881.jpg" alt=""></p>
<h2 id="实验设计与样本">实验设计与样本</h2><p>（1）Case-Control 对照组设计 ；<br>（2）家庭成员组设计：父母-子女组（4人、3人组或多人）；</p>
<h2 id="初级数据分析">初级数据分析</h2><p>1．数据量产出： 总碱基数量、Total Mapping Reads、Uniquely Mapping Reads统计，测序深度分析。<br>2．一致性序列组装：与参考基因组序列（Reference genome sequence）的比对分析，利用贝叶斯统计模型检测出每个碱基位点的最大可能性基因型，并组装出该个体基因组的一致序列。<br>3．SNP检测及在基因组中的分布：提取全基因组中所有多态性位点，结合质量值、测序深度、重复性等因素作进一步的过滤筛选，最终得到可信度高的SNP数据集。并根据参考基因组信息对检测到的变异进行注释。<br>4．InDel检测及在基因组的分布: 在进行mapping的过程中，进行容gap的比对并检测可信的short InDel。在检测过程中，gap的长度为1~5个碱基。对于每个InDel的检测，至少需要3个Paired-End序列的支持。<br>5．Structure Variation检测及在基因组中的分布: 能够检测到的结构变异类型主要有：插入、缺失、复制、倒位、易位等。根据测序个体序列与参考基因组序列比对分析结果，检测全基因组水平的结构变异并对检测到的变异进行注释。</p>
<h2 id="高级数据分析">高级数据分析</h2><h3 id="1-测序短序列匹配（Read_Mapping）">1.测序短序列匹配（Read Mapping）</h3><p>（1）屏蔽掉Y染色体上假体染色体区域（pseudo-autosomal region）, 将Read与参考序列NCBI36进行匹配（包括所有染色体，未定位的contig，以及线粒体序列mtDNA（将用校正的剑桥参考序列做替代）)。采用标准序列匹配处理对原始序列文件进行基因组匹配， 将Read与参考基因组进行初始匹配；给出匹配的平均质量得分分布；<br>（2）碱基质量得分的校准。我们采用碱基质量校准算法对每个Read中每个碱基的质量进行评分，并校准一些显著性误差，包括来自测序循环和双核苷酸结构导致的误差。<br>（3）测序误差率估计。 pseudoautosomal contigs，short repeat regions（包括segmental duplication，simple repeat sequence-通过tandem repeat识别算法识别）将被过滤；</p>
<h3 id="2-SNP_Calling_计算_（SNP_Calling）">2.SNP Calling 计算 （SNP Calling）</h3><p>我们可以采用整合多种SNP探测算法的结果，综合地，更准确地识别出SNP。通过对多种算法各自识别的SNP进行一致性分析，保留具有高度一致性的SNP作为最终SNP结果。这些具有高度一致性的SNP同时具有非常高的可信度。在分析中使用到的SNP识别算法包括基于贝叶斯和基因型似然值计算的方法，以及使用连锁不平衡LD或推断技术用于优化SNP识别检出的准确性。</p>
<p>统计SNV的等位基因频率在全基因组上的分布<br>稀有等位基因数目在不同类别的SNV中的比率分布（a）；SNV的类别主要考虑：（1）无义（nonsense）,（2）化学结构中非同义，（3）所有非同义，（4）保守的非同义，（5）非编码，（6）同义，等类型SNV； 另外，针对保守性的讨论，我们将分析非编码区域SNV的保守型情况及其分布（图a, b）</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_5ec32097f340e47881.jpg" alt=""><br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_892310de264ab6c881.jpg" alt=""></p>
<h3 id="3-短插入/缺失探测（Short_Insertion_/Deletion_（Indel）Call）">3.短插入/缺失探测（Short Insertion /Deletion （Indel）Call）</h3><p>(1). 计算全基因组的indel变异和基因型检出值的过程<br>计算过程主要包含3步：（1）潜在的indel的探测；（2）通过局部重匹配计算基因型的似然值；（3）基于LD连锁不平衡的基因型推断和检出识别。Indel在X，Y染色体上没有检出值得出。<br>(2). Indel 过滤处理</p>
<h3 id="4-融合基因的发现（Fusion_gene_Discovery）">4.融合基因的发现（Fusion gene Discovery）</h3><p>选择注释的基因信息来自于当前最新版本的Ensemble Gene数据库，RefSeq数据库和Vega Gene数据库。下面图例给出的是融合基因的形成，即来自不同染色体的各自外显子经过重组形成融合基因的模式图。</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_1883c266694b5ae881.jpg" alt=""></p>
<h3 id="5-结构变异（Structure_Variation）">5.结构变异（Structure Variation）</h3><p>结构变异（Structure Variation－SV）是基因组变异的一类主要来源，主要由大片段序列（一般&gt;1kb）的拷贝数变异（copy number variation, CNV）以及非平衡倒位（unbalance inversion）事件构成。目前主要一些基因组研究探测识别的SV大约有20,000个（DGV数据库）。在某些区域上，甚至SV形成的速率要大于SNP的速率，并与疾病临床表型具有很大关联。我们不仅可以通过测序方式识别公共的SV，也可以识别全新的SV。全新的SV的生成一般在germ line和突变机制方面都具有所报道。然而，当前对SV的精确解析需要更好的算法实现。同时，我们也需要对SV的形成机制要有更重要的认知，尤其是SV否起始于祖先基因组座位的插入或缺失，而不简单的根据等位基因频率或则与参考基因组序列比对判断。SV的功能性也结合群体遗传学和进化生物学结合起来，我们综合的考察SV的形成机制类别。</p>
<p>SV形成机制分析，包括以下几种可能存在的主要机制的识别发现：<br>（A）同源性介导的直系同源序列区段重组（NAHR）；<br>（B）与DNA双链断裂修复或复制叉停顿修复相关的非同源重组（NHR）；<br>（C）通过扩展和压缩机制形成可变数量的串联重复序列（VNTR）；<br>（D）转座元件插入（一般主要是长／短间隔序列元件LINE/SINE或者伴随TEI相关事件的两者的组合）。<br>结构变异探测和扩增子（Amplicon）的探测与识别分析:如下图所示</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_42a6ff12ae6db79881.jpg" alt=""><br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_e701a15884d0ef3881.jpg" alt=""></p>
<h3 id="6-测序深度分析">6.测序深度分析</h3><p>测序深度分析就是指根据基因组框内覆盖度深度与期望覆盖度深度进行关联，并识别出SV。我们也将采用不同算法识别原始测序数据中的缺失片段（deletion）和重复片段（duplication）。</p>
<h3 id="7-SV探测识别结果的整合与FDR推断(可选步骤)">7.SV探测识别结果的整合与FDR推断(可选步骤)</h3><p>(1). PCR或者芯片方式验证SV<br>(2). 计算FDR-错误发现率（配合验证试验由客户指定）<br>(3)  筛选SV检出结果用于SV的合并和后续分析：我们通过不同方式探测识别SV的目的极大程度的检出SV，并且降低其FDR（&lt;=10%）。通过下属筛选方法决定后续分析所使用到的SV集合。每种SV探测识别算法得到的SV的FDR要求小于10%，并将各自符合条件的SV合并；对于FDR大于10% 的算法计算识别的SV结果，如果有PCR和芯片平台验证数据，同样可以纳入后续SV分析中。最后，针对不同算法得到的SV，整合处理根据breakpoint断点左右重合覆盖度的置信区间来评定；</p>
<h3 id="8-变异属性分析">8.变异属性分析</h3><p>(1) neutral coalescent分析<br>测序数据可以探测到低频率的变异体（MAF&lt;=5%）。根据来自群体遗传学理论（neutral coalescent理论）的期望值可以计算低频度变异的分布。我们用不同等位基因频率下每Mb变异数目与neutral coalescent 选择下的期望值比值，即每Mb 基因组windows内的theta观测值，来刻画和反映自然纯化选择与种群（cancer cell-line可以特定的认为是可以区分的种群）增长速率。该分布分别考察SNP（蓝色线），Indel（红色线），具有基因型的大片段缺失（黑色线），以及外显子区域上的 SNP（绿色线）在不同等位基因频率区间上的theta情况（参见下图）。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_4de2924a2659023881.jpg" alt=""><br>(2). 全新变异体(novel variant)的等位基因频率和数量分布<br>分析对象包括全新预测的SNP，indel，large deletion, 以及外显子SNP在每个等位基因频率类别下的数目比率（fraction）（参见下图）；全新预测是指预测分析结果与dbSNP（当前版本129）以及deletion数据库dbVar（2010年6月份版本）和已经发表的有关indels研究的基因组数据经过比较后识别确定的全新的SNP，indel以及deletion。dbSNP包含SNP和indels; dbVAR包含有deletion,duplication,以及mobile element insertion。dbRIP以及其他基因组学研究（JC Ventrer 以及Watson 基因组，炎黄计划亚洲人基因组）结果提供的short indels和large deletion。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_294dc6a11175d87881.jpg" alt=""><br>(3). 变异体的大小分布以及新颖性分布</p>
<p>计算SNP，Deletion，以及Insertion 大小分布；计算SNP，Deletion，以及Insertion中属于全新预测结果的数目占已有各自参考数据库数目的比例（相对于dbSNP数据库；dbSNP包含SNP和indels;dbVAR包含有deletion,duplication,以及mobile element insertion。dbRIP以及其他基因组学研究（JC Ventrer 以及Watson 基因组，炎黄计划亚洲人基因组）结果提供的short indels和large deletion）其中，可以给出LINE，Alu的特征位置。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_1ef2f8ecce847e0881.jpg" alt=""></p>
<p>(4). 结构变异SV的断点联结点(BreakPoint Junction)分析<br>根据SV不同检出结果经过一些列筛选步骤构建所有结构变异SV的断点联结点数据库，保留长度大于等于50bp的SV；分析断点联结点处具有homology或者microhomology的SV；并将同一染色体，起始和终止位置坐标下的不同SV进行去冗余处理。</p>
<p>分析识别SV 的断点联结点（Breakpoint）: 将Breakpoint按照可能形成的方式可以分类为以下几类：<br>（a）非等位基因同源重组型（non-allelic homologous recombination-NAHR）;<br>（b）非同源重组（nonhomologous recombination-NHR），包括nonhomologous end-joining (NHEJ)和fork stalling /template switching（FoSTeS/MMBIR）；<br>（c）可变串联重复（VNTR）<br>（d）转座插入元件（TEI）。</p>
<p>图 C<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_cfbf071cefe41f6881.jpg" alt=""><br>SV形成偏好性分析<br>分析SV形成机制与断裂点临近区域序列的关系，包括染色质界标（端粒，中心粒），重组高发热点区域，重复序列以及ＧＣ含量，短DNA motif和微同源区域（microhomology region）。</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_88118df3c49e866881.jpg" alt=""></p>
<h3 id="9-突变率估计">9.突变率估计</h3><p>针对以家庭成员为单位的测序方案，我们主要探测de novo的突变（DNM）；通过采用不同的方法/算法，我们给出每个家庭一份推断的DNM报表；</p>
<p>(1) 根据基因型推断结果，分别对每人每碱基位置上的de novo突变进行综合度量；<br>(2) 采用贝叶斯方法计算家庭组设计中DNM的后验概率</p>
<h3 id="10-SNP，SNV功能分析与注释">10.SNP，SNV功能分析与注释</h3><p>(1). 祖先等位基因的注释<br>通过将人类（NCBI36），黑猩猩（chimpanzee2.1），猩猩（PPYG2）以及恒河猴（MMUL1）4种基因组进行基因组比对，发现保守的序列区域，计算祖先等位基因；以及duplication/deletion事件的进化分析。<br>(2). 分析基因结构序列上不同区域的多样性（Diversity）与分歧进化（divergence）<br>根据基因型分析结果计算基因结构序列上的多样性程度，即杂合度(heterozygosity); 杂合度指标可以说明选择效应的存在以及局部变异的结构分布特征模式。我们将考虑基因5’UTR上游200bp ，5’UTR ，第一个外显子，第一个内含子，中间外显子，中间内含子，最末外显子和内含子，以及3’UTR及其下游200bp区域左右考察的范围(参见下图a)。   分析编码转录本的起始/终止位置临近区域的多样性和进化分歧度（参见下图b）。</p>
<p>(3). 疾病变异体探测<br>将样本测序中分析得到SV与HGMD疾病变异体数据进行比对，得到交叉记录的错义和无义的SNP；通过将HGMD疾病关联突变与CUI（疾病概念分类标识数据库）比对获得HGMD中所有SV的疾病表型，并获得HGMD与测序数据分析得到的SV的疾病表型；并通过Fisher检验和Bonferroni多重假设检验校正计算样本SV所富集的疾病表型。</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_6a5a41bf5d1e34b881.jpg" alt=""></p>
<p>(4). 拷贝数变异CNV所含基因的功能注释<br>将CNV是否覆盖区段重复SD区域分类为2大类，每类CNV的所含基因的功能富集情况计算，显著性在横轴表示；各种显著性功能在纵轴表示。</p>
<p>(5). 变异的功能性分析与注释<br>（a）. SNP, Indels以及大的结构变异SV的功能注释;<br>（b）. 对包含翻译起始注释信息的转录本编码区上的SNP分类为：同义SNP，非同义SNP和无义SNP（引入终止子），干扰终止子的SNP，以及干扰剪接位点的SNP；为了降低假阳性，我们采用严格的筛选方式过滤来自indels的错误；<br>（c）.对错义编码区突变的功能性分析: 通过信息学分析算法评估相对于生殖系变异的体细胞突变对蛋白质的结构和功能的影响效应。</p>
<p>(6). SNV，SNP与miRNA研究之间的关联分析<br>miRNA是起重要的调控作用的小分子，我们将对miRNA的pri-mRNA，pre-miRNA以及miRNA靶基因序列进行分析，识别潜在的SNP功能位点。据文献研究提供证据表明Human pre-miRNA的二级结构中存在不同位置上的SNP，我们将通过热力学稳定性分析方法评估SNP对pre-miRNA结构的影响；另外，我们也将对miRNA-Target靶基因相互作用位点做分析，评估对SNP对靶基因靶向性的影响。</p>
<p>(7). SNV，SNP与GWAS研究之间的关联分析<br>分析GWAS研究中得到的易感基因在基因组上不同坐标上的OR值分布情况； 将当前已知的GWAS研究成果与SNP进行比较；根据LD连锁不平衡将SNP与易感基因的关系进行深入讨论;直接与间接关联方法可以分别识别与表型相关的SNP，对于不易获得（missing）和定位的SNP，通过LD连锁不平衡推断疾病易感基因突变座位。</p>
<p>(8) 生物学通路（代谢通路，信号通路）分析<br>生物学通路（Biological pathway），包括代谢通路和信号转导通路是生物功能的重要组成部分，我们将各种形式的突变、变异，包括SNV和SNP，的对应基因放到生物学通路中进行综合分析，考察功能性突变对pathway的影响程度和影响的规律。通过GSEA（配合芯片表达谱数据），KS检验，超几何分布检验等方法对变异基因在某些pathway的富集程度进行排序，识别发生功能改变的潜在通路。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_564fff92e831b5c881.jpg" alt=""></p>
<p>(9). 蛋白质-蛋白质相互作用（PPI）网络分析<br>蛋白质相互作用也是生物分子功能增益和缺失的重要途径，因此我们针对蛋白质相互作用网络中的突变的蛋白及其收到影响的网络节点蛋白进行系统分析，并对收到影响的网络子结构进行功能注释分析和聚类富分析。我们采用网络分析算法对由于各种突变所受到影响的子网络（subnetwork）进行功能富集度的分析；</p>
<p>(10). 顺式基因调控网络模块（CRM）分析</p>
<p>(a) 启动子序列分析<br>    包括动子区域上的Motif预测，并与已知转录因子数据库TRANSFAC和JASPAR中的TFBS结合位点进行比对；<br>    启动子区域上保守性分析，分析突变位置和保守性区域的关联；<br>(b) 计算全基因组保守性。确定TFBS的保守性以及mutation位置的保守性；</p>
<p>（11）重排（arrangements）与突变（mutation）的全基因组统计</p>
<p>（a）. 体细胞(somatic)和生殖系（germline）重排（arrangements）</p>
<p>体细胞突变是相对于germ line 突变的一类需要重要分析的内容，我们针对Case-control设计的测序方案可以分别分析突变的情况，包括SNV，indel，以及CNV；如果仅在tumor/disease(Case组)出现而不在normal（对照组）出现的突变我们可以认为是somatic体细胞突变。将somatic mutation 与dbSNP数据库比对可以发现潜在的全新的突变和有记录的突变位置。然后，将突变分别比对到基因区域和非基因区域。基因区域具体包括：内含子区，UTR，剪接位点区和外显子区。其中外显子区分别统计：同义（synonymous），缺失（deletion），阅读框移位（frameshift），插入（insertion）,错义（missense）,无义（nonsense）以及非编码蛋白外显子（non-protein coding exon）等不同类型。综合不同方面分析的结果，并按照突变分类给出各重排(arrangements)类型：SNV，CNV的数目统计数据表（参见下图） 。对每一测序样本分别进行标注，包括体细胞突变和生殖系突变。</p>
<p>（b） 全基因组全局重排分布特征分析</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_e11d895fe949294881.jpg" alt=""></p>
<p>主要将（a）染色体间和染色体内部的结构变异，（b）杂合体缺失（LOH）与等位基因不平衡的状况，（c）拷贝数变异（增益或者缺失）以及高可信度的SNV（在1Mb间隔区间统计）等不同情况配合染色体核型在环状图的不同层次上分别的表示出来（参见下图例对应a-d）</p>
<p>(c) 单核苷酸突变趋势与模式分析</p>
<p><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_d4a62ad19ebc732881.jpg" alt=""></p>
<p>分别统计在体细胞和生殖系细胞水平上的transversion的主要形式与各自所占比重（a）；如果有表达谱数据，可以分析表达基因与非表达基因所分别具有的突变重排数目或者种类（b）；转录起始位点上游区域的体细胞变异，生殖系germline变异以及随机变异的各自数目统计（c）和已知210种的不同肿瘤疾病的突变谱进行比较.</p>
<h3 id="11-自然选择分析">11.自然选择分析</h3><p>我们通过测序所观测到的体细胞突变可能是经历了复杂的过程所成的。因此，我们在研究这些突变的起源，突变如何受到DNA修复机制的影响，以及在疾病发展与进化过程中突变的规律方面需要做深入的分析。自然选择一般在两个方面发挥作用，即保留有利于疾病发展进化的突变的同时限制其在基因组中重要功能区域发生突变，例如转录调控区域和编码蛋白质的区域。因此，（1）如果实验设计是将primary disease与normal control做比较的话，系统的分析可以解析复杂疾病在形成突变过程中可能的机制和自然选择的因素。（2）如果实验设计是基于病灶及其转移位置或者邻接位置样本作测序，我们可以构建突变进化与转移的模型解析突变的动态模式和基因组中不稳定态变异的模式。</p>
<p>正向选择的判定:  分析SNP，SNV区域的正向选择趋势，在进化和群体遗传水平解释SNV，SNP的功能性；对待control与case 组样本,我们分别采用不同统计算法计算SNP，CNV在各自样本中的差异，进而从中发现具有正向选择特征的SV。<br><img src="http://pic.biodiscover.com/uploads/7504adad8bb96320eb3afdd4df6e1f60/article/biodiscover_2596a5e119b63cc881.jpg" alt=""></p>
<h2 id="相关文献(References)">相关文献(References)</h2><p>◆ <span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25nL2pvdXJuYWwvdjQyL24xMi9mdWxsL25nLjcxNS5odG1s" title="http://www.nature.com/ng/journal/v42/n12/full/ng.715.html">Resequencing of 31 wild and cultivated soybean genomes identifies patterns of genetic diversity and selection<i class="fa fa-external-link"></i></span><br>◆ <span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3YzMy9uNC9mdWxsL25idC4zMDk2Lmh0bWw=" title="http://www.nature.com/nbt/journal/v33/n4/full/nbt.3096.html">Resequencing 302 wild and cultivated accessions identifies genes related to domestication and improvement in soybean<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介(Introduction)&quot;&gt;简介(Introduction)&lt;/h2&gt;&lt;p&gt;通过高通量测序识别发现de novo的somatic和germ line 突变，结构变异-SNV，包括重排突变（deletioin, duplication 以及copy numb
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="resequencing" scheme="http://tiramisutes.github.io/tags/resequencing/"/>
    
  </entry>
  
  <entry>
    <title>Google Web</title>
    <link href="http://tiramisutes.github.io/2015/07/28/google.html"/>
    <id>http://tiramisutes.github.io/2015/07/28/google.html</id>
    <published>2015-07-28T14:51:06.000Z</published>
    <updated>2018-09-28T02:35:46.758Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/google.png" alt=""><br>本文将不定期维护更新，删除不能用的，增加新的可用网址。欢迎 Ctrl+D 收藏。</p>
<p></p><h3>原版：</h3><p></p>
<p></p><p><span style="color:red">[推荐]</span><span class="exturl" data-url="aHR0cHM6Ly9nLm5hbWFoby5jb20v" title="https://g.namaho.com/">https://g.namaho.com/<i class="fa fa-external-link"></i></span><br><br><span style="color:red">[推荐]</span><span class="exturl" data-url="aHR0cDovL2Rpci5zY21vci5jb20vZ29vZ2xlLw==" title="http://dir.scmor.com/google/">http://dir.scmor.com/google/<i class="fa fa-external-link"></i></span><br><br><span style="color:red">[推荐]</span><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dnLXdlbi1sdS8=" title="http://www.itechzero.com/go/gg-wen-lu/">https://gg.wen.lu/<i class="fa fa-external-link"></i></span><br><br><span style="color:red">[推荐]</span><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1zb3VndWdlLWNvbS8=" title="http://www.itechzero.com/go/www-souguge-com/">https://www.souguge.com/<i class="fa fa-external-link"></i></span><br><br><span style="color:red">[推荐]</span><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1ndWdlMTE5LWNvbS8=" title="http://www.itechzero.com/go/www-guge119-com/">https://www.guge119.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2ctYnQtZ2cv" title="http://www.itechzero.com/go/g-bt-gg/">http://g.bt.gg/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2cteW9uLWhrLw==" title="http://www.itechzero.com/go/g-yon-hk/">http://g.yon.hk/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvLzRiNGIteHl6Lw==" title="http://www.itechzero.com/go/4b4b-xyz/">https://4b4b.xyz/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2hpc2JpZy1jb20v" title="http://www.itechzero.com/go/hisbig-com/">http://hisbig.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3Mtamlhc3ViYW8tY28v" title="http://www.itechzero.com/go/s-jiasubao-co/">http://s.jiasubao.co/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dnLWN5dGJqLWNvbS8=" title="http://www.itechzero.com/go/gg-cytbj-com/">http://gg.cytbj.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2FsbGVlLXNjaWVuY2Uv" title="http://www.itechzero.com/go/allee-science/">https://allee.science/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2ctZ2ludG9raS1uZXQv" title="http://www.itechzero.com/go/g-gintoki-net/">https://g.gintoki.net/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1wcHgtcHcv" title="http://www.itechzero.com/go/www-ppx-pw/">https://www.ppx.pw/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1ndWdlLWxpbmsv" title="http://www.itechzero.com/go/www-guge-link/">http://www.guge.link/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1mY2N6cC1jb20v" title="http://www.itechzero.com/go/www-fcczp-com/">http://www.fcczp.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1obGZlZWwtY29tLw==" title="http://www.itechzero.com/go/www-hlfeel-com/">http://www.hlfeel.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1nZ29vby1uZXQv" title="http://www.itechzero.com/go/www-ggooo-net/">http://www.ggooo.net/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1ndWdlLWNsaWNrLw==" title="http://www.itechzero.com/go/www-guge-click/">https://www.guge.click/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1ndWdlLWRhdGUv" title="http://www.itechzero.com/go/www-guge-date/">https://www.guge.date/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2ctc2VhcmNoZXItdG9wLw==" title="http://www.itechzero.com/go/g-searcher-top/">https://gg.searcher.top/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3lvdXNoZW5nYnMtY29tLw==" title="http://www.itechzero.com/go/youshengbs-com/">http://youshengbs.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dvb2dsZS1rYWluaWRpLWNuLw==" title="http://www.itechzero.com/go/google-kainidi-cn/">http://google.kainidi.cn/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dvb2dsZS14ZmFjZS1tZS8=" title="http://www.itechzero.com/go/google-xface-me/">https://google.xface.me/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dvb2dsZS1pdHF5OC1jb20v" title="http://www.itechzero.com/go/google-itqy8-com/">http://google.itqy8.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dvLWhpYmVuYmVuLWNvbS8=" title="http://www.itechzero.com/go/go-hibenben-com/">http://go.hibenben.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL3d3dy1iYWlkdS1jb20tc2Uv" title="http://www.itechzero.com/go/www-baidu-com-se/">http://www.baidu.com.se/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2ctbmllLW5ldGVhc2UtY29tLw==" title="http://www.itechzero.com/go/g-nie-netease-com/">https://g.nie.netease.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvL2dvb2dsZS1oay13ZXdlbGwtbmV0Lw==" title="http://www.itechzero.com/go/google-hk-wewell-net/">https://google-hk.wewell.net/<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ3VnZTExOS5jb20v" title="https://www.guge119.com/">https://www.guge119.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nLnloLmdzLw==" title="https://g.yh.gs/">https://g.yh.gs/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5ndWdlLmxpbmsv" title="http://www.guge.link/">http://www.guge.link/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2NhcmJ5bmUubmV0LmNuLw==" title="http://carbyne.net.cn/">http://carbyne.net.cn/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dnLmNlbGxtZWFuLmNvbS8=" title="http://gg.cellmean.com/">http://gg.cellmean.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dvb2dsZS5zaWRuZXktYWxkZWJhcmFuLm1lLw==" title="http://google.sidney-aldebaran.me/">http://google.sidney-aldebaran.me/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nLnloLmdzLw==" title="https://g.yh.gs/">https://g.yh.gs/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9ndWdlLmluLw==" title="https://guge.in/">https://guge.in/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2cueW9uLmhrLw==" title="http://g.yon.hk/">http://g.yon.hk/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nZy53ZW4ubHUv" title="https://gg.wen.lu/">https://gg.wen.lu/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9ncy5hd2VpLm1lLw==" title="https://gs.awei.me/">https://gs.awei.me/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5wcHgucHcv" title="http://www.ppx.pw/">http://www.ppx.pw/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dnLmN5dGJqLmNvbS8=" title="http://gg.cytbj.com/">http://gg.cytbj.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nLmVlbG9hZC5jb20v" title="https://g.eeload.com/">https://g.eeload.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5ndWdlLmxpbmsv" title="http://www.guge.link/">http://www.guge.link/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nLnNlYXJjaGVyLnRvcC8=" title="https://g.searcher.top/">https://g.searcher.top/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly93d3cua281MC5jb20v" title="https://www.ko50.com/">https://www.ko50.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ3VnZS5jbGljay8=" title="https://www.guge.click/">https://www.guge.click/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nLnNlYXJjaGVyLnRvcC8=" title="https://g.searcher.top/">https://gg.searcher.top/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9ndWdlLmRyb2lkZXIuY24v" title="https://guge.droider.cn/">https://guge.droider.cn/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dnLmNlbGxtZWFuLmNvbS8=" title="http://gg.cellmean.com/">http://gg.cellmean.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9nb29nbGUueGZhY2UubWUv" title="https://google.xface.me/">https://google.xface.me/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5nb29nbGU1Mi5jb20v" title="http://www.google52.com/">http://www.google52.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ3VnZTExOS5jb20v" title="https://www.guge119.com/">https://www.guge119.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5nb29nbGVzdGFibGUuY24v" title="http://www.googlestable.cn/">http://www.googlestable.cn/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dvb2dsZS5zaWRuZXktYWxkZWJhcmFuLm1lLw==" title="http://google.sidney-aldebaran.me/">http://google.sidney-aldebaran.me/<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><h3>非原版：</h3><p></p>
<p></p><p>搜：<span class="exturl" data-url="aHR0cDovL3NvdS5jbG91ZGFwcC5uZXQv" title="http://sou.cloudapp.net/">http://sou.cloudapp.net/<i class="fa fa-external-link"></i></span><br><br>南搜：<span class="exturl" data-url="aHR0cDovL25hbi5zby9zaXRlcw==" title="http://nan.so/sites">http://nan.so/sites<i class="fa fa-external-link"></i></span><br><br>快搜：<span class="exturl" data-url="aHR0cDovL3d3dy5rdWFpc28uaGsv" title="http://www.kuaiso.hk/">http://www.kuaiso.hk/<i class="fa fa-external-link"></i></span><br><br>谷壳：<span class="exturl" data-url="aHR0cDovL3d3dy5nb29na2UubWUv" title="http://www.googke.me/">http://www.googke.me/<i class="fa fa-external-link"></i></span><br><br>蝴蝶：<span class="exturl" data-url="aHR0cDovL3d3dy54aWV4aW5nd2VuLmNvbS8=" title="http://www.xiexingwen.com/">http://www.xiexingwen.com/<i class="fa fa-external-link"></i></span><br><br>搜下看：<span class="exturl" data-url="aHR0cDovL3NveGlha2FuLmNvbS8=" title="http://soxiakan.com/">http://soxiakan.com/<i class="fa fa-external-link"></i></span><br><br>谷粉网：<span class="exturl" data-url="aHR0cDovL3d3dy5nb29sLndhbmcv" title="http://www.gool.wang/">http://www.gool.wang/<i class="fa fa-external-link"></i></span><br><br>喜乐搜：<span class="exturl" data-url="aHR0cDovL3d3dy54aWxlc291LmNvbS8=" title="http://www.xilesou.com/">http://www.xilesou.com/<i class="fa fa-external-link"></i></span><br><br>谷歌婊：<span class="exturl" data-url="aHR0cDovL3d3dy5ndWdlYmlhby5jb20v" title="http://www.gugebiao.com/">http://www.gugebiao.com/<i class="fa fa-external-link"></i></span><br><br>谷歌363：<span class="exturl" data-url="aHR0cDovL3d3dy5nMzYzLmNvbS8=" title="http://www.g363.com/">http://www.g363.com/<i class="fa fa-external-link"></i></span><br><br>给搜搜索：<span class="exturl" data-url="aHR0cDovL3d3dy5nZWlzby5jbi8=" title="http://www.geiso.cn/">http://www.geiso.cn/<i class="fa fa-external-link"></i></span><br><br>印象搜索：<span class="exturl" data-url="aHR0cDovL2dsLmltcHJlc3MucHcvcGFnZT9xPQ==" title="http://gl.impress.pw/page?q=">http://gl.impress.pw/<i class="fa fa-external-link"></i></span><br><br>谷粉搜搜：<span class="exturl" data-url="aHR0cDovL3d3dy5nZnNvdXNvdS5jbi8=" title="http://www.gfsousou.cn/">http://www.gfsousou.cn/<i class="fa fa-external-link"></i></span><br><br>翻墙谷歌：<span class="exturl" data-url="aHR0cDovL3NlYXJjaC41MjM5My5jb20v" title="http://search.52393.com/">http://search.52393.com/<i class="fa fa-external-link"></i></span><br><br>极客搜索：<span class="exturl" data-url="aHR0cDovL3d3dy5nZWVrZ2xlLmNvbS8=" title="http://www.geekgle.com/">http://www.geekgle.com/<i class="fa fa-external-link"></i></span><br><br>谷粉搜搜：<span class="exturl" data-url="aHR0cDovL2dmc29zby5oYW8xMzYuY29tLw==" title="http://gfsoso.hao136.com/">http://gfsoso.hao136.com/<i class="fa fa-external-link"></i></span><br><br>红杏谷歌：<span class="exturl" data-url="aHR0cDovL3d3dy5oeGdvb2dsZS5jb20v" title="http://www.hxgoogle.com/">http://www.hxgoogle.com/<i class="fa fa-external-link"></i></span><br><br>中国谷歌：<span class="exturl" data-url="aHR0cDovL3d3dy5nb29nbGVmb3JjaGluYS5jb20v" title="http://www.googleforchina.com/">http://www.googleforchina.com/<i class="fa fa-external-link"></i></span><br><br>极速网谷歌：<span class="exturl" data-url="aHR0cDovL2dvb2dsZS5tamlzdS5jb20v" title="http://google.mjisu.com/">http://google.mjisu.com/<i class="fa fa-external-link"></i></span><br><br>布谷鸟搜索：<span class="exturl" data-url="aHR0cDovL20ud2N1Y2tvby5jb20vc2VhcmNoLw==" title="http://m.wcuckoo.com/search/">http://m.wcuckoo.com/search/<i class="fa fa-external-link"></i></span><br><br>Ask：<span class="exturl" data-url="aHR0cDovL2hvbWUudGIuYXNrLmNvbS8=" title="http://home.tb.ask.com/">http://home.tb.ask.com/<i class="fa fa-external-link"></i></span><br><br>AOL：<span class="exturl" data-url="aHR0cDovL20uc2VhcmNoLmFvbC5jb20v" title="http://m.search.aol.com/">http://m.search.aol.com/<i class="fa fa-external-link"></i></span><br><br>5Ask：<span class="exturl" data-url="aHR0cDovL2NuLjVhc2suY29tLw==" title="http://cn.5ask.com/">http://cn.5ask.com/<i class="fa fa-external-link"></i></span><br><br>Avira：<span class="exturl" data-url="aHR0cHM6Ly9zYWZlc2VhcmNoLmF2aXJhLmNvbS8=" title="https://safesearch.avira.com/">https://safesearch.avira.com/<i class="fa fa-external-link"></i></span><br><br>WOW：<span class="exturl" data-url="aHR0cDovL3d3dy53b3cuY29tLw==" title="http://www.wow.com/">http://www.wow.com/<i class="fa fa-external-link"></i></span><br><br>Suche：<span class="exturl" data-url="aHR0cDovL3N1Y2hlLndlYi5kZS8=" title="http://suche.web.de/">http://suche.web.de/<i class="fa fa-external-link"></i></span><br><br>OpenGG：<span class="exturl" data-url="aHR0cDovL3d3dy5vcGVuZ2cuY24v" title="http://www.opengg.cn/">http://www.opengg.cn/<i class="fa fa-external-link"></i></span><br><br>Randomk：<span class="exturl" data-url="aHR0cDovL2dsLnJhbmRvbWsub3JnLw==" title="http://gl.randomk.org/">http://gl.randomk.org/<i class="fa fa-external-link"></i></span><br><br>Im Google：<span class="exturl" data-url="aHR0cDovL3d3dy5pbWdvb2dsZS5jbi8=" title="http://www.imgoogle.cn/">http://www.imgoogle.cn/<i class="fa fa-external-link"></i></span><br><br>Disconnect：<span class="exturl" data-url="aHR0cHM6Ly9zZWFyY2guZGlzY29ubmVjdC5tZS8=" title="https://search.disconnect.me/">https://search.disconnect.me/<i class="fa fa-external-link"></i></span><br><br>WebWebWeb：<span class="exturl" data-url="aHR0cDovL3dlYndlYndlYi5jb20v" title="http://webwebweb.com/">http://webwebweb.com/<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><h3>智能跳转：</h3><p></p>
<p></p><p>谷大爷：<span class="exturl" data-url="aHR0cDovL2cucGh2Yi5jbi8=" title="http://g.phvb.cn/">http://g.phvb.cn/<i class="fa fa-external-link"></i></span><br><br>大中华：<span class="exturl" data-url="aHR0cDovL2kuZm9yYm9vay5uZXQv" title="http://i.forbook.net/">http://i.forbook.net/<i class="fa fa-external-link"></i></span><br><br>简约谷歌：<span class="exturl" data-url="aHR0cDovL2ZyZWUxMjMuY2Mv" title="http://free123.cc/">http://free123.cc/<i class="fa fa-external-link"></i></span><br><br>谷粉恰搜：<span class="exturl" data-url="aHR0cDovL3d3dy5xaWFzb3UuY29tLw==" title="http://www.qiasou.com/">http://www.qiasou.com/<i class="fa fa-external-link"></i></span><br><br>逆天谷歌：<span class="exturl" data-url="aHR0cDovL3d3dy5nbzIxMjEuY29tLw==" title="http://www.go2121.com/">http://www.go2121.com/<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><h3>谷歌学术：</h3><p></p>
<p></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cucm9vbGluLmNvbS8=" title="https://www.roolin.com/">https://www.roolin.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3d3dy5zY2hvbGFybmV0LmNuLw==" title="http://www.scholarnet.cn/">http://www.scholarnet.cn/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3NjaG9sYXIueGlsZXNvdS5jb20v" title="http://scholar.xilesou.com/">http://scholar.xilesou.com/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL3h1ZXNodS5jeXRiai5jb20vc2Nob2xhci8=" title="http://xueshu.cytbj.com/scholar/">http://xueshu.cytbj.com/scholar/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cDovL2dmc3MuY2Mud2FsbHBhaS5jb20vc2Nob2xhci8=" title="http://gfss.cc.wallpai.com/scholar/">http://gfss.cc.wallpai.com/scholar/<i class="fa fa-external-link"></i></span><br><br><span class="exturl" data-url="aHR0cHM6Ly9kdWxpeml5b3UuY29tLyFzY2hvbGFyLmdvb2dsZS5jb20vc2NoaHA=" title="https://duliziyou.com/!scholar.google.com/schhp">https://duliziyou.com/!scholar.google.com/schhp<i class="fa fa-external-link"></i></span></p><br>贡献来源<br><span class="exturl" data-url="aHR0cDovL3d3dy5pdGVjaHplcm8uY29tL2dvb2dsZS1taXJyb3Itc2l0ZXMtY29sbGVjdC5odG1s" title="http://www.itechzero.com/google-mirror-sites-collect.html">http://www.itechzero.com/google-mirror-sites-collect.html<i class="fa fa-external-link"></i></span><p></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/google.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;本文将不定期维护更新，删除不能用的，增加新的可用网址。欢迎 Ctrl+D 收藏。&lt;/
    
    </summary>
    
      <category term="Google" scheme="http://tiramisutes.github.io/categories/Google/"/>
    
    
      <category term="Google" scheme="http://tiramisutes.github.io/tags/Google/"/>
    
  </entry>
  
  <entry>
    <title>awk 不排序删除重复行</title>
    <link href="http://tiramisutes.github.io/2015/07/28/awk.html"/>
    <id>http://tiramisutes.github.io/2015/07/28/awk.html</id>
    <published>2015-07-28T14:42:17.000Z</published>
    <updated>2015-12-27T07:15:34.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="处理的文件">处理的文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br><span class="line">1 2 3</span><br><span class="line">1 2 4</span><br><span class="line">1 2 3</span><br><span class="line">1 2 5</span><br></pre></td></tr></table></figure>
<h3 id="结果文件">结果文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br><span class="line">1 2 4</span><br><span class="line">1 2 5</span><br></pre></td></tr></table></figure>
<h3 id="处理流程">处理流程</h3><p>而如果使用sort加uniq进行排序的话，这个文档是看不出有什么不妥，不过我要处理的是用户名与密码一行行对应好的，如果使用sort + uniq处理的话，用户名都排到一块了，密码也又都跑到一块了。这样就分不出来那个是那个了。 而使用的脚本很简单：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'!x[$0]++'</span> filename</span><br></pre></td></tr></table></figure></p>
<p>注：此处的x只是一个数据参数的名字而已，随你用a、b、c、d都行。</p>
<p>简要解释一下，awk 的基本执行流程是，对文件的每一行，做一个指定的逻辑判断，如果逻辑判断成立，则执行指定的命令；如果逻辑判断不成立，则直接跳过这一行。</p>
<p>这里写的 awk 命令是<code>!x[$0]++</code>，意思是，首先创建一个 map 叫x，然后用当前行的全文<code>$0</code>作为 map 的 key，到 map 中查找相应的 value，如果没找到，则整个表达式的值为真，可以执行之后的语句；如果找到了，则表达式的值为假，跳过这一行。由于表达式之后有++，因此如果某个 key 找不到对应的 value，该++操作会先把对应的 value 设成 0，然后再自增成 1，这样下次再遇到重复的行的时候，对应的 key 就能找到一个非 0 的 value 了。</p>
<p>注：该处的map类似于array数组，只不过在awk中叫array不恰当。</p>
<p>awk Oneline中我们也学到过，awk 的流程是先判断表达式，表达式为真的时候就执行语句，可是我们前面写的这个 awk 命令里只有表达式，没有语句，那我们执行什么呢？原来，当语句被省略的时候，awk 就执行默认的语句，即打印整个完整的当前行。就这样，我们通过这个非常简短的 awk 命令实现了去除重复行并保留原有文件顺序的功能。</p>
<p>当然，我们也可以对该例进行下改变，通过判断某列的值相同，就只保留首行。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'!a[$3]++'</span> filename</span><br><span class="line"></span><br><span class="line">删除第三列重复的行</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'!a[$NF]++'</span> filename</span><br><span class="line">删除最后一列重复的行</span><br></pre></td></tr></table></figure>
<p>如何在去除重复行时对空白行不做处理，我这里总结了三种实现方法（都是仅使用awk工具），具体如下（为了便于区分，这里我使用nl命令加了行号）：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@361way ~]<span class="comment"># cat a.txt |nl -b a   #原文件</span></span><br><span class="line">     1  1 2 3</span><br><span class="line">     2  1 2 3</span><br><span class="line">     3</span><br><span class="line">     4</span><br><span class="line">     5  1 2 4</span><br><span class="line">     6  1 2 3</span><br><span class="line">     7</span><br><span class="line">     8</span><br><span class="line">     9  1 2 5</span><br><span class="line">[root@361way ~]<span class="comment"># awk '!NF || !a[$0]++'  a.txt |nl -b a   #方法一</span></span><br><span class="line">     1  1 2 3</span><br><span class="line">     2</span><br><span class="line">     3</span><br><span class="line">     4  1 2 4</span><br><span class="line">     5</span><br><span class="line">     6</span><br><span class="line">     7  1 2 5</span><br><span class="line">[root@361way ~]<span class="comment"># awk '!NF &#123;print;next&#125; !($0 in a) &#123;a[$0];print&#125;'  a.txt |nl -b a   #方法二</span></span><br><span class="line">     1  1 2 3</span><br><span class="line">     2</span><br><span class="line">     3</span><br><span class="line">     4  1 2 4</span><br><span class="line">     5</span><br><span class="line">     6</span><br><span class="line">     7  1 2 5</span><br><span class="line">[root@361way ~]<span class="comment"># awk '!/./ || !a[$0]++' a.txt |nl -b a  #方法三</span></span><br><span class="line">     1  1 2 3</span><br><span class="line">     2</span><br><span class="line">     3</span><br><span class="line">     4  1 2 4</span><br><span class="line">     5</span><br><span class="line">     6</span><br><span class="line">     7  1 2 5</span><br></pre></td></tr></table></figure></p>
<h3 id="指定列去重（经典之作）">指定列去重（经典之作）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'!a[$1]++'</span></span><br></pre></td></tr></table></figure>
<p><i class="fa fa-commenting-o"></i>解释</p>
<p><1> ：”!” 即非。</1></p>
<p><2>：a[$0]，以$0为数据下标，建立数组a</2></p>
<p><3>：a[$0]++，即给数组a赋值，a[$0]+=1</3></p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;处理的文件&quot;&gt;处理的文件&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="awk" scheme="http://tiramisutes.github.io/tags/awk/"/>
    
  </entry>
  
  <entry>
    <title>Linux和windows定时备份数据到百度云盘</title>
    <link href="http://tiramisutes.github.io/2015/07/28/Linux-backup.html"/>
    <id>http://tiramisutes.github.io/2015/07/28/Linux-backup.html</id>
    <published>2015-07-28T14:22:09.000Z</published>
    <updated>2017-04-03T09:26:22.833Z</updated>
    
    <content type="html"><![CDATA[<h2 id="php实现Linux定时备份数据到百度云盘">php实现Linux定时备份数据到百度云盘</h2><p>安装bpcs_uploader 虽然关于bpcs_uploader的教程不少，但都千篇一律。虽然网上也有很详细的教程，不过可能还有漏掉的细节。<br>废话不多说了，开工。<br>下载程序包：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/oott123/bpcs_uploader/zipball/master</span><br></pre></td></tr></table></figure></p>
<p>解压：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip master</span><br></pre></td></tr></table></figure></p>
<p>默认的文件夹名字很长，为了方便以后操作，重命名文件夹：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv oott123-bpcs_uploader-3a33d09 baidu</span><br></pre></td></tr></table></figure></p>
<p>这里我将文件夹名字修改成了baidu，需要注意的是，以后的默认文件夹名字可能有所不同，毕竟程序会升级，你需要看一下解压出来的文件夹名称是什么。<br>进入程序目录：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> baidu</span><br></pre></td></tr></table></figure></p>
<p>设置权限：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x bpcs_uploader.php</span><br></pre></td></tr></table></figure></p>
<p>运行程序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php</span><br></pre></td></tr></table></figure></p>
<p>你可能会看到出错提示，因为运行程序需要PHP环境，而你的服务器上的PHP路径可能与程序中设置的不同，修改一下程序文件bpcs_uploader.php中的PHP路径即可。<br>查看PHP路径：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">which</span> php</span><br></pre></td></tr></table></figure></p>
<p>编辑bpcs_uploader.php文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi bpcs_uploader.php</span><br></pre></td></tr></table></figure></p>
<p>将第一句#!后的路径修改为你的PHP路径，如果你安装的是WDCP一键包，路径为：/www/wdlinux/php/bin/php<br>登录百度开发者中心：<span class="exturl" data-url="aHR0cDovL2RldmVsb3Blci5iYWlkdS5jb20v" title="http://developer.baidu.com/">http://developer.baidu.com/<i class="fa fa-external-link"></i></span><br>创建一个Web应用，应用名称自定义，例如：huihuige，其他默认设置就可以了。<br>此时，我们可以得到该应用的API Key，运行./bpcs_uploader.php后首先要输入的就是Key。<br>另外我们还要在应用管理中找到API管理，开启PCS API，设置一个目录，该目录将用于存放服务器上传过来的数据。<br>温馨提示：开启PCS API时设置的目录不可更改，但可以在”操作”菜单中删除应用重建。<br>输入Key后，接下来需要输入app floder name，也就是刚才开启PCS API时设置的目录名称。<br>然后需要输入access token，将你的Key填入以下地址相应位置，在浏览器打开得到的地址：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://openapi.baidu.com/oauth/2.0/authorize?response_type=token&amp;client_id=KEY&amp;redirect_uri=oob&amp;scope=netdisk</span><br></pre></td></tr></table></figure></p>
<p>然后你会看到一个写着”百度 Oauth2.0”的页面，将浏览器地址栏中的URL复制下来，找到access_token=和&amp;之间的字符串，这就是access token，输入access token后就完成了，你会看到SSH终端显示出了你的百度云盘容量。<br>如果之前有安装过bpcs_uploader，那么可以执行以下命令初始化：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php init</span><br></pre></td></tr></table></figure></p>
<p>bpcs_uploader用法 查询容量：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php quota</span><br></pre></td></tr></table></figure></p>
<p>上传文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php upload [path_local] [path_remote]</span><br></pre></td></tr></table></figure></p>
<p>[path_local]是指服务器上的文件路径，[path_remote]是指百度云盘中的路径。<br>下载文件：<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php download <span class="string">[path_local]</span> <span class="string">[path_remote]</span></span><br></pre></td></tr></table></figure></p>
<p>删除文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php delete [path_remote]</span><br></pre></td></tr></table></figure></p>
<p>离线下载：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bpcs_uploader.php fetch [path_remote] [path_to_fetch]</span><br></pre></td></tr></table></figure></p>
<p>自动备份脚本 接下来需要设置自动备份数据，网上有许多自动备份脚本，所以我就不再复述了。<br>这里要介绍的是，由于我们多半都在Linux服务器上安装了控制面板，而控制面板都有自动备份数据的功能，比如WDCP就可以设置自动备份数据到/www/backup目录，那么我们就不再需要自动备份数据的脚本了，只需要一个脚本将备份目录下的所有文件上传到百度云盘即可。<br>下载脚本至baidu目录下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.huihuige.com/wp-content/uploads/2013/10/baidubd.zip</span><br></pre></td></tr></table></figure></p>
<p>解压：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip baidubd.zip</span><br></pre></td></tr></table></figure></p>
<p>这个脚本实用于WDCP面板用户，如果你的备份目录不同，可以打开脚本修改。<br>测试脚本是否有效：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sh baidubd.sh</span><br><span class="line">``` </span><br><span class="line">最后设置计划任务：</span><br><span class="line">``` bash</span><br><span class="line">crontab -e</span><br></pre></td></tr></table></figure></p>
<p>加入一行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0 * * * /root/baidu/baidubd.sh</span><br></pre></td></tr></table></figure></p>
<p>这里设置了每天的凌晨零点自动备份数据到百度云盘。</p>
<h2 id="python实现Linux命令行上传和下载百度云盘">python实现Linux命令行上传和下载百度云盘</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hvdXRpYW56ZS9ieXB5" title="https://github.com/houtianze/bypy">bypy<i class="fa fa-external-link"></i></span>:一个python写得百度网盘的linux客户端工具.</p>
<h3 id="下载">下载</h3><pre><code>git clone <span class="string">https:</span><span class="comment">//github.com/houtianze/bypy.git</span>
</code></pre><h3 id="要求">要求</h3><p><li>python &gt;=2.7</li></p>
<p><li>python需要Requests库</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line">&gt;&gt;&gt; import requests</span><br><span class="line">ImportError: No module named requests</span><br></pre></td></tr></table></figure></p>
<h3 id="使用">使用</h3><p>完成以上安装，cd至之前的bypy的目录下，运行下面的命令开始初始化<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> bypy</span><br><span class="line">./bypy.py list</span><br></pre></td></tr></table></figure></p>
<p>首先他会要求你访问一个网址，需要你授权，授权后复制code给程序，如果没有报错，就可以看到你的同步目录了，你可以在网盘的我的应用数据文件夹里找到bypy文件夹，他就是应用目录了。</p>
<p>如果你迫不及待的要测试，那就试试直接把当前目录上传至百度网盘<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bypy.py upload</span><br></pre></td></tr></table></figure></p>
<p>如果你想看到上传进度，请加入-v选项<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bypy.py -v upload</span><br></pre></td></tr></table></figure></p>
<h3 id="常用命令">常用命令</h3><p>./bypy.py list    查看目录</p>
<p>./bypy.py mkdir newdir    新建目录</p>
<p>./bypy.py upload <local_file或者dir> <remote_file或者dir>    上传</remote_file或者dir></local_file或者dir></p>
<p>./bypy.py downfile或者./bypy.py downdir    下载<br>./bypy.py delete filename<br>./bypy.py rm dir<br>用的时候注意用help查看一下参数的使用，其中remote path的/代表了apps/bypy/这个路径,且命令中的斜线/表示或，如“delete/remove/rm”表示delete，remove和rm三个命令。</p>
<h3 id="自动备份到百度云">自动备份到百度云</h3><p><li>编写备份bash</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># File:    home/bin/bypy/baidu_sync.sh</span></span><br><span class="line"><span class="comment"># Author:  hope</span></span><br><span class="line"><span class="comment"># Version: 1.0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Some vars</span></span><br><span class="line">UPLOAD_SCRIPTS_DIR=<span class="string">"/public/home/zpxu/scripts"</span></span><br><span class="line">DATE=`date +%F`</span><br><span class="line">DATE_YEAR=`date +%Y`</span><br><span class="line">DATE_MONTH=`date +%m`</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Backup</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$UPLOAD_SCRIPTS_DIR</span></span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czvf  scripts_<span class="variable">$DATE</span>.tar.gz <span class="variable">$UPLOAD_SCRIPTS_DIR</span></span><br><span class="line">/home/Python-2.7.10/./python /home/bin/bypy/./bypy.py mkdir scripts/<span class="variable">$DATE_YEAR</span>/<span class="variable">$DATE_MONTH</span></span><br><span class="line">/home/Python-2.7.10/./python /home/bin/bypy/./bypy.py -v upload scripts_<span class="variable">$DATE</span>.tar.gz scripts/<span class="variable">$DATE_YEAR</span>/<span class="variable">$DATE_MONTH</span></span><br><span class="line">rm scripts_<span class="variable">$DATE</span>.tar.gz</span><br><span class="line">/home/Python-2.7.10/./python /home/bin/bypy/./bypy.py list</span><br></pre></td></tr></table></figure></p>
<p><li>设置cron定时执行</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ crontab -e</span><br></pre></td></tr></table></figure></p>
<p>此时会启动默认编辑器vim，添加以下内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># backup my scripts to baidu</span></span><br><span class="line">40 1 * * * &lt;备份bash目录/baidu_sync.sh&gt;</span><br></pre></td></tr></table></figure></p>
<p>以上内容意义为：每一行由空格分割为6部分，依次为”分钟”、”小时”、”日”、”月”、”星期”、”要执行的程序”。<br>备份操作可能消耗大量资源和时间，应该设置在凌晨访问量小、系统负载低的时候运行。如果有独立的服务器存储备份文件，还可以在脚本中增加ftp或者email传送备份文件到远程服务器的功能。</p>
<p></p><p></p><br><i class="fa fa-blind" aria-hidden="true"></i><strong>百度限制上传/下载数度，所以对于较大文件的转移不是很方便，上传时至少可以打包压缩下，至于下载目前还不知道有何良策。</strong><p></p>
<p></p><p></p><br><i class="fa fa-sign-language" aria-hidden="true"></i><strong>由于百度权限问题，使用百度云备份需要差不多一个月跟新一次授权，否则报错</strong><br><code>OpenShift server failed, authorizing/refreshing with the Heroku server …<code><br><strong>跟新授权办法如下：</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">运行bypy.py -c，删除令牌文件，然后重新授权一次。</span><br><span class="line">如果还不行，去百度应用授权（https://passport.baidu.com/accountbind） 里删除bypy再重新授权。</span><br></pre></td></tr></table></figure><p></p>
<p></p><p></p><br>Contribution from ：<br><span class="exturl" data-url="aHR0cDovL3d3dy5sb3ZlbHVjeS5pbmZvL2F1dG8tYmFja3VwLXdlYnNpdGUtc2hlbGwtc2NyaXB0Lmh0bWw=" title="http://www.lovelucy.info/auto-backup-website-shell-script.html">http://www.lovelucy.info/auto-backup-website-shell-script.html<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hvdXRpYW56ZS9ieXB5L2lzc3Vlcy8xOTk=" title="https://github.com/houtianze/bypy/issues/199">https://github.com/houtianze/bypy/issues/199<i class="fa fa-external-link"></i></span><p></p>
</code></code>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;php实现Linux定时备份数据到百度云盘&quot;&gt;php实现Linux定时备份数据到百度云盘&lt;/h2&gt;&lt;p&gt;安装bpcs_uploader 虽然关于bpcs_uploader的教程不少，但都千篇一律。虽然网上也有很详细的教程，不过可能还有漏掉的细节。&lt;br&gt;废话不多说
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="Linux_backup" scheme="http://tiramisutes.github.io/tags/Linux-backup/"/>
    
  </entry>
  
  <entry>
    <title>关于Chrome的那些小技巧</title>
    <link href="http://tiramisutes.github.io/2015/07/25/chrome.html"/>
    <id>http://tiramisutes.github.io/2015/07/25/chrome.html</id>
    <published>2015-07-25T13:34:53.000Z</published>
    <updated>2019-03-16T13:14:23.422Z</updated>
    
    <content type="html"><![CDATA[<p>Chrome(<span class="exturl" data-url="aHR0cHM6Ly9kdWxpeml5b3UuY29tLyFkbC5nb29nbGUuY29tL3RhZy9zL2FwcGd1aWQlM0QlN0I4QTY5RDM0NS1ENTY0LTQ2M0MtQUZGMS1BNjlEOUU1MzBGOTYlN0QlMjZpaWQlM0QlN0JFQ0VCNEJERS04RTkyLTQzOUItOTVEMy0yNTQzN0UwMkJCMUMlN0QlMjZsYW5nJTNEemgtQ04lMjZicm93c2VyJTNENCUyNnVzYWdlc3RhdHMlM0QwJTI2YXBwbmFtZSUzREdvb2dsZSUyNTIwQ2hyb21lJTI2bmVlZHNhZG1pbiUzRHByZWZlcnMlMjZpbnN0YWxsZGF0YWluZGV4JTNEZGVmYXVsdGJyb3dzZXIvdXBkYXRlMi9pbnN0YWxsZXJzL0Nocm9tZVNldHVwLmV4ZQ==" title="https://duliziyou.com/!dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7BECEB4BDE-8E92-439B-95D3-25437E02BB1C%7D%26lang%3Dzh-CN%26browser%3D4%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dprefers%26installdataindex%3Ddefaultbrowser/update2/installers/ChromeSetup.exe">Download<i class="fa fa-external-link"></i></span>)是Google公司开发的一个现代化的网页浏览器，作为三大浏览器之一 它搭载了被称为V8的高效率Javascript引擎。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/chrome.png" alt=""></p> 

<p>由于简洁的界面风格 和便捷易用的特点 Chrome的市场份额已经升至45% ，一举超越了Internet Explorer和Mozilla Firefox成为全球第一大浏览器。</p>
<embed src="http://player.youku.com/player.php/sid/XMjMxOTkxNTMy/v.swf" allowfullscreen="true" quality="high" width="650" height="400" align="middle" allowscriptaccess="always" type="application/x-shockwave-flash">





<p>作为一个现代化的浏览器，就像智能手机的APP ，每装一个APP，意味着你的手机又多了一个功能。Chrome浏览器也是如此，Google</p>
<p>也提供了网上应用商店供人下载扩展自定义使用。</p>
<p>接下来我会介绍一些大家常用的扩展</p>
<h3 id="ABP广告过滤_/_Adblock_Plus">ABP广告过滤 / Adblock Plus</h3><p>超过5000万人使用，适用于 Chrome 的免费的广告拦截器，可阻止所有烦人的广告及恶意软件和跟踪。<br>享受没有恼人广告的网络世界。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnaugo0rnj20gc0a4ab7.jpg" alt=""></p> 


<h3 id="更好的历史记录_/_Better_History">更好的历史记录 / Better History</h3><p>替换浏览器自带的历史查看页面。本扩展能更好地查看您的历史记录。为查看您的历史记录带来最好的搜索体验，最清晰的界<br>面和最有帮助的筛选</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnawzvjabj20hd0b2404.jpg" alt=""></p> 


<h3 id="印象笔记_剪藏_/_Evernote_Web_Clipper">印象笔记 剪藏 / Evernote Web Clipper</h3><p>使用印象笔记扩展程序一键保存精彩网页内容到印象笔记帐户。<br>印象笔记•剪藏，以最快的速度，帮你保存网页、截取屏幕、添加标注、轻松归档，随时随地快速找到所需一切.。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnazdgwsmj20h00a1jso.jpg" alt=""></p> 

<h3 id="网页截图:注释&amp;批注">网页截图:注释&amp;批注</h3><p>捕获整个页面或任何部分，矩形，圆形，箭头，线条和文字，模糊敏感信息，一键上传分享注释。支持PNG和链接。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnb82kafbj20gu091tb4.jpg" alt=""></p> 


<h3 id="网易云音乐">网易云音乐</h3><p>不用打开网页，收听网易云音乐，更简单更易用。<br>网易云音乐Chrome扩展，追求简单体验，不用打开网页不用客户端即可收听网易云音乐，歌单，大牌DJ，我的收藏。与其他<br>终端同步，更简单，更易用。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnbakh6naj20h00amq51.jpg" alt=""></p><br>###SimpleUndoClose<br>简单的恢复您曾经关闭的网站标签<br><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epnbwmw11zj20c10atmyl.jpg" alt=""></p><br>###Pocket<br>轻松地保存文章、视频等供以后查看。有了 Pocket，您的所有内容可汇聚到一个地方，以便在任何设备上随时查看。甚至不需<br>要网络连接。<br><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epncrnf0zdj20gw0avwf9.jpg" alt=""></p><br>###没有PDF阅览器 没关系 直接把pdf文件拖到Chrome窗口里面就可以查看：<br><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/6d9bd6a5gw1epng1lmxp9j21kw17kdpq.jpg" alt=""></p> 





<h3 id="重要的网页标签可以固定_防止误关闭(pin_tab)">重要的网页标签可以固定 防止误关闭(pin tab)</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pin%20tab.jpg" alt=""></p> 



]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Chrome(&lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cHM6Ly9kdWxpeml5b3UuY29tLyFkbC5nb29nbGUuY29tL3RhZy9zL2FwcGd1aWQlM0QlN0I4QTY5RDM0NS1ENTY0LTQ2M0M
    
    </summary>
    
      <category term="Google" scheme="http://tiramisutes.github.io/categories/Google/"/>
    
    
      <category term="Chrome Plug-in" scheme="http://tiramisutes.github.io/tags/Chrome-Plug-in/"/>
    
  </entry>
  
  <entry>
    <title>CummeRbund</title>
    <link href="http://tiramisutes.github.io/2015/07/25/CummeRbund.html"/>
    <id>http://tiramisutes.github.io/2015/07/25/CummeRbund.html</id>
    <published>2015-07-25T09:31:20.000Z</published>
    <updated>2018-09-28T02:32:27.123Z</updated>
    
    <content type="html"><![CDATA[<p>CummeRbund was designed to help simplify the analysis and exploration portion of RNA-Seq data derrived from the output of a differential expression analysis using cuffdiff with the goal of providing fast and intuitive access to your results.</p>
<h3 id="Command:">Command:</h3><pre><code class="bash">$ <span class="built_in">cd</span> cuffdiff
$ R
&gt; library(cummeRbund)
&gt; cuff&lt;-readCufflinks()
&gt; cuff
</code></pre>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cummeRbund.png" alt=""></p> ]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CummeRbund was designed to help simplify the analysis and exploration portion of RNA-Seq data derrived from the output of a differential 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="CummeRbund" scheme="http://tiramisutes.github.io/tags/CummeRbund/"/>
    
  </entry>
  
  <entry>
    <title>转录组分析之--Cufflinks（很简单）</title>
    <link href="http://tiramisutes.github.io/2015/07/25/Cufflinks.html"/>
    <id>http://tiramisutes.github.io/2015/07/25/Cufflinks.html</id>
    <published>2015-07-25T09:31:08.000Z</published>
    <updated>2017-11-05T03:11:25.560Z</updated>
    
    <content type="html"><![CDATA[<p>Cufflinks assembles transcripts, estimates their abundances, and tests for differential expression and regulation in RNA-Seq samples. It accepts aligned RNA-Seq reads and assembles the alignments into a parsimonious set of transcripts. Cufflinks then estimates the relative abundances of these transcripts based on how many reads support each one, taking into account biases in library preparation protocols.</p>
<h2 id="Cufflinks:">Cufflinks:</h2><pre><code class="bash">cufflinks [options] &lt;aligned_reads.(sam/bam)&gt;
</code></pre>
<p>for example:</p>
<pre><code class="bash">$ cufflinks -p <span class="number">8</span> -G transcript.gtf --library-type fr-unstranded -o cufflinks_output tophat_out/accepted_hits.bam
  -o/--output-dir              write all output files to this directory              [ default:     ./ ]
  -p/--num-threads             number of threads used during analysis                [ default:      <span class="number">1</span> ]
  --seed                       value of random number generator seed                 [ default:      <span class="number">0</span> ]
  -G/--GTF                     quantitate against reference transcript annotations                      
  -g/--GTF-guide               use reference transcript annotation to guide assembly
</code></pre>
<h2 id="Cuffmerge:">Cuffmerge:</h2><p>Use to merge together several Cufflinks assemblies.</p>
<pre><code class="bash">cuffmerge [options]* &lt;assembly_GTF_list.txt&gt;
</code></pre>
<h3 id="Cuffmerge_input_files">Cuffmerge input files</h3><p>cuffmerge takes several assembly GTF files from Cufflinks’ as input. Input GTF files must be specified in a “manifest” file listing full paths to the files.</p>
<h3 id="Cuffmerge_arguments">Cuffmerge arguments</h3><pre><code class="bash">&lt;assembly_GTF_list.txt&gt;
</code></pre>
<p>Text file “manifest” with a list (one per line) of GTF files that you’d like to merge together into a single GTF file.</p>
<h2 id="Cuffdiff">Cuffdiff</h2><p>Use to find significant changes in transcript expression, splicing, and promoter use.</p>
<pre><code class="bash">cuffdiff [options]* &lt;transcripts.gtf&gt; \

&lt;sample1_replicate1.sam[,…,sample1_replicateM.sam]&gt; \

&lt;sample2_replicate1.sam[,…,sample2_replicateM.sam]&gt; … \

[sampleN.sam_replicate1.sam[,…,sample2_replicateM.sam]]
</code></pre>
<h3 id="Cuffdiff_output_Files">Cuffdiff output Files</h3><pre><code class="bash">gene_exp.diff    Gene-level differential expression. Tests differences <span class="keyword">in</span> the summed FPKM of transcripts sharing each gene_id
</code></pre>
<p><i class="fa fa-bullhorn"></i>cuffdiff过程中同一处理的多个样本间用逗号分隔，不同处理间空格分隔.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Cufflinks assembles transcripts, estimates their abundances, and tests for differential expression and regulation in RNA-Seq samples. It 
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="Cufflinks" scheme="http://tiramisutes.github.io/tags/Cufflinks/"/>
    
  </entry>
  
  <entry>
    <title>TopHat</title>
    <link href="http://tiramisutes.github.io/2015/07/25/TopHat.html"/>
    <id>http://tiramisutes.github.io/2015/07/25/TopHat.html</id>
    <published>2015-07-25T09:30:52.000Z</published>
    <updated>2015-07-25T11:45:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>TopHat is a fast splice junction mapper for RNA-Seq reads. It aligns RNA-Seq reads to mammalian-sized genomes using the ultra high-throughput short read aligner Bowtie, and then analyzes the mapping results to identify splice junctions between exons. </p>
<h2 id="Usage:">Usage:</h2><pre><code class="bash">tophat [options]* [reads1_2,...readsN_2]
</code></pre>
<p>for example:</p>
<pre><code class="bash">tophat -p <span class="number">8</span> -G genes.gtf -o C1_R1_thout genome C1_R1_1.fq C1_R1_2.fq
-p 代表线程
-G 代表转录本注释信息
-o 输出文件夹
--segment-length <span class="number">25</span> （将redas分成的最小比对片段）
--segment-mismatches <span class="number">1</span> （片段比对错配碱基数）
--library-type （是否链特异性）fr-unstranded
—transcriptome-index （转录本的bowtie-index文件）
</code></pre>
<p>比对输出文件：</p>
<pre><code class="bash">accepted_hits.bam（比对输出）
junctions.bed
insertions.bed and deletions.bed
</code></pre>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;TopHat is a fast splice junction mapper for RNA-Seq reads. It aligns RNA-Seq reads to mammalian-sized genomes using the ultra high-throug
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="tophat" scheme="http://tiramisutes.github.io/tags/tophat/"/>
    
  </entry>
  
  <entry>
    <title>Linux-sort</title>
    <link href="http://tiramisutes.github.io/2015/07/25/Linux-sort.html"/>
    <id>http://tiramisutes.github.io/2015/07/25/Linux-sort.html</id>
    <published>2015-07-25T06:21:10.000Z</published>
    <updated>2015-07-28T14:39:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>Sort is a Linux program used for printing lines of input text files and concatenation of all files in sorted order. Sort command takes blank space as field separator and entire Input file as sort key. It is important to notice that sort command don’t actually sort the files but only print the sorted output, until your redirect the output.</p>
<p>This article aims at deep insight of Linux ‘sort’ command with 14 useful practical examples that will show you how to use sort command in Linux.</p>
<h3 id="First_we_will_be_creating_a_text_file_(tecmint-txt)_to_execute_‘sort’_command_examples-_Our_working_directory_is_‘/home/$USER/Desktop/tecmint-">First we will be creating a text file (tecmint.txt) to execute ‘sort’ command examples. Our working directory is ‘/home/$USER/Desktop/tecmint.</h3><p>The option ‘-e’ in the below command enables interpretion of backslash and /n tells echo to write each string to a new line.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> -e <span class="string">"computer\nmouse\nLAPTOP\ndata\nRedHat\nlaptop\ndebian\nlaptop"</span> &gt; tecmint.txt</span><br></pre></td></tr></table></figure>
<h3 id="Before_we_start_with_‘sort’_lets_have_a_look_at_the_contents_of_the_file_and_the_way_it_look-">Before we start with ‘sort’ lets have a look at the contents of the file and the way it look.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat tecmint.txt</span><br></pre></td></tr></table></figure>
<h3 id="Now_sort_the_content_of_the_file_using_following_command-">Now sort the content of the file using following command.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sort tecmint.txt</span><br></pre></td></tr></table></figure>
<p>Note: The above command don’t actually sort the contents of text file but only show the sorted output on terminal.</p>
<h3 id="Sort_the_contents_of_the_file_‘tecmint-txt’_and_write_it_to_a_file_called_(sorted-txt)_and_verify_the_content_by_using_cat_command-">Sort the contents of the file ‘tecmint.txt’ and write it to a file called (sorted.txt) and verify the content by using cat command.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sort tecmint.txt &gt; sorted.txt</span><br><span class="line">$ cat sorted.txt</span><br></pre></td></tr></table></figure>
<h3 id="Now_sort_the_contents_of_text_file_‘tecmint-txt’_in_reverse_order_by_using_‘-r’_switch_and_redirect_output_to_a_file_‘reversesorted-txt’-_Also_check_the_content_listing_of_the_newly_created_file-">Now sort the contents of text file ‘tecmint.txt’ in reverse order by using ‘-r’ switch and redirect output to a file ‘reversesorted.txt’. Also check the content listing of the newly created file.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sort -r tecmint.txt &gt; reversesorted.txt</span><br><span class="line">$ cat reversesorted.txt</span><br></pre></td></tr></table></figure>
<h3 id="We_are_going_a_create_a_new_file_(lsl-txt)_at_the_same_location_for_detailed_examples_and_populate_it_using_the_output_of_‘ls_-l’_for_your_home_directory-">We are going a create a new file (lsl.txt) at the same location for detailed examples and populate it using the output of ‘ls -l’ for your home directory.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l /home/<span class="variable">$USER</span> &gt; /home/<span class="variable">$USER</span>/Desktop/tecmint/lsl.txt</span><br><span class="line">$ cat lsl.txt</span><br></pre></td></tr></table></figure>
<p>Now will see examples to sort the contents on the basis of other field and not the default initial characters.</p>
<h3 id="Sort_the_contents_of_file_‘lsl-txt’_on_the_basis_of_2nd_column_(which_represents_number_of_symbolic_links)-">Sort the contents of file ‘lsl.txt’ on the basis of 2nd column (which represents number of symbolic links).</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sort -nk2 lsl.txt</span><br></pre></td></tr></table></figure>
<p>Note: The ‘-n’ option in the above example sort the contents numerically. Option ‘-n’ must be used when we wanted to sort a file on the basis of a column which contains numerical values.</p>
<h3 id="Sort_the_contents_of_file_‘lsl-txt’_on_the_basis_of_9th_column_(which_is_the_name_of_the_files_and_folders_and_is_non-numeric)-">Sort the contents of file ‘lsl.txt’ on the basis of 9th column (which is the name of the files and folders and is non-numeric).</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sort -k9 lsl.txt</span><br></pre></td></tr></table></figure>
<h3 id="It_is_not_always_essential_to_run_sort_command_on_a_file-_We_can_pipeline_it_directly_on_the_terminal_with_actual_command-">It is not always essential to run sort command on a file. We can pipeline it directly on the terminal with actual command.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l /home/<span class="variable">$USER</span> | sort -nk5</span><br></pre></td></tr></table></figure>
<h3 id="Sort_and_remove_duplicates_from_the_text_file_tecmint-txt-_Check_if_the_duplicate_has_been_removed_or_not-">Sort and remove duplicates from the text file tecmint.txt. Check if the duplicate has been removed or not.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat tecmint.txt</span><br><span class="line">$ sort -u tecmint.txt</span><br></pre></td></tr></table></figure>
<p>Rules so far (what we have observed):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Lines starting with numbers are preferred <span class="keyword">in</span> the list and lies at the top until otherwise specified (-r).</span><br><span class="line">Lines starting with lowercase letters are preferred <span class="keyword">in</span> the list and lies at the top until otherwise specified (-r).</span><br><span class="line">Contents are listed on the basis of occurrence of alphabets <span class="keyword">in</span> dictionary until otherwise specified (-r).</span><br><span class="line">Sort <span class="built_in">command</span> by default treat each line as string and <span class="keyword">then</span> sort it depending upon dictionary occurrence of alphabets (Numeric preferred; see rule – 1) until otherwise specified.</span><br></pre></td></tr></table></figure></p>
<h3 id="Create_a_third_file_‘lsla-txt’_at_the_current_location_and_populate_it_with_the_output_of_‘ls_-lA’_command-">Create a third file ‘lsla.txt’ at the current location and populate it with the output of ‘ls -lA’ command.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls -lA /home/<span class="variable">$USER</span> &gt; /home/<span class="variable">$USER</span>/Desktop/tecmint/lsla.txt</span><br><span class="line">$ cat lsla.txt</span><br></pre></td></tr></table></figure>
<p>Those having understanding of ‘ls’ command knows that ‘ls -lA’=’ls -l’ + Hidden files. So most of the contents on these two files would be same.</p>
<h3 id="Sort_the_contents_of_two_files_on_standard_output_in_one_go-">Sort the contents of two files on standard output in one go.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sort lsl.txt lsla.txt</span><br></pre></td></tr></table></figure>
<p>Notice the repetition of files and folders.</p>
<h3 id="Now_we_can_see_how_to_sort,_merge_and_remove_duplicates_from_these_two_files-">Now we can see how to sort, merge and remove duplicates from these two files.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sort -u lsl.txt lsla.txt</span><br></pre></td></tr></table></figure>
<p>Notice that duplicates has been omitted from the output. Also, you can write the output to a new file by redirecting the output to a file.</p>
<h3 id="We_may_also_sort_the_contents_of_a_file_or_the_output_based_upon_more_than_one_column-_Sort_the_output_of_‘ls_-l’_command_on_the_basis_of_field_2,5_(Numeric)_and_9_(Non-Numeric)-">We may also sort the contents of a file or the output based upon more than one column. Sort the output of ‘ls -l’ command on the basis of field 2,5 (Numeric) and 9 (Non-Numeric).</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls -l /home/<span class="variable">$USER</span> | sort -t <span class="string">","</span> -nk2,5 -k9</span><br></pre></td></tr></table></figure>
<p>That’s all for now. In the next article we will cover a few more examples of ‘sort’ command in detail for you. Till then stay tuned and connected to Tecmint. Keep sharing. Keep commenting. Like and share us and help us get spread.</p>
<p>More info: <span class="exturl" data-url="aHR0cDovL3d3dy50ZWNtaW50LmNvbS9zb3J0LWNvbW1hbmQtbGludXgv" title="http://www.tecmint.com/sort-command-linux/">sort<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sort is a Linux program used for printing lines of input text files and concatenation of all files in sorted order. Sort command takes bl
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://tiramisutes.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>FASTX-Toolkit</title>
    <link href="http://tiramisutes.github.io/2015/07/24/FASTX-Toolkit.html"/>
    <id>http://tiramisutes.github.io/2015/07/24/FASTX-Toolkit.html</id>
    <published>2015-07-24T14:51:33.000Z</published>
    <updated>2018-09-28T02:34:10.324Z</updated>
    
    <content type="html"><![CDATA[<p>Here you’ll find a short description and examples of how to use the FASTX-toolkit from the command line.</p>
<h2 id="Command_Line_Arguments">Command Line Arguments</h2><p>Most tools show usage information with -h.<br>Tools can read from STDIN and write to STDOUT, or<br>from a specific input file (-i) and specific output file (-o).<br>Tools can operate silently (producing no output if everything was OK), or<br>print a short summary (-v).<br>If output goes to STDOUT, the summary will be printed to STDERR.<br>If output goes to a file, the summary will be printed to STDOUT.<br>Some tools can compress the output with GZIP (-z).</p>
<h3 id="FASTQ-to-FASTA">FASTQ-to-FASTA</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ fastq_to_fasta -h</span><br><span class="line">usage: fastq_to_fasta [-h] [-r] [-n] [-v] [-z] [-i INFILE] [-o OUTFILE]</span><br><span class="line"></span><br><span class="line">version 0.0.6</span><br><span class="line">   [-h]         = This helpful <span class="built_in">help</span> screen.</span><br><span class="line">   [-r]         = Rename sequence identifiers to numbers.</span><br><span class="line">   [-n]         = keep sequences with unknown (N) nucleotides.</span><br><span class="line">		  Default is to discard such sequences.</span><br><span class="line">   [-v]         = Verbose - report number of sequences.</span><br><span class="line">		  If [-o] is specified,  report will be printed to STDOUT.</span><br><span class="line">		  If [-o] is not specified (and output goes to STDOUT),</span><br><span class="line">		  report will be printed to STDERR.</span><br><span class="line">   [-z]         = Compress output with GZIP.</span><br><span class="line">   [-i INFILE]  = FASTA/Q input file. default is STDIN.</span><br><span class="line">   [-o OUTFILE] = FASTA output file. default is STDOUT.</span><br></pre></td></tr></table></figure>
<h3 id="FASTX_Statistics">FASTX Statistics</h3><pre><code>$ fastx_quality_stats -<span class="literal">h</span>
usage: fastx_quality_stats [-<span class="keyword">h</span>] [-i <span class="keyword">INFILE</span>] [-o <span class="keyword">OUTFILE</span>]

<span class="keyword">version</span> 0.0.6 (C) 2008 <span class="keyword">by</span> Assaf Gordon (gordon@cshl.edu)
   [-<span class="keyword">h</span>] = This helpful <span class="keyword">help</span> screen.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> <span class="keyword">file</span>. default is STDIN.
                  <span class="keyword">If</span> FASTA <span class="keyword">file</span> is given, only nucleotides
          distribution is calculated (there's <span class="keyword">no</span> quality info).
   [-o <span class="keyword">OUTFILE</span>] = TEXT output <span class="keyword">file</span>. default is STDOUT.

The output TEXT <span class="keyword">file</span> will have the following fields (<span class="keyword">one</span> row per column):
    column    = column number (1 to 36 <span class="keyword">for</span> a 36-cycles <span class="keyword">read</span> solexa <span class="keyword">file</span>)
    <span class="keyword">count</span>   = number of bases found <span class="keyword">in</span> this column.
    min     = Lowest quality <span class="keyword">score</span> value found <span class="keyword">in</span> this column.
    max     = Highest quality <span class="keyword">score</span> value found <span class="keyword">in</span> this column.
    <span class="keyword">sum</span>     = <span class="keyword">Sum</span> of quality <span class="keyword">score</span> values <span class="keyword">for</span> this column.
    <span class="keyword">mean</span>    = <span class="keyword">Mean</span> quality <span class="keyword">score</span> value <span class="keyword">for</span> this column.
    Q1    = 1st quartile quality <span class="keyword">score</span>.
    med    = <span class="keyword">Median</span> quality <span class="keyword">score</span>.
    Q3    = 3rd quartile quality <span class="keyword">score</span>.
    IQR    = Inter-Quartile <span class="keyword">range</span> (Q3-Q1).
    lW    = 'Left-Whisker' value (<span class="keyword">for</span> boxplotting).
    rW    = 'Right-Whisker' value (<span class="keyword">for</span> boxplotting).
    A_Count    = <span class="keyword">Count</span> of 'A' nucleotides found <span class="keyword">in</span> this column.
    C_Count    = <span class="keyword">Count</span> of 'C' nucleotides found <span class="keyword">in</span> this column.
    G_Count    = <span class="keyword">Count</span> of '<span class="keyword">G</span>' nucleotides found <span class="keyword">in</span> this column.
    T_Count    = <span class="keyword">Count</span> of 'T' nucleotides found <span class="keyword">in</span> this column.
    N_Count = <span class="keyword">Count</span> of '<span class="keyword">N</span>' nucleotides found <span class="keyword">in</span> this column.
    max-<span class="keyword">count</span> = max. number of bases (<span class="keyword">in</span> all cycles)
</code></pre><h3 id="FASTQ_Quality_Chart">FASTQ Quality Chart</h3><pre><code>$ fastq_quality_boxplot_graph.<span class="keyword">sh</span> -<span class="literal">h</span>
Solexa-Quality BoxPlot plotter
Generates a solexa quality <span class="keyword">score</span> box-<span class="keyword">plot</span> <span class="keyword">graph</span> 

Usage: /usr/<span class="keyword">local</span>/bin/fastq_quality_boxplot_graph.<span class="keyword">sh</span> [-i <span class="keyword">INPUT</span>.TXT] [-t TITLE] [-p] [-o OUTPUT]

  [-p]           - <span class="keyword">Generate</span> PostScript (.PS) <span class="keyword">file</span>. Default is PNG image.
  [-i <span class="keyword">INPUT</span>.TXT] - <span class="keyword">Input</span> <span class="keyword">file</span>. Should be the output of <span class="string">"solexa_quality_statistics"</span> <span class="keyword">program</span>.
  [-o OUTPUT]    - Output <span class="keyword">file</span> name. default is STDOUT.
  [-t TITLE]     - Title (usually the solexa <span class="keyword">file</span> name) - will be plotted <span class="keyword">on</span> the <span class="keyword">graph</span>.
</code></pre><h3 id="FASTA/Q_Nucleotide_Distribution">FASTA/Q Nucleotide Distribution</h3><pre><code>$ fastx_nucleotide_distribution_graph.<span class="keyword">sh</span> -<span class="literal">h</span>
FASTA/Q Nucleotide Distribution Plotter

Usage: /usr/<span class="keyword">local</span>/bin/fastx_nucleotide_distribution_graph.<span class="keyword">sh</span> [-i <span class="keyword">INPUT</span>.TXT] [-t TITLE] [-p] [-o OUTPUT]

  [-p]           - <span class="keyword">Generate</span> PostScript (.PS) <span class="keyword">file</span>. Default is PNG image.
  [-i <span class="keyword">INPUT</span>.TXT] - <span class="keyword">Input</span> <span class="keyword">file</span>. Should be the output of <span class="string">"fastx_quality_statistics"</span> <span class="keyword">program</span>.
  [-o OUTPUT]    - Output <span class="keyword">file</span> name. default is STDOUT.
  [-t TITLE]     - Title - will be plotted <span class="keyword">on</span> the <span class="keyword">graph</span>.
</code></pre><h3 id="FASTA/Q_Clipper">FASTA/Q Clipper</h3><pre><code>$ fastx_clipper -h
usage: fastx_clipper [-h] [-a ADAPTER] [-D] [-l N] [-n] [-d N] [-c] [-C] [-o] [-v] [-z] [-i INFILE] [-o OUTFILE]

version 0.0.6
   [-h]         = This helpful <span class="operator"><span class="keyword">help</span> screen.
   [-a ADAPTER] = ADAPTER <span class="keyword">string</span>. <span class="keyword">default</span> <span class="keyword">is</span> CCTTAAGG (dummy adapter).
   [-l N]       = discard sequences shorter than N nucleotides. <span class="keyword">default</span> <span class="keyword">is</span> <span class="number">5.</span>
   [-d N]       = Keep the adapter <span class="keyword">and</span> N bases <span class="keyword">after</span> it.
          (<span class="keyword">using</span> <span class="string">'-d 0'</span> <span class="keyword">is</span> the same <span class="keyword">as</span> <span class="keyword">not</span> <span class="keyword">using</span> <span class="string">'-d'</span> <span class="keyword">at</span> <span class="keyword">all</span>. which <span class="keyword">is</span> the <span class="keyword">default</span>).
   [-c]         = Discard non-clipped sequences (i.e. - keep <span class="keyword">only</span> sequences which contained the adapter).
   [-C]         = Discard clipped sequences (i.e. - keep <span class="keyword">only</span> sequences which did <span class="keyword">not</span> contained the adapter).
   [-k]         = Report Adapter-<span class="keyword">Only</span> sequences.
   [-n]         = keep sequences <span class="keyword">with</span> <span class="keyword">unknown</span> (N) nucleotides. <span class="keyword">default</span> <span class="keyword">is</span> <span class="keyword">to</span> discard such sequences.
   [-v]         = Verbose - report <span class="built_in">number</span> <span class="keyword">of</span> sequences.
          <span class="keyword">If</span> [-o] <span class="keyword">is</span> specified,  report will be printed <span class="keyword">to</span> STDOUT.
          <span class="keyword">If</span> [-o] <span class="keyword">is</span> <span class="keyword">not</span> specified (<span class="keyword">and</span> <span class="keyword">output</span> goes <span class="keyword">to</span> STDOUT),
          report will be printed <span class="keyword">to</span> STDERR.
   [-z]         = <span class="keyword">Compress</span> <span class="keyword">output</span> <span class="keyword">with</span> GZIP.
   [-D]        = DEBUG <span class="keyword">output</span>.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q <span class="keyword">output</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDOUT.</span>
</code></pre><h3 id="FASTA/Q_Renamer">FASTA/Q Renamer</h3><pre><code>$ fastx_renamer -<span class="literal">h</span>
usage: fastx_renamer [-<span class="keyword">n</span> <span class="keyword">TYPE</span>] [-<span class="keyword">h</span>] [-z] [-v] [-i <span class="keyword">INFILE</span>] [-o <span class="keyword">OUTFILE</span>]
Part of FASTX Toolkit 0.0.10 <span class="keyword">by</span> A. Gordon (gordon@cshl.edu)

   [-<span class="keyword">n</span> <span class="keyword">TYPE</span>]    = <span class="keyword">rename</span> <span class="keyword">type</span>:
          SEQ - <span class="keyword">use</span> the nucleotides sequence <span class="keyword">as</span> the name.
          <span class="keyword">COUNT</span> - <span class="keyword">use</span> simply counter <span class="keyword">as</span> the name.
   [-<span class="keyword">h</span>]         = This helpful <span class="keyword">help</span> screen.
   [-z]         = <span class="keyword">Compress</span> output with GZIP.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> <span class="keyword">file</span>. default is STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q output <span class="keyword">file</span>. default is STDOUT.
</code></pre><h3 id="FASTA/Q_Trimmer">FASTA/Q Trimmer</h3><pre><code>$ fastx_trimmer -h
usage: fastx_trimmer [-h] [-f N] [-l N] [-z] [-v] [-i INFILE] [-o OUTFILE]

version 0.0.6
   [-h]         = This helpful <span class="operator"><span class="keyword">help</span> screen.
   [-f N]       = <span class="keyword">First</span> base <span class="keyword">to</span> keep. <span class="keyword">Default</span> <span class="keyword">is</span> <span class="number">1</span> (=<span class="keyword">first</span> base).
   [-l N]       = <span class="keyword">Last</span> base <span class="keyword">to</span> keep. <span class="keyword">Default</span> <span class="keyword">is</span> entire <span class="keyword">read</span>.
   [-z]         = <span class="keyword">Compress</span> <span class="keyword">output</span> <span class="keyword">with</span> GZIP.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q <span class="keyword">output</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDOUT.</span>
</code></pre><h3 id="FASTA/Q_Collapser">FASTA/Q Collapser</h3><pre><code>$ fastx_collapser -<span class="literal">h</span>
usage: fastx_collapser [-<span class="keyword">h</span>] [-v] [-i <span class="keyword">INFILE</span>] [-o <span class="keyword">OUTFILE</span>]

<span class="keyword">version</span> 0.0.6
   [-<span class="keyword">h</span>]         = This helpful <span class="keyword">help</span> screen.
   [-v]         = verbose: <span class="keyword">print</span> short summary of <span class="keyword">input</span>/output counts
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> <span class="keyword">file</span>. default is STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q output <span class="keyword">file</span>. default is STDOUT.
</code></pre><h3 id="FASTQ/A_Artifacts_Filter">FASTQ/A Artifacts Filter</h3><pre><code>$ fastx_artifacts_filter -h
usage: fastq_artifacts_filter [-h] [-v] [-z] [-i INFILE] [-o OUTFILE]

version 0.0.6
   [-h]         = This helpful <span class="operator"><span class="keyword">help</span> screen.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q <span class="keyword">output</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDOUT.
   [-z]         = <span class="keyword">Compress</span> <span class="keyword">output</span> <span class="keyword">with</span> GZIP.
   [-v]         = Verbose - report <span class="built_in">number</span> <span class="keyword">of</span> processed reads.
          <span class="keyword">If</span> [-o] <span class="keyword">is</span> specified,  report will be printed <span class="keyword">to</span> STDOUT.
          <span class="keyword">If</span> [-o] <span class="keyword">is</span> <span class="keyword">not</span> specified (<span class="keyword">and</span> <span class="keyword">output</span> goes <span class="keyword">to</span> STDOUT),
          report will be printed <span class="keyword">to</span> STDERR.</span>
</code></pre><h3 id="FASTQ_Quality_Filter">FASTQ Quality Filter</h3><pre><code>$ <span class="atom">fastq_quality_filter</span> -<span class="atom">h</span>
<span class="atom">usage</span>: <span class="atom">fastq_quality_filter</span> [-<span class="atom">h</span>] [-<span class="atom">v</span>] [-<span class="atom">q</span> <span class="name">N</span>] [-<span class="atom">p</span> <span class="name">N</span>] [-<span class="atom">z</span>] [-<span class="atom">i</span> <span class="name">INFILE</span>] [-<span class="atom">o</span> <span class="name">OUTFILE</span>]

<span class="atom">version</span> <span class="number">0.0</span>.6
   [-<span class="atom">h</span>]         = <span class="name">This</span> <span class="atom">helpful</span> <span class="atom">help</span> <span class="atom">screen</span>.
   [-<span class="atom">q</span> <span class="name">N</span>]       = <span class="name">Minimum</span> <span class="atom">quality</span> <span class="atom">score</span> <span class="atom">to</span> <span class="atom">keep</span>.
   [-<span class="atom">p</span> <span class="name">N</span>]       = <span class="name">Minimum</span> <span class="atom">percent</span> <span class="atom">of</span> <span class="atom">bases</span> <span class="atom">that</span> <span class="atom">must</span> <span class="atom">have</span> [-<span class="atom">q</span>] <span class="atom">quality</span>.
   [-<span class="atom">z</span>]         = <span class="name">Compress</span> <span class="atom">output</span> <span class="atom">with</span> <span class="name">GZIP</span>.
   [-<span class="atom">i</span> <span class="name">INFILE</span>]  = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">input</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDIN</span>.
   [-<span class="atom">o</span> <span class="name">OUTFILE</span>] = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">output</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDOUT</span>.
   [-<span class="atom">v</span>]         = <span class="name">Verbose</span> - <span class="atom">report</span> <span class="atom">number</span> <span class="atom">of</span> <span class="atom">sequences</span>.
          <span class="name">If</span> [-<span class="atom">o</span>] <span class="atom">is</span> <span class="atom">specified</span>,  <span class="atom">report</span> <span class="atom">will</span> <span class="atom">be</span> <span class="atom">printed</span> <span class="atom">to</span> <span class="name">STDOUT</span>.
          <span class="name">If</span> [-<span class="atom">o</span>] <span class="atom">is</span> <span class="atom">not</span> <span class="atom">specified</span> (<span class="atom">and</span> <span class="atom">output</span> <span class="atom">goes</span> <span class="atom">to</span> <span class="name">STDOUT</span>),
          <span class="atom">report</span> <span class="atom">will</span> <span class="atom">be</span> <span class="atom">printed</span> <span class="atom">to</span> <span class="name">STDERR</span>.
</code></pre><h3 id="FASTQ/A_Reverse_Complement">FASTQ/A Reverse Complement</h3><pre><code>$ <span class="atom">fastx_reverse_complement</span> -<span class="atom">h</span>
<span class="atom">usage</span>: <span class="atom">fastx_reverse_complement</span> [-<span class="atom">h</span>] [-<span class="atom">r</span>] [-<span class="atom">z</span>] [-<span class="atom">v</span>] [-<span class="atom">i</span> <span class="name">INFILE</span>] [-<span class="atom">o</span> <span class="name">OUTFILE</span>]

<span class="atom">version</span> <span class="number">0.0</span>.6
   [-<span class="atom">h</span>]         = <span class="name">This</span> <span class="atom">helpful</span> <span class="atom">help</span> <span class="atom">screen</span>.
   [-<span class="atom">z</span>]         = <span class="name">Compress</span> <span class="atom">output</span> <span class="atom">with</span> <span class="name">GZIP</span>.
   [-<span class="atom">i</span> <span class="name">INFILE</span>]  = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">input</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDIN</span>.
   [-<span class="atom">o</span> <span class="name">OUTFILE</span>] = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">output</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDOUT</span>.
</code></pre><h3 id="FASTA_Formatter">FASTA Formatter</h3><pre><code>$ fasta_formatter -h
usage: fasta_formatter [-h] [-i INFILE] [-o OUTFILE] [-w N] [-t] [-e]
Part of FASTX Toolkit 0.0.7 by gordon@cshl.edu

   [-h]         = This helpful <span class="operator"><span class="keyword">help</span> screen.
   [-i <span class="keyword">INFILE</span>]  = FASTA/Q <span class="keyword">input</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDIN.
   [-o <span class="keyword">OUTFILE</span>] = FASTA/Q <span class="keyword">output</span> file. <span class="keyword">default</span> <span class="keyword">is</span> STDOUT.
   [-w N]       = <span class="keyword">max</span>. sequence line width <span class="keyword">for</span> <span class="keyword">output</span> FASTA file.
          <span class="keyword">When</span> ZERO (the <span class="keyword">default</span>), sequence <span class="keyword">lines</span> will <span class="keyword">NOT</span> be wrapped -
          <span class="keyword">all</span> nucleotides <span class="keyword">of</span> <span class="keyword">each</span> sequences will appear <span class="keyword">on</span> a single 
          line (good <span class="keyword">for</span> scripting).
   [-t]         = <span class="keyword">Output</span> tabulated <span class="keyword">format</span> (instead <span class="keyword">of</span> FASTA <span class="keyword">format</span>).
          Sequence-Identifiers will be <span class="keyword">on</span> <span class="keyword">first</span> <span class="keyword">column</span>,
          Nucleotides will appear <span class="keyword">on</span> <span class="keyword">second</span> <span class="keyword">column</span> (<span class="keyword">as</span> single line).
   [-e]         = <span class="keyword">Output</span> empty sequences (<span class="keyword">default</span> <span class="keyword">is</span> <span class="keyword">to</span> discard them).
          Empty sequences <span class="keyword">are</span> ones who have <span class="keyword">only</span> a sequence identifier,
          but <span class="keyword">not</span> actual nucleotides.

<span class="keyword">Input</span> Example:
   &gt;MY-ID
   AAAAAGGGGG
   CCCCCTTTTT
   AGCTN

<span class="keyword">Output</span> example <span class="keyword">with</span> unlimited line width [-w <span class="number">0</span>]:
   &gt;MY-ID
   AAAAAGGGGGCCCCCTTTTTAGCTN

<span class="keyword">Output</span> example <span class="keyword">with</span> <span class="keyword">max</span>. line width=<span class="number">7</span> [-w <span class="number">7</span>]:
   &gt;MY-ID
   AAAAAGG
   GGGTTTT
   TCCCCCA
   GCTN

<span class="keyword">Output</span> example <span class="keyword">with</span> tabular <span class="keyword">output</span> [-t]:
   MY-ID    AAAAAGGGGGCCCCCTTTTAGCTN

example <span class="keyword">of</span> empty sequence:
(will be discarded unless [-e] <span class="keyword">is</span> used)
  &gt;REGULAR-SEQUENCE-<span class="number">1</span>
  AAAGGGTTTCCC
  &gt;EMPTY-SEQUENCE
  &gt;REGULAR-SEQUENCE-<span class="number">2</span>
  AAGTAGTAGTAGTAGT
  GTATTTTATAT</span>
</code></pre><h3 id="FASTA_Nucleotides_Changer">FASTA Nucleotides Changer</h3><pre><code>$ <span class="atom">fasta_nucleotide_changer</span> -<span class="atom">h</span>
<span class="atom">usage</span>: <span class="atom">fasta_nucleotide_changer</span> [-<span class="atom">h</span>] [-<span class="atom">z</span>] [-<span class="atom">v</span>] [-<span class="atom">i</span> <span class="name">INFILE</span>] [-<span class="atom">o</span> <span class="name">OUTFILE</span>] [-<span class="atom">r</span>] [-<span class="atom">d</span>]

<span class="atom">version</span> <span class="number">0.0</span>.7
   [-<span class="atom">h</span>]         = <span class="name">This</span> <span class="atom">helpful</span> <span class="atom">help</span> <span class="atom">screen</span>.
   [-<span class="atom">z</span>]         = <span class="name">Compress</span> <span class="atom">output</span> <span class="atom">with</span> <span class="name">GZIP</span>.
   [-<span class="atom">v</span>]         = <span class="name">Verbose</span> <span class="atom">mode</span>. <span class="name">Prints</span> <span class="atom">a</span> <span class="atom">short</span> <span class="atom">summary</span>.
          <span class="atom">with</span> [-<span class="atom">o</span>], <span class="atom">summary</span> <span class="atom">is</span> <span class="atom">printed</span> <span class="atom">to</span> <span class="name">STDOUT</span>.
          <span class="name">Otherwise</span>, <span class="atom">summary</span> <span class="atom">is</span> <span class="atom">printed</span> <span class="atom">to</span> <span class="name">STDERR</span>.
   [-<span class="atom">i</span> <span class="name">INFILE</span>]  = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">input</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDIN</span>.
   [-<span class="atom">o</span> <span class="name">OUTFILE</span>] = <span class="name">FASTA</span>/<span class="name">Q</span> <span class="atom">output</span> <span class="atom">file</span>. <span class="atom">default</span> <span class="atom">is</span> <span class="name">STDOUT</span>.
   [-<span class="atom">r</span>]         = <span class="name">DNA</span>-<span class="atom">to</span>-<span class="name">RNA</span> <span class="atom">mode</span> - <span class="atom">change</span> <span class="name">T</span><span class="string">'s into U'</span><span class="atom">s</span>.
   [-<span class="atom">d</span>]         = <span class="name">RNA</span>-<span class="atom">to</span>-<span class="name">DNA</span> <span class="atom">mode</span> - <span class="atom">change</span> <span class="name">U</span><span class="string">'s into T'</span><span class="atom">s</span>.
</code></pre><h3 id="FASTA_Clipping_Histogram">FASTA Clipping Histogram</h3><pre><code>$ fasta_clipping_histogram<span class="class">.pl</span>
Create <span class="tag">a</span> Linker Clipping Information Histogram

usage: fasta_clipping_histogram<span class="class">.pl</span> INPUT_FILE<span class="class">.FA</span> OUTPUT_FILE<span class="class">.PNG</span>

    INPUT_FILE<span class="class">.FA</span>   = <span class="tag">input</span> file (<span class="keyword">in</span> FASTA format, can be GZIPped)
    OUTPUT_FILE<span class="class">.PNG</span> = histogram image
</code></pre><h3 id="FASTX_Barcode_Splitter">FASTX Barcode Splitter</h3><pre><code>$ fastx_barcode_splitter.pl
Barcode Splitter, <span class="keyword">by</span> Assaf Gordon (gordon@cshl.edu), <span class="number">11</span>sep2008

This program reads FASTA/FASTQ <span class="type">file</span> <span class="keyword">and</span> splits <span class="keyword">it</span> <span class="keyword">into</span> several smaller files,
Based <span class="function_start"><span class="keyword">on</span></span> barcode matching.
FASTA/FASTQ data <span class="keyword">is</span> <span class="command">read</span> <span class="keyword">from</span> STDIN (format <span class="keyword">is</span> auto-detected.)
Output files will be writen <span class="keyword">to</span> disk.
Summary will be printed <span class="keyword">to</span> STDOUT.

usage: /usr/<span class="keyword">local</span>/bin/fastx_barcode_splitter.pl <span class="comment">--bcfile FILE --prefix PREFIX [--suffix SUFFIX] [--bol|--eol] </span>
     [<span class="comment">--mismatches N] [--exact] [--partial N] [--help] [--quiet] [--debug]</span>

Arguments:

<span class="comment">--bcfile FILE    - Barcodes file name. (see explanation below.)</span>
<span class="comment">--prefix PREFIX    - File prefix. will be added to the output files. Can be used</span>
          <span class="keyword">to</span> specify output directories.
<span class="comment">--suffix SUFFIX    - File suffix (optional). Can be used to specify file</span>
          extensions.
<span class="comment">--bol        - Try to match barcodes at the BEGINNING of sequences.</span>
          (What biologists would call <span class="keyword">the</span> <span class="number">5</span>' <span class="keyword">end</span>, <span class="keyword">and</span> programmers
          would call index <span class="number">0.</span>)
<span class="comment">--eol        - Try to match barcodes at the END of sequences.</span>
          (What biologists would call <span class="keyword">the</span> <span class="number">3</span>' <span class="keyword">end</span>, <span class="keyword">and</span> programmers
          would call <span class="keyword">the</span> <span class="keyword">end</span> <span class="keyword">of</span> <span class="keyword">the</span> <span class="type">string</span>.)
          NOTE: one <span class="keyword">of</span> <span class="comment">--bol, --eol must be specified, but not both.</span>
<span class="comment">--mismatches N    - Max. number of mismatches allowed. default is 1.</span>
<span class="comment">--exact        - Same as '--mismatches 0'. If both --exact and --mismatches </span>
          are specified, '<span class="comment">--exact' takes precedence.</span>
<span class="comment">--partial N    - Allow partial overlap of barcodes. (see explanation below.)</span>
          (Default <span class="keyword">is</span> <span class="keyword">not</span> partial matching)
<span class="comment">--quiet        - Don't print counts and summary at the end of the run.</span>
          (Default <span class="keyword">is</span> <span class="keyword">to</span> print.)
<span class="comment">--debug        - Print lots of useless debug information to STDERR.</span>
<span class="comment">--help        - This helpful help screen.</span>

Example (Assuming 's_2_100.txt' <span class="keyword">is</span> a FASTQ <span class="type">file</span>, 'mybarcodes.txt' <span class="keyword">is</span> 

<span class="keyword">the</span> barcodes <span class="type">file</span>):

   $ cat s_2_100.txt | /usr/<span class="keyword">local</span>/bin/fastx_barcode_splitter.pl <span class="comment">--bcfile mybarcodes.txt --bol --mismatches 2 \</span>
    <span class="comment">--prefix /tmp/bla_ --suffix ".txt"</span>

Barcode <span class="type">file</span> format
<span class="comment">-------------------</span>
Barcode files are simple <span class="type">text</span> files. Each line should <span class="keyword">contain</span> an identifier 
(descriptive <span class="property">name</span> <span class="keyword">for</span> <span class="keyword">the</span> barcode), <span class="keyword">and</span> <span class="keyword">the</span> barcode itself (A/C/G/T), 
separated <span class="keyword">by</span> a TAB <span class="property">character</span>. Example:

    <span class="comment">#This line is a comment (starts with a 'number' sign)</span>
    BC1 GATCT
    BC2 ATCGT
    BC3 GTGAT
    BC4 TGTCT

For each barcode, a new FASTQ <span class="type">file</span> will be created (<span class="keyword">with</span> <span class="keyword">the</span> barcode's 
identifier <span class="keyword">as</span> part <span class="keyword">of</span> <span class="keyword">the</span> <span class="type">file</span> <span class="property">name</span>). Sequences matching <span class="keyword">the</span> barcode 
will be stored <span class="keyword">in</span> <span class="keyword">the</span> appropriate <span class="type">file</span>.

Running <span class="keyword">the</span> <span class="keyword">above</span> example (assuming <span class="string">"mybarcodes.txt"</span> <span class="keyword">contains</span> <span class="keyword">the</span> <span class="keyword">above</span> 
barcodes), will create <span class="keyword">the</span> following files:
    /tmp/bla_BC1.txt
    /tmp/bla_BC2.txt
    /tmp/bla_BC3.txt
    /tmp/bla_BC4.txt
    /tmp/bla_unmatched.txt
The 'unmatched' <span class="type">file</span> will <span class="keyword">contain</span> all sequences <span class="keyword">that</span> didn't match any barcode.

Barcode matching
<span class="comment">----------------</span>

** Without partial matching:

Count mismatches <span class="keyword">between</span> <span class="keyword">the</span> FASTA/Q sequences <span class="keyword">and</span> <span class="keyword">the</span> barcodes.
The barcode which matched <span class="keyword">with</span> <span class="keyword">the</span> lowest mismatches <span class="command">count</span> (providing <span class="keyword">the</span>
<span class="command">count</span> <span class="keyword">is</span> small <span class="keyword">or</span> <span class="keyword">equal</span> <span class="keyword">to</span> '<span class="comment">--mismatches N') 'gets' the sequences.</span>

Example (using <span class="keyword">the</span> <span class="keyword">above</span> barcodes):
Input Sequence:
    GATTTACTATGTAAAGATAGAAGGAATAAGGTGAAG

Matching <span class="keyword">with</span> '<span class="comment">--bol --mismatches 1':</span>
   GATTTACTATGTAAAGATAGAAGGAATAAGGTGAAG
   GATCT (<span class="number">1</span> mismatch, BC1)
   ATCGT (<span class="number">4</span> mismatches, BC2)
   GTGAT (<span class="number">3</span> mismatches, BC3)
   TGTCT (<span class="number">3</span> mismatches, BC4)

This sequence will be classified <span class="keyword">as</span> 'BC1' (<span class="keyword">it</span> has <span class="keyword">the</span> lowest mismatch <span class="command">count</span>).
If '<span class="comment">--exact' or '--mismatches 0' were specified, this sequence would be </span>
classified <span class="keyword">as</span> 'unmatched' (because, although BC1 had <span class="keyword">the</span> lowest mismatch <span class="command">count</span>,
<span class="keyword">it</span> <span class="keyword">is</span> <span class="keyword">above</span> <span class="keyword">the</span> maximum allowed mismatches).

Matching <span class="keyword">with</span> '<span class="comment">--eol' (end of line) does the same, but from the other side</span>
<span class="keyword">of</span> <span class="keyword">the</span> sequence.

** With partial matching (very similar <span class="keyword">to</span> indels):

Same <span class="keyword">as</span> <span class="keyword">above</span>, <span class="keyword">with</span> <span class="keyword">the</span> following addition: barcodes are also checked <span class="keyword">for</span>
partial overlap (<span class="type">number</span> <span class="keyword">of</span> allowed non-overlapping bases <span class="keyword">is</span> '<span class="comment">--partial N').</span>

Example:
Input sequence <span class="keyword">is</span> ATTTACTATGTAAAGATAGAAGGAATAAGGTGAAG
(Same <span class="keyword">as</span> <span class="keyword">above</span>, <span class="keyword">but</span> note <span class="keyword">the</span> missing 'G' <span class="keyword">at</span> <span class="keyword">the</span> <span class="keyword">beginning</span>.)

Matching (<span class="keyword">without</span> partial overlapping) <span class="keyword">against</span> BC1 yields <span class="number">4</span> mismatches:
   ATTTACTATGTAAAGATAGAAGGAATAAGGTGAAG
   GATCT (<span class="number">4</span> mismatches)

Partial overlapping would also <span class="keyword">try</span> <span class="keyword">the</span> following match:
   -ATTTACTATGTAAAGATAGAAGGAATAAGGTGAAG
   GATCT (<span class="number">1</span> mismatch)

Note: scoring counts a missing base <span class="keyword">as</span> a mismatch, so <span class="keyword">the</span> final
mismatch <span class="command">count</span> <span class="keyword">is</span> <span class="number">2</span> (<span class="number">1</span> '<span class="type">real</span>' mismatch, <span class="number">1</span> 'missing base' mismatch).
If <span class="property">running</span> <span class="keyword">with</span> '<span class="comment">--mismatches 2' (meaning allowing upto 2 mismatches) - this </span>
seqeunce will be classified <span class="keyword">as</span> BC1.
</code></pre><h2 id="Example:_FASTQ_Information">Example: FASTQ Information</h2><h3 id="Genrating_Quality_Information_on_BC54-fq:">Genrating Quality Information on BC54.fq:</h3><p>$ fastx_quality_stats -i BC54.fq -o bc54_stats.txt<br>$ fastq_quality_boxplot_graph.sh -i bc54_stats.txt -o bc54_quality.png -t “My Library”<br>$ fastx_nucleotide_distribution_graph.sh -i bc54_stats.txt -o bc54_nuc.png -t “My Library”</p>
<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bc54_quality.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/bc54_nuc.png" alt=""></p> <p></p>
<h2 id="Example:_FASTQ/A_Manipulation">Example: FASTQ/A Manipulation</h2><h3 id="Common_pre-processing_work-flow:">Common pre-processing work-flow:</h3><p>Covnerting FASTQ to FASTA<br>Clipping the Adapter/Linker<br>Trimming to 27nt (if you’re analyzing miRNAs, for example)<br>Collapsing the sequences<br>Plotting the clipping results</p>
<h3 id="Using_the_FASTX-toolkit_from_the_command_line:">Using the FASTX-toolkit from the command line:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ fastq_to_fasta -v -n -i BC54.fq -o BC54.fa</span><br><span class="line">Input: 100000 reads.</span><br><span class="line">Output: 100000 reads.</span><br><span class="line">$ fastx_clipper -v -i BC54.fa -a CTGTAGGCACCATCAATTCGTA -o BC54.clipped.fa</span><br><span class="line">Clipping Adapter: CTGTAGGCACCATCAATTCGTA</span><br><span class="line">Min. Length: 15</span><br><span class="line">Input: 100000 reads.</span><br><span class="line">Output: 92533 reads.</span><br><span class="line">discarded 468 too-short reads.</span><br><span class="line">discarded 6939 adapter-only reads.</span><br><span class="line">discarded 60 N reads.</span><br><span class="line">$ fastx_trimmer -v -f 1 -l 27 -i BC54.clipped.fa -o BC54.trimmed.fa</span><br><span class="line">Trimming: base 1 to 27</span><br><span class="line">Input: 92533 reads.</span><br><span class="line">Output: 92533 reads.</span><br><span class="line">$ fastx_collapser -v -i BC54.trimmed.fa -o BC54.collapsed.fa</span><br><span class="line">Collapsd 92533 reads into 36431 unique sequences.</span><br><span class="line">$ fasta_clipping_histogram.pl BC54.collapsed.fa bc54_clipping.png</span><br></pre></td></tr></table></figure>
<h3 id="Mapping_(or_any_other_kind_of_analysis)_of_the_Clipped_+_Collapsed_FASTA_file_will_be:">Mapping (or any other kind of analysis) of the Clipped + Collapsed FASTA file will be:</h3><p>quicker - each unique sequence appears only once in the FASTA file.<br>more accurate - the Adapter/Linker sequence was removed from the 3’ end, and will affect the mapping results.</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Here you’ll find a short description and examples of how to use the FASTX-toolkit from the command line.&lt;/p&gt;
&lt;h2 id=&quot;Command_Line_Argumen
    
    </summary>
    
      <category term="Bioinformatics" scheme="http://tiramisutes.github.io/categories/Bioinformatics/"/>
    
    
      <category term="FASTX" scheme="http://tiramisutes.github.io/tags/FASTX/"/>
    
  </entry>
  
  <entry>
    <title>20 Unix Command Line Tricks</title>
    <link href="http://tiramisutes.github.io/2015/07/24/20-Unix-Command.html"/>
    <id>http://tiramisutes.github.io/2015/07/24/20-Unix-Command.html</id>
    <published>2015-07-24T14:03:30.000Z</published>
    <updated>2015-07-25T06:16:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>Let us start new year with these Unix command line tricks to increase productivity at the Terminal. I have found them over the years and I’m now going to share with you.</p>
<p></p><p><img src="http://s0.cyberciti.org/uploads/cms/2015/01/unix-command-line-tricks.001.jpg" alt=""></p> <p></p>
<h3 id="Deleting_a_HUGE_file">Deleting a HUGE file</h3><p>I had a huge log file 200GB I need to delete on a production web server. My rm and ls command was crashed and I was afraid that the system to a crawl with huge disk I/O load. To remove a HUGE file, enter:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; /path/to/file.log</span><br><span class="line"><span class="comment"># or use the following syntax</span></span><br><span class="line">: &gt; /path/to/file.log</span><br><span class="line"> </span><br><span class="line"><span class="comment"># finally delete it </span></span><br><span class="line">rm /path/to/file.log</span><br></pre></td></tr></table></figure>
<h3 id="Want_to_cache_console_output?">Want to cache console output?</h3><p>Try the script command line utility to create a typescript of everything printed on your terminal.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script my.terminal.session</span><br></pre></td></tr></table></figure>
<p>Type commands:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">date</span><br><span class="line">sudo service foo stop</span><br></pre></td></tr></table></figure></p>
<p>To exit (to end script session) type exit or logout or press control-D<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></p>
<p>To view type:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more my.terminal.session</span><br><span class="line">less my.terminal.session</span><br><span class="line">cat my.terminal.session</span><br></pre></td></tr></table></figure>
<h3 id="Restoring_deleted_/tmp_folder">Restoring deleted /tmp folder</h3><p>As my journey continues with Linux and Unix shell, I made a few mistakes. I accidentally deleted /tmp folder. To restore it all you have to do is:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp</span><br><span class="line">chmod 1777 /tmp</span><br><span class="line">chown root:root /tmp</span><br><span class="line">ls -ld /tmp</span><br></pre></td></tr></table></figure></p>
<h3 id="Locking_a_directory">Locking a directory</h3><p>For privacy of my data I wanted to lock down /downloads on my file server. So I ran:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 0000 /downloads</span><br></pre></td></tr></table></figure></p>
<p>The root user can still has access and ls and cd commands will not work. To go back:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 0755 /downloads</span><br></pre></td></tr></table></figure></p>
<h3 id="Password_protecting_file_in_vim_text_editor">Password protecting file in vim text editor</h3><p>Afraid that root user or someone may snoop into your personal text files? Try password protection to a file in vim, type:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vim +X filename</span><br><span class="line">``` </span><br><span class="line">Or, before quitting <span class="keyword">in</span> vim use :X vim <span class="built_in">command</span> to encrypt your file and vim will prompt <span class="keyword">for</span> a password.</span><br><span class="line"></span><br><span class="line"><span class="comment">### Clear gibberish all over the screen</span></span><br><span class="line"></span><br><span class="line">Just <span class="built_in">type</span>:</span><br><span class="line"></span><br><span class="line">``` bash </span><br><span class="line">reset</span><br></pre></td></tr></table></figure></p>
<h3 id="Becoming_human">Becoming human</h3><p>Pass the -h or -H (and other options) command line option to GNU or BSD utilities to get output of command commands like ls, df, du, in human-understandable formats:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ls -lh</span><br><span class="line"><span class="comment"># print sizes in human readable format (e.g., 1K 234M 2G)</span></span><br><span class="line">df -h</span><br><span class="line">df -k</span><br><span class="line"><span class="comment"># show output in bytes, KB, MB, or GB</span></span><br><span class="line">free -b</span><br><span class="line">free -k</span><br><span class="line">free -m</span><br><span class="line">free -g</span><br><span class="line"><span class="comment"># print sizes in human readable format (e.g., 1K 234M 2G)</span></span><br><span class="line">du -h</span><br><span class="line"><span class="comment"># get file system perms in human readable format</span></span><br><span class="line"><span class="built_in">stat</span> -c %A /boot</span><br><span class="line"><span class="comment"># compare human readable numbers</span></span><br><span class="line">sort -h -a file</span><br><span class="line"><span class="comment"># display the CPU information in human readable format on a Linux</span></span><br><span class="line">lscpu</span><br><span class="line">lscpu -e</span><br><span class="line">lscpu -e=cpu,node</span><br><span class="line"><span class="comment"># Show the  size of each file but in a more human readable way</span></span><br><span class="line">tree -h</span><br><span class="line">tree -h /boot</span><br></pre></td></tr></table></figure>
<h3 id="Show_information_about_known_users_in_the_Linux_based_system">Show information about known users in the Linux based system</h3><p>Just type:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## linux version ##</span></span><br><span class="line">lslogins</span><br><span class="line"> </span><br><span class="line"><span class="comment">## BSD version ##</span></span><br><span class="line">logins</span><br></pre></td></tr></table></figure></p>
<p>Sample outputs:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">UID USER      PWD-LOCK PWD-DENY LAST-LOGIN GECOS</span><br><span class="line">  0 root             0        0   22:37:59 root</span><br><span class="line">  1 bin              0        1            bin</span><br><span class="line">  2 daemon           0        1            daemon</span><br><span class="line">  3 adm              0        1            adm</span><br><span class="line">  4 lp               0        1            lp</span><br><span class="line">  5 sync             0        1            sync</span><br><span class="line">  6 shutdown         0        1 2014-Dec17 shutdown</span><br><span class="line">  7 halt             0        1            halt</span><br><span class="line">  8 mail             0        1            mail</span><br><span class="line"> 10 uucp             0        1            uucp</span><br><span class="line"> 11 operator         0        1            operator</span><br><span class="line"> 12 games            0        1            games</span><br><span class="line"> 13 gopher           0        1            gopher</span><br><span class="line"> 14 ftp              0        1            FTP User</span><br><span class="line"> 27 mysql            0        1            MySQL Server</span><br><span class="line"> 38 ntp              0        1</span><br><span class="line"> 48 apache           0        1            Apache</span><br><span class="line"> 68 haldaemon        0        1            HAL daemon</span><br><span class="line"> 69 vcsa             0        1            virtual console memory owner</span><br><span class="line"> 72 tcpdump          0        1</span><br><span class="line"> 74 sshd             0        1            Privilege-separated SSH</span><br><span class="line"> 81 dbus             0        1            System message bus</span><br><span class="line"> 89 postfix          0        1</span><br><span class="line"> 99 nobody           0        1            Nobody</span><br><span class="line">173 abrt             0        1</span><br><span class="line">497 vnstat           0        1            vnStat user</span><br><span class="line">498 nginx            0        1            nginx user</span><br><span class="line">499 saslauth         0        1            <span class="string">"Saslauthd user"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="How_do_I_fix_mess_created_by_accidentally_untarred_files_in_the_current_dir?">How do I fix mess created by accidentally untarred files in the current dir?</h3><p>So I accidentally untar a tarball in /var/www/html/ directory instead of /home/projects/www/current. It created mess in /var/www/html/. The easiest way to fix this mess:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">/bin/rm -f <span class="string">"<span class="variable">$(tar ztf /path/to/file.tar.gz)</span>"</span></span><br></pre></td></tr></table></figure>
<h3 id="Confused_on_a_top_command_output?">Confused on a top command output?</h3><p>Seriously, you need to try out htop instead of top:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo htop</span><br></pre></td></tr></table></figure></p>
<h3 id="Want_to_run_the_same_command_again?">Want to run the same command again?</h3><p>Just type !!. For example:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/myhome/dir/script/name arg1 arg2</span><br><span class="line"> </span><br><span class="line"><span class="comment"># To run the same command again </span></span><br><span class="line">!!</span><br><span class="line"> </span><br><span class="line"><span class="comment">## To run the last command again as root user</span></span><br><span class="line">sudo !!</span><br></pre></td></tr></table></figure>
<p>The !! repeats the most recent command. To run the most recent command beginning with “foo”:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">!foo</span><br><span class="line"><span class="comment"># Run the most recent command beginning with "service" as root</span></span><br><span class="line">sudo !service</span><br></pre></td></tr></table></figure></p>
<p>The !$ use to run command with the last argument of the most recent command:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Edit nginx.conf</span></span><br><span class="line">sudo vi /etc/nginx/nginx.conf</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Test nginx.conf for errors</span></span><br><span class="line">/sbin/nginx -t -c /etc/nginx/nginx.conf</span><br><span class="line"> </span><br><span class="line"><span class="comment"># After testing a file with "/sbin/nginx -t -c /etc/nginx/nginx.conf", you</span></span><br><span class="line"><span class="comment"># can edit file again with vi</span></span><br><span class="line">sudo vi !$</span><br></pre></td></tr></table></figure></p>
<h3 id="Get_a_reminder_you_when_you_have_to_leave">Get a reminder you when you have to leave</h3><p>If you need a reminder to leave your terminal, type the following command:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">leave +hhmm</span><br></pre></td></tr></table></figure>
<p>Where,</p>
<p>hhmm - The time of day is in the form hhmm where hh is a time in hours (on a 12 or 24 hour clock), and mm are minutes. All times are converted to a 12 hour clock, and assumed to be in the next 12 hours.</p>
<h3 id="Home_sweet_home">Home sweet home</h3><p>Want to go the directory you were just in? Run:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> -</span><br></pre></td></tr></table></figure></p>
<p>Need to quickly return to your home directory? Enter:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br></pre></td></tr></table></figure></p>
<p>The variable CDPATH defines the search path for the directory containing directories:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CDPATH=/var/www:/nas10</span><br></pre></td></tr></table></figure></p>
<p>Now, instead of typing cd /var/www/html/ I can simply type the following to cd into /var/www/html path:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> html</span><br></pre></td></tr></table></figure></p>
<h3 id="Editing_a_file_being_viewed_with_less_pager">Editing a file being viewed with less pager</h3><p>To edit a file being viewed with less pager, press v. You will have the file for edit under $EDITOR:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">less *.c</span><br><span class="line">less foo.html</span><br><span class="line"><span class="comment">## Press v to edit file ##</span></span><br><span class="line"><span class="comment">## Quit from editor and you would return to the less pager again ##</span></span><br><span class="line">``` bash</span><br><span class="line"><span class="comment">### List all files or directories on your system</span></span><br><span class="line"></span><br><span class="line">To see all of the directories on your system, run:</span><br><span class="line">``` bash</span><br><span class="line">find / -<span class="built_in">type</span> d | less</span><br><span class="line"> </span><br><span class="line"><span class="comment"># List all directories in your $HOME</span></span><br><span class="line">find <span class="variable">$HOME</span> -<span class="built_in">type</span> d -ls | less</span><br><span class="line">``` </span><br><span class="line">To see all of the files, run:</span><br><span class="line">``` bash</span><br><span class="line">find / -<span class="built_in">type</span> f | less</span><br><span class="line"> </span><br><span class="line"><span class="comment"># List all files in your $HOME</span></span><br><span class="line">find <span class="variable">$HOME</span> -<span class="built_in">type</span> f -ls | less</span><br><span class="line">``` </span><br><span class="line"><span class="comment">### Build directory trees in a single command</span></span><br><span class="line"></span><br><span class="line">You can create directory trees one at a time using mkdir <span class="built_in">command</span> by passing the -p option:</span><br><span class="line">``` bash</span><br><span class="line">mkdir -p /jail/&#123;dev,bin,sbin,etc,usr,lib,lib64&#125;</span><br><span class="line">ls -l /jail/</span><br><span class="line">``` </span><br><span class="line"><span class="comment">### Copy file into multiple directories</span></span><br><span class="line"></span><br><span class="line">Instead of running:</span><br><span class="line">``` bash</span><br><span class="line">cp /path/to/file /usr/dir1</span><br><span class="line">cp /path/to/file /var/dir2</span><br><span class="line">cp /path/to/file /nas/dir3</span><br><span class="line">``` </span><br><span class="line">Run the following <span class="built_in">command</span> to copy file into multiple <span class="built_in">dirs</span>:</span><br><span class="line">``` bash</span><br><span class="line"><span class="built_in">echo</span> /usr/dir1 /var/dir2 /nas/dir3 |  xargs -n 1 cp -v /path/to/file</span><br></pre></td></tr></table></figure>
<p>Creating a shell function is left as an exercise for the reader</p>
<h3 id="Quickly_find_differences_between_two_directories">Quickly find differences between two directories</h3><p>The diff command compare files line by line. It can also compare two directories:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls -l /tmp/r</span><br><span class="line">ls -l /tmp/s</span><br><span class="line"><span class="comment"># Compare two folders using diff ##</span></span><br><span class="line">diff /tmp/r/ /tmp/s/</span><br></pre></td></tr></table></figure></p>
<p></p><p><img src="http://s0.cyberciti.org/uploads/cms/2015/01/differences-between-folders.jpg" alt=""></p><br>Fig. : Finding differences between folders<p></p>
<h3 id="Text_formatting">Text formatting</h3><p>You can reformat each paragraph with fmt command. In this example, I’m going to reformat file by wrapping overlong lines and filling short lines:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt file.txt</span><br></pre></td></tr></table></figure></p>
<p>You can also split long lines, but do not refill i.e. wrap overlong lines, but do not fill short lines:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt -s file.txt</span><br></pre></td></tr></table></figure></p>
<h3 id="See_the_output_and_write_it_to_a_file">See the output and write it to a file</h3><p>Use the tee command as follows to see the output on screen and also write to a log file named my.log:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mycoolapp arg1 arg2 input.file | tee my.log</span><br></pre></td></tr></table></figure></p>
<p>The tee command ensures that you will see mycoolapp output on on the screen and to a file same time.</p>
<p>More info: <span class="exturl" data-url="aHR0cDovL3d3dy5jeWJlcmNpdGkuYml6L29wZW4tc291cmNlL2NvbW1hbmQtbGluZS1oYWNrcy8yMC11bml4LWNvbW1hbmQtbGluZS10cmlja3MtcGFydC1pLw==" title="http://www.cyberciti.biz/open-source/command-line-hacks/20-unix-command-line-tricks-part-i/">Unix Command<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Let us start new year with these Unix command line tricks to increase productivity at the Terminal. I have found them over the years and 
    
    </summary>
    
      <category term="Linux" scheme="http://tiramisutes.github.io/categories/Linux/"/>
    
    
      <category term="Linux" scheme="http://tiramisutes.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://tiramisutes.github.io/2015/07/24/hello-world.html"/>
    <id>http://tiramisutes.github.io/2015/07/24/hello-world.html</id>
    <published>2015-07-24T14:03:30.000Z</published>
    <updated>2015-07-29T14:25:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <span class="exturl" data-url="aHR0cDovL2hleG8uaW8v" title="http://hexo.io/">Hexo<i class="fa fa-external-link"></i></span>! This is your very first post. Check <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy8=" title="http://hexo.io/docs/">documentation<i class="fa fa-external-link"></i></span> for more info. If you get any problems when using Hexo, you can find the answer in <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy90cm91Ymxlc2hvb3RpbmcuaHRtbA==" title="http://hexo.io/docs/troubleshooting.html">troubleshooting<i class="fa fa-external-link"></i></span> or you can ask me on <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==" title="https://github.com/hexojs/hexo/issues">GitHub<i class="fa fa-external-link"></i></span>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy93cml0aW5nLmh0bWw=" title="http://hexo.io/docs/writing.html">Writing<i class="fa fa-external-link"></i></span></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy9zZXJ2ZXIuaHRtbA==" title="http://hexo.io/docs/server.html">Server<i class="fa fa-external-link"></i></span></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy9nZW5lcmF0aW5nLmh0bWw=" title="http://hexo.io/docs/generating.html">Generating<i class="fa fa-external-link"></i></span></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <span class="exturl" data-url="aHR0cDovL2hleG8uaW8vZG9jcy9kZXBsb3ltZW50Lmh0bWw=" title="http://hexo.io/docs/deployment.html">Deployment<i class="fa fa-external-link"></i></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;span class=&quot;exturl&quot; data-url=&quot;aHR0cDovL2hleG8uaW8v&quot; title=&quot;http://hexo.io/&quot;&gt;Hexo&lt;i class=&quot;fa fa-external-link&quot;&gt;&lt;/i&gt;&lt;/span&gt;! T
    
    </summary>
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://tiramisutes.github.io/tags/Hexo/"/>
    
  </entry>
  
</feed>
