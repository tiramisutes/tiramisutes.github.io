<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=66189719" charset="UTF-8"></script>


  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"/>





  
  
    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/Han/3.3.0/han.min.css"/>



  <meta http-equiv="Cache-Control" content="no-transform"/>
  <meta http-equiv="Cache-Control" content="no-siteapp"/>



  <meta name="google-site-verification" content="b12Zu40L63PLgCtcn0IW8KCNRolmyQlaF22tf4rRLEg"/>



  <meta name="msvalidate.01" content="74A687E04D4EF9914B7AA20824207409"/>









  
  
    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link rel="stylesheet" href="https://fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"/>
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"/>

<link rel="stylesheet" href="/css/main.css?v=7.0.1"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/small_favicon.png?v=7.0.1">


  <link rel="mask-icon" href="/images/favicon.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":true,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="hope bioinformatics blog">
<meta property="og:type" content="website">
<meta property="og:title" content="hope">
<meta property="og:url" content="http://tiramisutes.github.io/page/12/index.html">
<meta property="og:site_name" content="hope">
<meta property="og:description" content="hope bioinformatics blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hope">
<meta name="twitter:description" content="hope bioinformatics blog">



  <link rel="alternate" href="/atom.xml" title="hope" type="application/atom+xml"/>




  <link rel="canonical" href="http://tiramisutes.github.io/page/12/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>hope – A new day is coming,whether we like it or not. The question is will you control it,or will it control you?</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?08b17c69c7ba460d9ab5f188a048ee6d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hope</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">A new day is coming,whether we like it or not. The question is will you control it,or will it control you?</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-code">

    
    
    
      
    

    

    <a href="/code/" rel="section"><i class="menu-item-icon fa fa-fw fa-code"></i> <br/>Code</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-footprint">

    
    
    
      
    

    

    <a href="/footprint/" rel="section"><i class="menu-item-icon fa fa-fw fa-image"></i> <br/>Footprint</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-qrt-pcr">

    
    
    
      
    

    

    <span class="exturl" data-url="aHR0cHM6Ly9paG9wZS5zaGlueWFwcHMuaW8vcVJULVBDUi1QaXBlbGluZS8="><i class="menu-item-icon fa fa-fw fa-cloud"></i> <br/>qRT-PCR</span>

  </li>
        
        
        
          
          <li class="menu-item menu-item-project">

    
    
    
      
    

    

    <a href="/project/" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br/>Project</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-publish">

    
    
    
      
    

    

    <a href="/publish/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i> <br/>Publish</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sci-figure">

    
    
    
      
    

    

    <a href="/SCIFigure/" rel="section"><i class="menu-item-icon fa fa-fw fa-angellist"></i> <br/>SCI Figure</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-cv">

    
    
    
      
    

    

    <a href="/resume/" rel="section"><i class="menu-item-icon fa fa-fw fa-address-card"></i> <br/>CV</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/08/ANOVA.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/08/ANOVA.html" class="post-title-link" itemprop="url">ANOVA单因素方差分析与R实现</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-08 23:37:43" itemprop="dateCreated datePublished" datetime="2015-10-08T23:37:43+08:00">2015-10-08</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/08/ANOVA.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/08/ANOVA.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/08/ANOVA.html" class="leancloud_visitors" data-flag-title="ANOVA单因素方差分析与R实现">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="单因子方差分析">单因子方差分析</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;方差分析(analysis of variance, 简写为ANOVA)是工农业生产和科学研究中分析试验数据的一种有效的统计方法. 引起观测值不同(波动)的原因主要有两类: 一类是试验过程中随机因素的干扰或观测误差所引起不可控制的的波动, 另一类则是由于试验中处理方式不同或试验条件不同引起的可以控制的波动.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>方差分析</strong>的主要工作就是将观测数据的总变异(波动)按照变异的原因的不同分解为因子效应与试验误差，并对其作出数量分析，发现多组数据之间的差异显著行，比较各种原因在总变异中所占的重要程度，以此作为进一步统计推断的依据.<br><strong>在进行方差分析之前先对几条假设进行检验，由于随机抽取，假设总体满足独立、正态，考察方差齐次性（用bartlett检验）.</strong></p>
<p><iframe width="420" height="315" src="https://www.youtube.com/embed/bklkCjiY3E0" frameborder="0" allowfullscreen></iframe></p>
<h3 id="正态性检验">正态性检验</h3><p>在进行方差分析前先对输入数据做正态性检验。<br>对数据的正态性，利用Shapiro-Wilk正态检验方法(W检验)，它通常用于样本容量n≤50时，检验样本是否符合正态分布。</p>
<p>R中，函数shapiro.test()提供了W统计量和相应P值，所以可以直接使用P值作为判断标准(<strong>P值大于0.05说明数据正态</strong>)，其调用格式为shapiro.test(x)，参数x即所要检验的数据集，它是长度在3到5000之间的向量。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nx &lt;- c(rnorm(10))</span><br><span class="line">nx</span><br><span class="line">[1] -0.83241783 -0.29609562 -0.06736888 -0.02366562</span><br><span class="line">0.23652392 0.97570959</span><br><span class="line">[7] -0.85301145 1.51769488 -0.84866517 0.20691119</span><br><span class="line">shapiro.test(nx)</span><br><span class="line">Shapiro-Wilk normality <span class="built_in">test</span></span><br><span class="line">data: nx</span><br><span class="line">W = 0.9084, p-value = 0.2699</span><br><span class="line"><span class="comment">#检验结果，因为p 值小于W 值，所以数据为正态分布.</span></span><br></pre></td></tr></table></figure></p>
<p>更多正态性检验见：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9ibHVlaWNlbHkvYXJjaGl2ZS8yMDEzLzAxLzA4LzI4NTA5MjkuaHRtbA==" title="http://www.cnblogs.com/blueicely/archive/2013/01/08/2850929.html">R语言做正态分布检验<i class="fa fa-external-link"></i></span><br>其中，<strong>D检验(Kolmogorov - Smirnov)是比较精确的正态检验法。</strong></p>
<p><li><strong>SPSS 规定:当样本含量3 ≤n ≤5000 时,结果以Shapiro - Wilk (W 检验) 为准,当样本含量n &gt; 5000 结果以Kolmogorov - Smirnov 为准。</strong></li></p>
<p><li><strong>SAS 规定:当样本含量n ≤2000 时,结果以Shapiro - Wilk (W 检验) 为准,当样本含量n &gt;2000 时,结果以Kolmogorov - Smirnov (D 检验) 为准。</strong></li></p>
<h3 id="方差齐性检验">方差齐性检验</h3><p>方差分析的另一个假设：方差齐性，需要检验不同水平下的数据方差是否相等。R中最常用的是Bartlett检验,bartlett.test()调用格式为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bartlett.test(x，g…)</span><br></pre></td></tr></table></figure></p>
<p>其中，参数X是数据向量或列表(list) ; g是因子向量，如果X是列表则忽略g.当使用数据集时，也通过formula调用函数:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bartlett.test(formala, data, subset，na.action…)</span><br></pre></td></tr></table></figure></p>
<p>formula是形如lhs一rhs的方差分析公式;data指明数据集:subset是可选项，可以用来指定观测值的一个子集用于分析:na.action表示遇到缺失值时应当采取的行为。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; x=c(x1,x2,x3)</span><br><span class="line">&gt; account=data.frame(x,A=factor(rep(1:3,each=7)))</span><br><span class="line">&gt; bartlett.test(x~A,data=account)</span><br><span class="line"> </span><br><span class="line">Bartlett <span class="built_in">test</span> of homogeneity of variances</span><br><span class="line"> </span><br><span class="line">data: x by A</span><br><span class="line">Bartlett<span class="string">'s K-squared = 0.13625, df = 2, p-value = 0.9341</span></span><br></pre></td></tr></table></figure></p>
<p>由于P值远远大于显著性水平a=0.05，因此不能拒绝原假设，我们认为不同水平下的数据是等方差的。</p>
<h3 id="方差分析：F-Test">方差分析：F-Test</h3><p>In R the function var.test allows for the comparison of two variances using an F-test.Although it is possible to compare values of s2 for two samples, there is no capability within R for comparing the variance of a sample,s2,to the variance of a population, σ2. The syntax for the testing variances is :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var.test(X, Y, ratio = 1, alternative = <span class="string">"two.sided"</span>, conf.level = 0.95)</span><br></pre></td></tr></table></figure></p>
<p>where X and Y are vectors containing the two samples.<br>The optional command ratio is the null hypothesis; the default value is 1 if not specified.<br>The command alternative gives the alternative hypothesis should the experimental F-ratio is found to be significantly different than that specified by ratio. The default for alternative is “two-sided” with the other possible choices being “less” or “greater” .<br>The command conf.level gives the confidence level to be used in the test and the default value of 0.95 is equivalent to α = 0.05.<br>Here is a typical result using the objects std.method and new.method.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; std.method&lt;-c( 21.62, 22.20, 24.27, 23.54, 24.25, 23.09, 21.01 )</span><br><span class="line">&gt; new.method&lt;-c(21.54 ,20.51 ,22.31, 21.30, 24.62, 25.72, 21.54 ) </span><br><span class="line">&gt; var(std.method); var(new.method) </span><br><span class="line">[1] 1.638495</span><br><span class="line">[1] 3.690329</span><br><span class="line">&gt; var.test(std.method, new.method)    </span><br><span class="line"></span><br><span class="line">	F <span class="built_in">test</span> to compare two variances</span><br><span class="line"></span><br><span class="line">data:  std.method and new.method</span><br><span class="line">F = 0.444, num df = 6, denom df = 6, p-value = 0.3462</span><br><span class="line">alternative hypothesis: <span class="literal">true</span> ratio of variances is not equal to 1</span><br><span class="line">95 percent confidence interval:</span><br><span class="line"> 0.07629135 2.58395513</span><br><span class="line">sample estimates:</span><br><span class="line">ratio of variances </span><br><span class="line">         0.4439971</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>There are two ways to interpret the results provided by R.<br>First, the p-value provides the smallest value of α for which the F-ratio is significantly different from the hypothesized value.<br>If this value is larger than the desired α, then there is insufficient evidence to reject the null hypothesis; otherwise, the null hypothesis is rejected. Second, R provides the desired confidence interval for the F-ratio;<br>if the calculated value falls within the confidence interval, then the null hypothesis is retained. For this example, the null hypothesis is retained and we find no evidence for a difference in the variances for the objects std.method and new.method. Note that R does not restrict the F-ratio to values greater than 1.<br>1）判断组间是否有差别<br>R中的函数aov()用于方差分析的计算，其调用格式为:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aov(formula, data = NULL, projections =FALSE, qr = TRUE,contrasts = NULL, ...)</span><br></pre></td></tr></table></figure></p>
<p>其中的参数formula表示方差分析的公式，在单因素方差分析中即为x~A ;<br>data表示做方差分析的数据框:projections为逻辑值，表示是否返回预测结果;<br>qr同样是逻辑值，表示是否返回QR分解结果，默认为TRUE;<br>contrasts是公式中的一些因子的对比列表;<br>通过函数summary()可列出方差分析表的详细结果。<br>以淀粉为原料生产葡萄的过程中, 残留许多糖蜜, 可作为生产酱色的原料. 在生产酱色的过程之前应尽可能彻彻底底除杂, 以保证酱色质量.为此对除杂方法进行选择. 在实验中选用5种不同的除杂方法, 每种方法做4次试验, 即重复4次, 结果见表.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aoc.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; X&lt;-c(25.6, 22.2, 28.0, 29.8, 24.4, 30.0, 29.0, 27.5, 25.0, 27.7,</span><br><span class="line">       23.0, 32.2, 28.8, 28.0, 31.5, 25.9, 20.6, 21.2, 22.0, 21.2)</span><br><span class="line">&gt; A&lt;-factor(rep(1:5, each=4))</span><br><span class="line">&gt; miscellany&lt;-data.frame(X, A)</span><br><span class="line">&gt; miscellany</span><br><span class="line">      X A</span><br><span class="line">1  25.6 1</span><br><span class="line">2  22.2 1</span><br><span class="line">3  28.0 1</span><br><span class="line">4  29.8 1</span><br><span class="line">5  24.4 2</span><br><span class="line">6  30.0 2</span><br><span class="line">7  29.0 2</span><br><span class="line">8  27.5 2</span><br><span class="line">9  25.0 3</span><br><span class="line">10 27.7 3</span><br><span class="line">11 23.0 3</span><br><span class="line">12 32.2 3</span><br><span class="line">13 28.8 4</span><br><span class="line">14 28.0 4</span><br><span class="line">15 31.5 4</span><br><span class="line">16 25.9 4</span><br><span class="line">17 20.6 5</span><br><span class="line">18 21.2 5</span><br><span class="line">19 22.0 5</span><br><span class="line">20 21.2 5</span><br><span class="line">&gt; aov.mis&lt;-aov(X~A, data=miscellany)</span><br><span class="line">&gt; summary(aov.mis)</span><br><span class="line">            Df Sum Sq Mean Sq F value Pr(&gt;F)  </span><br><span class="line">A            4  132.0   32.99   4.306 0.0162 *</span><br><span class="line">Residuals   15  114.9    7.66                 </span><br><span class="line">---</span><br><span class="line">Signif. codes: 0 <span class="string">'***'</span> 0.001 <span class="string">'**'</span> 0.01 <span class="string">'*'</span> 0.05 <span class="string">'.'</span> 0.1 <span class="string">' '</span> 1</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>上述结果中, Df表示自由度; sum Sq表示平方和; Mean Sq表示均方和;<br>F value表示F检验统计量的值, 即F比; Pr(&gt;F)表示检验的p值; A就是因素A;<br>Residuals为残差.<br>可以看出, F = 4.3061 &gt; F0.05(5-1, 20-5) = 3.06, 或者p=0.01618&lt;0.05,<br>说明有理由拒绝原假设, 即认为五种除杂方法有显著差异.<br>2）如果有差别，判断是哪两组间有差别<br>其中，上述所得结果为5个除杂方法之间的差异显著性分析，如果假设上述5中处理中A1为对照组，其余A2,A3,A4,A5均为处理组，现在若想分析一个对照和多个处理间的差异显著性，可以通过以下代码实现：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; A1A2&lt;-miscellany[1:8,]</span><br><span class="line">&gt; A1A2</span><br><span class="line">     X A</span><br><span class="line">1 25.6 1</span><br><span class="line">2 22.2 1</span><br><span class="line">3 28.0 1</span><br><span class="line">4 29.8 1</span><br><span class="line">5 24.4 2</span><br><span class="line">6 30.0 2</span><br><span class="line">7 29.0 2</span><br><span class="line">8 27.5 2</span><br><span class="line">&gt; an.aov.mis&lt;-aov(X~A, data=A1A2)</span><br><span class="line">&gt; summary(an.aov.mis)</span><br><span class="line">            Df Sum Sq Mean Sq F value Pr(&gt;F)</span><br><span class="line">A            1   3.51   3.511   0.419  0.542</span><br><span class="line">Residuals    6  50.31   8.385</span><br></pre></td></tr></table></figure>
<p>即选取对照为一组数据，处理为另一组，缺点是对于多个处理一个对照需要重复此操作，现在还没找到好的处理办法，希望以后能学到或者有谁知道望相告。<br><i class="fa fa-bullhorn"></i>最近总结出的另一个比较有效的办法：<br><i class="fa fa-level-up"></i>接上aov()的F检验通过summary(aov.mis)看出五种除杂方法有显著差异.接下来考察具体的差异（多重比较）通过 <strong>TukeyHSD()</strong>函数：<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">  &gt; TukeyHSD(aov.mis)</span><br><span class="line">  Tukey multiple comparisons of means</span><br><span class="line">    95% family-wise confidence level</span><br><span class="line"></span><br><span class="line">Fit: aov(formula = X ~ A, data = miscellany)</span><br><span class="line"></span><br><span class="line"><span class="variable">$A</span></span><br><span class="line">      diff        lwr        upr     p adj</span><br><span class="line">2-1  1.325  -4.718582  7.3685818 0.9584566</span><br><span class="line">3-1  0.575  -5.468582  6.6185818 0.9981815</span><br><span class="line">4-1  2.150  -3.893582  8.1935818 0.8046644</span><br><span class="line">5-1 -5.150 -11.193582  0.8935818 0.1140537</span><br><span class="line">3-2 -0.750  -6.793582  5.2935818 0.9949181</span><br><span class="line">4-2  0.825  -5.218582  6.8685818 0.9926905</span><br><span class="line">5-2 -6.475 -12.518582 -0.4314182 0.0330240</span><br><span class="line">4-3  1.575  -4.468582  7.6185818 0.9251337</span><br><span class="line">5-3 -5.725 -11.768582  0.3185818 0.0675152</span><br><span class="line">5-4 -7.300 -13.343582 -1.2564182 0.0146983 </span><br><span class="line">  &gt; miscellany</span><br><span class="line">      X A</span><br><span class="line">1  25.6 1</span><br><span class="line">2  22.2 1</span><br><span class="line">3  28.0 1</span><br><span class="line">4  29.8 1</span><br><span class="line">5  24.4 2</span><br><span class="line">6  30.0 2</span><br><span class="line">7  29.0 2</span><br><span class="line">8  27.5 2</span><br><span class="line">9  25.0 3</span><br><span class="line">10 27.7 3</span><br><span class="line">11 23.0 3</span><br><span class="line">12 32.2 3</span><br><span class="line">13 28.8 4</span><br><span class="line">14 28.0 4</span><br><span class="line">15 31.5 4</span><br><span class="line">16 25.9 4</span><br><span class="line">17 20.6 5</span><br><span class="line">18 21.2 5</span><br><span class="line">19 22.0 5</span><br><span class="line">20 21.2 5</span><br><span class="line"><span class="comment">#TukeyHSD图</span></span><br><span class="line"> &gt; plot(TukeyHSD(aov.mis))</span><br></pre></td></tr></table></figure></p>
<p> 注意：<strong>可以看出上述结果是所有分组间的两两比较，但经常我们所需要的仅仅是一个对照组和其他几个处理组间的比较，这时multcomp包是不错的选择；</strong><br><strong>Dunnett</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = c(56,60,44,53)</span><br><span class="line">b = c(29,38,18,35)</span><br><span class="line">c = c(11,25,7,18)</span><br><span class="line">d = c(26,44,20,32)</span><br><span class="line">strains.frame = data.frame(a, b, c, d)</span><br><span class="line">strains = stack(strains.frame)  <span class="comment">#stack是reshape2包中的一个函数，用于将宽格式数据转化为长格式；</span></span><br><span class="line">colnames(strains) = c(<span class="string">"weight"</span>, <span class="string">"group"</span>)</span><br><span class="line"><span class="comment">##常规的两两相互比较计算</span></span><br><span class="line">TukeyHSD( aov(weight ~ group, data=strains) )</span><br><span class="line">library(multcomp)</span><br><span class="line">summary(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br><span class="line"><span class="comment">## The first group ("a" in this example) is used as the reference group. </span></span><br><span class="line"><span class="comment">## If this is not the case, use the relevel() command to set the reference.</span></span><br><span class="line">strains<span class="variable">$group</span> = relevel(strains<span class="variable">$group</span>, <span class="string">"b"</span>)</span><br><span class="line">summary(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br><span class="line">plot(glht(aov(weight ~ group, data=strains), linfct=mcp(group=<span class="string">"Dunnett"</span>)))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov2.png" alt=""><br>More: <span class="exturl" data-url="aHR0cDovL2JhcmN3aWtpLndpLm1pdC5lZHUvd2lraS9TT1BzL2Fub3Zh" title="http://barcwiki.wi.mit.edu/wiki/SOPs/anova">http://barcwiki.wi.mit.edu/wiki/SOPs/anova<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov3.png" alt=""><br><i class="fa fa-book" aria-hidden="true"></i>multcomp包部分参数解释：<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>glht</strong>：General Linear Hypotheses，General linear hypotheses and multiple comparisons for parametric models, including generalized linear models, linear mixed effects models, and survival models.<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>linfct</strong>：a specification of the linear hypotheses to be tested，即指定之前的线性model将用于何种检验。<br><i class="fa fa-pencil-square-o" aria-hidden="true"></i><strong>mcp (Multiple comparisons)</strong>：多重比较的意思，For each factor, which is included in model as independent variable, a contrast matrix or a symbolic description of the contrasts can be specified as arguments to mcp，其参数意思为Tukey’s all-pair comparisons or Dunnett’s comparison with a control.</p>
<p><i class="fa fa-bullhorn"></i>同样高效的办法：<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; person &lt;- rep(c(1:10),2)</span><br><span class="line">&gt; treat &lt;- c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"A"</span>)</span><br><span class="line">&gt; phase &lt;- rep(c(1,2),each=10)</span><br><span class="line">&gt; x &lt;- c(760,860,568,780,960,940,635,440,528,800,770,855,602,800,958,952,650,450,530,803)</span><br><span class="line">&gt; data46 &lt;- data.frame(person,treat,phase,x)</span><br><span class="line">&gt; data46<span class="variable">$person</span>&lt;-factor(data46<span class="variable">$person</span>)</span><br><span class="line">&gt; data46</span><br><span class="line">   person treat phase   x</span><br><span class="line">1       1     A     1 760</span><br><span class="line">2       2     B     1 860</span><br><span class="line">3       3     A     1 568</span><br><span class="line">4       4     A     1 780</span><br><span class="line">5       5     B     1 960</span><br><span class="line">6       6     B     1 940</span><br><span class="line">7       7     A     1 635</span><br><span class="line">8       8     B     1 440</span><br><span class="line">9       9     A     1 528</span><br><span class="line">10     10     B     1 800</span><br><span class="line">11      1     B     2 770</span><br><span class="line">12      2     A     2 855</span><br><span class="line">13      3     B     2 602</span><br><span class="line">14      4     B     2 800</span><br><span class="line">15      5     A     2 958</span><br><span class="line">16      6     A     2 952</span><br><span class="line">17      7     B     2 650</span><br><span class="line">18      8     A     2 450</span><br><span class="line">19      9     B     2 530</span><br><span class="line">20     10     A     2 803</span><br><span class="line">&gt; result&lt;-aov(x~phase+person+treat,data=data46)</span><br><span class="line">&gt; summary(result)</span><br><span class="line">            Df Sum Sq Mean Sq  F value   Pr(&gt;F)    </span><br><span class="line">phase        1    490     490    9.925   0.0136 *  </span><br><span class="line">person       9 551111   61235 1240.195 1.32e-11 ***</span><br><span class="line">treat        1    198     198    4.019   0.0799 .  </span><br><span class="line">Residuals    8    395      49                      </span><br><span class="line">---</span><br><span class="line">Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span><br></pre></td></tr></table></figure></p>
<p> 观察p adj值发现两两二者间的方差显著性.<br>据上述结果可以填写下面的方差分析表:<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aoc2.png" alt=""><br>再通过函数plot( )绘图可直观描述5种不同除杂方法之间的差异, R中运行命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; plot(miscellany<span class="variable">$X</span>~miscellany<span class="variable">$A</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/aov.png" alt=""><br>从图形上也可以看出, 5种除杂方法产生的除杂量有显著差异, 特别第5种与前面的4种, 而方法1与3, 方法2与4的差异不<br>明显.</p>
<p></p><p></p><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9qcGxkL3AvNDU5NDAwMy5odG1s" title="http://www.cnblogs.com/jpld/p/4594003.html">http://www.cnblogs.com/jpld/p/4594003.html<i class="fa fa-external-link"></i></span><p></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/08/bar.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/08/bar.html" class="post-title-link" itemprop="url">bar</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-08 22:18:26" itemprop="dateCreated datePublished" datetime="2015-10-08T22:18:26+08:00">2015-10-08</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/08/bar.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/08/bar.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/08/bar.html" class="leancloud_visitors" data-flag-title="bar">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>The bar geom is used to produce 1d area plots: bar charts for categorical x, and histograms for continuous y. stat_bin explains the details of these summaries in more detail. In particular, you can use the weight aesthetic to create weighted histograms and barcharts where the height of the bar no longer represent a count of observations, but a sum over some other variable. See the examples for a practical example.</p>
<h2 id="Usage">Usage</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geom_bar(mapping = NULL, data = NULL, <span class="built_in">stat</span> = <span class="string">"bin"</span>, position = <span class="string">"stack"</span>, ...)</span><br></pre></td></tr></table></figure>
<h2 id="Aesthetics">Aesthetics</h2><p>geom_bar understands the following aesthetics (required aesthetics are in bold):</p>
<p><li> <code><strong>x</strong></code><br>  </li></p>
<p><li> <code>alpha</code><br>  </li></p>
<p><li> <code>colour</code><br>  </li></p>
<p><li> <code>fill</code><br>  </li></p>
<p><li> <code>linetype</code><br>  </li></p>
<p><li> <code>size</code><br>  </li></p>
<p><li> <code>weight</code><br></li></p>
<h2 id="Grouping_Bars_Together">Grouping Bars Together</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p&lt;- ggplot(df2, aes(x=sample, y=high, fill=sample)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,fill=<span class="string">"lightblue"</span>, color=<span class="string">"black"</span>, </span><br><span class="line">           position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=high-sd, ymax=high+sd), width=.2,</span><br><span class="line">                position=position_dodge(.9)) +</span><br><span class="line">  theme(legend.position=<span class="string">'none'</span>) +</span><br><span class="line">  labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Sample"</span>, y = <span class="string">"high"</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>aes中fill可指定不同类显示柱子颜色.<br>geom_bar()的fill修改柱子填充颜色，color修改柱子外围颜色.<br>theme()控制图例.<br>labs()添加x，y轴和主题标签.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scale_fill_brewer(palette=<span class="string">"Pastel1"</span>) <span class="comment">#亦可用来修改柱子颜色</span></span><br></pre></td></tr></table></figure></p>
<h2 id="在柱状图中使用不同颜色—把适当的变量映射到Fill中">在柱状图中使用不同颜色—把适当的变量映射到Fill中</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot(upc, aes(x=reorder(Abb, Change), y=Change, fill=Region)) +</span><br><span class="line">	  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, colour=<span class="string">"black"</span>)  +</span><br><span class="line">	  scale_fill_manual(values=c(<span class="string">"#669933"</span>, <span class="string">"#FFCC66"</span>)) + </span><br><span class="line">	  xlab(<span class="string">"State"</span>)</span><br></pre></td></tr></table></figure>
<p><i class="fa fa-hand-o-right"></i>代码解释<br>reorder函数，把柱状图按照大小排列.<br>xlab()对x轴修改坐标轴注释.<br>其方法随可以为不同柱子fill不同颜色，但所填充颜色是ggplot2系统自动生成，有时候颜色不好看想要修改为你自己制定的颜色，方法如下：<br><strong>方法1:breaks()</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MYdata &lt;- data.frame(Age = rep(c(0,1,3,6,9,12), each=20),</span><br><span class="line">                    Richness = rnorm(120, 10000, 2500))</span><br><span class="line">ggplot(data = MYdata, aes(x = Age, y = Richness)) + </span><br><span class="line">  geom_boxplot(aes(fill=factor(Age))) + </span><br><span class="line">  geom_point(aes(color = factor(Age))) +</span><br><span class="line">  scale_x_continuous(breaks = c(0, 1, 3, 6, 9, 12)) +</span><br><span class="line">  scale_colour_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>)) +</span><br><span class="line">  scale_fill_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/HPZWL.png" alt=""><br>With this color scheme, the points that fall inside the boxplot are not visible (since they are the same color as the boxplot’s fill). Perhaps leaving the boxplot hollow and drawing its lines in the color would be better.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data = MYdata, aes(x = Age, y = Richness)) + </span><br><span class="line">  geom_boxplot(aes(colour=factor(Age)), fill=NA) + </span><br><span class="line">  geom_point(aes(color = factor(Age))) +</span><br><span class="line">  scale_x_continuous(breaks = c(0, 1, 3, 6, 9, 12)) +</span><br><span class="line">  scale_colour_manual(breaks = c(<span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"3"</span>, <span class="string">"6"</span>, <span class="string">"9"</span>, <span class="string">"12"</span>),</span><br><span class="line">                      labels = c(<span class="string">"0 month"</span>, <span class="string">"1 month"</span>, <span class="string">"3 months"</span>,</span><br><span class="line">                                 <span class="string">"6 months"</span>, <span class="string">"9 months"</span>, <span class="string">"12 months"</span>),</span><br><span class="line">                      values = c(<span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, </span><br><span class="line">                                 <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Xmn5v.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br>操作自己数据时可能会出现报错 “Continuous value supplied to discrete scale” ，Brian Diggs<i class="fa fa-thumbs-o-up"></i>大神给出的解释是：<br><i class="fa fa-commenting-o"></i>Age is a continuous variable, but you are trying to use it in a discrete scale (by specifying the color for specific values of age). In general, a scale maps the variable to the visual; for a continuous age, there is a corresponding color for every possible value of age, not just the ones that happen to appear in your data. However, you can simultaneously treat age as a categorical variable (factor) for some of the aesthetics. For the third part of your question, within the scale description, you can define specific labels corresponding to specific breaks in the scale.<br>也就是要转换连续型变量为因子变量.<br><strong>方法2：Change the default palettes</strong><br>These are color-blind-friendly palettes, one with gray, and one with black.</p>
<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-5-1.png" alt=""><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-5-2.png" alt=""></p><br>To use with ggplot2, it is possible to store the palette in a variable, then use it later.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The palette with grey:</span></span><br><span class="line">cbPalette &lt;- c(<span class="string">"#999999"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>, <span class="string">"#CC79A7"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The palette with black:</span></span><br><span class="line">cbbPalette &lt;- c(<span class="string">"#000000"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>, <span class="string">"#009E73"</span>, <span class="string">"#F0E442"</span>, <span class="string">"#0072B2"</span>, <span class="string">"#D55E00"</span>, <span class="string">"#CC79A7"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use for fills, add</span></span><br><span class="line">  scale_fill_manual(values=cbPalette)</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use for line and point colors, add</span></span><br><span class="line">  scale_colour_manual(values=cbPalette)</span><br></pre></td></tr></table></figure><p></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colorblind_palette.jpg" alt=""></p>
<h2 id="Coloring_Negative_and_Postive_Bars_Differently—设定新的变量，将新建变量映射到fill中">Coloring Negative and Postive Bars Differently—设定新的变量，将新建变量映射到fill中</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">csub &lt;- subset(climate, Source==<span class="string">"Berkeley"</span> &amp; Year &gt;= 1900)</span><br><span class="line">	csub<span class="variable">$pos</span> &lt;- csub<span class="variable">$Anomaly10y</span> &gt;= 0</span><br><span class="line">	ggplot(csub, aes(x=Year, y=Anomaly10y, fill=pos)) +</span><br><span class="line">  	  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, position=<span class="string">"identity"</span>, colour=<span class="string">"black"</span>, size=0.25) +</span><br><span class="line">	  scale_fill_manual(values=c(<span class="string">"#CCEEFF"</span>, <span class="string">"#FFDDDD"</span>), guide=FALSE)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/gS0niDp.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br>首先通过subset()函数选取一个数集赋值到csub，选取原则为：climate数据中Source这一列值为Berkeley并且Year这一列&gt;= 1900.<br>csub$pos为原数集添加pos这一列，若Anomaly10y &gt;= 0则其值为TRUE,否则为FALSE.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">      Source Year Anomaly1y Anomaly5y Anomaly10y Unc10y   pos</span><br><span class="line">155 Berkeley 1954        NA        NA     -0.032  0.038 FALSE</span><br><span class="line">156 Berkeley 1955        NA        NA     -0.022  0.035 FALSE</span><br><span class="line">157 Berkeley 1956        NA        NA      0.012  0.031  TRUE</span><br><span class="line">158 Berkeley 1957        NA        NA      0.007  0.028  TRUE</span><br><span class="line">159 Berkeley 1958        NA        NA      0.002  0.027  TRUE</span><br><span class="line">160 Berkeley 1959        NA        NA      0.002  0.026  TRUE</span><br><span class="line">161 Berkeley 1960        NA        NA     -0.019  0.026 FALSE</span><br><span class="line">162 Berkeley 1961        NA        NA     -0.001  0.021 FALSE</span><br><span class="line">163 Berkeley 1962        NA        NA      0.017  0.018  TRUE</span><br><span class="line">164 Berkeley 1963        NA        NA      0.004  0.016  TRUE</span><br><span class="line">165 Berkeley 1964        NA        NA     -0.028  0.018 FALSE</span><br><span class="line">166 Berkeley 1965        NA        NA     -0.006  0.017 FALSE</span><br><span class="line">167 Berkeley 1966        NA        NA     -0.024  0.017 FALSE</span><br></pre></td></tr></table></figure></p>
<p>最后将pos映射到fill，geom_bar()中size改变柱子外框黑线的厚度.<br>scale_fill_manual()进行修改颜色，通过设定guide=FALSE 去掉图例.<br>geom_bar(width=0.5)调整width改变柱子宽度，也就是改变了柱子之间的距离.</p>
<h2 id="pylr改变图中堆积的颜色—order=desc()">pylr改变图中堆积的颜色—order=desc()</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(plyr) <span class="comment"># Needed for desc()</span></span><br><span class="line">ggplot(cabbage_exp, aes(x=Date, y=Weight, fill=Cultivar, order=desc(Cultivar))) +</span><br><span class="line">      geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br></pre></td></tr></table></figure>
<p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/52ChlFe.png" width="340"><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/9k0Y2le.png" width="340"></p><p></p>
<h2 id="Making_a_Propotional_Stacked_Bar_Graph">Making a Propotional Stacked Bar Graph</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(gcookbook) <span class="comment"># For the data set</span></span><br><span class="line">library(plyr)</span><br><span class="line"><span class="comment"># Do a group-wise transform(), splitting on "Date"</span></span><br><span class="line">ce &lt;- ddply(cabbage_exp, <span class="string">"Date"</span>, transform,</span><br><span class="line">            percent_weight = Weight / sum(Weight) * 100)</span><br><span class="line">ggplot(ce, aes(x=Date, y=percent_weight, fill=Cultivar)) +</span><br><span class="line">      geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/pZAfWxF.png" alt=""><br><i class="fa fa-hand-o-right"></i>plyr里ddply的语法解析<br>cabbage是数据集<br>“Date” 通俗来说就是x轴的变量<br>transform是要做的变形，在ddply中还有summarize等<br>最后一项是是新建的变量和变型方法</p>
<h2 id="柱条上添加文字">柱条上添加文字</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(ggthemes)</span><br><span class="line">dt = data.frame(obj = c(<span class="string">'A'</span>,<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'E'</span>,<span class="string">'C'</span>), val = c(2,15,6,9,7))</span><br><span class="line">dt<span class="variable">$obj</span> = factor(dt<span class="variable">$obj</span>, levels=c(<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'E'</span>))   <span class="comment">## 设置柱条的顺序</span></span><br><span class="line">p = ggplot(dt, aes(x = obj, y = val, fill = obj, group = factor(1))) + </span><br><span class="line">    geom_bar(<span class="built_in">stat</span> = <span class="string">"identity"</span>, width = 0.5) +   <span class="comment">## 修改柱条的宽度</span></span><br><span class="line">    theme_pander() + </span><br><span class="line">    geom_text(aes(label = val, vjust = -0.8, hjust = 0.5, color = obj), show_guide = FALSE) +   <span class="comment">## 显示柱条上的数字</span></span><br><span class="line">    ylim(min(dt<span class="variable">$val</span>, 0)*1.1, max(dt<span class="variable">$val</span>)*1.1)   <span class="comment">## 加大 Y 轴的范围，防止数字显示不齐全</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/ggthemes.png" alt=""><br><i class="fa fa-hand-o-right"></i>代码解释<br><span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dndGhlbWVzL3ZpZ25ldHRlcy9nZ3RoZW1lcy5odG1s" title="https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html">ggthemes<i class="fa fa-link"></i><i class="fa fa-external-link"></i></span>为ggplot2的一个主题包，通过theme_pander()修改ggplot2默认主题（theme）.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dt<span class="variable">$obj</span>是因子类型，ggplot2作图时按照因子水平顺序来的，所以修改因子水平的顺序即可修改作图顺序，具体可以输出dt<span class="variable">$obl</span>.</span><br></pre></td></tr></table></figure></p>
<p>另一种改变柱子顺序方式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p + scale_x_discrete(limits=c(<span class="string">'D'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'A'</span>,<span class="string">'E'</span>))</span><br></pre></td></tr></table></figure></p>
<p></p><p></p><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3lhbmdjaGFvLm1lLzIwMTMvMDIvZ2dwbG90Mi1iYXItY2hhcnQv" title="http://yangchao.me/2013/02/ggplot2-bar-chart/">http://yangchao.me/2013/02/ggplot2-bar-chart/<i class="fa fa-external-link"></i></span><br>                       <span class="exturl" data-url="aHR0cDovL3d3dy5idWJ1a28uY29tL2luZm9kZXRhaWwtMTA1MTk0MC5odG1s" title="http://www.bubuko.com/infodetail-1051940.html">http://www.bubuko.com/infodetail-1051940.html<i class="fa fa-external-link"></i></span><br>                       <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDgwNTY0My9nZ3Bsb3QyLWFkZC1jb2xvci10by1ib3hwbG90LWNvbnRpbnVvdXMtdmFsdWUtc3VwcGxpZWQtdG8tZGlzY3JldGUtc2NhbGUtZXI=" title="http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er">http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er<i class="fa fa-external-link"></i></span><p></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/07/icon.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/07/icon.html" class="post-title-link" itemprop="url">Icons</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-07 13:56:31" itemprop="dateCreated datePublished" datetime="2015-10-07T13:56:31+08:00">2015-10-07</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Hexo/" itemprop="url" rel="index"><span itemprop="name">Hexo</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/07/icon.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/07/icon.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/07/icon.html" class="leancloud_visitors" data-flag-title="Icons">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p><i class="fa fa-bullhorn fa-3x"></i> Setting up Font Awesome can be as simple as adding two lines of code to your website, or you can be a pro and<br>customize the LESS yourself! Font Awesome even plays nicely with<span class="exturl" data-url="aHR0cDovL2dldGJvb3RzdHJhcC5jb20=" title="http://getbootstrap.com">Bootstrap 3<i class="fa fa-external-link"></i></span>!</p>
<h2 id="Paste_the_following_code_into_the_section_of_your_site’s_HTML-"><i class="fa fa-pencil-square-o"></i>Paste the following code into the <head> section of your site’s HTML.</head></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="如果font-awesome-min-css文件在本地，则按一下操作：">如果font-awesome.min.css文件在本地，则按一下操作：</h3><p><i class="fa fa-hand-lizard-o"></i> 进入<i class="fa fa-chain-broken"></i> <span class="exturl" data-url="aHR0cDovL2ZvbnRhd2Vzb21lLmlvLyNtb2RhbC1kb3dubG9hZA==" title="http://fontawesome.io/#modal-download">fontawesome<i class="fa fa-external-link"></i></span>下载字体<i class="fa fa-font"></i>和相应的CSS<i class="fa fa-th"></i>文件。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/font.png" alt=""></p>
<p></p><p></p><br><i class="fa fa-hand-lizard-o"></i> 找到下载<i class="fa fa-download"></i>压缩文件<i class="fa fa-file-archive-o"></i>中的fonts<i class="fa fa-file"></i>和css<i class="fa fa-file"></i>文件夹，将其中内容拷贝<i class="fa fa-files-o"></i>到自己站点下。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/font2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">your blog address\themes\jacman\<span class="built_in">source</span>\font   修改字体文件</span><br><span class="line">your blog address\jacman\<span class="built_in">source</span>\css    修改字体相应的css</span><br></pre></td></tr></table></figure><p></p>
<p><i class="fa fa-hand-lizard-o"></i> following code into the <head> section of your site’s HTML.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href=<span class="string">"/css/font-awesome.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure></head></p>
<h2 id="Examples"><i class="fa fa-pencil-square-o"></i>Examples</h2><h3 id="Basic_Icons">Basic Icons</h3><p><i class="fa fa-camera-retro"></i> fa-camera-retro<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro"</span>&gt;&lt;/i&gt; fa-camera-retro</span><br></pre></td></tr></table></figure></p>
<h3 id="Larger_Icons">Larger Icons</h3><p><i class="fa fa-camera-retro fa-lg"></i> fa-lg<br><i class="fa fa-camera-retro fa-2x"></i> fa-2x<br><i class="fa fa-camera-retro fa-3x"></i> fa-3x<br><i class="fa fa-camera-retro fa-4x"></i> fa-4x<br><i class="fa fa-camera-retro fa-5x"></i> fa-5x<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-lg"</span>&gt;&lt;/i&gt; fa-lg</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-2x"</span>&gt;&lt;/i&gt; fa-2x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-3x"</span>&gt;&lt;/i&gt; fa-3x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-4x"</span>&gt;&lt;/i&gt; fa-4x</span><br><span class="line">&lt;i class=<span class="string">"fa fa-camera-retro fa-5x"</span>&gt;&lt;/i&gt; fa-5x</span><br></pre></td></tr></table></figure></p>
<h3 id="Fixed_Width_Icons">Fixed Width Icons</h3><p>  <a class="list-group-item" href="#"><i class="fa fa-home fa-fw"></i>&nbsp; Home</a><br>  <a class="list-group-item" href="#"><i class="fa fa-book fa-fw"></i>&nbsp; Library</a><br>  <a class="list-group-item" href="#"><i class="fa fa-pencil fa-fw"></i>&nbsp; Applications</a><br>  <a class="list-group-item" href="#"><i class="fa fa-cog fa-fw"></i>&nbsp; Settings</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=<span class="string">"list-group"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-home fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Home&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-book fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Library&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-pencil fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Applications&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"list-group-item"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-cog fa-fw"</span>&gt;&lt;/i&gt;&amp;nbsp; Settings&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="List_Icons">List Icons</h3><p>  <li><i class="fa-li fa fa-check-square"></i>List icons</li><br>  <li><i class="fa-li fa fa-check-square"></i>can be used</li><br>  <li><i class="fa-li fa fa-spinner fa-spin"></i>as bullets</li><br>  <li><i class="fa-li fa fa-square"></i>in lists</li><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class=<span class="string">"fa-ul"</span>&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-check-square"</span>&gt;&lt;/i&gt;List icons&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-check-square"</span>&gt;&lt;/i&gt;can be used&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-spinner fa-spin"</span>&gt;&lt;/i&gt;as bullets&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;i class=<span class="string">"fa-li fa fa-square"</span>&gt;&lt;/i&gt;<span class="keyword">in</span> lists&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Bordered_&amp;_Pulled_Icons">Bordered &amp; Pulled Icons</h3><p><i class="fa fa-quote-left fa-3x fa-pull-left fa-border"></i><br>…tomorrow we will run faster, stretch out our arms farther…<br>And then one fine morning— So we beat on, boats against the<br>current, borne back ceaselessly into the past.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-quote-left fa-3x fa-pull-left fa-border"</span>&gt;&lt;/i&gt;</span><br><span class="line">...tomorrow we will run faster, stretch out our arms farther...</span><br><span class="line">And <span class="keyword">then</span> one fine morning— So we beat on, boats against the</span><br><span class="line">current, borne back ceaselessly into the past.</span><br></pre></td></tr></table></figure></p>
<h3 id="Animated_Icons">Animated Icons</h3><p><i class="fa fa-spinner fa-spin"></i><br><i class="fa fa-circle-o-notch fa-spin"></i><br><i class="fa fa-refresh fa-spin"></i><br><i class="fa fa-cog fa-spin"></i><br><i class="fa fa-spinner fa-pulse"></i><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-spinner fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-circle-o-notch fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-refresh fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-cog fa-spin"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-spinner fa-pulse"</span>&gt;&lt;/i&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Rotated_&amp;_Flipped">Rotated &amp; Flipped</h3><p><i class="fa fa-shield"></i> normal<br><br><i class="fa fa-shield fa-rotate-90"></i> fa-rotate-90<br><br><i class="fa fa-shield fa-rotate-180"></i> fa-rotate-180<br><br><i class="fa fa-shield fa-rotate-270"></i> fa-rotate-270<br><br><i class="fa fa-shield fa-flip-horizontal"></i> fa-flip-horizontal<br><br><i class="fa fa-shield fa-flip-vertical"></i> icon-flip-vertical<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;i class=<span class="string">"fa fa-shield"</span>&gt;&lt;/i&gt; normal&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-90"</span>&gt;&lt;/i&gt; fa-rotate-90&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-180"</span>&gt;&lt;/i&gt; fa-rotate-180&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-rotate-270"</span>&gt;&lt;/i&gt; fa-rotate-270&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-flip-horizontal"</span>&gt;&lt;/i&gt; fa-flip-horizontal&lt;br&gt;</span><br><span class="line">&lt;i class=<span class="string">"fa fa-shield fa-flip-vertical"</span>&gt;&lt;/i&gt; icon-flip-vertical</span><br></pre></td></tr></table></figure></p>
<h3 id="Stacked_Icons">Stacked Icons</h3><p><span class="fa-stack fa-lg"><br>  <i class="fa fa-square-o fa-stack-2x"></i><br>  <i class="fa fa-twitter fa-stack-1x"></i><br></span><br>fa-twitter on fa-square-o<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-circle fa-stack-2x"></i><br>  <i class="fa fa-flag fa-stack-1x fa-inverse"></i><br></span><br>fa-flag on fa-circle<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-square fa-stack-2x"></i><br>  <i class="fa fa-terminal fa-stack-1x fa-inverse"></i><br></span><br>fa-terminal on fa-square<br><br><span class="fa-stack fa-lg"><br>  <i class="fa fa-camera fa-stack-1x"></i><br>  <i class="fa fa-ban fa-stack-2x text-danger"></i><br></span><br>fa-ban on fa-camera<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-square-o fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-twitter fa-stack-1x"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-twitter on fa-square-o&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-circle fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-flag fa-stack-1x fa-inverse"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-flag on fa-circle&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-square fa-stack-2x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-terminal fa-stack-1x fa-inverse"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-terminal on fa-square&lt;br&gt;</span><br><span class="line">&lt;span class=<span class="string">"fa-stack fa-lg"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-camera fa-stack-1x"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-ban fa-stack-2x text-danger"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">fa-ban on fa-camera</span><br></pre></td></tr></table></figure></p>
<h3 id="Bootstrap_3_Examples">Bootstrap 3 Examples</h3><p><a class="btn btn-danger" href="#"><br>  <i class="fa fa-trash-o fa-lg"></i> Delete</a><br><a class="btn btn-default btn-sm" href="#"><br>  <i class="fa fa-cog"></i> Settings</a></p>
<p><a class="btn btn-lg btn-success" href="#"><br>  <i class="fa fa-flag fa-2x pull-left"></i> Font Awesome<br>Version 4.4.0</a></p>
<div class="btn-group"><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-left"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-center"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-right"></i></a><br>  <a class="btn btn-default" href="#"><i class="fa fa-align-justify"></i></a><br></div>

<div class="input-group margin-bottom-sm"><br>  <span class="input-group-addon"><i class="fa fa-envelope-o fa-fw"></i></span><br>  <input class="form-control" type="text" placeholder="Email address"><br></div><br><div class="input-group"><br>  <span class="input-group-addon"><i class="fa fa-key fa-fw"></i></span><br>  <input class="form-control" type="password" placeholder="Password"><br></div>

<p><div class="btn-group open"><br>  <a class="btn btn-primary" href="#"><i class="fa fa-user fa-fw"></i> User</a><br>  <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><br>    <span class="fa fa-caret-down"></span></a><br>  <ul class="dropdown-menu"><br>    <li><a href="#"><i class="fa fa-pencil fa-fw"></i> Edit</a></li><br>    <li><a href="#"><i class="fa fa-trash-o fa-fw"></i> Delete</a></li><br>    <li><a href="#"><i class="fa fa-ban fa-fw"></i> Ban</a></li><br>    <li><a href="#"><i class="i"></i> Make admin</a></li><br>  </ul><br></div><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;a class=<span class="string">"btn btn-danger"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-trash-o fa-lg"</span>&gt;&lt;/i&gt; Delete&lt;/a&gt;</span><br><span class="line">&lt;a class=<span class="string">"btn btn-default btn-sm"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-cog"</span>&gt;&lt;/i&gt; Settings&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;a class=<span class="string">"btn btn-lg btn-success"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">  &lt;i class=<span class="string">"fa fa-flag fa-2x pull-left"</span>&gt;&lt;/i&gt; Font Awesome&lt;br&gt;Version 4.4.0&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"btn-group"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-left"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-center"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-right"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-default"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-align-justify"</span>&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"input-group margin-bottom-sm"</span>&gt;</span><br><span class="line">  &lt;span class=<span class="string">"input-group-addon"</span>&gt;&lt;i class=<span class="string">"fa fa-envelope-o fa-fw"</span>&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class="line">  &lt;input class=<span class="string">"form-control"</span> <span class="built_in">type</span>=<span class="string">"text"</span> placeholder=<span class="string">"Email address"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=<span class="string">"input-group"</span>&gt;</span><br><span class="line">  &lt;span class=<span class="string">"input-group-addon"</span>&gt;&lt;i class=<span class="string">"fa fa-key fa-fw"</span>&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class="line">  &lt;input class=<span class="string">"form-control"</span> <span class="built_in">type</span>=<span class="string">"password"</span> placeholder=<span class="string">"Password"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"btn-group open"</span>&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-primary"</span> href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-user fa-fw"</span>&gt;&lt;/i&gt; User&lt;/a&gt;</span><br><span class="line">  &lt;a class=<span class="string">"btn btn-primary dropdown-toggle"</span> data-toggle=<span class="string">"dropdown"</span> href=<span class="string">"#"</span>&gt;</span><br><span class="line">    &lt;span class=<span class="string">"fa fa-caret-down"</span>&gt;&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">  &lt;ul class=<span class="string">"dropdown-menu"</span>&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-pencil fa-fw"</span>&gt;&lt;/i&gt; Edit&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-trash-o fa-fw"</span>&gt;&lt;/i&gt; Delete&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"fa fa-ban fa-fw"</span>&gt;&lt;/i&gt; Ban&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href=<span class="string">"#"</span>&gt;&lt;i class=<span class="string">"i"</span>&gt;&lt;/i&gt; Make admin&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL2ZvbnRhd2Vzb21lLmlvL2V4YW1wbGVzLw==" title="http://fontawesome.io/examples/">http://fontawesome.io/examples/<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/05/plot-text.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/05/plot-text.html" class="post-title-link" itemprop="url">为图形添加文本</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-05 19:52:16" itemprop="dateCreated datePublished" datetime="2015-10-05T19:52:16+08:00">2015-10-05</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/05/plot-text.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/05/plot-text.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/05/plot-text.html" class="leancloud_visitors" data-flag-title="为图形添加文本">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&gt; text1&lt;-read.delim(<span class="string">"fun.txt"</span>,header=FALSE)</span><br><span class="line">&gt; text1</span><br><span class="line">                                                                    V1</span><br><span class="line">1                                   INFORMATION STORAGE AND PROCESSING</span><br><span class="line">2                 [J] Translation, ribosomal structure and biogenesis </span><br><span class="line">3                                 [A] RNA processing and modification </span><br><span class="line">4                                                   [K] Transcription </span><br><span class="line">5                           [L] Replication, recombination and repair </span><br><span class="line">6                                [B] Chromatin structure and dynamics </span><br><span class="line">7                                     CELLULAR PROCESSES AND SIGNALING</span><br><span class="line">8      [D] Cell cycle control, cell division, chromosome partitioning </span><br><span class="line">9                                               [Y] Nuclear structure </span><br><span class="line">10                                             [V] Defense mechanisms </span><br><span class="line">11                                 [T] Signal transduction mechanisms </span><br><span class="line">12                         [M] Cell wall/membrane/envelope biogenesis </span><br><span class="line">13                                                  [N] Cell motility </span><br><span class="line">14                                                   [Z] Cytoskeleton </span><br><span class="line">15                                       [W] Extracellular structures </span><br><span class="line">16  [U] Intracellular trafficking, secretion, and vesicular transport </span><br><span class="line">17   [O] Posttranslational modification, protein turnover, chaperones </span><br><span class="line">18                                                          METABOLISM</span><br><span class="line">19                               [C] Energy production and conversion </span><br><span class="line">20                          [G] Carbohydrate transport and metabolism </span><br><span class="line">21                            [E] Amino acid transport and metabolism </span><br><span class="line">22                            [F] Nucleotide transport and metabolism </span><br><span class="line">23                              [H] Coenzyme transport and metabolism </span><br><span class="line">24                                 [I] Lipid transport and metabolism </span><br><span class="line">25                         [P] Inorganic ion transport and metabolism </span><br><span class="line">26   [Q] Secondary metabolites biosynthesis, transport and catabolism </span><br><span class="line">27                                                POORLY CHARACTERIZED</span><br><span class="line">28                               [R] General <span class="keyword">function</span> prediction only </span><br><span class="line">29                                               [S] Function unknown </span><br><span class="line">&gt; a&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>);</span><br><span class="line">&gt; b&lt;-c(1,2,3);</span><br><span class="line">&gt; c&lt;-c(4,6,7);</span><br><span class="line">&gt; abc&lt;-data.frame(a,b,c);</span><br><span class="line">&gt; abc;</span><br><span class="line">  a b c</span><br><span class="line">1 a 1 4</span><br><span class="line">2 b 2 6</span><br><span class="line">3 c 3 7</span><br><span class="line">&gt; library(reshape2);</span><br><span class="line">&gt; agcd&lt;-melt(abc,id.vars=<span class="string">"a"</span>,value.name=<span class="string">"value"</span>,variable.name=<span class="string">"bq"</span>);</span><br><span class="line">&gt; len&lt;-nrow(text1);</span><br><span class="line">&gt; a1&lt;-agcd[,1];</span><br><span class="line">&gt; b1&lt;-agcd[,3];</span><br><span class="line">&gt; library(ggplot2);</span><br><span class="line">&gt; library(grid);</span><br><span class="line">&gt; vp1&lt;-viewport(width=0.6,height=1,x=0.3,y=0.5);</span><br><span class="line">&gt; pm&lt;-ggplot(agcd,aes(a1,weight=value,fill=bq))+geom_bar(position=<span class="string">"dodge"</span>)+theme(legend.title=element_blank(),legend.position=c(0.1,0.9))+xlab(<span class="string">"COG"</span>)+ylab(<span class="string">"M82/smithella  and  M82/SB"</span>);</span><br><span class="line"><span class="comment">#之上为画图部分，下面开始绘制文本</span></span><br><span class="line">&gt; par(fig=c(0.55,1,0,1),bty=<span class="string">"n"</span>);</span><br><span class="line">&gt; b&lt;-20;</span><br><span class="line">&gt; plot(1:b,1:b,<span class="built_in">type</span>=<span class="string">"n"</span>,xaxt=<span class="string">"n"</span>,yaxt=<span class="string">"n"</span>,xlab=<span class="string">""</span>,ylab=<span class="string">""</span>);</span><br><span class="line">&gt; sum=b+b/(2*len);</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:(len))&#123;</span><br><span class="line">+   <span class="keyword">if</span> (i %<span class="keyword">in</span>% c(1,7,18,27) )&#123;</span><br><span class="line">+     text(1,sum,text1[i,],adj=0,cex=0.8,font=2);</span><br><span class="line">+     sum=sum-b/(len);</span><br><span class="line">+   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">+     text(1,sum,text1[i,],adj=0,cex=0.8);</span><br><span class="line">+     sum=sum-b/(len);&#125;&#125;</span><br><span class="line"><span class="comment">#将图形和文本合并</span></span><br><span class="line">&gt; <span class="built_in">print</span>(pm,vp=vp1);</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plot-text.png" alt=""></p>
<h3 id="关键点解释">关键点解释</h3><p>设置图形参数—函数par()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adj：设定在text、mtext、title中字符串的对齐方向。0表示左对齐，0.5（默认值）表示居中，而1表示右对齐。</span><br><span class="line">ann：如果ann=FALSE，那么高水平绘图函数会调用函数plot.default使对坐标轴名称、整体图像名称不做任何注解。</span><br><span class="line">bty：用于限定图形的边框类型。如果bty的值为<span class="string">"o"</span>（默认值）、<span class="string">"l"</span>、<span class="string">"7"</span>、<span class="string">"c"</span>、<span class="string">"u"</span>或者<span class="string">"]"</span>中的任意一个，对应的边框类型就和该字母的形状相似，<span class="string">"n"</span>，表示无边框。</span><br><span class="line">fig: c(x1, x2, y1, y2)，设定当前图形在绘图设备中所占区域，需要满足x1&lt;x2,y1&lt;y2。如果修改参数fig，会自动打开一个新的绘图设备，而若希望在原来的绘图设备中添加新的图形，需要和参数new=TRUE一起使用。</span><br><span class="line">fin：当前绘图区域的尺寸规格，形式为(width,height)。</span><br><span class="line">lty：直线类型。参数的值可以为整数（0为空，1为实线（默认值），2为虚线，3为点线。</span><br><span class="line">oma：参数形式为c(bottom, left, top, right) ，用于设定外边界。</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fig.jpg" alt=""><br>melt()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id.vars 是被当做维度的列变量，每个变量在结果中占一列；</span><br><span class="line">measure.vars 是被当成观测值的列变量，它们的列变量名称和值分别组成 variable 和 value两列，列变量名称用variable.name 和 value.name来指定。</span><br></pre></td></tr></table></figure></p>
<p>position()<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">geom_bar(position=<span class="string">"dodge"</span>)调整条形图排列方式，可选参数为<span class="string">"dodge，fill，identity，jitter，stack"</span>。legend.position调整图例位置。</span><br><span class="line">dodge：<span class="string">"避让"</span>方式，即往旁边闪，如柱形图的并排方式就是这种</span><br><span class="line">fill：填充方式， 先把数据归一化，再填充到绘图区的顶部</span><br><span class="line">identity：原地不动，不调整位置</span><br><span class="line">jitter：随机抖一抖，让本来重叠的露出点头来</span><br><span class="line">stack：叠罗汉</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&lt;-20;为自定义值，根据图形微调。</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1,7,18,27为文本文件中特殊行。</span><br></pre></td></tr></table></figure>
<h2 id="附加">附加</h2><p>通过设置par（）绘制一页多图<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">attach(mtcars)</span><br><span class="line">opar&lt;-par(no.readonly=T) </span><br><span class="line">par(fig=c(0,0.8,0,0.8))</span><br><span class="line">plot(wt,mpg,xlab=<span class="string">"Miles per Gallon"</span>,ylab=<span class="string">"car weight"</span>)</span><br><span class="line">par(fig=c(0,0.8,0.55,1),new=T)</span><br><span class="line">boxplot(wt,horizontal=T,axes=F)</span><br><span class="line">par(fig=c(0.65,1,0,0.8),new=T)</span><br><span class="line">boxplot(mpg,axes=F)</span><br><span class="line">par(opar)</span><br><span class="line">detach(mtcars)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/duotu.png" alt=""></p>
<p><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5kYXRhZ3VydS5jbi9hcnRpY2xlLTQ4MjctMS5odG1s" title="http://www.dataguru.cn/article-4827-1.html">http://www.dataguru.cn/article-4827-1.html<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/05/statistics.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/05/statistics.html" class="post-title-link" itemprop="url">R中分组统计函数</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-05 19:37:27" itemprop="dateCreated datePublished" datetime="2015-10-05T19:37:27+08:00">2015-10-05</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/05/statistics.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/05/statistics.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/05/statistics.html" class="leancloud_visitors" data-flag-title="R中分组统计函数">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="apply（对一个数组按行或者按列进行计算）">apply（对一个数组按行或者按列进行计算）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply(X, MARGIN, FUN, ...)</span><br></pre></td></tr></table></figure></p>
<p>其中X为一个数组；MARGIN为一个向量（表示要将函数FUN应用到X的行还是列），若为1表示取行，为2表示取列，为c(1,2)表示行、列都计算。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; ma &lt;- matrix(c(1:4, 1, 6:8), nrow = 2)</span><br><span class="line">&gt; ma</span><br><span class="line">     [,1] [,2] [,3] [,4]</span><br><span class="line">[1,]    1    3    1    7</span><br><span class="line">[2,]    2    4    6    8</span><br><span class="line">&gt; apply(ma, c(1,2), sum)</span><br><span class="line">     [,1] [,2] [,3] [,4]</span><br><span class="line">[1,]    1    3    1    7</span><br><span class="line">[2,]    2    4    6    8</span><br><span class="line">&gt; apply(ma, 1, sum)</span><br><span class="line">[1] 12 20</span><br><span class="line">&gt; apply(ma, 2, sum)</span><br><span class="line">[1]  3  7  7 15</span><br></pre></td></tr></table></figure></p>
<h2 id="tapply（分组统计）">tapply（分组统计）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tapply(X, INDEX, FUN = NULL, ..., simplify = TRUE)</span><br></pre></td></tr></table></figure></p>
<p>其中X通常是一向量；<br>INDEX是一个list对象，且该list中的每一个元素都是与X有同样长度的因子；<br>FUN是需要计算的函数；<br>simplify是逻辑变量，若取值为TRUE（默认值），且函数FUN的计算结果总是为一个标量值，那么函数tapply返回一个数组；<br>                  若取值为FALSE，则函数tapply的返回值为一个list对象。<br>需要注意的是，当第二个参数INDEX不是因子时，函数 tapply() 同样有效，因为必要时 R 会用 as.factor()把参数强制转换成因子。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt; a&lt;-data.frame(name=c(<span class="string">"tom"</span>,<span class="string">"sam"</span>,<span class="string">"mik"</span>,<span class="string">"ali"</span>),age=c(8,9,8,9),math=c(50,100,70,90),verbal=c(90,60,96,80))</span><br><span class="line">&gt; a</span><br><span class="line">  name age math verbal</span><br><span class="line">1  tom   8   50     90</span><br><span class="line">2  sam   9  100     60</span><br><span class="line">3  mik   8   70     96</span><br><span class="line">4  ali   9   90     80</span><br><span class="line">&gt; ages&lt;-levels(as.factor(a<span class="variable">$age</span>))</span><br><span class="line">&gt; ages</span><br><span class="line">[1] <span class="string">"8"</span> <span class="string">"9"</span></span><br><span class="line">&gt; b&lt;-matrix(nrow=length(ages),ncol=2)</span><br><span class="line">&gt; rownames(b)&lt;-ages</span><br><span class="line">&gt; colnames(b)&lt;-c(<span class="string">"math"</span>,<span class="string">"verbal"</span>)</span><br><span class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> 1:2)&#123;</span><br><span class="line">+   b[,i]&lt;-tapply(a[,i+2],a[,<span class="string">"age"</span>],mean)   <span class="comment">#tapply的排序方法是输入factor的levels.</span></span><br><span class="line">+   &#125;</span><br><span class="line">&gt; b</span><br><span class="line">  math verbal</span><br><span class="line">8   60     93</span><br><span class="line">9   95     70</span><br></pre></td></tr></table></figure></p>
<h2 id="table（因子出现的频数）">table（因子出现的频数）</h2><p>使用格式为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table(..., exclude = <span class="keyword">if</span> (useNA == <span class="string">"no"</span>) c(NA, NaN), useNA = c(<span class="string">"no"</span>,</span><br><span class="line">    <span class="string">"ifany"</span>, <span class="string">"always"</span>), dnn = list.names(...), deparse.level = 1)</span><br></pre></td></tr></table></figure></p>
<p>其中参数exclude表示哪些因子不计算。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; d &lt;- factor(rep(c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>), 10), levels=c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>,<span class="string">"E"</span>))</span><br><span class="line">&gt; d</span><br><span class="line"> [1] A B C A B C A B C A B C A B C A B C A B C A B C A B C A B C</span><br><span class="line">Levels: A B C D E</span><br><span class="line">&gt; table(d)</span><br><span class="line">d</span><br><span class="line"> A  B  C  D  E</span><br><span class="line">10 10 10  0  0</span><br><span class="line">&gt; table(d, exclude=<span class="string">"B"</span>)</span><br><span class="line">d</span><br><span class="line"> A  C  D  E</span><br><span class="line">10 10  0  0</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/05/plotrix.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/05/plotrix.html" class="post-title-link" itemprop="url">R作图--坐标中断(axis breaks)-- plotrix</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-05 13:12:51" itemprop="dateCreated datePublished" datetime="2015-10-05T13:12:51+08:00">2015-10-05</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/05/plotrix.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/05/plotrix.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/05/plotrix.html" class="leancloud_visitors" data-flag-title="R作图--坐标中断(axis breaks)-- plotrix">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>R当中的坐标中断一般都使用plotrix库中的axis.break(), gap.plot(), gap.barplot(), gap.boxplot()等几个函数来实现.</p>
<h2 id="axis-break">axis.break</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(plotrix)</span><br><span class="line">opar&lt;-par(mfrow=c(1,3))</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of gap"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of slash"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">plot(sample(5:7,20,replace=T),main=<span class="string">"Axis break test of zigzag"</span>,ylim=c(2,8))</span><br><span class="line">axis.break(axis=2,breakpos=3.5,breakcol=<span class="string">"red"</span>,style=<span class="string">"zigzag"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix1.png" alt=""></p>
<h3 id="parameters">parameters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">axis.break(axis=1,breakpos=NULL,pos=NA,bgcol=<span class="string">"white"</span>,breakcol=<span class="string">"black"</span>,</span><br><span class="line">           style=<span class="string">"slash"</span>,brw=0.02)</span><br><span class="line">axis：    <span class="built_in">which</span> axis to <span class="built_in">break</span>,1=x轴，2=y轴，3=顶端x轴，4=右y轴</span><br><span class="line">breakpos：<span class="built_in">where</span> to place the <span class="built_in">break</span> <span class="keyword">in</span> user units</span><br><span class="line">pos：     position of the axis (see axis)</span><br><span class="line">bgcol：   the color of the plot background</span><br><span class="line">breakcol：the color of the <span class="string">"break"</span> marker</span><br><span class="line">style：   Either gap, slash or zigzag</span><br><span class="line">brw：     <span class="built_in">break</span> width relative to plot width</span><br></pre></td></tr></table></figure>
<h2 id="gap-plot">gap.plot</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">opar&lt;-par(mfrow=c(1,3))</span><br><span class="line">twogrp&lt;-c(rnorm(5)+4,rnorm(5)+20,rnorm(5)+5,rnorm(5)+22)</span><br><span class="line">gap.plot(twogrp,gap=c(8,16,25,35),</span><br><span class="line">          xlab=<span class="string">"X values"</span>,ylab=<span class="string">"Y values"</span>,xlim=c(1,30),ylim=c(0,45),</span><br><span class="line">          main=<span class="string">"Test two gap plot with the lot"</span>,xtics=seq(0,30,by=5),</span><br><span class="line">          ytics=c(4,6,18,20,22,38,40,42),</span><br><span class="line">          lty=c(rep(1,10),rep(2,10)),</span><br><span class="line">          pch=c(rep(2,10),rep(3,10)),</span><br><span class="line">          col=c(rep(2,10),rep(3,10)),</span><br><span class="line">          <span class="built_in">type</span>=<span class="string">"b"</span>)</span><br><span class="line">gap.plot(21:30,rnorm(10)+40,gap=c(8,16,25,35),add=TRUE,</span><br><span class="line">         lty=rep(3,10),col=rep(4,10),<span class="built_in">type</span>=<span class="string">"l"</span>)</span><br><span class="line">gap.barplot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ytics=c(3,6,17,20),</span><br><span class="line">         ylab=<span class="string">"Group values"</span>,main=<span class="string">"Barplot with gap"</span>)</span><br><span class="line">gap.barplot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ytics=c(3,6,17,20),</span><br><span class="line">         ylab=<span class="string">"Group values"</span>,horiz=TRUE,main=<span class="string">"Horizontal barplot with gap"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">opar&lt;-par(mfrow=c(1,2))</span><br><span class="line">twovec&lt;-list(vec1=c(rnorm(30),-6),vec2=c(sample(1:10,40,TRUE),20))</span><br><span class="line">gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),</span><br><span class="line">        main=<span class="string">"Show outliers separately"</span>)</span><br><span class="line">gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),range=0,</span><br><span class="line">         main=<span class="string">"Include outliers in whiskers"</span>)</span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix3.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">twogrp&lt;-c(rnorm(5)+4,rnorm(5)+20,rnorm(5)+5,rnorm(5)+22)</span><br><span class="line">gpcol&lt;-c(2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5)</span><br><span class="line">gap.plot(twogrp,gap=c(8,16),xlab=<span class="string">"Index"</span>,ylab=<span class="string">"Group values"</span>, main=<span class="string">"E "</span>,col=gpcol)</span><br><span class="line">legend(19, 9.5, c(<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>), pch = 1, col = 2:5)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix4.png" alt=""></p>
<h3 id="parameters-1">parameters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">gap.plot(x,y,gap,gap.axis=<span class="string">"y"</span>,bgcol=<span class="string">"white"</span>,breakcol=<span class="string">"black"</span>,brw=0.02,xlim=range(x),ylim=range(y),</span><br><span class="line">xticlab,xtics=NA,yticlab,ytics=NA,lty=rep(1,length(x)),col=rep(par(<span class="string">"col"</span>),length(x)),</span><br><span class="line">pch=rep(1,length(x)),add=FALSE,stax=FALSE,...)</span><br><span class="line"> </span><br><span class="line">x,y:      data values</span><br><span class="line">gap:      the range(s) of values to be left out  省略的轴</span><br><span class="line">gap.axis: whether the gaps are to be on the x or y axis   在哪个轴上省略</span><br><span class="line">bgcol:    the color of the plot background</span><br><span class="line">breakcol: the color of the <span class="string">"break"</span> marker</span><br><span class="line">brw:      <span class="built_in">break</span> width relative to plot width</span><br><span class="line">xlim,ylim:the plot limits.</span><br><span class="line">xticlab:  labels <span class="keyword">for</span> the x axis ticks</span><br><span class="line">xtics:    position of the x axis ticks  <span class="comment">#x轴显示的表号</span></span><br><span class="line">yticlab:  labels <span class="keyword">for</span> the y axis ticks</span><br><span class="line">ytics:    position of the y axis ticks</span><br><span class="line">lty:      line <span class="built_in">type</span>(s) to use <span class="keyword">if</span> there are lines</span><br><span class="line">col:      color(s) <span class="keyword">in</span> <span class="built_in">which</span> to plot the values</span><br><span class="line">pch:      symbols to use <span class="keyword">in</span> plotting.</span><br><span class="line">add:      whether to add values to an existing plot.</span><br><span class="line">stax:     whether to call staxlab <span class="keyword">for</span> staggered axis labels.</span><br></pre></td></tr></table></figure>
<h2 id="gap-barplot">gap.barplot</h2><p>使用gap.plot, gap.barplot, gap.boxplot之后重新使用axis.break来修改中断类型，使得看上去美一点,<br>并绘制出双反斜线中断，可以视实际情况延伸断点起止位置.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">library(plotrix)</span><br><span class="line">opar&lt;-par(mfrow=c(2,2))</span><br><span class="line">x&lt;-c(1:5,6.9,7)</span><br><span class="line">y&lt;-2^x</span><br><span class="line">from&lt;-33</span><br><span class="line">to&lt;-110</span><br><span class="line">plot(x,y,<span class="built_in">type</span>=<span class="string">"b"</span>,main=<span class="string">"normal plot"</span>)</span><br><span class="line">gap.plot(x,y,gap=c(from,to),<span class="built_in">type</span>=<span class="string">"b"</span>,main=<span class="string">"gap plot"</span>)</span><br><span class="line">axis.break(2,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(2,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(4,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(2,at=from)</span><br><span class="line">gap.barplot(y,gap=c(from,to),col=as.numeric(x),main=<span class="string">"barplot with gap"</span>)</span><br><span class="line">axis.break(2,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(2,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(4,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(2,at=from)</span><br><span class="line">gap.barplot(y,gap=c(from,to),col=as.numeric(x),horiz=T,main=<span class="string">"Horizontal barplot with gap"</span>)</span><br><span class="line">axis.break(1,from,breakcol=<span class="string">"red"</span>,style=<span class="string">"gap"</span>)</span><br><span class="line">axis.break(1,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis.break(3,from*(1+0.02),breakcol=<span class="string">"black"</span>,style=<span class="string">"slash"</span>)</span><br><span class="line">axis(1,at=from) </span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/plotrix5.png" alt=""><br><i class="fa fa-diamond"></i>如果画图过程中困惑了，记得重新来看一下内容，有惊喜：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">x1=c(3,5,6,9,375,190);</span><br><span class="line">x1</span><br><span class="line">x2=c(2,2,3,30,46,60);</span><br><span class="line">x2</span><br><span class="line">data=rbind(x1,x2);</span><br><span class="line">data</span><br><span class="line">colnames(data)=c(<span class="string">"Pig"</span>,<span class="string">"Layer"</span>,<span class="string">"Broiler"</span>,<span class="string">"Dairy"</span>,<span class="string">"Beef"</span>,<span class="string">"Sheep"</span>)</span><br><span class="line">rownames(data)=c(<span class="string">"1980"</span>,<span class="string">"2010"</span>)</span><br><span class="line">data</span><br><span class="line">library(plotrix)</span><br><span class="line">newdata&lt;-data</span><br><span class="line">newdata[newdata&gt;200]&lt;-newdata[newdata&gt;200]-150</span><br><span class="line">newdata</span><br><span class="line">barpos&lt;-barplot(newdata,names.arg=colnames(newdata),</span><br><span class="line">                ylim=c(0,250),beside=TRUE,col=c(<span class="string">"darkblue"</span>,<span class="string">"red"</span>),axes=FALSE)</span><br><span class="line">axis(2,at=c(0,50,100,150,200,235),</span><br><span class="line">     labels=c(0,50,100,150,200,375))</span><br><span class="line">box()</span><br><span class="line">axis.break(2,210,style=<span class="string">"gap"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/axis.png" alt=""><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5kYXRhZ3VydS5jbi9hcnRpY2xlLTQ4MjctMS5odG1s" title="http://www.dataguru.cn/article-4827-1.html">http://www.dataguru.cn/article-4827-1.html<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/03/coordinates.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/03/coordinates.html" class="post-title-link" itemprop="url">Modify the coordinates</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-03 15:30:33" itemprop="dateCreated datePublished" datetime="2015-10-03T15:30:33+08:00">2015-10-03</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/03/coordinates.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/03/coordinates.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/03/coordinates.html" class="leancloud_visitors" data-flag-title="Modify the coordinates">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="修改坐标的函数">修改坐标的函数</h2><p>修改坐标的这类属性，要用到theme()函数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gg&lt;-ggplot(diamonds[1:20,])</span><br><span class="line">gg+geom_bar(aes(price,fill=cut)) + theme(axis.text.x=element_text(family=<span class="string">"myFont2"</span>,face=<span class="string">"bold"</span>,size=10,angle=45,color=<span class="string">"red"</span>))</span><br></pre></td></tr></table></figure></p>
<h3 id="效果:">效果:</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo.png" alt=""></p>
<h3 id="解释：">解释：</h3><p>凡事要修改坐标文字的格式，都加一句来修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme(axis.text.x=theme_text(X轴属性),asix.text.y=theme_text(Y轴属性))</span><br></pre></td></tr></table></figure></p>
<p>theme_text()是存储文字属性的函数，其内置属性如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">family：字体</span><br><span class="line">face：粗体、斜体等</span><br><span class="line">size：字体大小</span><br><span class="line">angle：倾斜角度</span><br><span class="line">color：颜色</span><br></pre></td></tr></table></figure></p>
<h2 id="修改字体">修改字体</h2><p>提前设置一下字体：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windowsFonts(myFont1=windowsFont(<span class="string">"Times New Roman"</span>),myFont2=windowsFont(<span class="string">"宋体"</span>))</span><br></pre></td></tr></table></figure></p>
<p>然后才可以用family来修改字体<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Family=<span class="string">"myfont1"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="修改字体粗细">修改字体粗细</h2><p>Face可以设置的属性有以下几个：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plain：普通</span><br><span class="line">italic：斜体</span><br><span class="line">bold：粗体</span><br><span class="line">bold.italic：粗体+斜体</span><br></pre></td></tr></table></figure></p>
<h2 id="修改尺寸大小">修改尺寸大小</h2><p>用数字代表字体大小即可，普通的字体可以设置为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">size=8</span><br></pre></td></tr></table></figure></p>
<h2 id="修改角度">修改角度</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angle=45</span><br></pre></td></tr></table></figure>
<p>表示字体逆时针倾斜45°，范围是0-360</p>
<h2 id="修改颜色">修改颜色</h2><p>用color或者colour都可以修改颜色，颜色用关键字来表示，或者用十六进制的颜色代码来表示<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colour.png" alt=""><br>详细说明<i class="fa fa-link"></i><span class="exturl" data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYm9uZV9hY2UvYXJ0aWNsZS9kZXRhaWxzLzQ3MzYyNjE5" title="http://blog.csdn.net/bone_ace/article/details/47362619">http://blog.csdn.net/bone_ace/article/details/47362619<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5jb29rYm9vay1yLmNvbS9HcmFwaHMvQ29sb3JzXyhnZ3Bsb3QyKS8=" title="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/<i class="fa fa-external-link"></i></span></p>
<h2 id="修改位置">修改位置</h2><p>修改位置用下面的参数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hjust：调整横向位置</span><br><span class="line">vjust：调整纵向位置</span><br><span class="line">上面都设置数字，一般调整0.5左右，可以是负值</span><br></pre></td></tr></table></figure></p>
<h2 id="修改刻度标签">修改刻度标签</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xname&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>)</span><br><span class="line">p&lt;- ggplot(data, aes(x=name, y=high),xaxt=<span class="string">"n"</span>)+</span><br><span class="line">           scale_y_discrete(labels=xname)</span><br><span class="line">           scale_x_discrete(labels=xname)</span><br></pre></td></tr></table></figure>
<p>scale_xx_manual(values=c(a,b,c))对ggplot2自动设置aes()进行修改，xx可以是aes()包括的fill，colour，shape.</p>
<h2 id="legend图例的修改">legend图例的修改</h2><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/legend2.jpg" alt=""><br><i class="fa fa-bullhorn fa-2x"></i>ggplot2中的legend包括四个部分:legend.tittle, legend.text, legend.key, legend.backgroud。针对每一部分有四种处理方式：<br><i class="fa fa-bell-o"></i>element_text()绘制标签和标题，可控制字体的family, face, colour, size, hjust, vjust, angle, lineheight,当改变角度时，序将hjust调整至0或1.<br><i class="fa fa-bell-o"></i>element_rect()绘制主要供背景使用的矩形，你可以控制颜色的填充（fill）和边界的colour, size, linetype<br><i class="fa fa-bell-o"></i>element_blank()表示空主题，即对元素不分配相应的绘图空间。该函数可以山区我们不感兴趣的绘图元素。使用之前的colour=NA，fill=NA,让某些元素不可见，但仍然占绘图空间。<br><i class="fa fa-bell-o"></i>element_get()可得到当前主题的设置。<br><i class="fa fa-check"></i>theme()可在一幅图中对某些元素进行局部性修改，theme_update()可为后面图形的绘制进行全局性的修改<br><i class="fa fa-hand-o-right"></i>不加Legend<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.title=element_blank())</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>图例（legend）的位置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.position=<span class="string">"left"</span>)</span><br></pre></td></tr></table></figure></p>
<p>图例（legend）的位置和对齐使用的主题设置legend.position来控制，其值可为right,left,top,bottom,none。<br><i class="fa fa-hand-o-right"></i>修改legend.tittle内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p+scale_colour_hue(name=<span class="string">"what does it eat?"</span>,breaks=c(<span class="string">"herbi"</span>,<span class="string">"carni"</span>,<span class="string">"omni"</span>,NA),labels=c(<span class="string">"plants"</span>,<span class="string">"meat"</span>,<span class="string">"both"</span>,<span class="string">"don't know"</span>))</span><br><span class="line">注：name定义标签标题(legend.tittle)</span><br><span class="line">    breaks为标签原内容(legend.text)</span><br><span class="line">	labels为自定义后的标签内容(legend.text)</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-hand-o-right"></i>修改尺寸大小<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p+theme(legend.background=element_rect(colour=<span class="string">"purple"</span>,fill=<span class="string">"pink"</span>,size=3,linetype=<span class="string">"dashed"</span>));</span><br><span class="line">p+theme(legend.key.size=unit(2,<span class="string">'cm'</span>));</span><br><span class="line">p+theme(legend.key.width=unit(5,<span class="string">'cm'</span>));</span><br><span class="line">p+theme(legend.text = element_text(colour = <span class="string">'red'</span>, angle = 45, size = 10, hjust = 3, vjust = 3, face = <span class="string">'bold'</span>))</span><br></pre></td></tr></table></figure></p>
<p><i class="fa fa-times"></i>报错：could not find function “unit”<br><i class="fa fa-commenting-o"></i>解决办法：library(grid)<br><i class="fa fa-hand-o-right"></i>颜色的修改以及一致性<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">library(RColorBrewer);</span><br><span class="line">newpalette&lt;-colorRampPalette(brewer.pal(12,<span class="string">"Set3"</span>))(length(unique(eee<span class="variable">$name</span>)));</span><br><span class="line">p+scale_fill_manual(values=newpalette);</span><br><span class="line">p+geom_bar(position=<span class="string">"stack"</span>,aes(order=desc(name)))</span><br></pre></td></tr></table></figure></p>
<p>更多图例修改：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhZGxleS9nZ3Bsb3QyL3dpa2kvTGVnZW5kLUF0dHJpYnV0ZXM=" title="https://github.com/hadley/ggplot2/wiki/Legend-Attributes">https://github.com/hadley/ggplot2/wiki/Legend-Attributes<i class="fa fa-external-link"></i></span></p>
<h2 id="修改坐标轴的显示范围">修改坐标轴的显示范围</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +labs(title=<span class="string">"example"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">     labs(title=<span class="string">"example"</span>) +</span><br><span class="line">     scale_x_continuous(limits=c(60,64))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo3.png" alt=""></p>
<h2 id="修改坐标的显示刻度">修改坐标的显示刻度</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">    labs(title=<span class="string">"example"</span>) +</span><br><span class="line">    scale_x_continuous(limits=c(60,64)) +</span><br><span class="line">    theme(axis.text.x=element_text(angle=45,size=5))</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo4.png" alt=""><br>修改坐标轴显示间隔用到breaks参数，并且要用seq(起始值，终止值，间隔)函数来设置间隔<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gg+geom_line(aes(depth,price,color=cut,alpha=1/3),size=2) +</span><br><span class="line">    labs(title=<span class="string">"example"</span>) +</span><br><span class="line">    scale_x_continuous(limits=c(60,64),breaks=seq(60,64,2)) +</span><br><span class="line">    theme(axis.text.x=element_text(angle=45,size=5))</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/colo5.png" alt=""><br><i class="fa fa-link"></i> Contribution from ：<span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzY3MDQ0NTI0MDEwMnYyNTAuaHRtbA==" title="http://blog.sina.com.cn/s/blog_670445240102v250.html">http://blog.sina.com.cn/s/blog_670445240102v250.html<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/03/multiple-R.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/03/multiple-R.html" class="post-title-link" itemprop="url">Mix multiple graphs on the same page</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-03 11:23:52" itemprop="dateCreated datePublished" datetime="2015-10-03T11:23:52+08:00">2015-10-03</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/03/multiple-R.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/03/multiple-R.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/03/multiple-R.html" class="leancloud_visitors" data-flag-title="Mix multiple graphs on the same page">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>Easy way to mix multiple graphs on the same page - R software and data visualization</p>
<h2 id="Install_and_load_required_packages">Install and load required packages</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">install.packages(<span class="string">"gridExtra"</span>)</span><br><span class="line">library(<span class="string">"gridExtra"</span>)</span><br><span class="line">install.packages(<span class="string">"cowplot"</span>)</span><br><span class="line">library(<span class="string">"cowplot"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Prepare_some_data">Prepare some data</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df &lt;- ToothGrowth</span><br><span class="line"><span class="comment"># Convert the variable dose from a numeric to a factor variable</span></span><br><span class="line">df<span class="variable">$dose</span> &lt;- as.factor(df<span class="variable">$dose</span>)</span><br><span class="line">head(df)</span><br><span class="line"><span class="comment">##    len supp dose</span></span><br><span class="line"><span class="comment">## 1  4.2   VC  0.5</span></span><br><span class="line"><span class="comment">## 2 11.5   VC  0.5</span></span><br><span class="line"><span class="comment">## 3  7.3   VC  0.5</span></span><br><span class="line"><span class="comment">## 4  5.8   VC  0.5</span></span><br><span class="line"><span class="comment">## 5  6.4   VC  0.5</span></span><br><span class="line"><span class="comment">## 6 10.0   VC  0.5</span></span><br></pre></td></tr></table></figure>
<h2 id="Cowplot:_Publication-ready_plots">Cowplot: Publication-ready plots</h2><p>The cowplot package is an extension to ggplot2 and it can be used to provide a publication-ready plots.</p>
<h2 id="Basic_plots">Basic plots</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library(cowplot)</span><br><span class="line"><span class="comment"># Default plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line">bp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add gridlines</span></span><br><span class="line">bp + background_grid(major = <span class="string">"xy"</span>, minor = <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-1.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-2.png" width="192"><br>Recall that, the function <strong>ggsave()</strong>[in <strong>ggplot2</strong> package] can be used to save ggplots. However, when working with <strong>cowplot</strong>, the function <strong>save_plot()</strong> [in <strong>cowplot</strong> package] is preferred. It’s an alternative to <strong>ggsave</strong> with a better support for multi-figur plots.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">save_plot(<span class="string">"mpg.pdf"</span>, plot.mpg,</span><br><span class="line">          base_aspect_ratio = 1.3 <span class="comment"># make room for figure legend</span></span><br><span class="line">          )</span><br></pre></td></tr></table></figure></p>
<h2 id="Arranging_multiple_graphs_using_cowplot">Arranging multiple graphs using cowplot</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Scatter plot</span></span><br><span class="line">sp &lt;- ggplot(mpg, aes(x = cty, y = hwy, colour = factor(cyl)))+ </span><br><span class="line">  geom_point(size=2.5)</span><br><span class="line">sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bar plot</span></span><br><span class="line">bp &lt;- ggplot(diamonds, aes(clarity, fill = cut)) +</span><br><span class="line">  geom_bar() +</span><br><span class="line">  theme(axis.text.x = element_text(angle=70, vjust=0.5))</span><br><span class="line">bp</span><br></pre></td></tr></table></figure>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-2.png" width="259.2"><br>Combine the two plots (the scatter plot and the bar plot):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot_grid(sp, bp, labels=c(<span class="string">"A"</span>,<span class="string">"B"</span>), ncol = 2, nrow = 1)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-2-1.png" width="528"><br>The function <strong>draw_plot()</strong> can be used to place graphs at particular locations with a particular sizes. The format of the function is:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw_plot(plot, x = 0, y = 0, width = 1, height = 1)</span><br></pre></td></tr></table></figure></p>
<p><ul></ul></p>
<p><li><strong>plot</strong>: the plot to place (ggplot2 or a gtable)</li></p>
<p><li><strong>x</strong>: The x location of the lower left corner of the plot.</li></p>
<p><li><strong>y</strong>: The y location of the lower left corner of the plot.</li></p>
<p><li><strong>width, height</strong>: the width and the height of the plot</li><br><br>The function <strong>ggdraw()</strong> is used to initialize an empty drawing canvas.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plot.iris &lt;- ggplot(iris, aes(Sepal.Length, Sepal.Width)) + </span><br><span class="line">  geom_point() + facet_grid(. ~ Species) + stat_smooth(method = <span class="string">"lm"</span>) +</span><br><span class="line">  background_grid(major = &amp;<span class="comment">#39;y&amp;#39;, minor = "none") + # add thin horizontal lines </span></span><br><span class="line">  panel_border() <span class="comment"># and a border around each panel</span></span><br><span class="line"><span class="comment"># plot.mpt and plot.diamonds were defined earlier</span></span><br><span class="line">ggdraw() +</span><br><span class="line">  draw_plot(plot.iris, 0, .5, 1, .5) +</span><br><span class="line">  draw_plot(sp, 0, 0, .5, .5) +</span><br><span class="line">  draw_plot(bp, .5, 0, .5, .5) +</span><br><span class="line">  draw_plot_label(c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>), c(0, 0, 0.5), c(1, 0.5, 0.5), size = 15)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-cowplot-ggplot2-arranging-multiple-plot-3-1.png" width="537.6"></p>
<h2 id="grid-arrange:_Create_and_arrange_multiple_plots">grid.arrange: Create and arrange multiple plots</h2><p>The R code below creates a box plot, a dot plot, a violin plot and a stripchart (jitter plot) :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># Create a box plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot() + </span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a dot plot</span></span><br><span class="line"><span class="comment"># Add the mean point and the standard deviation</span></span><br><span class="line">dp &lt;- ggplot(df, aes(x=dose, y=len, fill=dose)) +</span><br><span class="line">  geom_dotplot(binaxis=&amp;<span class="comment">#39;y&amp;#39;, stackdir=&amp;#39;center&amp;#39;)+</span></span><br><span class="line">  stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">                 geom=<span class="string">"pointrange"</span>, color=<span class="string">"red"</span>)+</span><br><span class="line">   theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a violin plot</span></span><br><span class="line">vp &lt;- ggplot(df, aes(x=dose, y=len)) +</span><br><span class="line">  geom_violin()+</span><br><span class="line">  geom_boxplot(width=0.1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a stripchart</span></span><br><span class="line">sc &lt;- ggplot(df, aes(x=dose, y=len, color=dose, shape=dose)) +</span><br><span class="line">  geom_jitter(position=position_jitter(0.2))+</span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>) +</span><br><span class="line">  theme_gray()</span><br></pre></td></tr></table></figure></p>
<p>Combine the plots using the function <strong>grid.arrange()</strong> [in <strong>gridExtra</strong>] :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">grid.arrange(bp, dp, vp, sc, ncol=2, </span><br><span class="line">             main=<span class="string">"Multiple plots on the same page"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-grid-arrange-data-visualization-1.png" width="518.4"></p>
<h2 id="Add_a_common_legend_for_multiple_ggplot2_graphs">Add a common legend for multiple ggplot2 graphs</h2><p>This can be done in four simple steps :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create the plots : p1, p2, ….</li></p>
<p><li>Save the legend of the plot p1 as an external graphical element (called a “grob” in Grid terminology)</li></p>
<p><li>Remove the legends from all plots</li></p>
<p><li>Draw all the plots with only one legend in the right panel</li><br><br>To <strong>save the legend</strong> of a ggplot, the helper function below can be used :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">get_legend&lt;-<span class="keyword">function</span>(myggplot)&#123;</span><br><span class="line">  tmp &lt;- ggplot_gtable(ggplot_build(myggplot))</span><br><span class="line">  leg &lt;- <span class="built_in">which</span>(sapply(tmp<span class="variable">$grobs</span>, <span class="keyword">function</span>(x) x<span class="variable">$name</span>) == <span class="string">"guide-box"</span>)</span><br><span class="line">  legend &lt;- tmp<span class="variable">$grobs</span>[[leg]]</span><br><span class="line">  <span class="built_in">return</span>(legend)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>(The function above is derived from this <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjUzOTM0OC9nZ3Bsb3Qtc2VwYXJhdGUtbGVnZW5kLWFuZC1wbG90" title="http://stackoverflow.com/questions/12539348/ggplot-separate-legend-and-plot">forum<i class="fa fa-external-link"></i></span>. )<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Create the plots</span></span><br><span class="line"><span class="comment">#++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Create a box plot</span></span><br><span class="line">bp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_boxplot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a violin plot</span></span><br><span class="line">vp &lt;- ggplot(df, aes(x=dose, y=len, color=dose)) +</span><br><span class="line">  geom_violin()+</span><br><span class="line">  geom_boxplot(width=0.1)+</span><br><span class="line">  theme(legend.position=<span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Save the legend</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++</span></span><br><span class="line">legend &lt;- get_legend(bp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Remove the legend from the box plot</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++</span></span><br><span class="line">bp &lt;- bp + theme(legend.position=<span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Arrange ggplot2 graphs with a specific width</span></span><br><span class="line">grid.arrange(bp, vp, legend, ncol=3, widths=c(2.3, 2.3, 0.8))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-common-legend-data-visualization-1.png" width="518.4"></p>
<h2 id="Scatter_plot_with_marginal_density_plots">Scatter plot with marginal density plots</h2><p><strong>Step 1/3. Create some data :</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(rnorm(500, mean = -1), rnorm(500, mean = 1.5))</span><br><span class="line">y &lt;- c(rnorm(500, mean = 1), rnorm(500, mean = 1.7))</span><br><span class="line">group &lt;- as.factor(rep(c(1,2), each=500))</span><br><span class="line">df2 &lt;- data.frame(x, y, group)</span><br><span class="line">head(df2)</span><br><span class="line">##             x          y group</span><br><span class="line">## 1 -2.20706575 -0.2053334     1</span><br><span class="line">## 2 -0.72257076  1.3014667     1</span><br><span class="line">## 3  0.08444118 -0.5391452     1</span><br><span class="line">## 4 -3.34569770  1.6353707     1</span><br><span class="line">## 5 -0.57087531  1.7029518     1</span><br><span class="line">## 6 -0.49394411 -0.9058829     1</span><br></pre></td></tr></table></figure></p>
<p><strong>Step 2/3. Create the plots :</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Scatter plot of x and y variables and color by groups</span></span><br><span class="line">scatterPlot &lt;- ggplot(df2,aes(x, y, color=group)) + </span><br><span class="line">  geom_point() + </span><br><span class="line">  scale_color_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position=c(0,1), legend.justification=c(0,1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Marginal density plot of x (top panel)</span></span><br><span class="line">xdensity &lt;- ggplot(df2, aes(x, fill=group)) + </span><br><span class="line">  geom_density(alpha=.5) + </span><br><span class="line">  scale_fill_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Marginal density plot of y (right panel)</span></span><br><span class="line">ydensity &lt;- ggplot(df2, aes(y, fill=group)) + </span><br><span class="line">  geom_density(alpha=.5) + </span><br><span class="line">  scale_fill_manual(values = c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;)) + </span></span><br><span class="line">  theme(legend.position = <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure></p>
<p>Create a blank placeholder plot :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">lankPlot &lt;- ggplot()+geom_blank(aes(1,1))+</span><br><span class="line">  theme(</span><br><span class="line">    plot.background = element_blank(), </span><br><span class="line">   panel.grid.major = element_blank(),</span><br><span class="line">   panel.grid.minor = element_blank(), </span><br><span class="line">   panel.border = element_blank(),</span><br><span class="line">   panel.background = element_blank(),</span><br><span class="line">   axis.title.x = element_blank(),</span><br><span class="line">   axis.title.y = element_blank(),</span><br><span class="line">   axis.text.x = element_blank(), </span><br><span class="line">   axis.text.y = element_blank(),</span><br><span class="line">   axis.ticks = element_blank(),</span><br><span class="line">   axis.line = element_blank()</span><br><span class="line">     )</span><br></pre></td></tr></table></figure></p>
<p><strong>Step 3/3. Put the plots together:</strong><br>Arrange ggplot2 with adapted height and width for each row and column :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(<span class="string">"gridExtra"</span>)</span><br><span class="line">grid.arrange(xdensity, blankPlot, scatterPlot, ydensity, </span><br><span class="line">        ncol=2, nrow=2, widths=c(4, 1.4), heights=c(1.4, 4))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-put-multiple-plot-together-data-visualization-1.png" width="480"></p>
<h2 id="Create_a_complex_layout_using_the_function_viewport()">Create a complex layout using the function viewport()</h2><p>The different steps are :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create plots : p1, p2, p3, ….</li></p>
<p><li>Move to a new page on a grid device using the function <strong>grid.newpage()</strong></li></p>
<p><li>Create a layout 2X2 - number of columns = 2; number of rows = 2</li></p>
<p><li>Define a grid viewport : a rectangular region on a graphics device</li></p>
<p><li>Print a plot into the viewport</li><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Move to a new page</span></span><br><span class="line">grid.newpage()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create layout : nrow = 2, ncol = 2</span></span><br><span class="line">pushViewport(viewport(layout = grid.layout(2, 2)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># A helper function to define a region on the layout</span></span><br><span class="line">define_region &lt;- <span class="keyword">function</span>(row, col)&#123;</span><br><span class="line">  viewport(layout.pos.row = row, layout.pos.col = col)</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment"># Arrange the plots</span></span><br><span class="line"><span class="built_in">print</span>(scatterPlot, vp=define_region(1, 1:2))</span><br><span class="line"><span class="built_in">print</span>(xdensity, vp = define_region(2, 1))</span><br><span class="line"><span class="built_in">print</span>(ydensity, vp = define_region(2, 2))</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-complex-layout-data-visualization-1.png" width="480"></p>
<h2 id="Insert_an_external_graphical_element_inside_a_ggplot">Insert an external graphical element inside a ggplot</h2><p>The function <strong>annotation_custom()</strong> [in <strong>ggplot2</strong>] can be used for adding tables, plots or other grid-based elements. The simplified format is :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotation_custom(grob, xmin, xmax, ymin, ymax)</span><br></pre></td></tr></table></figure></p>
<p><ul></ul></p>
<p><li><strong>grob</strong>: the external graphical element to display</li></p>
<p><li><strong>xmin, xmax</strong> : x location in data coordinates (horizontal location)</li></p>
<p><li><strong>ymin, ymax</strong> : y location in data coordinates (vertical location)</li><br><br>The different steps are :</p>
<p><ol style="list-style-type: decimal"></ol></p>
<p><li>Create a scatter plot of y = f(x)</li></p>
<p><li>Add, for example, the box plot of the variables x and y inside the scatter plot using the function <strong>annotation_custom()</strong></li><br><br><span class="warning">As the inset box plot overlaps with some points, a <strong>transparent background</strong> is used for the box plots.</span><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a transparent theme object</span></span><br><span class="line">transparent_theme &lt;- theme(</span><br><span class="line"> axis.title.x = element_blank(),</span><br><span class="line"> axis.title.y = element_blank(),</span><br><span class="line"> axis.text.x = element_blank(), </span><br><span class="line"> axis.text.y = element_blank(),</span><br><span class="line"> axis.ticks = element_blank(),</span><br><span class="line"> panel.grid = element_blank(),</span><br><span class="line"> axis.line = element_blank(),</span><br><span class="line"> panel.background = element_rect(fill = <span class="string">"transparent"</span>,colour = NA),</span><br><span class="line"> plot.background = element_rect(fill = <span class="string">"transparent"</span>,colour = NA))</span><br></pre></td></tr></table></figure></p>
<p>Create the graphs :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">p1 &lt;- scatterPlot <span class="comment"># see previous sections for the scatterPlot</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot of the x variable</span></span><br><span class="line">p2 &lt;- ggplot(df2, aes(factor(1), x))+</span><br><span class="line">  geom_boxplot(width=0.3)+coord_flip()+</span><br><span class="line">  transparent_theme</span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot of the y variable</span></span><br><span class="line">p3 &lt;- ggplot(df2, aes(factor(1), y))+</span><br><span class="line">  geom_boxplot(width=0.3)+</span><br><span class="line">  transparent_theme</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the external graphical elements</span></span><br><span class="line"><span class="comment"># called a "grop" in Grid terminology</span></span><br><span class="line">p2_grob = ggplotGrob(p2)</span><br><span class="line">p3_grob = ggplotGrob(p3)</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="comment"># Insert p2_grob inside the scatter plot</span></span><br><span class="line">xmin &lt;- min(x); xmax &lt;- max(x)</span><br><span class="line">ymin &lt;- min(y); ymax &lt;- max(y)</span><br><span class="line">p1 + annotation_custom(grob = p2_grob, xmin = xmin, xmax = xmax, </span><br><span class="line">                       ymin = ymin-1.5, ymax = ymin+1.5)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-insert-plot-inside-ggplot-data-visualization-1.png" width="384"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Insert p3_grob inside the scatter plot</span></span><br><span class="line">p1 + annotation_custom(grob = p3_grob,</span><br><span class="line">                       xmin = xmin-1.5, xmax = xmin+1.5, </span><br><span class="line">                       ymin = ymin, ymax = ymax)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-insert-plot-inside-ggplot-data-visualization-2.png" width="384"><br><span class="error">If you have a solution to insert, at the same time, both p2_grob and p3_grob inside the scatter plot, please let me a comment. I got some errors trying to do this…</span></p>
<h2 id="Mix_table,_text_and_ggplot2_graphs">Mix table, text and ggplot2 graphs</h2><p>The functions below are required :</p>
<p><ul></ul></p>
<p><li><strong>tableGrob()</strong> [in the package <em>gridExtra</em>] : for adding a data table to a graphic device</li></p>
<p><li><strong>splitTextGrob()</strong> [in the package <em>RGraphics</em>] : for adding a text to a graph</li><br><br><span class="warning">Make sure that the package <strong>RGraphics</strong> is installed.</span><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">library(RGraphics)</span><br><span class="line">library(gridExtra)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Table</span></span><br><span class="line">p1 &lt;- tableGrob(head(ToothGrowth))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Text</span></span><br><span class="line">text &lt;- <span class="string">"ToothGrowth data describes the effect of Vitamin C on tooth growth in Guinea pigs.  Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used."</span></span><br><span class="line">p2 &lt;- splitTextGrob(text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Box plot</span></span><br><span class="line">p3 &lt;- ggplot(df, aes(x=dose, y=len)) + geom_boxplot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Arrange the plots on the same page</span></span><br><span class="line">grid.arrange(p1, p2, p3, ncol=1)</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-mixing-multiple-plots-add-table-add-text-data-visualization-1.png" width="480"></p>
<h2 id="Infos">Infos</h2><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZWFzeS13YXktdG8tbWl4LW11bHRpcGxlLWdyYXBocy1vbi10aGUtc2FtZS1wYWdlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page-r-software-and-data-visualization<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/10/03/multiple-ggplot2.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/10/03/multiple-ggplot2.html" class="post-title-link" itemprop="url">Multiple graphs on one page using ggplot2</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-10-03 10:41:58" itemprop="dateCreated datePublished" datetime="2015-10-03T10:41:58+08:00">2015-10-03</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/10/03/multiple-ggplot2.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/10/03/multiple-ggplot2.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/10/03/multiple-ggplot2.html" class="leancloud_visitors" data-flag-title="Multiple graphs on one page using ggplot2">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>The easy way is to use the multiplot function to put multiple graphs on one page, defined at the bottom of this page. If it isn’t suitable for your needs, you can copy and modify it.</p>
<h2 id="Problem">Problem</h2><p>You want to put multiple graphs on one page.</p>
<h2 id="Solution-1">Solution-1</h2><p>use the multiplot function</p>
<h3 id="plots_and_store">plots and store</h3><p>First, set up the plots and store them, but don’t render them yet. The details of these plots aren’t important; all you need to do is store the plot objects in variables.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># This example uses the ChickWeight dataset, which comes with ggplot2</span></span><br><span class="line"><span class="comment"># First plot</span></span><br><span class="line">p1 &lt;- ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet, group=Chick)) +</span><br><span class="line">    geom_line() +</span><br><span class="line">    ggtitle(<span class="string">"Growth curve for individual chicks"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Second plot</span></span><br><span class="line">p2 &lt;- ggplot(ChickWeight, aes(x=Time, y=weight, colour=Diet)) +</span><br><span class="line">    geom_point(alpha=.3) +</span><br><span class="line">    geom_smooth(alpha=.2, size=1) +</span><br><span class="line">    ggtitle(<span class="string">"Fitted growth curve per diet"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Third plot</span></span><br><span class="line">p3 &lt;- ggplot(subset(ChickWeight, Time==21), aes(x=weight, colour=Diet)) +</span><br><span class="line">    geom_density() +</span><br><span class="line">    ggtitle(<span class="string">"Final weight, by diet"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fourth plot</span></span><br><span class="line">p4 &lt;- ggplot(subset(ChickWeight, Time==21), aes(x=weight, fill=Diet)) +</span><br><span class="line">    geom_histogram(colour=<span class="string">"black"</span>, binwidth=50) +</span><br><span class="line">    facet_grid(Diet ~ .) +</span><br><span class="line">    ggtitle(<span class="string">"Final weight, by diet"</span>) +</span><br><span class="line">    theme(legend.position=<span class="string">"none"</span>)        <span class="comment"># No legend (redundant in this graph)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="multiplot_function">multiplot function</h3><p>This is the definition of multiplot. It can take any number of plot objects as arguments, or if it can take a list of plot objects passed to plotlist.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Multiple plot function</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)</span></span><br><span class="line"><span class="comment"># - cols:   Number of columns in layout</span></span><br><span class="line"><span class="comment"># - layout: A matrix specifying the layout. If present, 'cols' is ignored.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),</span></span><br><span class="line"><span class="comment"># then plot 1 will go in the upper left, 2 will go in the upper right, and</span></span><br><span class="line"><span class="comment"># 3 will go all the way across the bottom.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">multiplot &lt;- <span class="keyword">function</span>(..., plotlist=NULL, file, cols=1, layout=NULL) &#123;</span><br><span class="line">  library(grid)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Make a list from the ... arguments and plotlist</span></span><br><span class="line">  plots &lt;- c(list(...), plotlist)</span><br><span class="line"></span><br><span class="line">  numPlots = length(plots)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># If layout is NULL, then use 'cols' to determine layout</span></span><br><span class="line">  <span class="keyword">if</span> (is.null(layout)) &#123;</span><br><span class="line">    <span class="comment"># Make the panel</span></span><br><span class="line">    <span class="comment"># ncol: Number of columns of plots</span></span><br><span class="line">    <span class="comment"># nrow: Number of rows needed, calculated from # of cols</span></span><br><span class="line">    layout &lt;- matrix(seq(1, cols * ceiling(numPlots/cols)),</span><br><span class="line">                    ncol = cols, nrow = ceiling(numPlots/cols))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> (numPlots==1) &#123;</span><br><span class="line">    <span class="built_in">print</span>(plots[[1]])</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment"># Set up the page</span></span><br><span class="line">    grid.newpage()</span><br><span class="line">    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Make each plot, in the correct location</span></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> 1:numPlots) &#123;</span><br><span class="line">      <span class="comment"># Get the i,j matrix positions of the regions that contain this subplot</span></span><br><span class="line">      matchidx &lt;- as.data.frame(<span class="built_in">which</span>(layout == i, arr.ind = TRUE))</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(plots[[i]], vp = viewport(layout.pos.row = matchidx<span class="variable">$row</span>,</span><br><span class="line">                                      layout.pos.col = matchidx<span class="variable">$col</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="multiplot">multiplot</h3><p>Once the plot objects are set up, we can render them with multiplot. This will make two columns of graphs:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">multiplot(p1, p2, p3, p4, cols=2)</span><br><span class="line"><span class="comment">#&gt; Loading required package: grid</span></span><br><span class="line"><span class="comment">#&gt; geom_smooth: method="auto" and size of largest group is &lt;1000, so using loess. Use 'method = x' to change the smoothing method.</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-3-1.png" alt=""></p>
<h2 id="Solution-2">Solution-2</h2><p>facet_grid<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(mtcars, aes(mpg, wt)) + geom_point()</span><br><span class="line"><span class="comment"># With one variable</span></span><br><span class="line">p + facet_grid(. ~ cyl)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/facet_grid-2.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># With two variables</span></span><br><span class="line">p + facet_grid(vs ~ am)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/facet_grid-6.png" alt=""></p>
<h2 id="Solution-3">Solution-3</h2><p>grid.arrange<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library(gridExtra)</span><br><span class="line">grid.arrange(p1, p2, p3, p4, ncol=2, </span><br><span class="line">             main=<span class="string">"Multiple plots on the same page"</span>)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/unnamed-chunk-3-1.png" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/09/21/line-ggplots.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/09/21/line-ggplots.html" class="post-title-link" itemprop="url">quick start guide of ggplot2 line plot  - R software and data visualization</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-09-21 14:29:22" itemprop="dateCreated datePublished" datetime="2015-09-21T14:29:22+08:00">2015-09-21</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/09/21/line-ggplots.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/09/21/line-ggplots.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/09/21/line-ggplots.html" class="leancloud_visitors" data-flag-title="quick start guide of ggplot2 line plot  - R software and data visualization">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p></p><p>This <strong>R tutorial</strong> describes how to create <strong>line plots</strong> using <strong>R software</strong> and <strong>ggplot2</strong> package.</p><p></p>
<p></p><p>In a line graph, observations are ordered by x value and connected.</p><p></p>
<p></p><p>The functions <strong>geom_line()</strong>, <strong>geom_step()</strong>, or <strong>geom_path()</strong> can be used.</p><p></p>
<p></p><p>x value (for x axis) can be :</p><p></p>
<p><ul></ul></p>
<p><li>date : for a time series data</li></p>
<p><li>texts</li></p>
<p><li>discrete numeric values</li></p>
<p><li>continuous numeric values</li><br></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-logo-data-visualization-1.png" width="384"></p><p></p>
<p><div id="basic-line-plots" class="section level1"></div></p>
<p></p><h1>Basic line plots</h1><p></p>
<p><div id="data" class="section level2"></div></p>
<p></p><h2>Data</h2><p></p>
<p></p><p>Data derived from <em>ToothGrowth</em> data sets are used. ToothGrowth describes the effect of Vitamin C on tooth growth in Guinea pigs.</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df &lt;- data.frame(dose=c(<span class="string">"D0.5"</span>, <span class="string">"D1"</span>, <span class="string">"D2"</span>),</span><br><span class="line">                len=c(4.2, 10, 29.5))</span><br><span class="line"></span><br><span class="line">head(df)</span><br><span class="line"><span class="comment">##   dose  len</span></span><br><span class="line"><span class="comment">## 1 D0.5  4.2</span></span><br><span class="line"><span class="comment">## 2   D1 10.0</span></span><br><span class="line"><span class="comment">## 3   D2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<p><ul></ul></p>
<p><li><em>len</em> : Tooth length<br></li></p>
<p><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li><br><br></p>
<p><div id="create-line-plots-with-points" class="section level2"></div></p>
<p></p><h2>Create line plots with points</h2><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Basic line plot with points</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"># Change the line type</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(linetype = &quot;dashed&quot;)+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"># Change the color</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(color=&quot;red&quot;)+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-basic-data-visualization-3.png" width="240"></p><p></p>
<p></p><p>Read more on line types : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS10eXBlcy1ob3ctdG8tY2hhbmdlLWxpbmUtdHlwZXMtb2YtYS1ncmFwaC1pbi1yLXNvZnR3YXJl" title="http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software">ggplot2 line types<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><p>You can add an arrow to the line using the <em>grid</em> package :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(grid)</span><br><span class="line"><span class="comment"># Add an arrow</span></span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(arrow = arrow())+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a closed arrow to the end of the line</span></span><br><span class="line">myarrow=arrow(angle = 15, ends = <span class="string">"both"</span>, <span class="built_in">type</span> = <span class="string">"closed"</span>)</span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_line(arrow=myarrow)+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-add-arrow-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-add-arrow-data-visualization-2.png" width="240"></p><p></p>
<p></p><p>Observations can be also connected using the functions <strong>geom_step()</strong> or <strong>geom_path()</strong> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_step()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ggplot(data=df, aes(x=dose, y=len, group=1)) +</span><br><span class="line">  geom_path()+</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-geom-step-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-geom-step-data-visualization-2.png" width="240"></p><br><br><p></p>
<p><div class="block"></div></p>
<p><ul></ul></p>
<p><li><strong>geom_line</strong> : Connecting observations, ordered by x value</li></p>
<p><li><strong>geom_path()</strong> : Observations are connected in original order</li></p>
<p><li><strong>geom_step</strong> : Connecting observations by stairs</li><br><br><br><br></p>
<p><div id="line-plot-with-multiple-groups" class="section level1"></div></p>
<p></p><h1>Line plot with multiple groups</h1><p></p>
<p><div id="data-1" class="section level2"></div></p>
<p></p><h2>Data</h2><p></p>
<p></p><p>Data derived from <em>ToothGrowth</em> data sets are used. ToothGrowth describes the effect of Vitamin C on tooth growth in Guinea pigs. Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;- data.frame(supp=rep(c(<span class="string">"VC"</span>, <span class="string">"OJ"</span>), each=3),</span><br><span class="line">                dose=rep(c(<span class="string">"D0.5"</span>, <span class="string">"D1"</span>, <span class="string">"D2"</span>),2),</span><br><span class="line">                len=c(6.8, 15, 33, 4.2, 10, 29.5))</span><br><span class="line"></span><br><span class="line">head(df2)</span><br><span class="line"><span class="comment">##   supp dose  len</span></span><br><span class="line"><span class="comment">## 1   VC D0.5  6.8</span></span><br><span class="line"><span class="comment">## 2   VC   D1 15.0</span></span><br><span class="line"><span class="comment">## 3   VC   D2 33.0</span></span><br><span class="line"><span class="comment">## 4   OJ D0.5  4.2</span></span><br><span class="line"><span class="comment">## 5   OJ   D1 10.0</span></span><br><span class="line"><span class="comment">## 6   OJ   D2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<p><ul></ul></p>
<p><li><em>len</em> : Tooth length<br></li></p>
<p><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li></p>
<p><li><em>supp</em> : Supplement type (VC or OJ)</li><br><br></p>
<p><div id="create-line-plots" class="section level2"></div></p>
<p></p><h2>Create line plots</h2><p></p>
<p></p><p>In the graphs below, line types, colors and sizes are the same for the two groups :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Line plot with multiple groups</span></span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change line types</span></span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(linetype=<span class="string">"dashed"</span>, color=<span class="string">"blue"</span>, size=1.2)+</span><br><span class="line">  geom_point(color=<span class="string">"red"</span>, size=3)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-data-visualization-2.png" width="240"></p><br><p></p>
<p><div id="change-line-types-by-groups" class="section level2"></div></p>
<p></p><h2>Change line types by groups</h2><p></p>
<p></p><p>In the graphs below, line types and point shapes are controlled automatically by the levels of the variable <em>supp</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change line types by groups (supp)</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change line types and point shapes</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point(aes(shape=supp)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-change-line-type-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-change-line-type-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>It is also possible to change manually the line types using the function <strong>scale_linetype_manual()</strong>.</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set line types manually</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(linetype=supp))+</span><br><span class="line">  geom_point()+</span><br><span class="line">  scale_linetype_manual(values=c(<span class="string">"twodash"</span>, <span class="string">"dotted"</span>))</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-multiple-groups-manual-scale-data-visualization-1.png" width="288"></p><p></p>
<p></p><p>You can read more on line types here : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS10eXBlcy1ob3ctdG8tY2hhbmdlLWxpbmUtdHlwZXMtb2YtYS1ncmFwaC1pbi1yLXNvZnR3YXJl" title="http://www.sthda.com/english/wiki/ggplot2-line-types-how-to-change-line-types-of-a-graph-in-r-software">ggplot2 line types<i class="fa fa-external-link"></i></span></p><p></p>
<p></p><p><span class="warning">If you want to change also point shapes, read this article : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItcG9pbnQtc2hhcGVz" title="http://www.sthda.com/english/wiki/ggplot2-point-shapes">ggplot2 point shapes<i class="fa fa-external-link"></i></span></span></p><br><p></p>
<p><div id="change-line-colors-by-groups" class="section level2"></div></p>
<p></p><h2>Change line colors by groups</h2><p></p>
<p></p><p>Line colors are controlled automatically by the levels of the variable <em>supp</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p&lt;-ggplot(df2, aes(x=dose, y=len, group=supp)) +</span><br><span class="line">  geom_line(aes(color=supp))+</span><br><span class="line">  geom_point(aes(color=supp))</span><br><span class="line">p</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-change-line-color-data-visualization-1.png" width="240"></p><p></p>
<p></p><p>It is also possible to <em>change manually line colors</em> using the functions :</p><p></p>
<p><ul></ul></p>
<p><li><em>scale_color_manual()</em> : to use custom colors</li></p>
<p><li><em>scale_color_brewer()</em> : to use color palettes from <em>RColorBrewer</em> package</li></p>
<p><li><em>scale_color_grey()</em> : to use grey color palettes</li><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use custom color palettes</span></span><br><span class="line">p+scale_color_manual(values=c(<span class="string">"#999999"</span>, <span class="string">"#E69F00"</span>, <span class="string">"#56B4E9"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use brewer color palettes</span></span><br><span class="line">p+scale_color_brewer(palette=<span class="string">"Dark2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use grey scale</span></span><br><span class="line">p + scale_color_grey() + theme_classic()</span><br></pre></td></tr></table></figure></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-group-line-manual-color-data-visualization-3.png" width="240"></p><p></p>
<p></p><p>Read more on ggplot2 colors here : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItY29sb3JzLWhvdy10by1jaGFuZ2UtY29sb3JzLWF1dG9tYXRpY2FsbHktYW5kLW1hbnVhbGx5" title="http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually">ggplot2 colors<i class="fa fa-external-link"></i></span></p><br><br><p></p>
<p><div id="change-the-legend-position" class="section level1"></div></p>
<p></p><h1>Change the legend position</h1><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- p + scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br><span class="line"></span><br><span class="line">p + theme(legend.position=<span class="string">"top"</span>)</span><br><span class="line"></span><br><span class="line">p + theme(legend.position=<span class="string">"bottom"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove legend</span></span><br><span class="line">p + theme(legend.position=<span class="string">"none"</span>)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-2.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-legend-position-data-visualization-3.png" width="240"></p><p></p>
<p></p><p><span class="success">The allowed values for the arguments <strong>legend.position</strong> are : “left”,”top”, “right”, “bottom”.</span></p><p></p>
<p></p><p>Read more on ggplot legend : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGVnZW5kLWVhc3ktc3RlcHMtdG8tY2hhbmdlLXRoZS1wb3NpdGlvbi1hbmQtdGhlLWFwcGVhcmFuY2Utb2YtYS1ncmFwaC1sZWdlbmQtaW4tci1zb2Z0d2FyZQ==" title="http://www.sthda.com/english/wiki/ggplot2-legend-easy-steps-to-change-the-position-and-the-appearance-of-a-graph-legend-in-r-software">ggplot2 legend<i class="fa fa-external-link"></i></span></p><br><p></p>
<p><div id="line-plot-with-a-numeric-x-axis" class="section level1"></div></p>
<p></p><h1>Line plot with a numeric x-axis</h1><p></p>
<p></p><p>If the variable on x-axis is numeric, it can be useful to treat it as a continuous or a factor variable depending on what you want to do :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create some data</span></span><br><span class="line">df2 &lt;- data.frame(supp=rep(c(<span class="string">"VC"</span>, <span class="string">"OJ"</span>), each=3),</span><br><span class="line">                dose=rep(c(<span class="string">"0.5"</span>, <span class="string">"1"</span>, <span class="string">"2"</span>),2),</span><br><span class="line">               len=c(6.8, 15, 33, 4.2, 10, 29.5))</span><br><span class="line">head(df2)</span><br><span class="line"><span class="comment">##   supp dose  len</span></span><br><span class="line"><span class="comment">## 1   VC  0.5  6.8</span></span><br><span class="line"><span class="comment">## 2   VC    1 15.0</span></span><br><span class="line"><span class="comment">## 3   VC    2 33.0</span></span><br><span class="line"><span class="comment">## 4   OJ  0.5  4.2</span></span><br><span class="line"><span class="comment">## 5   OJ    1 10.0</span></span><br><span class="line"><span class="comment">## 6   OJ    2 29.5</span></span><br></pre></td></tr></table></figure><p></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x axis treated as continuous variable</span></span><br><span class="line">df2<span class="variable">$dose</span> &lt;- as.numeric(as.vector(df2<span class="variable">$dose</span>))</span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp, color=supp)) +</span><br><span class="line">  geom_line() + geom_point()+</span><br><span class="line">  scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Axis treated as discrete variable</span></span><br><span class="line">df2<span class="variable">$dose</span>&lt;-as.factor(df2<span class="variable">$dose</span>)</span><br><span class="line">ggplot(data=df2, aes(x=dose, y=len, group=supp, color=supp)) +</span><br><span class="line">  geom_line() + geom_point()+</span><br><span class="line">  scale_color_brewer(palette=<span class="string">"Paired"</span>)+</span><br><span class="line">  theme_minimal()</span><br></pre></td></tr></table></figure>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-numeric-x-axis-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-numeric-x-axis-data-visualization-2.png" width="240"></p><br><p></p>
<p><div id="line-plot-with-dates-on-x-axis" class="section level1"></div></p>
<p></p><h1>Line plot with dates on x-axis</h1><p></p>
<p></p><p><em>economics</em> time series data sets are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">head(economics)</span><br><span class="line">        date   pce    pop psavert uempmed unemploy</span><br><span class="line"><span class="comment">## 1 1967-06-30 507.8 198712     9.8     4.5     2944</span></span><br><span class="line"><span class="comment">## 2 1967-07-31 510.9 198911     9.8     4.7     2945</span></span><br><span class="line"><span class="comment">## 3 1967-08-31 516.7 199113     9.0     4.6     2958</span></span><br><span class="line"><span class="comment">## 4 1967-09-30 513.3 199311     9.8     4.9     3143</span></span><br><span class="line"><span class="comment">## 5 1967-10-31 518.5 199498     9.7     4.7     3066</span></span><br><span class="line"><span class="comment">## 6 1967-11-30 526.2 199657     9.4     4.8     3018</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p>Plots :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Basic line plot</span></span><br><span class="line">ggplot(data=economics, aes(x=date, y=pop))+</span><br><span class="line">  geom_line()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot a subset of the data</span></span><br><span class="line">ggplot(data=subset(economics, date &amp;gt; as.Date(<span class="string">"2006-1-1"</span>)), </span><br><span class="line">       aes(x=date, y=pop))+geom_line()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>Change line size :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change line size</span></span><br><span class="line">ggplot(data=economics, aes(x=date, y=pop, size=unemploy/pop))+</span><br><span class="line">  geom_line()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-time-serie-data-line-size-data-visualization-1.png" width="384"></p><br><p></p>
<p><div id="line-graph-with-error-bars" class="section level1"></div></p>
<p></p><h1>Line graph with error bars</h1><p></p>
<p></p><p>The function below will be used to calculate the mean and the standard deviation, for the variable of interest, in each group :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Function to calculate the mean and the standard deviation</span></span><br><span class="line">  <span class="comment"># for each group</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># data : a data frame</span></span><br><span class="line"><span class="comment"># varname : the name of a column containing the variable</span></span><br><span class="line">  <span class="comment">#to be summariezed</span></span><br><span class="line"><span class="comment"># groupnames : vector of column names to be used as</span></span><br><span class="line">  <span class="comment"># grouping variables</span></span><br><span class="line">data_summary &lt;- <span class="keyword">function</span>(data, varname, groupnames)&#123;</span><br><span class="line">  require(plyr)</span><br><span class="line">  summary_func &lt;- <span class="keyword">function</span>(x, col)&#123;</span><br><span class="line">    c(mean = mean(x[[col]], na.rm=TRUE),</span><br><span class="line">      sd = sd(x[[col]], na.rm=TRUE))</span><br><span class="line">  &#125;</span><br><span class="line">  data_sum&lt;-ddply(data, groupnames, .fun=summary_func,</span><br><span class="line">                  varname)</span><br><span class="line">  data_sum &lt;- rename(data_sum, c(<span class="string">"mean"</span> = varname))</span><br><span class="line"> <span class="built_in">return</span>(data_sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>
<p></p><p>Summarize the data :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df3 &lt;- data_summary(ToothGrowth, varname=<span class="string">"len"</span>, </span><br><span class="line">                    groupnames=c(<span class="string">"supp"</span>, <span class="string">"dose"</span>))</span><br><span class="line">head(df3)</span><br><span class="line"><span class="comment">##   supp dose   len       sd</span></span><br><span class="line"><span class="comment">## 1   OJ  0.5 13.23 4.459709</span></span><br><span class="line"><span class="comment">## 2   OJ  1.0 22.70 3.910953</span></span><br><span class="line"><span class="comment">## 3   OJ  2.0 26.06 2.655058</span></span><br><span class="line"><span class="comment">## 4   VC  0.5  7.98 2.746634</span></span><br><span class="line"><span class="comment">## 5   VC  1.0 16.77 2.515309</span></span><br><span class="line"><span class="comment">## 6   VC  2.0 26.14 4.797731</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p>The function <strong>geom_errorbar()</strong> can be used to produce a line graph with error bars :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Standard deviation of the mean</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1) +</span><br><span class="line">    geom_line() + geom_point()+</span><br><span class="line">   scale_color_brewer(palette=<span class="string">"Paired"</span>)+theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use position_dodge to move overlapped errorbars horizontally</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line() + geom_point()+</span><br><span class="line">   scale_color_brewer(palette=<span class="string">"Paired"</span>)+theme_minimal()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-with-error-bar-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-with-error-bar-data-visualization-2.png" width="259.2"></p><br><p></p>
<p><div id="customized-line-graphs" class="section level1"></div></p>
<p></p><h1>Customized line graphs</h1><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Simple line plot</span></span><br><span class="line"><span class="comment"># Change point shapes and line types by groups</span></span><br><span class="line">ggplot(df3, aes(x=dose, y=len, shape=supp, linetype=supp))+ </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line() +</span><br><span class="line">    geom_point()+</span><br><span class="line">    labs(title=<span class="string">"Plot of lengthby dose"</span>,x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">    theme_classic()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change color by groups</span></span><br><span class="line"><span class="comment"># Add error bars</span></span><br><span class="line">p &lt;- ggplot(df3, aes(x=dose, y=len,  color=supp))+ </span><br><span class="line">    geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.1, </span><br><span class="line">    position=position_dodge(0.05)) +</span><br><span class="line">    geom_line(aes(linetype=supp)) + </span><br><span class="line">    geom_point(aes(shape=supp))+</span><br><span class="line">    labs(title=<span class="string">"Plot of lengthby dose"</span>,x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">    theme_classic()</span><br><span class="line"></span><br><span class="line">p + theme_classic() + scale_color_manual(values=c(&amp;<span class="comment">#39;#999999&amp;#39;,&amp;#39;#E69F00&amp;#39;))</span></span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-line-graph-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-line-graph-data-visualization-2.png" width="259.2"></p><p></p>
<p></p><p>Change colors manually :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p + scale_color_brewer(palette=<span class="string">"Paired"</span>) + theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Greens</span></span><br><span class="line">p + scale_color_brewer(palette=<span class="string">"Greens"</span>) + theme_minimal()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reds</span></span><br><span class="line">p + scale_color_brewer(palette=<span class="string">"Reds"</span>) + theme_minimal()</span><br></pre></td></tr></table></figure><p></p>
<p></p><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-2.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-line-plot-customized-plot-change-color-data-visualization-3.png" width="259.2"></p><p></p>
<p></p><h1>Infos</h1><p></p>
<p></p><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span></p><br>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS1wbG90LXF1aWNrLXN0YXJ0LWd1aWRlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization<i class="fa fa-external-link"></i></span><p></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/" class="site-author-image" rel="start" style="border:none">
              <img class="site-author-image" itemprop="image"
                src="/images/author.jpg"
                alt="tiramisutes"/>
              </a>
            
              <p class="site-author-name" itemprop="name">tiramisutes</p>
              <div class="site-description motion-element" itemprop="description">hope bioinformatics blog</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">148</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">112</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpcmFtaXN1dGVz" title="GitHub &rarr; https://github.com/tiramisutes"><i class="fa fa-fw fa-github"></i>GitHub</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="bWFpbHRvOnRpcmFtaXN1dGVze2F0fTEyNi5jb20=" title="E-Mail &rarr; mailto:tiramisutes{at}126.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cDovL3dlaWJvLmNvbS90aXJhbWlzdXRlc1Rlcw==" title="Weibo &rarr; http://weibo.com/tiramisutesTes"><i class="fa fa-fw fa-globe"></i>Weibo</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9ob3BldG9neQ==" title="Twitter &rarr; https://twitter.com/hopetogy"><i class="fa fa-fw fa-twitter"></i>Twitter</span>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"/></span>
             </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9paG9wZS5zaGlueWFwcHMuaW8vcVJULVBDUi1QaXBlbGluZS8=" title="https://ihope.shinyapps.io/qRT-PCR-Pipeline/">qRT-PCR-Pipeline</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly90aXJhbWlzdXRlcy5naXRib29rcy5pby9hd2svY29udGVudC8=" title="https://tiramisutes.gitbooks.io/awk/content/">GitBook《awk学习总结》</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2NvdHRvbi5oemF1LmVkdS5jbi8=" title="http://cotton.hzau.edu.cn/">棉花遗传改良团队</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5iaW8taW5mby10cmFpbmVlLmNvbS8=" title="http://www.bio-info-trainee.com/">生信菜鸟团-深圳大学城</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5iaW90cmFpbmVlLmNvbS9mb3J1bS5waHA=" title="http://www.biotrainee.com/forum.php">生信技能树</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5pd2hnYW8uY29tLw==" title="http://www.iwhgao.com/">rabbit gao's blog</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9odWFucy5naXRodWIuaW8v" title="https://huans.github.io/">Huans(代谢+GWAS)</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5zZXF1ZW5jaW5nLnVpby5uby8=" title="http://www.sequencing.uio.no/">NSC-sequenceing</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2Jsb2cuam9iYm9sZS5jb20v" title="http://blog.jobbole.com/">伯乐在线</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9saW51eC5jbi8=" title="https://linux.cn/">Linux开源中文社区</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5yLWJsb2dnZXJzLmNvbS8=" title="http://www.r-bloggers.com/">R-bloggers</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvb3RoZXItZG9jcy5odG1s" title="https://cran.r-project.org/other-docs.html">R-resource</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3R1dG9yaWFscy5pcS5oYXJ2YXJkLmVkdS9SL1JncmFwaGljcy9SZ3JhcGhpY3MuaHRtbA==" title="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">ggplot2</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2xpbGliZWkubmV0Lw==" title="http://lilibei.net/">pele' blog</span>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <a class="theme-link" target="_blank" href="http://tiramisutes.github.io/about/"><span class="author" itemprop="copyrightHolder">tiramisutes</span></a>

  
    <span class="post-meta-item-icon">
    </span>
    <span title="Symbols count total"></span>
  

  
    <span class="post-meta-item-icon">
    </span>
    <span title="Reading time total"></span>
  
</div>


  <div class="powered-by">Powered: <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">▽ – <span class="exturl theme-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL25leHQtdGhlbWUvaGV4by10aGVtZS1uZXh0">NexT.Muse</span></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-line-chart"></i>
    </span>
    <span class="site-pv" title="Total Views">
    <a style="line-height: 1.5;" href="https://tongji.baidu.com/web/welcome/login" target="_blank">The total visits
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>&nbsp;times</a>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  



  
    
    
      
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='20' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest-nomobile.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.js"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  
  <script src="/js/src/exturl.js?v=7.0.1"></script>


  
  
  
    
  

  
    
      
    
  

  
  
  
    <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
    <script>
      
        window.addEventListener('load', () => {
      
        quicklink({
          timeout: 3000,
          priority: true,
          ignores: [uri => uri.includes('#'),uri => uri == 'http://tiramisutes.github.io/page/12/',]
        });
      
        });
      
    </script>
  


  
  

  

<script src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: true,
    appId: 'c7x0fPmO8Ci9avDBRuGWHqpG-gzGzoHsz',
    appKey: 'iVJ6ST0e1O5xaiIhVwOyhbf3',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true
  });
</script>





  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  
<style>
.pdfobject-container {
  position: relative;
  overflow: auto;
  width: 100%;
}
</style>
<script>
if ($('body').find('div.pdf').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/pdfobject@2.1.1/pdfobject.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      $('body').find('div.pdf').each(function(i, o) {
        PDFObject.embed($(o).attr('target'), $(o), {
          pdfOpenParams: {
            navpanes: 0,
            toolbar: 0,
            statusbar: 0,
            pagemode: 'thumbs',
            view: 'FitH'
          },
          PDFJS_URL: '/lib/pdf/web/viewer.html',
          height: $(o).attr('height') || '500px'
        });
      });
    },
  });
}
</script>


  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
    
      pbOptions = {};
      
        pbOptions.iconStyle = "box";
      
        pbOptions.boxForm = "horizontal";
      
        pbOptions.position = "bottomCenter";
      
        pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Evernote,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>


  

  

  

  

</body>
</html>
