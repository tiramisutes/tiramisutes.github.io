<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=66189719" charset="UTF-8"></script>


  
  
    
  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"/>





  
  
    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/Han/3.3.0/han.min.css"/>



  <meta http-equiv="Cache-Control" content="no-transform"/>
  <meta http-equiv="Cache-Control" content="no-siteapp"/>



  <meta name="google-site-verification" content="b12Zu40L63PLgCtcn0IW8KCNRolmyQlaF22tf4rRLEg"/>



  <meta name="msvalidate.01" content="74A687E04D4EF9914B7AA20824207409"/>









  
  
    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.css"/>




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link rel="stylesheet" href="https://fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"/>
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"/>

<link rel="stylesheet" href="/css/main.css?v=7.0.1"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/small_favicon.png?v=7.0.1">


  <link rel="mask-icon" href="/images/favicon.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":true,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="hope bioinformatics blog">
<meta property="og:type" content="website">
<meta property="og:title" content="hope">
<meta property="og:url" content="http://tiramisutes.github.io/page/13/index.html">
<meta property="og:site_name" content="hope">
<meta property="og:description" content="hope bioinformatics blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hope">
<meta name="twitter:description" content="hope bioinformatics blog">



  <link rel="alternate" href="/atom.xml" title="hope" type="application/atom+xml"/>




  <link rel="canonical" href="http://tiramisutes.github.io/page/13/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>hope – A new day is coming,whether we like it or not. The question is will you control it,or will it control you?</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?08b17c69c7ba460d9ab5f188a048ee6d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hope</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">A new day is coming,whether we like it or not. The question is will you control it,or will it control you?</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-code">

    
    
    
      
    

    

    <a href="/code/" rel="section"><i class="menu-item-icon fa fa-fw fa-code"></i> <br/>Code</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-footprint">

    
    
    
      
    

    

    <a href="/footprint/" rel="section"><i class="menu-item-icon fa fa-fw fa-image"></i> <br/>Footprint</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-qrt-pcr">

    
    
    
      
    

    

    <span class="exturl" data-url="aHR0cHM6Ly9paG9wZS5zaGlueWFwcHMuaW8vcVJULVBDUi1QaXBlbGluZS8="><i class="menu-item-icon fa fa-fw fa-cloud"></i> <br/>qRT-PCR</span>

  </li>
        
        
        
          
          <li class="menu-item menu-item-project">

    
    
    
      
    

    

    <a href="/project/" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br/>Project</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-publish">

    
    
    
      
    

    

    <a href="/publish/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i> <br/>Publish</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sci-figure">

    
    
    
      
    

    

    <a href="/SCIFigure/" rel="section"><i class="menu-item-icon fa fa-fw fa-angellist"></i> <br/>SCI Figure</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-cv">

    
    
    
      
    

    

    <a href="/resume/" rel="section"><i class="menu-item-icon fa fa-fw fa-address-card"></i> <br/>CV</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br/>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/09/21/ggplot2-error-bars.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/09/21/ggplot2-error-bars.html" class="post-title-link" itemprop="url">ggplot2 error bars (finished)-Quick start guide - R software and data visualization</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-09-21 13:13:36" itemprop="dateCreated datePublished" datetime="2015-09-21T13:13:36+08:00">2015-09-21</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/09/21/ggplot2-error-bars.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/09/21/ggplot2-error-bars.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/09/21/ggplot2-error-bars.html" class="leancloud_visitors" data-flag-title="ggplot2 error bars (finished)-Quick start guide - R software and data visualization">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>This <strong>tutorial</strong> describes how to create a <strong>graph</strong> with <strong>error bars</strong> using <strong>R software</strong> and <strong>ggplot2</strong> package. There are different types of <em>error bars</em> which can be created using the functions below :</p><br><ul><br><li>geom_errorbar()</li><br><li>geom_linerange()</li><br><li>geom_pointrange()</li><br><li>geom_crossbar()</li><br><li>geom_errorbarh()</li><br></ul><br><h1>Add error bars to a bar and line plots</h1><br><h2>Prepare the data</h2><br><p><em>ToothGrowth</em> data is used. It describes the effect of Vitamin C on tooth growth in Guinea pigs. Three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods [orange juice (OJ) or ascorbic acid (VC)] are used :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">df &lt;- ToothGrowth</span><br><span class="line">df<span class="variable">$dose</span> &lt;- as.factor(df<span class="variable">$dose</span>)</span><br><span class="line">head(df)</span><br><span class="line">   len supp dose</span><br><span class="line">1  4.2   VC  0.5</span><br><span class="line">2 11.5   VC  0.5</span><br><span class="line">3  7.3   VC  0.5</span><br><span class="line">4  5.8   VC  0.5</span><br><span class="line">5  6.4   VC  0.5</span><br><span class="line">6 10.0   VC  0.5</span><br></pre></td></tr></table></figure><br><br><li><em>len</em> : Tooth length<br></li><br><li><em>dose</em> : Dose in milligrams (0.5, 1, 2)</li><br><li><em>supp</em> : Supplement type (VC or OJ)</li><br><p>In the example below, we’ll plot the mean value of Tooth length in each group. The standard deviation is used to draw the error bars on the graph.</p><br><p>First, the helper function below will be used to calculate the mean and the standard deviation, for the variable of interest, in each group :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># Function to calculate the mean and the standard deviation</span></span><br><span class="line">  <span class="comment"># for each group</span></span><br><span class="line"><span class="comment">#+++++++++++++++++++++++++</span></span><br><span class="line"><span class="comment"># data : a data frame</span></span><br><span class="line"><span class="comment"># varname : the name of a column containing the variable</span></span><br><span class="line">  <span class="comment">#to be summariezed</span></span><br><span class="line"><span class="comment"># groupnames : vector of column names to be used as</span></span><br><span class="line">  <span class="comment"># grouping variables</span></span><br><span class="line">data_summary &lt;- <span class="keyword">function</span>(data, varname, groupnames)&#123;</span><br><span class="line">  require(plyr)</span><br><span class="line">  summary_func &lt;- <span class="keyword">function</span>(x, col)&#123;</span><br><span class="line">    c(mean = mean(x[[col]], na.rm=TRUE),</span><br><span class="line">      sd = sd(x[[col]], na.rm=TRUE))</span><br><span class="line">  &#125;</span><br><span class="line">  data_sum&lt;-ddply(data, groupnames, .fun=summary_func,</span><br><span class="line">                  varname)</span><br><span class="line">  data_sum &lt;- rename(data_sum, c(<span class="string">"mean"</span> = varname))</span><br><span class="line"> <span class="built_in">return</span>(data_sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br><p>Summarize the data :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df2 &lt;- data_summary(ToothGrowth, varname=<span class="string">"len"</span>, </span><br><span class="line">                    groupnames=c(<span class="string">"supp"</span>, <span class="string">"dose"</span>))</span><br><span class="line"><span class="comment"># Convert dose to a factor variable</span></span><br><span class="line">df2<span class="variable">$dose</span>=as.factor(df2<span class="variable">$dose</span>)</span><br><span class="line">head(df2)</span><br><span class="line">   supp dose   len       sd</span><br><span class="line">1   OJ  0.5 13.23 4.459709</span><br><span class="line">2   OJ    1 22.70 3.910953</span><br><span class="line">3   OJ    2 26.06 2.655058</span><br><span class="line">4   VC  0.5  7.98 2.746634</span><br><span class="line">5   VC    1 16.77 2.515309</span><br><span class="line">6   VC    2 26.14 4.797731</span><br></pre></td></tr></table></figure><br><br><h2>Barplot with error bars</h2><br><p>The function <strong>geom_errorbar()</strong> can be used to produce the error bars :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line"><span class="comment"># Default bar plot</span></span><br><span class="line">p&lt;- ggplot(df2, aes(x=dose, y=len, fill=supp)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, color=<span class="string">"black"</span>, </span><br><span class="line">           position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(.9)) </span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finished bar plot</span></span><br><span class="line">p+labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">   theme_classic() +</span><br><span class="line">   scale_fill_manual(values=c(<span class="string">'#999999'</span>,<span class="string">'#E69F00'</span>))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-barplot-data-visualization-1.png" width="359.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-barplot-data-visualization-2.png" width="359.2"></p><br>Note that, you can chose to keep only the upper error bars<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keep only upper error bars</span></span><br><span class="line"> ggplot(df2, aes(x=dose, y=len, fill=supp)) + </span><br><span class="line">  geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>, color=<span class="string">"black"</span>, position=position_dodge()) +</span><br><span class="line">  geom_errorbar(aes(ymin=len, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(.9))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-upper-error-bars-barplot-data-visualization-1.png" width="336"></p><br><p>Read more on ggplot2 bar graphs : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItYmFycGxvdHMtcXVpY2stc3RhcnQtZ3VpZGUtci1zb2Z0d2FyZS1hbmQtZGF0YS12aXN1YWxpemF0aW9u" title="http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization">ggplot2 bar graphs<i class="fa fa-external-link"></i></span></p><br><h2>Line plot with error bars</h2><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default line plot</span></span><br><span class="line">p&lt;- ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">  geom_line() +</span><br><span class="line">  geom_point()+</span><br><span class="line">  geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.2,</span><br><span class="line">                 position=position_dodge(0.05))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finished line plot</span></span><br><span class="line">p+labs(title=<span class="string">"Tooth length per dose"</span>, x=<span class="string">"Dose (mg)"</span>, y = <span class="string">"Length"</span>)+</span><br><span class="line">   theme_classic() +</span><br><span class="line">   scale_color_manual(values=c(<span class="string">'#999999'</span>,<span class="string">'#E69F00'</span>))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-line-plot-barplot-data-visualization-1.png" width="259.2"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-line-plot-barplot-data-visualization-2.png" width="259.2"></p><br><p><span class="warning">You can also use the functions <strong>geom_pointrange()</strong> or <strong>geom_linerange()</strong> instead of using <strong>geom_errorbar()</strong></span></p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use geom_pointrange</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">geom_pointrange(aes(ymin=len-sd, ymax=len+sd))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use geom_line()+geom_pointrange()</span></span><br><span class="line">ggplot(df2, aes(x=dose, y=len, group=supp, color=supp)) + </span><br><span class="line">  geom_line()+</span><br><span class="line">  geom_pointrange(aes(ymin=len-sd, ymax=len+sd))</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-point-range-barplot-data-visualization-1.png" width="240"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-point-range-barplot-data-visualization-2.png" width="240"></p><br><p>Read more on ggplot2 line plots : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItbGluZS1wbG90LXF1aWNrLXN0YXJ0LWd1aWRlLXItc29mdHdhcmUtYW5kLWRhdGEtdmlzdWFsaXphdGlvbg==" title="http://www.sthda.com/english/wiki/ggplot2-line-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 line plots<i class="fa fa-external-link"></i></span></p><br><h1>Dot plot with mean point and error bars</h1><br><p>The functions <strong>geom_dotplot()</strong> and <strong>stat_summary()</strong> are used :</p><br><p>The mean +/- SD can be added as a <em>crossbar</em> , a <strong>error bar</strong> or a <em>pointrange</em> :</p><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p &lt;- ggplot(df, aes(x=dose, y=len)) + </span><br><span class="line">    geom_dotplot(binaxis=<span class="string">'y'</span>, stackdir=<span class="string">'center'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># use geom_crossbar()</span></span><br><span class="line">p + stat_summary(fun.data=<span class="string">"mean_sdl"</span>, mult=1, </span><br><span class="line">                 geom=<span class="string">"crossbar"</span>, width=0.5)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use geom_errorbar()</span></span><br><span class="line">p + stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">        geom=<span class="string">"errorbar"</span>, color=<span class="string">"red"</span>, width=0.2) +</span><br><span class="line">  stat_summary(fun.y=mean, geom=<span class="string">"point"</span>, color=<span class="string">"red"</span>)</span><br><span class="line">   </span><br><span class="line"><span class="comment"># Use geom_pointrange()</span></span><br><span class="line">p + stat_summary(fun.data=mean_sdl, mult=1, </span><br><span class="line">                 geom=<span class="string">"pointrange"</span>, color=<span class="string">"red"</span>)</span><br></pre></td></tr></table></figure><br><br><p><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-1.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-2.png" width="192"><img src="http://www.sthda.com/sthda/RDoc/figure/ggplot2/ggplot2-error-bar-add-mean-sd-barplot-data-visualization-3.png" width="192"></p><br><p>Read more on ggplot2 dot plots : <span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZG90LXBsb3QtcXVpY2stc3RhcnQtZ3VpZGUtci1zb2Z0d2FyZS1hbmQtZGF0YS12aXN1YWxpemF0aW9u" title="http://www.sthda.com/english/wiki/ggplot2-dot-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 dot plot<i class="fa fa-external-link"></i></span></p><br><h1>Infos</h1><br><p><span class="warning"> This analysis has been performed using <strong>R software</strong> (ver. 3.1.2) and <strong>ggplot2</strong> (ver. 1.0.0) </span></p>

<p>Contribution from ：<span class="exturl" data-url="aHR0cDovL3d3dy5zdGhkYS5jb20vZW5nbGlzaC93aWtpL2dncGxvdDItZXJyb3ItYmFycy1xdWljay1zdGFydC1ndWlkZS1yLXNvZnR3YXJlLWFuZC1kYXRhLXZpc3VhbGl6YXRpb24=" title="http://www.sthda.com/english/wiki/ggplot2-error-bars-quick-start-guide-r-software-and-data-visualization">http://www.sthda.com/english/wiki/ggplot2-error-bars-quick-start-guide-r-software-and-data-visualization<i class="fa fa-external-link"></i></span></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/09/13/CRISPR-Cas9.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/09/13/CRISPR-Cas9.html" class="post-title-link" itemprop="url">CRISPR/Cas9</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-09-13 09:26:55" itemprop="dateCreated datePublished" datetime="2015-09-13T09:26:55+08:00">2015-09-13</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Bioinformatics/" itemprop="url" rel="index"><span itemprop="name">Bioinformatics</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/09/13/CRISPR-Cas9.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/09/13/CRISPR-Cas9.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/09/13/CRISPR-Cas9.html" class="leancloud_visitors" data-flag-title="CRISPR/Cas9">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>CRISPR/Cas9 gene editing technology has revolutionized the field of genome modification. This system is based on two key components that form a complex: Cas9 endonuclease and a target-specific RNA (single guide RNA or sgRNA) that guides Cas9 to the genomic DNA target site. Targeting to a particular genomic locus is solely mediated by the sgRNA.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/cris.jpg" alt=""></p>
<h2 id="CRISPR/Cas9_简介">CRISPR/Cas9 简介</h2><p>细菌（bacteria）和古细菌（archaea）都有一套防御机制抵御这种外来的侵入性因子，这种防御机制就是在成簇的、有规律间隔的多次重复短片段（clustered regularly interspaced short palindromic repeat, CRISPR）的基础上建立起来的适应性免疫系统（adaptive immune system）。<br>CRISPR系统能够将各种外源的病毒或质粒DNA短片段”集中”到细胞基因组里某个特定的重复片段区域上，将这些外源DNA当作细胞曾经经受过外源DNA入侵的一种记忆给储存起来。然后这段DNA会转录生成CRISPR前体RNA（precursor CRISPR RNA），前体RNA生成之后会被切割成一段一段的重复RNA片段，这些小RNA分子就是成熟的CRISPR RNA（crRNA）。然后crRNA会招募CRISPR相关蛋白（CRISPR-associated proteins, Cas）和tracrRNA与各种被细胞记住的外源的入侵DNA或mRNA片段结合，将它们彻底摧毁。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/FA_Cas9_Fig1_Cas9InVivo.png" alt=""></p>
<h2 id="CRISPR/Cas9发现史">CRISPR/Cas9发现史</h2><p>1987年，日本人在大肠杆菌中发现有串联间隔重复序列，后来的研究发现，这种重复序列广泛存在于细菌和古细菌中。<br>2002年，正式命名为CRISPR(Clustered regulatory interspaced short palindromic repeats)。<br>2005年，三个研究组同时发现间隔序列和侵染细菌的病毒或phage高度同源。从而推测，这一系统可能是类似于siRNA一样，是细菌抵抗Phage的一种机理。<br>2007年，Science发表文章，证明细菌可能利用CRSPR系统对抗噬菌体入侵，并解释细菌抵抗外界入侵的大致流程，Cas位点编码多个核酸酶和解旋酶，他们把入侵的DNA切割，整合到CRISPR的重复序列中，形成记忆。当再次遭到入侵时，转录出RNA，Cas蛋白复合物利用这些和入侵的DNA同源的RNA去切割摧毁外源的DNA。<br>2012年，Jennifer A. Doudna和Emmanuelle Charpentier的这篇Science发现了一个比较简单的CRISPR（TypeII）系统的机理。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Genloci%20Classic%20CRISPR-Cas9%20protocol.jpg" alt=""></p>
<h2 id="CRISPR/Cas9_type_II_作用机制">CRISPR/Cas9 type II 作用机制</h2><h3 id="相关术语">相关术语</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/FA_Cas9_GenomeEditingGlossary.png" alt=""><br>CRISPR–Cas系统也称作2型系统（type II systems），如图所示。Cas9内切酶在向导RNA的指引下能够对各种入侵的外源DNA分子进行定点切割，不过主要识别的还是保守的间隔相邻基序（proto-spacer adjacent motifs，PAM基序）。如果要形成一个有功能的DNA切割复合体，还需要另外两个RNA分子的帮助，它们就是CRISPR RNA (crRNA)和反式作用CRISPR RNA（trans -acting CRISPR RNA, tracrRNA)。不过最近有研究发现，这两种RNA可以被”改装”成一个向导RNA（single-guide RNA, sgRNA）。tracrRNA刚好与crRNA的小片段互补，同时它们还是RNA特异性的宿主核糖核酸酶RNase III的底物。经过RNase III的切割之后，这一对互补的RNA（其中包括一条42bp的crRNA和一条75bp的tracrRNA）就可以充当Cas9因子的向导，也就是说，tracrRNA分子能够帮助Cas9-crRNA复合体在细胞复杂的DNA环境中精准地定位到入侵的DNA序列上，这个sgRNA足以帮助Cas9内切酶对DNA进行定点切割,在完整基因组上的特定位点完成切割反应后细胞通常会通过两种方式对发生双链断裂的DNA进行修复，这两种方式分别是同源重组修复机制（homologous recombination, HR）和非同源末端连接修复机制（non-homologous end joining, NHEJ），不过在修复的过程中细胞有可能会对修复位点进行修饰，或者插入新的遗传信息。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crispr-process.png" width="1024" height="768"></p>
<h3 id="图例解释">图例解释</h3><p>The type II RNA-mediated CRISPR/Cas immune pathway. The expression and interference steps are represented in the drawing. The type II CRISPR/Cas loci are composed of an operon of four genes (blue) encoding the proteins Cas9, Cas1, Cas2 and Csn2, a CRISPR array consisting of a leader sequence followed by identical repeats (black rectangles) interspersed with unique genome-targeting spacers (colored diamonds) and a sequence encoding the trans-activating tracrRNA (red). Represented here is the type II CRISPR/Cas locus of S. pyogenes SF370 (Accession number NC_002737) (4). Experimentally confirmed promoters and transcriptional terminator in this locus are indicated (4). The CRISPR array is transcribed as a precursor CRISPR RNA (pre-crRNA) molecule that undergoes a maturation process specific to the type II systems (4). In S. pyogenes SF370, tracrRNA is transcribed as two primary transcripts of 171 and 89 nt in length that have complementarity to each repeat of the pre-crRNA. The first processing event involves pairing of tracrRNA to pre-crRNA, forming a duplex RNA that is recognized and cleaved by the housekeeping endoribonuclease RNase III (orange) in the presence of the Cas9 protein. RNase III-mediated cleavage of the duplex RNA generates a 75-nt processed tracrRNA and a 66-nt intermediate crRNAs consisting of a central region containing a sequence of one spacer, flanked by portions of the repeat sequence. A second processing event, mediated by unknown ribonuclease(s), leads to the formation of mature crRNAs of 39 to 42 nt in length consisting of 5’-terminal spacer-derived guide sequence and repeat-derived 3’-terminal sequence. Following the first and second processing events, mature tracrRNA remains paired to the mature crRNAs and bound to the Cas9 protein. In this ternary complex, the dual tracrRNA:crRNA structure acts as guide RNA that directs the endonuclease Cas9 to the cognate target DNA. Target recognition by the Cas9-tracrRNA:crRNA complex is initiated by scanning the invading DNA molecule for homology between the protospacer sequence in the target DNA and the spacer-derived sequence in the crRNA. In addition to the DNA protospacer-crRNA spacer complementarity, DNA targeting requires the presence of a short motif (NGG, where N can be any nucleotide) adjacent to the protospacer (protospacer adjacent motif - PAM). Following pairing between the dual-RNA and the protospacer sequence, an R-loop is formed and Cas9 subsequently introduces a double-stranded break (DSB) in the DNA. Cleavage of target DNA by Cas9 requires two catalytic domains in the protein. At a specific site relative to the PAM, the HNH domain cleaves the complementary strand of the DNA while the RuvC-like domain cleaves the noncomplementary strand.</p>
<h3 id="关键点注释">关键点注释</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5端是来源于spacer的序列，3端是来源于重复端（repeat）的序列，二者共同组成了39到42nt的成熟crRNAs，其中的3端重复端部分序列</span><br><span class="line">与成熟的tracrRNAs部分互补配对。</span><br><span class="line">tracrRNA:crRNA形成的二元结构招募Cas9形成Cas9-tracrRNA:crRNA三元复合体，开始扫描入侵的DNA，识别与成熟crRNA来源于5端</span><br><span class="line">的spacer序列互补的区段.</span><br><span class="line">PAM即为NGG序列，存在与入侵DNA也就是CRISPR/Cas9系统所要去切割的双链DNA上，对应于CRISPR/Cas9的crRNA上就是3端的CCN。</span><br><span class="line">参与三元复合体Cas9-tracrRNA:crRNA与目标DNA的识别.</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crRNA-tracRNA.png" width="1024" height="768"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Schematic representation of tracrRNA, crRNA-sp2, and protospacer 2 DNA sequences. Regions of crRNA </span><br><span class="line">complementarity to tracrRNA (orange) and the protospacer DNA (yellow) are represented. The PAM </span><br><span class="line">sequence is shown <span class="keyword">in</span> gray; cleavage sites mapped <span class="keyword">in</span> (C)and (D) are represented by blue arrows (C),</span><br><span class="line"> a red arrow [(D), complementary strand], and a red line [(D), noncomplementary strand].</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/crispr.jpg" alt=""><br>（A）Cas9蛋白需要crRNA和tracrRNA的共同帮助才能识别入侵的外来DNA分子，与之结合并将其降解。因为crRNA中的向导链部分可以与外源DNA的一条链互补并结合形成R环结构。在被识别区域两端的DNA基序也起到了非常重要的作用，它们可以帮助DNA链结旋打开双链，有利于crRNA链侵入。然后靶标DNA会在Cas9蛋白两个核酶结构域的作用下被切断。（B）级联反应复合体里含有一个crRNA，可是却最多携带了5种不同的Cas蛋白。所以它能够持续不断地招募核酶和解旋酶Cas3蛋白，不停歇地将入侵的外源DNA打开并切断。<br>Cas9蛋白能够凭借分子内的两个核酸酶结构域切割靶标DNA分子，形成平末端产物，其中每一个结构域负责切割靶标DNA分子R环状（R-loop）结构中的一条DNA链，具体来说，就是一个HNH核酶结构域负责切割与crRNA互补配对的那一条DNA链，RuvC核酶结构域负责切割另外一条DNA链。Jinek等人发现这种切割的效率非常高，而且不论靶标DNA分子是松弛型的，还是紧密的超螺旋型的都可以被毫不费力地被切割开，说明Cas9蛋白在细胞里是循环使用的，这样能保证在第一时间将所有来犯的入侵者全都消灭掉。</p>
<h2 id="Choosing_a_Target_Sequence_for_CRISPR/Cas9_Gene_Editing">Choosing a Target Sequence for CRISPR/Cas9 Gene Editing</h2><p>CRISPR/Cas9 gene targeting requires a custom single guide RNA (sgRNA) that contains a targeting sequence (crRNA sequence) and a Cas9 nuclease-recruiting sequence (tracrRNA). The crRNA region (shown in red below) is a 20-nucleotide sequence that is homologous to a region in your gene of interest and will direct Cas9 nuclease activity.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/xxclt_ibcGetAttachment.gif" alt=""></p>
<p>Selecting an appropriate DNA target sequence</p>
<p>Use the following guidelines to select a genomic DNA region that corresponds to the crRNA sequence of the sgRNA:</p>
<p>The 3′ end of the DNA target sequence must have a proto-spacer adjacent motif (PAM) sequence (5′-NGG-3′). The 20 nucleotides upstream of the PAM sequence will be your targeting sequence (crRNA) and Cas9 nuclease will cleave approximately 3 bases upstream of the PAM.<br>The PAM sequence itself is absolutely required for cleavage, but it is NOT part of the sgRNA sequence and therefore should not be included in the sgRNA.<br>The target sequence can be on either DNA strand.<br>There are online tools (e.g., <span class="exturl" data-url="aHR0cDovL2NyaXNwci5taXQuZWR1Lw==" title="http://crispr.mit.edu/">http://crispr.mit.edu/<i class="fa fa-external-link"></i></span> or <span class="exturl" data-url="aHR0cHM6Ly9jaG9wY2hvcC5yYy5mYXMuaGFydmFyZC5lZHUv" title="https://chopchop.rc.fas.harvard.edu/">https://chopchop.rc.fas.harvard.edu/<i class="fa fa-external-link"></i></span>) that detect PAM sequences and list possible crRNA sequences within a specific DNA region. These algorithms also predict off-target effects in different organisms, allowing you to choose the most specific crRNA.<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/xxclt_ib.gif" alt=""></p>
<h2 id="CRISPR/Cas9-sgRNA设计工具">CRISPR/Cas9-sgRNA设计工具</h2><p><i class="fa fa-database"></i>模式生物(Model Organism)</p>
<ol>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5lLWNyaXNwLm9yZy9FLUNSSVNQLw==" title="http://www.e-crisp.org/E-CRISP/">http://www.e-crisp.org/E-CRISP/<i class="fa fa-external-link"></i></span> currently the best online solution (Recommended).</li>
<li><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmZseWNyaXNwci5tb2xiaW8ud2lzYy5lZHUvdGFyZ2V0RmluZGVyLw==" title="http://tools.flycrispr.molbio.wisc.edu/targetFinder/">http://tools.flycrispr.molbio.wisc.edu/targetFinder/<i class="fa fa-external-link"></i></span>  a simple drosophila focused tool.</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci5taXQuZWR1Lw==" title="http://crispr.mit.edu/">http://crispr.mit.edu/<i class="fa fa-external-link"></i></span>  MIT’s online CRISPR tool is a little slow, but pretty decent if they support your genome of interest.</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci51LXBzdWQuZnIv" title="http://crispr.u-psud.fr/">http://crispr.u-psud.fr/<i class="fa fa-external-link"></i></span>  simple but effective, supports analysis of any sequence for target-sites.</li>
<li><span class="exturl" data-url="aHR0cDovL3ppZml0LnBhcnRuZXJzLm9yZy9aaUZpVC8=" title="http://zifit.partners.org/ZiFiT/">http://zifit.partners.org/ZiFiT/<i class="fa fa-external-link"></i></span>  another simple but effective solution.</li>
</ol>
<p><i class="fa fa-database"></i>模式生物+部分非模式生物(Model Organism AND Some non-model organisms)</p>
<ol>
<li><span class="exturl" data-url="aHR0cHM6Ly9jcmlzcHIuZGJjbHMuanAv" title="https://crispr.dbcls.jp/">https://crispr.dbcls.jp/<i class="fa fa-external-link"></i></span> Rational design of CRISPR/Cas target.</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5yZ2Vub21lLm5ldC9jYXMtb2ZmaW5kZXIv" title="http://www.rgenome.net/cas-offinder/">http://www.rgenome.net/cas-offinder/<i class="fa fa-external-link"></i></span> select genomes only, but allows for alternative Cas9 species.</li>
<li><span class="exturl" data-url="aHR0cDovL3Rvb2xzLmZseWNyaXNwci5tb2xiaW8ud2lzYy5lZHUvdGFyZ2V0RmluZGVyLw==" title="http://tools.flycrispr.molbio.wisc.edu/targetFinder/">http://tools.flycrispr.molbio.wisc.edu/targetFinder/<i class="fa fa-external-link"></i></span> a simple drosophila focused tool.</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9zc2ZpbmRlci8=" title="https://code.google.com/p/ssfinder/">https://code.google.com/p/ssfinder/<i class="fa fa-external-link"></i></span> (SSFinder) a simple but effective tool, it will likely be slow for large genomes.</li>
<li><span class="exturl" data-url="aHR0cDovL2FyZXAubWVkLmhhcnZhcmQuZWR1L0Nhc0ZpbmRlci8=" title="http://arep.med.harvard.edu/CasFinder/">CasFinder<i class="fa fa-external-link"></i></span>: Flexible algorithm for identifying specific Cas9 targets in genomes</li>
<li><span class="exturl" data-url="aHR0cDovL2NyaXNwci5oemF1LmVkdS5jbi9DUklTUFIyL2hlbHAucGhw" title="http://crispr.hzau.edu.cn/CRISPR2/help.php">http://crispr.hzau.edu.cn/CRISPR2/help.php<i class="fa fa-external-link"></i></span></li>
</ol>
<p><i class="fa fa-database"></i>可自己提供基因组的程序(use yourself genome data)</p>
<ol>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5yZ2Vub21lLm5ldC9jYXMtZGVzaWduZXIvcG9ydGFibGU=" title="http://www.rgenome.net/cas-designer/portable">Cas-Designer<i class="fa fa-external-link"></i></span>: provides all possible RGEN targets in the given input sequence</li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5iaW9vdG9vbHMuY29tL2NvbC5qc3A/aWQ9MTQz" title="http://www.biootools.com/col.jsp?id=143">sgRNAcas9<i class="fa fa-external-link"></i></span>: A software package for designing CRISPR sgRNA and evaluating potential off-target cleavagesites</li>
</ol>
<h2 id="CRISPR/Cas9存在的问题暨避免措施">CRISPR/Cas9存在的问题暨避免措施</h2><h3 id="Predicting_sgRNA_Efficacy">Predicting sgRNA Efficacy</h3><p>We have recently examined sequence features that enhance on-target activity of sgRNAs by creating all possible sgRNAs for a panel of genes and assessing, by flow cytometry, which sequences led to complete protein knockout (1). Some sequences worked better than others, and we also saw that variations in the protospacer-adjacent motif (PAM) led to differences in activity: specifically, CGGT tended to serve as a better PAM than the canonical NGG sequence. By examining the nucleotide features of the most-active sgRNAs from a set of 1,841 sgRNAs, we derived scoring rules and built a website implementation of these rules to design sgRNAs against genes of interest, available here: <span class="exturl" data-url="aHR0cDovL3d3dy5icm9hZGluc3RpdHV0ZS5vcmcvcm5haS9wdWJsaWMvYW5hbHlzaXMtdG9vbHMvc2dybmEtZGVzaWdu" title="http://www.broadinstitute.org/rnai/public/analysis-tools/sgrna-design">http://www.broadinstitute.org/rnai/public/analysis-tools/sgrna-design<i class="fa fa-external-link"></i></span>.</p>
<p>Once sgRNA sequences most-likely to give high activity are identified, some filtering can be used to further winnow down a list. For example, basic features of the target gene can be used to eliminate some sgRNAs, such as those that target near the C’ terminus of a protein, as frameshifts are less-likely to be deleterious if most of the protein has already been translated. While every protein will be different, it seems reasonable that target sites in the first half of a protein will likely lead to a functional knockout. Indeed, for some of the genes we examined, even targets very close to the C’ terminus disrupted expression. Certainly, for any gene of interest, it would be unwise to make conclusions on the basis of the activity of a single sgRNA, and thus diversity of target sites across a gene should be examined.</p>
<h3 id="Avoiding_Off-target_Sites">Avoiding Off-target Sites</h3><p>The off-target activity of sgRNAs is important to consider. Several papers have reached far-different conclusions regarding the extent of these effects, and certainly at least one reason for these observed differences is the expression levels of Cas9 and sgRNA used in these studies (2,3). Additionally, the ability to predict off-target sites in the genome is still in its infancy. While the basic landscape of mismatches that can lead to cutting has been established, and can be used to identify sites that are likely to give rise to an off-target effect, as yet there is not enough data to fully predict which sites will and will not show appreciable levels of modification. To further confound matters, it has recently been shown that bulges in either the RNA or DNA – that is, non-symmetrical basepairing of the strands – can give rise to off-target activity (4). Predicting such basepairing interactions is far-more computationally intensive, and thus existing algorithms ignore these potential off-target sites.</p>
<p>Importantly, recent whole-genome sequencing of cells modified by CRISPR indicates that the consequences of off-target activity, at least for the experimental conditions used, led to no detectable mutations (5). Indeed, when working with single-cell clones, the authors note that “clonal heterogeneity may represent a more serious obstacle to the generation of truly isogenic cell lines than nuclease-mediated off-target effects.” Further, several genetic screens using genome-wide libraries have shown high concordance between different sequences targeting the same gene, suggesting that off-target effects did not overwhelm true signal in these assays (6-8). Again, the experimental strategy is clear: for any gene of interest, one should require that multiple sgRNAs of different sequence give rise to the same phenotype in order to conclude that the phenotype is due to an on-target effect.</p>
<h3 id="How_Can_It_Go_Wrong?">How Can It Go Wrong?</h3><p>Even with optimized on-target design, and proper avoidance of off-target effects both explicitly when designing sgRNAs and experimentally by the use of multiple sgRNAs, it is apparent that not all genes are equally amenable to targeting in all cellular contexts. One major reason is the chromatin state of a target site. For genes that are in more restricted chromatin or, potentially, different locations in the nucleus, Cas9 will be less effective at finding the target (9). Achieving biallelic knockout of such a gene in a high percentage of target cells might therefore not be practical. Here, single cell-cloning might be necessary, and complementary technologies such as RNAi may be a better experimental choice (while still relying, of course, on multiple different sequences of small RNA to interpret a phenotype!)</p>
<p>In sum, selection of sgRNAs for an experiment needs to balance maximizing on-target activity while minimizing off-target activity, which sounds obvious but can often require difficult decisions. For example, would it be better to use a less-active sgRNA that targets a truly unique site in the genome, or a more-active sgRNA with one additional target site in a region of the genome with no known function? For the creation of stable cell models that are to be used for long-term study, the former may be the better choice. For a genome-wide library to conduct genetic screens, however, a library composed of the latter would likely be more effective, so long as care is taken in the interpretation of results by requiring multiple sequences targeting a gene to score in order to call that gene as a hit. Indeed, existing genome-wide libraries have not taken into account on-target activity, and new libraries will surely incorporate such design rules in the near future.</p>
<p>This is exciting time for functional genomics, with an ever-expanding list of tools to probe gene function. The best tools are only as good as the person using them, and the proper use of CRISPR technology will always depend on careful experimental design, execution, and analysis.</p>
<h2 id="CRISPR/Cas9:_Planning_Your_Experiment">CRISPR/Cas9: Planning Your Experiment</h2><h3 id="How_do_I_get_started?">How do I get started?</h3><p>CRISPR (Clustered Regularly Interspaced Short Palindromic Repeats) genome editing is a popular new technology that uses a short RNA (gRNA) to guide a nuclease (generally, Cas9) to a DNA target. The technology has been quickly adopted due to its advantages, like speed, cost, efficiency, and ease of implementation, over protein-based targeting methods (zinc fingers and TALENs). This experimental guide is meant to provide a broad overview of the major steps and considerations in setting up a CRISPR experiment. With all genome engineering technologies, it is recommended that the user performs due diligence regarding off-target effects.</p>
<p>Before getting started, familiarize yourself with the science behind CRISPR at our <a href="/crispr/guide/">CRISPR Science Guide</a>. You can also find more information from <span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvdG9waWMvY3Jpc3By" title="http://blog.addgene.org/topic/crispr">our blog<i class="fa fa-external-link"></i></span> and our list of <a href="/crispr/reference/#forums">CRISPR forums and FAQs</a>.</p>
<h3 id="Experimental_Design">Experimental Design</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/CRISPRweb.png" width="1024" height="768"></p>
<p>1.Choose a CRISPR system</p>
<ul>
<li><p>What do you want to use CRISPR for? Common uses of CRISPR are:</p>
<ul>
<li>Gene disruption (via insertion or deletion)</li>
<li>Activation or repression of gene expression</li>
<li>You can find more information about <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvZ3VpZGUvI0Rpc3J1cHQ=" title="http://www.addgene.org/crispr/guide/#Disrupt">CRISPR uses<i class="fa fa-external-link"></i></span> in our CRISPR guide or <a href="/CRISPR/">browse CRISPR plasmids</a> by function.</li>
</ul>
</li>
<li><p>What system will you be using CRISPR in?</p>
<ul>
<li>You can browse <a href="/crispr/#modelorg">CRISPR plasmids by model organism</a> or browse <a href="/crispr/">CRISPR plasmids by function.</a></li>
</ul>
</li>
<li><p>Once you know what you want to do and what system you want to use, you can design your gRNA.</p>
</li>
</ul>
<p>2.Design a gRNA for your genome target</p>
<p>As versatile as the Cas9 protein is, it requires the specificity of a gRNA to guide it to the desired genome target. Choosing an appropriate target sequence in the genomic DNA is a very important step in designing your experiment.</p>
<p>Important characteristics of a genome target are:</p>
<ul>
<li>~20 nucleotides in length</li>
<li>Followed (or preceded) by the appropriate Protospacer Adjacent Motif (PAM) sequence in the genomic DNA</li>
</ul>
<p>The PAM will vary depending on the bacterial species the Cas9 was derived from. The Cas9 and gRNA have to be from the same bacterial species. Read more about <a href="/crispr/guide/#PAM">PAM sequences</a>.<br>The majority of the CRISPR plasmids in Addgene’s collection are from the bacteria S. pyogenes unless otherwise noted.<br>gRNAs:</p>
<ul>
<li>should not contain the PAM sequence</li>
<li>can be on either strand of the genomic DNA</li>
</ul>
<p>For genomic disruptions (via Insertions/Deletions or InDels), the gRNA should be targeted closer to the N-terminus of a protein coding region to increase the likelihood of gene disruption.<br>For genome editing or modification, the gRNA target site will be limited to the desired location of the edit or modification.</p>
<ul>
<li>should be designed using bioinformatics software to minimize off-target effects</li>
</ul>
<p>A gRNA sequence can potentially appear in multiple places in the genome.</p>
<p>While we offer <a href="/crispr/validated-grnas/">validated gRNAs</a>, there are a <a href="/crispr/reference/#software">number of software tools</a> available to help you choose/design target sequences, as well as lists of bioinformatically determined (but not experimentally validated) unique gRNAs for different genes in different species.</p>
<p>Looking for more help?</p>
<p><span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvaG93LXRvLWRlc2lnbi15b3VyLWdybmEtZm9yLWNyaXNwci1nZW5vbWUtZWRpdGluZw==" title="http://blog.addgene.org/how-to-design-your-grna-for-crispr-genome-editing">From our blog<i class="fa fa-external-link"></i></span>, John Doench and Ella Hartenian (Broad Institute) give practical advice for using CRISPRs, as well as designing your gRNA and introducing it into cells.<br>Additionally, we have <a href="/crispr/reference/#protocols">gRNA design protocols</a> from our CRISPR depositors and links to <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvcmVmZXJlbmNlLyNmb3J1bXM=" title="http://www.addgene.org/crispr/reference/#forums">CRISPR discussion groups.<i class="fa fa-external-link"></i></span></p>
<p>Once you have your genomic target identified and gRNA designed, you can synthesize the oligos for your gRNA and find an <a href="/crispr/empty-grna-vectors/">empty gRNA vector</a>, or browse our selection of <a href="/crispr/validated-grnas/">validated gRNAs</a>.</p>
<ol>
<li>Clone the gRNA into a plasmid</li>
</ol>
<p>If you are using one of our validated gRNA plasmids, you can skip this step.</p>
<p>If you have to clone your gRNA into your CRISPR plasmid:</p>
<ul>
<li>Depositor plasmids may have <a href="/crispr/reference/#protocols">specific cloning guides</a> in their protocols.  </li>
<li>For a general overview of cloning, review our <a href="/plasmid-reference/index/">molecular biology tools and references</a>.</li>
</ul>
<p>After cloning, sequence verify your final plasmid product. Some depositor tools are designed so that a test digest can verify a successful insertion.</p>
<ol>
<li>Deliver your CRISPR components</li>
</ol>
<p>Each model system will have its best practices for efficient delivery of CRISPR components. CRISPR depositors have submitted protocols for a few model organisms like nematode, fly, and zebrafish.</p>
<p>If you will be working in mammalian cell culture, some common mammalian DNA delivery methods are: </p>
<p>Mammalian Cell Line DNA Delivery<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/deliver.png" alt=""><br><em>This table is not inclusive of all methods and the user will want to <span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3B1Ym1lZD90ZXJtPWNyaXNwcg==" title="http://www.ncbi.nlm.nih.gov/pubmed?term=crispr">review the current literature<i class="fa fa-external-link"></i></span> about their preferred model.</em></p>
<ol>
<li>Evaluate outcome</li>
</ol>
<p>If CRISPR is being used for genome modification, the modification has to be evaluated after delivery of CRISPR components.</p>
<ul>
<li>Design PCR (polymerase chain reaction) primers and amplify genomic region of modification.</li>
</ul>
<p>PCR is a method for making a copy of a piece of DNA.<br>There are many software tools available on the web for primer design. Example: <span class="exturl" data-url="aHR0cHM6Ly93d3cuaWR0ZG5hLmNvbS9wYWdlcy9zY2l0b29scy9zY2l0b29scy0tLW9saWdvLWFuYWx5c2lzLWFuZC1wcmltZXItZGVzaWduLXRvb2xz" title="https://www.idtdna.com/pages/scitools/scitools---oligo-analysis-and-primer-design-tools">IDT Web Tools<i class="fa fa-external-link"></i></span><br>View our walk-through of a basic <a href="/plasmid-protocols/pcr/">PCR reaction and the required reagents</a>.</p>
<ul>
<li>Two popular methods to assess genomic alteration from a PCR product are:</li>
</ul>
<p>Endonuclease mismatch detection assay<br><span class="exturl" data-url="aHR0cHM6Ly93d3cubmViLmNvbS9hcHBsaWNhdGlvbnMvY2xvbmluZy1hbmQtc3ludGhldGljLWJpb2xvZ3kvZ2Vub21lLWVkaXRpbmcvbWVhc3VyaW5nLXRhcmdldGluZy1lZmZpY2llbmN5LXdpdGgtdGhlLXQ3LWVuZG9udWNsZWFzZS1pLWFzc2F5" title="https://www.neb.com/applications/cloning-and-synthetic-biology/genome-editing/measuring-targeting-efficiency-with-the-t7-endonuclease-i-assay">NEB<i class="fa fa-external-link"></i></span> provides a graphical overview of the assay.<br>Sequence verification<br>Find tips for sequencing analysis and troubleshooting at our <span class="exturl" data-url="aHR0cDovL2Jsb2cuYWRkZ2VuZS5vcmcvNi10aXBzLWZvci1hbmFseXppbmctYW5kLXRyb3VibGVzaG9vdGluZy1kbmEtc2VxdWVuY2luZy1yZXN1bHRz" title="http://blog.addgene.org/6-tips-for-analyzing-and-troubleshooting-dna-sequencing-results">blog<i class="fa fa-external-link"></i></span>.</p>
<h2 id="CRISPR-Cas9_FAQs_Answered!">CRISPR-Cas9 FAQs Answered!</h2><h3 id="Designing_Your_CRISPR_Genome_Editing_Experiment">Designing Your CRISPR Genome Editing Experiment</h3><p><strong>Q1:&nbsp;Should I use wildtype or double nickase for my CRISPR genome engineering experiments?</strong><br><strong>A1:&nbsp;</strong><span>When assessing which nickase type to use for your CRISPR genome engineering experiments, consider that wildtype Cas9 with optimized chimeric gRNA has high efficiency but has been shown to have off-target effects. ‘Double nickase’ is a new system, developed by the Zhang lab, which has comparable efficiency to the optimized chimeric design but with better accuracy (in other words, lower off-target effect.<br>The double nickase system is based on the Cas9 D10A nickase described in&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzNzk1NDExL2ZpZ3VyZS9GNC8=" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3795411/figure/F4/">Figure 4<i class="fa fa-external-link"></i></span>&nbsp;of the Cong, et. al, 2013 Science paper. For example, if you want to use double nickase, you could express two spacers and use&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy80MjMzNS8=" title="http://www.addgene.org/42335/">PX335<i class="fa fa-external-link"></i></span>&nbsp;to express the Cas9n (nickase).<br>The concept of the double nickase system is that you can express two different chimeric gRNAs with the Cas9 nickase which will together introduce cleavage of the target site with efficiency similar to using a single chimeric gRNA. At the same time, the off-target effects are reduced because the Cas9 nickase doesn’t have the ability to induce double-stranded breaks like the wildtype Cas9 does. There are a few references for the double nickase system, including&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5jZWxsLmNvbS9hYnN0cmFjdC9TMDA5Mi04Njc0KDEzKTAxMDE1LTU=" title="http://www.cell.com/abstract/S0092-8674(13)01015-5">one recently from the Zhang group<i class="fa fa-external-link"></i></span>.<br>Learn more <span class="exturl" data-url="aHR0cHM6Ly93d3cuYWRkZ2VuZS5vcmcvQ1JJU1BSL2d1aWRlLyNOaWNrYXNl" title="https://www.addgene.org/CRISPR/guide/#Nickase">here<i class="fa fa-external-link"></i></span>.<br><strong>Q2:&nbsp;When designing oligos for cloning my target sequence into a backbone that uses the human U6 promoterto drive expression, is it necessary to add a G nucleotide to the start of my target sequence?</strong><br><strong style="font-size: inherit;">A2:&nbsp;</strong>The human U6 promoter prefers a ‘G’ at the transcription start site to have high expression, so adding this G couldhelp with expression, though it is possible for the plasmid to still express without the G. Because the G is only one base, the Zhang lab usually adds it when they order the oligo. If your spacer sequence starts with a ‘G’, you naturally have one and do not need to add an additional ‘G’.<br><strong>Q3:&nbsp;What is the maximum amount of DNA that can be inserted into the genome using CRISPR/Cas forHomologous Recombination (HR)? How long should the homology arms be for efficient recombination?</strong><br><strong>A3:&nbsp;</strong>The most we’ve tried to insert so far has been 1kb. We used homology arms that were 800bp long.</span></p>
<h3 id="Tips_for_Using_CRISPR-Cas9_at_the_Lab_Bench">Tips for Using CRISPR-Cas9 at the Lab Bench</h3><p><strong>Q4:&nbsp;After the introduction of a mutation into the genome, how can cells with that mutation be selected/screened?</strong><br><strong>A4:</strong>&nbsp;Before starting your experiment, consider co-transfecting with GFP. This allows you to sort for GFP-positive cells and to enrich for those cells that were positively transfected. Alternatively, you can use a selection marker to select transfected cells (for example, plasmid with a puromycin resistance cassette, such as&nbsp;<span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy80ODEzOS8=" title="http://www.addgene.org/48139/">PX459<i class="fa fa-external-link"></i></span>). After you co-transfect the CRISPR/Cas system with your homologous recombination (HR) template, you could then:</p>
<ul>
<li>Confirm your HR by doing Restriction Fragment Length Polymorphism (RFLP) (<span class="exturl" data-url="aHR0cDovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUMzNzk1NDExL2ZpZ3VyZS9GNC8=" title="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3795411/figure/F4/">see Figure 4<i class="fa fa-external-link"></i></span>&nbsp;of the Cong, et. al, 2013 Science paper).</li>
<li>If you detect positive HR, isolate single-cell colonies, grow them up, then perform individual genotyping (using Sanger sequencing, for example) on each colony in order to screen for positive ones.&nbsp;</li>
<li>If your HR template has a selection marker such as puromycin, you can (also) select for the positive colonies by puromycin selection. You could then confirm this purification by performing a genotyping assay (such as Sanger sequencing).<br><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlZGlyZWN0LmNvbS9zY2llbmNlL2FydGljbGUvcGlpL1MwMDkyODY3NDEzMDA0Njc0" title="http://www.sciencedirect.com/science/article/pii/S0092867413004674">Click here<i class="fa fa-external-link"></i></span>for a useful reference.</li>
</ul>
<h3 id="More_FAQS,_CRISPR_Protocols,_and_gRNA_Design_Tools">More FAQS, CRISPR Protocols, and gRNA Design Tools</h3><p><em><strong>Need more questions answered about CRISPRs?</strong></em></p>
<ul>
<li>Check out the <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9jcmlzcHIvemhhbmcvRkFRLw==" title="http://www.addgene.org/crispr/zhang/FAQ/">full list of 16 FAQs answered by Le Cong<i class="fa fa-external-link"></i></span></li>
<li>Read Addgene’s <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvZ3VpZGUv" title="http://www.addgene.org/CRISPR/guide/">CRISPR guide for background information<i class="fa fa-external-link"></i></span>&nbsp;on CRISPR/Cas9 systems</li>
<li>Peruse the most recent genome editing review articles, such as: Sander JD &amp; Joung JK, <em><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3Zhb3AvbmN1cnJlbnQvcGRmL25idC4yODQyLnBkZg==" title="http://www.nature.com/nbt/journal/vaop/ncurrent/pdf/nbt.2842.pdf">Nature Biotech<i class="fa fa-external-link"></i></span>, </em>2 March 2014.</li>
<li>Or browse the <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvI0FydGljbGU=" title="http://www.addgene.org/CRISPR/#Article">articles related to the most frequently requested CRISPR<i class="fa fa-external-link"></i></span> plasmids at Addgene<br><em><strong>Find protocols and gRNA design tools:</strong></em></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvcmVmZXJlbmNlLyNwcm90b2NvbHM=" title="http://www.addgene.org/CRISPR/reference/#protocols">List of CRISPR protocols<i class="fa fa-external-link"></i></span> developed by a variety of labs and optimized for specific plasmids</li>
<li>Links to different <span class="exturl" data-url="aHR0cDovL3d3dy5hZGRnZW5lLm9yZy9DUklTUFIvcmVmZXJlbmNlLyNnUk5B" title="http://www.addgene.org/CRISPR/reference/#gRNA">software to help you identify your gRNA<i class="fa fa-external-link"></i></span> target sequences</li>
</ul>
<h2 id="CRISPR/Cas9_文献">CRISPR/Cas9 文献</h2><ul>
<li><span class="exturl" data-url="aHR0cDovL29ubGluZWRpZ2VkaXRpb25zLmNvbS9wdWJsaWNhdGlvbi9mcmFtZS5waHA/aT0yMjMzMjI=" title="http://onlinedigeditions.com/publication/frame.php?i=223322">Cell Press Selections: CRISPR/Cas9<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlbWFnLm9yZy9jb250ZW50LzMzNy82MDk2LzgwOA==" title="http://www.sciencemag.org/content/337/6096/808">Science：A Swiss Army Knife of Immunity<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5zY2llbmNlbWFnLm9yZy9jb250ZW50LzMzNy82MDk2LzgxNi5sb25n" title="http://www.sciencemag.org/content/337/6096/816.long">Science：A Programmable Dual-RNA–Guided DNA Endonuclease in Adaptive Bacterial Immunity<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3d3dy5uYXR1cmUuY29tL25idC9qb3VybmFsL3YzMS9uOC9mdWxsL25idC4yNjU1Lmh0bWwjcmVmMw==" title="http://www.nature.com/nbt/journal/v31/n8/full/nbt.2655.html#ref3">Nature：Targeted mutagenesis in the model plant Nicotiana benthamiana using Cas9 RNA-guided endonuclease<i class="fa fa-external-link"></i></span></li>
</ul>
<h2 id="CRISPR/Cas9_科幻之力">CRISPR/Cas9 科幻之力</h2><p>◆ 自我复制<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/5bfd74f6187e5b0020435c06d8060826.jpg" alt=""></p>
<p>◆ 改变孟德尔遗传规律，改变整个种群<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/nature_crispr_gene_drive.png" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/22/error-bars.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/22/error-bars.html" class="post-title-link" itemprop="url">Error bars (basic)</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-22 18:00:06" itemprop="dateCreated datePublished" datetime="2015-08-22T18:00:06+08:00">2015-08-22</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/22/error-bars.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/22/error-bars.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/22/error-bars.html" class="leancloud_visitors" data-flag-title="Error bars (basic)">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>Error bars are a graphical representation of the variability of data and are used on graphs to indicate the error, or uncertainty in a reported measurement. They give a general idea of how precise a measurement is, or conversely, how far from the reported value the true (error free) value might be. Error bars often represent one standard deviation of uncertainty, one standard error, or a certain confidence interval (e.g., a 95% interval). </p>
<h3 id="Add_error_bar_used_R">Add error bar used R</h3><p>loading data<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot(mpg~disp,data=mtcars)</span><br></pre></td></tr></table></figure></p>
<h3 id="verticality_error_bars">verticality error bars</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">arrows(x0=mtcars<span class="variable">$disp</span>,</span><br><span class="line">       y0=mtcars<span class="variable">$mpg</span>*0.95,</span><br><span class="line">       x1=mtcars<span class="variable">$disp</span>,</span><br><span class="line">       y1=mtcars<span class="variable">$mpg</span>*1.05,</span><br><span class="line">       angle=90,</span><br><span class="line">       code=3,      <span class="comment">#drawing an arrowhead at both ends</span></span><br><span class="line">       length=0.04,</span><br><span class="line">       lwd=0.4)</span><br></pre></td></tr></table></figure>
<p>结果如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot.png" alt=""></p>
<h3 id="horizontal_error_bars">horizontal error bars</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">arrows(x0=mtcars<span class="variable">$disp</span>*0.95,</span><br><span class="line">       y0=mtcars<span class="variable">$mpg</span>,</span><br><span class="line">       x1=mtcars<span class="variable">$disp</span>*1.05,</span><br><span class="line">       y1=mtcars<span class="variable">$mpg</span>,</span><br><span class="line">       angle=90,</span><br><span class="line">       code=3,</span><br><span class="line">       length=0.04,</span><br><span class="line">       lwd=0.4)</span><br></pre></td></tr></table></figure>
<p>结果如下：<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot01.png" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/22/etc.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/22/etc.html" class="post-title-link" itemprop="url">Linux环境变量</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-22 16:23:25" itemprop="dateCreated datePublished" datetime="2015-08-22T16:23:25+08:00">2015-08-22</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/22/etc.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/22/etc.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/22/etc.html" class="leancloud_visitors" data-flag-title="Linux环境变量">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常见的环境变量">常见的环境变量</h2><p>对于PATH和HOME等环境变量大家都不陌生。除此之外，还有下面一些常见环境变量。<br>◆ HISTSIZE是指保存历史命令记录的条数。<br>◆ LOGNAME是指当前用户的登录名。<br>◆ HOSTNAME是指主机的名称，许多应用程序如果要用到主机名的话，通常是从这个环境变量中来取得的。<br>◆ SHELL是指当前用户用的是哪种Shell。<br>◆ LANG/LANGUGE是和语言相关的环境变量，使用多种语言的用户可以修改此环境变量。<br>◆ MAIL是指当前用户的邮件存放目录。<br>◆ PS1是基本提示符，对于root用户是#，对于普通用户是$。PS2是附属提示符，默认是”&gt;”。可以通过修改此环境变量来修改当前的命令符，比如下列命令会将提示符修改成字符串”Hello,My NewPrompt “。</p>
<p>除了这些常见的环境变量，许多应用程序在安装时也会增加一些环境变量，比如使用Java就要设置JAVA_HOME和CLASSPATH等</p>
<h2 id="定制环境变量">定制环境变量</h2><p>环境变量是和Shell紧密相关的，用户登录系统后就启动了一个Shell。对于Linux来说一般是bash，但也可以重新设定或切换到其它的 Shell。环境变量是通过Shell命令来设置的，设置好的环境变量又可以被所有当前用户所运行的程序所使用。对于bash这个Shell程序来说，可 以通过变量名来访问相应的环境变量，通过export来设置环境变量。下面通过几个实例来说明。<br>1、显示环境变量HOME<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HOME</span> </span><br><span class="line">/home/terry</span><br></pre></td></tr></table></figure></p>
<p>2、设置一个新的环境变量WELCOME<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> WELCOME=<span class="string">"Hello!"</span> </span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$WELCOME</span> </span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure></p>
<p>3、使用env命令显示所有的环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ env </span><br><span class="line">HOSTNAME=terry.mykms.org </span><br><span class="line">PVM_RSH=/usr/bin/rsh </span><br><span class="line">SHELL=/bin/bash </span><br><span class="line">TERM=xterm</span><br><span class="line">HISTSIZE=1000 </span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>4、使用set命令显示所有本地定义的Shell变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> </span><br><span class="line">BASH=/bin/bash </span><br><span class="line">BASH_VERSINFO=([0]=<span class="string">"2"</span>[1]=<span class="string">"05b"</span>[2]=<span class="string">"0"</span>[3]=<span class="string">"1"</span>[4]=<span class="string">"release"</span>[5]=<span class="string">"i386-redhat-linux-gnu"</span>) </span><br><span class="line">BASH_VERSION=<span class="string">'2.05b.0(1)-release'</span> </span><br><span class="line">COLORS=/etc/DIR_COLORS.xterm </span><br><span class="line">COLUMNS=80 </span><br><span class="line">DIRSTACK=() </span><br><span class="line">DISPLAY=:0.0 </span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>5、使用unset 命令来清除环境变量<br>set可以设置某个环境变量的值。清除环境变量的值用unset命令。如果未指定值，则该变量值将被设为NULL。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> TEST=<span class="string">"Test..."</span> <span class="comment">#增加一个环境变量TEST </span></span><br><span class="line">$ env|grep TEST <span class="comment">#此命令有输入，证明环境变量TEST已经存在了 </span></span><br><span class="line">TEST=Test... </span><br><span class="line">$ <span class="built_in">unset</span> <span class="variable">$TEST</span> <span class="comment">#删除环境变量TEST </span></span><br><span class="line">$ env|grep TEST <span class="comment">#此命令没有输出，证明环境变量TEST已经存在了</span></span><br></pre></td></tr></table></figure></p>
<p>6、使用readonly 命令设置只读变量<br>如果使用了readonly命令的话，变量就不可以被修改或清除了。示例如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> TEST=<span class="string">"Test..."</span> <span class="comment">#增加一个环境变量TEST </span></span><br><span class="line">$ <span class="built_in">readonly</span> TEST <span class="comment">#将环境变量TEST设为只读 </span></span><br><span class="line">$ <span class="built_in">unset</span> TEST <span class="comment">#会发现此变量不能被删除 </span></span><br><span class="line">-bash: <span class="built_in">unset</span>: TEST: cannot <span class="built_in">unset</span>: <span class="built_in">readonly</span> variable </span><br><span class="line">$ TEST=<span class="string">"New"</span> <span class="comment">#会发现此也变量不能被修改 </span></span><br><span class="line">-bash: TEST: <span class="built_in">readonly</span> variable</span><br></pre></td></tr></table></figure></p>
<h2 id="环境变量PATH">环境变量PATH</h2><p>which, 它用来查找某个命令的绝对路径<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># which rmdir</span></span><br><span class="line">/bin/rmdir</span><br><span class="line">[root@localhost ~]<span class="comment"># which rm</span></span><br><span class="line"><span class="built_in">alias</span> rm=<span class="string">'rm -i'</span></span><br><span class="line">        /bin/rm</span><br><span class="line">[root@localhost ~]<span class="comment"># which ls</span></span><br><span class="line"><span class="built_in">alias</span> ls=<span class="string">'ls --color=auto'</span></span><br><span class="line">        /bin/ls</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/22/awk2.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/22/awk2.html" class="post-title-link" itemprop="url">AWK程序设计语言</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-22 13:48:08" itemprop="dateCreated datePublished" datetime="2015-08-22T13:48:08+08:00">2015-08-22</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/22/awk2.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/22/awk2.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/22/awk2.html" class="leancloud_visitors" data-flag-title="AWK程序设计语言">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p></p><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/awk2.png" width="590" height="400"></p><p></p>
<h2 id="一-_AWK入门指南">一. AWK入门指南</h2><p>Awk是一种便于使用且表达能力强的程序设计语言，可应用于各种计算和数据处理任务。本章是个入门指南，让你能够尽快地开始编写你自己的程序。第二章将描述整个语言，而剩下的章节将向你展示如何使用Awk来解决许多不同方面的问题。纵观全书，我们尽量选择了一些对你有用、有趣并且有指导意义的实例。</p>
<h3 id="1-1_起步">1.1 起步</h3><p>有用的awk程序往往很简短，仅仅一两行。假设你有一个名为 emp.data 的文件，其中包含员工的姓名、薪资（美元/小时）以及小时数，一个员工一行数据，如下所示：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth	4.00	0</span><br><span class="line">Dan	3.75	0</span><br><span class="line">kathy	4.00	10</span><br><span class="line">Mark	5.00	20</span><br><span class="line">Mary	5.50	22</span><br><span class="line">Susie	4.25	18</span><br></pre></td></tr></table></figure></p>
<p>现在你想打印出工作时间超过零小时的员工的姓名和工资（薪资乘以时间）。这种任务对于awk来说就是小菜一碟。输入这个命令行就可以了：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 &gt;0 &#123; print $1, $2 * $3 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>你应该会得到如下输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br></pre></td></tr></table></figure></p>
<p>该命令行告诉系统执行引号内的awk程序，从输入文件 emp.data 获取程序所需的数据。引号内的部分是个完整的awk程序，包含单个模式-动作语句。模式 $3&gt;0 用于匹配第三列大于0的输入行，动作:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印每个匹配行的第一个字段以及第二第三字段的乘积。</p>
<p>如果你想打印出还没工作过的员工的姓名，则输入命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>这里，模式 $3 == 0 匹配第三个字段等于0的行，动作:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印该行的第一个字段。</p>
<p>当你阅读本书时，应该尝试执行与修改示例程序。大多数程序都很简短，所以你能快速理解awk是如何工作的。在Unix系统上，以上两个事务在终端里看起来是这样的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'$3 &gt; 0 &#123; print $1, $2 * $3 &#125;'</span> emp.data</span><br><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br><span class="line">$ awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> emp.data</span><br><span class="line">Beth</span><br><span class="line">Dan</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p>
<p>行首的 $ 是系统提示符，也许在你的机器上不一样。</p>
<p>AWK程序的结构</p>
<p>让我们回头看一下到底发生了什么事情。上述的命令行中，引号之间的部分是awk编程语言写就的程序。本章中的每个awk程序都是一个或多个模式-动作语句的序列：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern &#123; action &#125;</span><br><span class="line">pattern &#123; action &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>awk的基本操作是一行一行地扫描输入，搜索匹配任意程序中模式的行。词语”匹配”的准确意义是视具体的模式而言，对于模式 $3 &gt;0 来说，意思是”条件为真”。</p>
<p>每个模式依次测试每个输入行。对于匹配到行的模式，其对应的动作（也许包含多步）得到执行，然后读取下一行并继续匹配，直到所有的输入读取完毕。</p>
<p>上面的程序都是模式与动作的典型示例。:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> == 0 &#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>是单个模式-动作语句；对于第三个字段为0的每行，打印其第一个字段。</p>
<p>模式-动作语句中的模式或动作（但不是同时两者）都可以省略。如果某个模式没有动作，例如：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> == 0</span><br></pre></td></tr></table></figure></p>
<p>那么模式匹配到的每一行（即，对于该行，条件为真）都会被打印出来。该程序会打印 emp.data 文件中第三个字段为0的两行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Beth 4.00 0</span><br><span class="line">Dan 3.75 0</span><br></pre></td></tr></table></figure></p>
<p>如果有个没有模式的动作，例如：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>那么这种情况下的动作会打印每个输入行的第一列。</p>
<p>由于模式和动作两者任一都是可选的，所以需要使用大括号包围动作以区分于其他模式。</p>
<p>执行AWK程序</p>
<p>执行awk程序的方式有多种。你可以输入如下形式的命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'program'</span> input files</span><br></pre></td></tr></table></figure></p>
<p>从而在每个指定的输入文件上执行这个program。例如，你可以输入：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span> file1 file2</span><br></pre></td></tr></table></figure></p>
<p>打印file1和file2文件中第三个字段为0的每一行的第一个字段。</p>
<p>你可以省略命令行中的输入文件，仅输入：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'program'</span></span><br></pre></td></tr></table></figure></p>
<p>这种情况下，awk会将program应用于你在终端中接着输入的任意数据行，直到你输入一个文件结束信号（Unix系统上为control-d）。如下是Unix系统的一个会话示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'$3 == 0 &#123; print $1 &#125;'</span></span><br><span class="line">Beth 4.00 0</span><br><span class="line">Beth</span><br><span class="line"></span><br><span class="line">Dan 3.75 0</span><br><span class="line">Dan</span><br><span class="line"></span><br><span class="line">Kathy 3.75 10</span><br><span class="line">Kathy 3.75 0</span><br><span class="line">Kathy</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>加粗的字符是计算机打印的。</p>
<p>这个动作非常便于尝试awk：输入你的程序，然后输入数据，观察发生了什么。我们再次鼓励你尝试这些示例并进行改动。</p>
<p>注意命令行中的程序是用单引号包围着的。这会防止shell解释程序中 $ 这样的字符，也允许程序的长度超过一行。</p>
<p>当程序比较短小（几行的长度）的时候，这种约定会很方便。然而，如果程序较长，将程序写到一个单独的文件中会更加方便。假设存在程序 progfile ，输入命令行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -f progfile     optional list of input files</span><br></pre></td></tr></table></figure></p>
<p>其中 -f 选项指示awk从指定文件中获取程序。可以使用任意文件名替换 progfile 。</p>
<p>错误</p>
<p>如果你的awk程序存在错误，awk会给你一段诊断信息。例如，如果你打错了大括号，如下所示：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'$3 == 0 [ print $1 &#125;'</span> emp.data</span><br></pre></td></tr></table></figure></p>
<p>你会得到如下信息：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">awk: syntax error at <span class="built_in">source</span> line 1</span><br><span class="line">context is</span><br><span class="line"><span class="variable">$3</span> == 0 &gt;&gt;&gt; [ &lt;&lt;&lt;</span><br><span class="line">extra &#125;</span><br><span class="line">missing ]</span><br><span class="line">awk: bailing out at <span class="built_in">source</span> line 1</span><br></pre></td></tr></table></figure></p>
<p>“Syntax error”意味着在 &gt;&gt;&gt; &lt;&lt;&lt; 标记的地方检测到语法错误。”Bailing out”意味着没有试图恢复。有时你会得到更多的帮助-关于错误是什么，比如大括号或括弧不匹配。</p>
<p>因为存在句法错误，awk就不会尝试执行这个程序。然而，有些错误，直到你的程序被执行才会检测出来。例如，如果你试图用零去除某个数，awk会在这个除法的地方停止处理并报告输入行的行号以及在程序中的行号（这话是什么意思？难道输入行的行号是忽略空行后的行号？）。</p>
<h3 id="1-2_简单输出">1.2 简单输出</h3><p>这一节接下来的部分包含了一些短小，典型的awk程序，基于操纵上文中提到的 emp.data 文件. 我们会简单的解释程序在做什么，但这些例子主要是为了介绍 awk 中常见的一些简单有用的操作 – 打印字段, 选择输入, 转换数据. 我们并 没有展现 awk 程序能做的所有事情, 也并不打算深入的去探讨例子中的一些细节. 但在你读完这一节之后, 你将能够完成一些简单的任务, 并且你将发现在阅读后 面章节的时候会变的容易的多.</p>
<p>我们通常只会列出程序部分, 而不是整个命令行. 在任何情况下, 程序都可以用 引号包含起来放到 awk 命令的地一个参数中运行, 就像上文中展示的那样, 或者 把它放到一个文件中使用 awk 的 -f 参数调用它.</p>
<p>在 awk 中仅仅只有两种数据类型: 数值 和 字符构成的字符串. emp.data 是 一个包含这类信息的典型文件 – 混合了被空格和(或)制表符分割的数字和词语.</p>
<p>Awk 程序一次从输入文件的中读取一行内容并把它分割成一个个字段, 通常默认 情况下, 一个字段是一个不包含任何空格或制表符的连续字符序列. 当前输入的 行中的地一个字段被称做 $1, 第二个是 $2, 以此类推. 整个行的内容被定 义为 $0. 每一行的字段数量可以不同.</p>
<p>通常, 我们要做的仅仅只是打印出每一行中的某些字段, 也许还要做一些计算. 这一节的程序基本上都是这种形式.</p>
<p>打印每一行</p>
<p>如果一个动作没有任何模式, 这个动作会对所有输入的行进行操作. print 语 句用来打印(输出)当前输入的行, 所以程序</p>
<p>{ print }<br>会输出所有输入的内容到标准输出. 由于 $0 表示整行,</p>
<p>{ print $0 }<br>也会做一样的事情.</p>
<p>打印特定字段</p>
<p>使用一个 print 语句可以在同一行中输出不止一个字段. 下面的程序输出了每 行输入中的第一和第三个字段<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>使用 emp.data 作为输入, 它将会得到<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 0</span><br><span class="line">Dan 0</span><br><span class="line">Kathy 10</span><br><span class="line">Mark 20</span><br><span class="line">Mary 22</span><br><span class="line">Susie 18</span><br></pre></td></tr></table></figure></p>
<p>在 print 语句中被逗号分割的表达式, 在默认情况下他们将会用一个空格分割 来输出. 每一行 print 生成的内容都会以一个换行符作为结束. 但这些默认行 为都可以自定义; 我们将在第二章中介绍具体的方法.</p>
<p>NF, 字段数量</p>
<p>很显然你可能会发现你总是需要通过 $1, $2 这样来指定不同的字段, 但任何表 达式都可以使用在$之后来表达一个字段的序号; 表达式会被求值并用于表示字段 序号. Awk会对当前输入的行有多少个字段进行计数, 并且将当前行的字段数量存 储在一个内建的称作 NF 的变量中. 因此, 下面的程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> NF, <span class="variable">$1</span>, <span class="variable">$NF</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>会依次打印出每一行的字段数量, 第一个字段的值, 最后一个字段的值.</p>
<p>计算和打印</p>
<p>你也可以对字段的值进行计算后再打印出来. 下面的程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>是一个典型的例子. 它会打印出姓名和员工的合计支出(以小时计算):<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 0</span><br><span class="line">Dan 0</span><br><span class="line">Kathy 40</span><br><span class="line">Mark 100</span><br><span class="line">Mary 121</span><br><span class="line">Susie 76.5</span><br></pre></td></tr></table></figure></p>
<p>我们马上就会学到怎么让这个输出看起来更漂亮.</p>
<p>打印行号</p>
<p>Awk提供了另一个内建变量, 叫做 NR, 它会存储当前已经读取了多少行的计数. 我们可以使用 NR 和 $0 给 emp.data 的没一行加上行号:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> NR, <span class="variable">$0</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印的输出看起来会是这样:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 Beth   4.00     0</span><br><span class="line">2 Dan    3.75     0</span><br><span class="line">3 Kathy  4.00    10</span><br><span class="line">4 Mark   5.00    20</span><br><span class="line">5 Mary   5.50    22</span><br><span class="line">6 Susie  4.25   1 8</span><br></pre></td></tr></table></figure></p>
<p>在输出中添加内容</p>
<p>你当然也可以在字段中间或者计算的值中间打印输出想要的内容:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="string">"total pay for"</span>, <span class="variable">$1</span>, <span class="string">"is"</span>, <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">total pay <span class="keyword">for</span> Beth is 0</span><br><span class="line">total pay <span class="keyword">for</span> Dan is 0</span><br><span class="line">total pay <span class="keyword">for</span> Kathy is 40</span><br><span class="line">total pay <span class="keyword">for</span> Mark is 100</span><br><span class="line">total pay <span class="keyword">for</span> Mary is 121</span><br><span class="line">total pay <span class="keyword">for</span> Susie is 76.5</span><br></pre></td></tr></table></figure></p>
<p>在打印语句中, 双引号内的文字将会在字段和计算的值中插入输出.</p>
<h3 id="1-3_高级输出">1.3 高级输出</h3><p>print 语句可用于快速而简单的输出。若要严格按照你所想的格式化输出，则需要使用 printf 语句。正如我将在2.4节所见， printf 几乎可以产生任何形式的输出，但在本节中，我们仅展示其部分功能。</p>
<p>字段排队</p>
<p>printf 语句的形式如下：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(format, value1, value2, ..., valuen)</span><br></pre></td></tr></table></figure></p>
<p>其中 format 是字符串，包含要逐字打印的文本，穿插着 format 之后的每个值该如何打印的规格(specification)。一个规格是一个 % 符，后面跟着一些字符，用来控制一个 value 的格式。第一个规格说明如何打印 value1 ，第二个说明如何打印 value2 ，… 。因此，有多少 value 要打印，在 format 中就要有多少个 % 规格。</p>
<p>这里有个程序使用 printf 打印每位员工的总薪酬：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">printf</span>(<span class="string">"total pay for %s is $%.2f\n"</span>, <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>printf 语句中的规格字符串包含两个 % 规格。第一个是 %s ，说明以字符串的方式打印第一个值 $1 。第二个是 %.2f ，说明以数字的方式打印第二个值 $2*$3 ，并保留小数点后面两位。规格字符串中其他东西，包括美元符号，仅逐字打印。字符串尾部的 \n 代表开始新的一行，使得后续输出将从下一行开始。以 emp.data 为输入，该程序产生：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">total pay <span class="keyword">for</span> Beth is <span class="variable">$0</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Dan is <span class="variable">$0</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Kathy is <span class="variable">$40</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Mark is <span class="variable">$100</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Mary is <span class="variable">$121</span>.00</span><br><span class="line">total pay <span class="keyword">for</span> Susie is <span class="variable">$76</span>.50</span><br></pre></td></tr></table></figure></p>
<p>printf 不会自动产生空格或者新的行，必须是你自己来创建，所以不要忘了 \n 。</p>
<p>另一个程序是打印每位员工的姓名与薪酬：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">printf</span>(<span class="string">"%-8s $%6.2f\n"</span>, <span class="variable">$1</span>, <span class="variable">$2</span> * <span class="variable">$3</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>第一个规格 %-8s 将一个姓名以字符串形式在8个字符宽度的字段中左对齐输出。第二个规格 %6.2f 将薪酬以数字的形式，保留小数点后两位，在6个字符宽度的字段中输出。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth     $  0.00</span><br><span class="line">Dan      $  0.00</span><br><span class="line">Kathy    $ 40.00</span><br><span class="line">Mark     <span class="variable">$100</span>.00</span><br><span class="line">Mary     <span class="variable">$121</span>.00</span><br><span class="line">Susie    $ 76.50</span><br></pre></td></tr></table></figure></p>
<p>之后我们将展示更多的 printf 示例。一切精彩尽在2.4小节。</p>
<p>排序输出</p>
<p>假设你想打印每位员工的所有数据，包括他或她的薪酬，并以薪酬递增的方式进行排序输出。最简单的方式是使用awk将每位员工的总薪酬置于其记录之前，然后利用一个排序程序来处理awk的输出。Unix上，命令行如下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123; printf("%6.2f    %s\n", $2 * $3, $0) &#125;'</span> emp.data | sort</span><br></pre></td></tr></table></figure></p>
<p>将awk的输出通过管道传给 sort 命令，输出为：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  0.00    Beth  4.00 0</span><br><span class="line">  0.00    Dan   3.75 0</span><br><span class="line"> 40.00    Kathy 4.00 10</span><br><span class="line"> 76.50    Susie 4.25 18</span><br><span class="line">100.00    Mark  5.00 20</span><br><span class="line">121.00    Mary  5.50 22</span><br></pre></td></tr></table></figure></p>
<h3 id="1-4_选择">1.4 选择</h3><p>Awk的模式适合用于为进一步的处理从输入中选择相关的数据行。由于不带动作的模式会打印所有匹配模式的行，所以很多awk程序仅包含一个模式。本节将给出一些有用的模式示例。</p>
<p>通过对比选择</p>
<p>这个程序使用一个对比模式来选择每小时赚5美元或更多的员工记录，也就是，第二个字段大于等于5的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 5</span><br></pre></td></tr></table></figure></p>
<p>从 emp.data 中选出这些行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br></pre></td></tr></table></figure></p>
<p>通过计算选择</p>
<p>程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> * <span class="variable">$3</span> &gt; 50 &#123; <span class="built_in">printf</span>(<span class="string">"$%.2f for %s\n"</span>, <span class="variable">$2</span> * <span class="variable">$3</span>, <span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>打印出总薪资超过50美元的员工的薪酬。</p>
<p>通过文本内容选择</p>
<p>除了数值测试，你还可以选择包含特定单词或短语的输入行。这个程序会打印所有第一个字段为 Susie 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$1</span> == <span class="string">"Susie"</span></span><br></pre></td></tr></table></figure></p>
<p>操作符 == 用于测试相等性。你也可以使用称为 正则表达式 的模式查找包含任意字母组合，单词或短语的文本。这个程序打印任意位置包含 Susie 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Susie/</span><br></pre></td></tr></table></figure></p>
<p>输出为这一行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>正则表达式可用于指定复杂的多的模式；2.1节将会有全面的论述。</p>
<p>模式组合</p>
<p>可以使用括号和逻辑操作符与 &amp;&amp; ， 或 || ， 以及非 ! 对模式进行组合。程序:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 4 || <span class="variable">$3</span> &gt;= 20</span><br></pre></td></tr></table></figure></p>
<p>会打印 $2 (第二个字段) 大于等于 4 或者 $3 (第三个字段) 大于等于 20 的行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Beth    4.00    0</span><br><span class="line">kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>两个条件都满足的行仅打印一次。与如下包含两个模式程序相比：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt;= 4</span><br><span class="line"><span class="variable">$3</span> &gt;= 20</span><br></pre></td></tr></table></figure></p>
<p>如果某个输入行两个条件都满足，这个程序会打印它两遍：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Beth    4.00    0</span><br><span class="line">Kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>注意如下程序:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!(<span class="variable">$2</span> &lt; 4 &amp;&amp; <span class="variable">$3</span> &lt; 20)</span><br></pre></td></tr></table></figure></p>
<p>会打印极不满足 $2 小于4也不满足 $3 小于20的行；这个条件与上面第一个模式组合等价，虽然也许可读性差了点。</p>
<p>数据验证</p>
<p>实际的数据中总是会存在错误的。在数据验证-检查数据的值是否合理以及格式是否正确-方面，Awk是个优秀的工具。</p>
<p>数据验证本质上是否定的：不是打印具备期望属性的行，而是打印可疑的行。如下程序使用对比模式 将5个数据合理性测试应用于 emp.data 的每一行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NF != 3     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"number of fields is not equal to 3"</span> &#125;</span><br><span class="line"><span class="variable">$2</span> &lt; 3.35   &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"rate is below minimum wage"</span> &#125;</span><br><span class="line"><span class="variable">$2</span> &gt; 10     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"rate exceeds <span class="variable">$10</span> per hour"</span> &#125;</span><br><span class="line"><span class="variable">$3</span> &lt; 0      &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"negative hours worked"</span> &#125;</span><br><span class="line"><span class="variable">$3</span> &gt; 60     &#123; <span class="built_in">print</span> <span class="variable">$0</span>, <span class="string">"too many hours worked"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>如果没有错误，则没有输出。</p>
<p>BEGIN与END</p>
<p>特殊模式 BEGIN 用于匹配第一个输入文件的第一行之前的位置， END 则用于匹配处理过的最后一个文件的最后一行之后的位置。这个程序使用 BEGIN 来输出一个标题：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BEGIN &#123; <span class="built_in">print</span> <span class="string">"Name    RATE    HOURS"</span>; <span class="built_in">print</span> <span class="string">""</span>&#125;</span><br><span class="line">      &#123; <span class="built_in">print</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出为：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">NAME    RATE    HOURS</span><br><span class="line"></span><br><span class="line">Beth    4.00    0</span><br><span class="line">Dan     3.75    0</span><br><span class="line"></span><br><span class="line">Kathy   4.00    10</span><br><span class="line">Mark    5.00    20</span><br><span class="line">Mary    5.50    22</span><br><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<p>程序的动作部分你可以在一行上放多个语句，不过要使用分号进行分隔。注意 普通的 print 是打印当前输入行，与之不同的是 print “” 会打印一个空行。</p>
<h3 id="1-5_使用AWK进行计算">1.5 使用AWK进行计算</h3><p>一个动作就是一个以新行或者分号分隔的语句序列。你已经见过一些其动作仅是单个 print 语句的例子。本节将提供一些执行简单的数值以及字符串计算的语句示例。在这些语句中，你不仅可以使用像 NF 这样的内置变量，还可以创建自己的变量用于计算、存储数据诸如此类的操作。awk中，用户创建的变量不需要声明。</p>
<h4 id="计数">计数</h4><p>这个程序使用一个变量 emp 来统计工作超过15个小时的员工的数目：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$3</span> &gt; 15 &#123; emp = emp + 1 &#125;</span><br><span class="line">END     &#123; <span class="built_in">print</span> emp, <span class="string">"employees worked more than 15 hours"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>对于第三个字段超过15的每行， emp 的前一个值加1。以 emp.data 为输入，该程序产生：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 employees worked more than 15 hours</span><br></pre></td></tr></table></figure></p>
<p>用作数字的awk变量的默认初始值为0，所以我们不需要初始化 emp 。</p>
<h4 id="求和与平均值">求和与平均值</h4><p>为计算员工的数目，我们可以使用内置变量 NR ，它保存着到目前位置读取的行数；在所有输入的结尾它的值就是所读的所有行数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"employees"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出为：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6 employees</span><br></pre></td></tr></table></figure></p>
<p>如下是一个使用 NR 来计算薪酬均值的程序：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    &#123; pay = pay + <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"employees"</span></span><br><span class="line">      <span class="built_in">print</span> <span class="string">"total pay is"</span>, pay</span><br><span class="line">      <span class="built_in">print</span> <span class="string">"average pay is"</span>, pay/NR</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>第一个动作累计所有员工的总薪酬。 END 动作打印出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6 employees</span><br><span class="line">total pay is 337.5</span><br><span class="line">average pay is 56.25</span><br></pre></td></tr></table></figure></p>
<p>很明显， printf 可用来产生更简洁的输出。并且该程序也有个潜在的错误：在某种不太可能发生的情况下， NR 等于0，那么程序会试图执行零除，从而产生错误信息。</p>
<h4 id="处理文本">处理文本</h4><p>awk的优势之一是能像大多数语言处理数字一样方便地处理字符串。awk变量可以保存数字也可以保存字符串。这个程序会找出时薪最高的员工：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt; maxrate &#123; maxrate = <span class="variable">$2</span>; maxemp = <span class="variable">$1</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> <span class="string">"highest hourly rate:"</span>, maxrate, <span class="string">"for"</span>, maxemp &#125;</span><br></pre></td></tr></table></figure></p>
<p>输出<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highest hourly rate: 5.50 <span class="keyword">for</span> Mary</span><br></pre></td></tr></table></figure></p>
<p>这个程序中，变量 maxrate 保存着一个数值，而变量 maxemp 则是保存着一个字符串。（如果有几个员工都有着相同的最大时薪，该程序则只找出第一个。）</p>
<h4 id="字符串连接">字符串连接</h4><p>可以合并老字符串来创建新字符串。这种操作称为 连接（concatenation） 。程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    &#123; names = names <span class="variable">$1</span> <span class="string">" "</span>&#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> names &#125;</span><br></pre></td></tr></table></figure></p>
<p>通过将每个姓名和一个空格附加到变量 names 的前一个值， 来将所有员工的姓名收集进单个字符串中。最后 END 动作打印出 names 的值：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Beth Dan Kathy Mark Mary Susie</span><br></pre></td></tr></table></figure></p>
<p>awk程序中，连接操作的表现形式是将字符串值一个接一个地写出来。对于每个输入行，程序的第一个语句先连接三个字符串： names 的前一个值、当前行的第一个字段以及一个空格，然后将得到的字符串赋值给 names 。因此，读取所有的输入行之后， names 就是个字符串，包含所有员工的姓名，每个姓名后面跟着一个空格。用于保存字符串的变量的默认初始值是空字符串(也就是说该字符串包含零个字符)，因此这个程序中的 names 不需要显式初始化。</p>
<h4 id="打印最后一个输入行">打印最后一个输入行</h4><p>虽然在 END 动作中 NR 还保留着它的值，但 $0 没有。程序<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    &#123; last = <span class="variable">$0</span> &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> last &#125;</span><br></pre></td></tr></table></figure></p>
<p>是打印最后一个输入行的一种方式：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Susie   4.25    18</span><br></pre></td></tr></table></figure></p>
<h4 id="内置函数">内置函数</h4><p>我们已看到awk提供了内置变量来保存某些频繁使用的数量，比如：字段的数量和输入行的数量。类似地，也有内置函数用来计算其他有用的数值。除了平方根、对数、随机数诸如此类的算术函数，也有操作文本的函数。其中之一是 length ，计算一个字符串中的字符数量。例如，这个程序会计算每个人的姓名的长度：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, length(<span class="variable">$1</span>) &#125;</span><br></pre></td></tr></table></figure></p>
<p>结果：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Beth 4</span><br><span class="line">Dan 3</span><br><span class="line">Kathy 5</span><br><span class="line">Mark 4</span><br><span class="line">Mary 4</span><br><span class="line">Susie 5</span><br></pre></td></tr></table></figure></p>
<h4 id="行、单词以及字符的计数">行、单词以及字符的计数</h4><p>这个程序使用了 length 、 NF 、以及 NR 来统计输入中行、单词以及字符的数量。为了简便，我们将每个字段看作一个单词。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    &#123; nc = nc + length(<span class="variable">$0</span>) + 1</span><br><span class="line">      nw = nw + NF</span><br><span class="line">    &#125;</span><br><span class="line">END &#123; <span class="built_in">print</span> NR, <span class="string">"lines,"</span>, nw, <span class="string">"words,"</span>, nc, <span class="string">"characters"</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>文件 emp.data 有:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6 lines, 18 words, 77 characters</span><br></pre></td></tr></table></figure></p>
<p>$0 并不包含每个输入行的末尾的换行符，所以我们要另外加个1。</p>
<h3 id="1-6_控制语句">1.6 控制语句</h3><p>Awk为选择提供了一个 if-else 语句，以及为循环提供了几个语句，所以都效仿C语言中对应的控制语句。它们仅可以在动作中使用。</p>
<p>if-else语句</p>
<p>如下程序将计算时薪超过6美元的员工的总薪酬与平均薪酬。它使用一个 if 来防范计算平均薪酬时的零除问题。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> &gt; 6 &#123; n = n + 1; pay = pay + <span class="variable">$2</span> * <span class="variable">$3</span> &#125;</span><br><span class="line">END    &#123; <span class="keyword">if</span> (n &gt; 0)</span><br><span class="line">            <span class="built_in">print</span> n, <span class="string">"employees, total pay is"</span>, pay,</span><br><span class="line">                     <span class="string">"average pay is"</span>, pay/n</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">             <span class="built_in">print</span> <span class="string">"no employees are paid more than <span class="variable">$6</span>/hour"</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p>
<p>emp.data 的输出是：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">no employees are paid more than <span class="variable">$6</span>/hour</span><br></pre></td></tr></table></figure></p>
<p>if-else 语句中，if 后的条件会被计算。如果为真，执行第一个 print 语句。否则，执行第二个 print 语句。注意我们可以使用一个逗号将一个长语句截断为多行来书写。</p>
<p>while语句</p>
<p>一个 while 语句有一个条件和一个执行体。条件为真时执行体中的语句会被重复执行。这个程序使用公式 [Math Processing Error]</p>
<p>来演示以特定的利率投资一定量的钱，其数值是如何随着年数增长的。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># interest1 - 计算复利</span></span><br><span class="line"><span class="comment">#   输入: 钱数    利率    年数</span></span><br><span class="line"><span class="comment">#   输出: 复利值</span></span><br><span class="line"></span><br><span class="line">&#123;   i = 1</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= <span class="variable">$3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t%.2f\n"</span>, <span class="variable">$1</span> * (1 + <span class="variable">$2</span>) ^ i)</span><br><span class="line">        i = i + 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>条件是 while 后括弧包围的表达式；循环体是条件后大括号包围的两个表达式。 printf 规格字符串中的 \t 代表制表符； ^ 是指数操作符。从 # 开始到行尾的文本是注释，会被awk忽略，但能帮助程序的读者理解程序做的事情。</p>
<p>你可以为这程序输入三个一组的数字，看看不一样的钱数、利率、以及年数会产生什么。例如，如下事务演示了1000美元，利率为6%与12%，5年的复利分别是如何增长的：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ awk -f interest1</span><br><span class="line">1000 .06 5</span><br><span class="line">        1060.00</span><br><span class="line">        1123.60</span><br><span class="line">        1191.02</span><br><span class="line">        1262.48</span><br><span class="line">        1338.23</span><br><span class="line">1000 .12 5</span><br><span class="line">        1120.00</span><br><span class="line">        1254.40</span><br><span class="line">        1404.93</span><br><span class="line">        1573.52</span><br><span class="line">        1762.34</span><br></pre></td></tr></table></figure></p>
<p>for语句</p>
<p>另一个语句， for ，将大多数循环都包含的初始化、测试、以及自增压缩成一行。如下是之前利息计算的 for 版本：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># interest1 - 计算复利</span></span><br><span class="line"><span class="comment">#   输入: 钱数    利率    年数</span></span><br><span class="line"><span class="comment">#   输出: 每年末的复利</span></span><br><span class="line"></span><br><span class="line">&#123; <span class="keyword">for</span> (i = 1; i &lt;= <span class="variable">$3</span>; i = i + 1)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\t%.2f\n"</span>, <span class="variable">$1</span> * (1 + <span class="variable">$2</span>) ^ i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>初始化 i = 1 只执行一次。接下来，测试条件 i &lt;= $3 ；如果为真，则执行循环体的 printf 语句。循环体执行结束后执行自增 i = i + 1 ，接着由另一次条件测试开始下一个循环迭代。代码更加紧凑，并且由于循环体仅是一条语句，所以不需要大括号来包围它。</p>
<h3 id="1-7_数组">1.7 数组</h3><p>awk为存储一组相关的值提供了数组。虽然数组给予了awk很强的能力，但在这里我们仅展示一个简单的例子。如下程序将按行逆序打印输入。第一个动作将输入行存为数组 line 的连续元素；即第一行放在 line[1] ，第二行放在 line[2] , 依次继续。 END 动作使用一个 while 语句从后往前打印数组中的输入行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 反转 - 按行逆序打印输入</span></span><br><span class="line"></span><br><span class="line">    &#123; line[NR] = <span class="variable">$0</span> &#125;  <span class="comment"># 记下每个输入行</span></span><br><span class="line"></span><br><span class="line">END &#123; i = NR           <span class="comment"># 逆序打印</span></span><br><span class="line">      <span class="keyword">while</span> (i &gt; 0) &#123;</span><br><span class="line">        <span class="built_in">print</span> line[i]</span><br><span class="line">        i = i - 1</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>以 emp.data 为输入，输出为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Susie    4.25   18</span><br><span class="line">Mary     5.50   22</span><br><span class="line">Mark     5.00   20</span><br><span class="line">Kathy    4.00   10</span><br><span class="line">Dan      3.75   0</span><br><span class="line">Beth     4.00   0</span><br></pre></td></tr></table></figure></p>
<p>如下是使用 for 语句实现的相同示例：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 反转 - 按行逆序打印输入</span></span><br><span class="line"></span><br><span class="line">    &#123; line[NR] = <span class="variable">$0</span> &#125;   <span class="comment"># 记下每个输入行</span></span><br><span class="line"></span><br><span class="line">END &#123; <span class="keyword">for</span> (i = NR; i &gt; 0; i = i - 1)</span><br><span class="line">        <span class="built_in">print</span> line[i]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="二-_AWK语言详解">二. AWK语言详解</h2><p>本章将主要通过示例来解释构成awk程序的概念。因为这是对语言的全面描述，材料会很详细，因此我们推荐你浏览略读，需要的时候再回来核对细节。</p>
<p>最简单的awk程序就是一个模式-动作语句的序列：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pattern    &#123; action &#125;</span><br><span class="line">pattern    &#123; action &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>某些语句中，可能没有模式；另一些语句中，可能没有动作及其大括号。awk检查你的程序以确认不存在语法错误后，一次读取一行输入，并对每一行按序处理模式。对于每个匹配到当前输入行的模式，执行其关联的动作。不存在模式，则匹配每个输入行，因此没有模式的每个动作对于每个输入行都要执行。一个仅包含模式的模式-动作语句将打印匹配该模式的每个输入行。本章的大部分内容中，名词”输入行(input-line)”和”记录(record)” 是同义的。2.5小节中，我们将讨论多行记录，即一个记录包含多行输入。</p>
<p>本章的第一节将详细描述模式。第二节通过表达式、赋值以及控制语句来描述动作。剩下的章节覆盖函数定义，输出，输入，以及awk程序如何调用其他程序等内容。多数章节包含了主要特性的概要。</p>
<p>输入文件 countries</p>
<p>本章中，我们使用一个名为 countries 的文件作为许多awk程序的输入。文件的每行包含一个国家的名字，以千平方英里为单位的面积，以百万为单位的人口数，以及属于哪个洲。数据是1984年的，苏联(USSR)被武断地归入了亚洲。文件中，四列数据以制表符tab分隔；以单个空格将 North 、 South 与 America 分隔开。</p>
<p>文件 countries 包含如下数据行：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USSR    8649    275     Asia</span><br><span class="line">Canada  3852    25      North America</span><br><span class="line">China   3705    1032    Asia</span><br><span class="line">USA     3615    237     North America</span><br><span class="line">Brazil  3286    134     South America</span><br><span class="line">India   1267    746     Asia</span><br><span class="line">Mexico  762     78      North America</span><br><span class="line">France  211     55      Europe</span><br><span class="line">Japan   144     120     Asia</span><br><span class="line">Germany 96      61      Europe</span><br><span class="line">England 94      56      Europe</span><br></pre></td></tr></table></figure></p>
<p>本章的其余部分，如果没有明确说明输入文件，那么就是使用文件 countries 。</p>
<p>程序的格式</p>
<p>模式-动作语句以及动作中的语句通常以换行分隔，如果它们以分号分隔，则多个语句可以出现在一行中。分号可以放在任意语句的尾部。</p>
<p>动作的开大括号必须与其对应的模式处于同一行；动作的其余部分，包括闭大括号，则可以出现接下来的行中。</p>
<p>空行会被忽略；一般为了提高程序的可读性会在语句的前面或者后面插入空行。在操作符和操作数的两边插入空格和制表符也是为了提高可读性。</p>
<p>任意行的末尾可能会有注释。注释以符号 # 开始，结束于行尾，就像这样<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> <span class="variable">$1</span>, <span class="variable">$3</span> &#125;        <span class="comment"># print country name and population</span></span><br></pre></td></tr></table></figure></p>
<p>长语句可以跨越多行，但要在断行的地方加入一个反斜杠和一个换行符：:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="built_in">print</span> \</span><br><span class="line">                <span class="variable">$1</span>,             <span class="comment"># country name</span></span><br><span class="line">                <span class="variable">$2</span>,             <span class="comment"># area in thousands of square miles</span></span><br><span class="line">                <span class="variable">$3</span> &#125;    <span class="comment"># population in millions</span></span><br></pre></td></tr></table></figure></p>
<p>如上例所示，语句也可以逗号断行，在每个断行的末尾也可以加入注释。</p>
<p>本书中，我们使用了多种格式风格，部分是为了说明相异之处，部分是为了避免程序占用太多的行空间。类似于本章中的简短程序，格式并不是很重要，但一致性与可读性可以帮助更长的程序保持可控。</p>
<h3 id="2-1_模式">2.1 模式</h3><p>模式控制着动作的执行：模式匹配，其关联的动作则执行。本节将描述6种模式及其匹配条件。</p>
<p>模式摘要</p>
<ol>
<li>BEGIN { 语句 }<br>在读取任何输入前执行一次 语句</li>
<li>END { 语句 }<br>读取所有输入之后执行一次 语句</li>
<li>表达式 { 语句 }<br>对于 表达式 为真（即，非零或非空）的行，执行 语句</li>
<li>/正则表达式/ { 语句 }<br>如果输入行包含字符串与 正则表达式 相匹配，则执行 语句</li>
<li>组合模式 { 语句 }<br>一个 组合模式 通过与（&amp;&amp;），或（||），非（|），以及括弧来组合多个表达式；对于组合模式为真的每个输入行，执行 语句</li>
<li>模式1，模式2 { 语句 }<br>范围模式(range pattern)匹配从与 模式1 相匹配的行到与 模式2 相匹配的行（包含该行）之间的所有行，对于这些输入行，执行 语句 。<br>BEGIN和END不与其他模式组合。范围模式不可以是任何其他模式的一部分。BEGIN和END是仅有的必须搭配动作的模式。</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/02/firewall.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/02/firewall.html" class="post-title-link" itemprop="url">firewall</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-02 14:18:15" itemprop="dateCreated datePublished" datetime="2015-08-02T14:18:15+08:00">2015-08-02</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Google/" itemprop="url" rel="index"><span itemprop="name">Google</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/02/firewall.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/02/firewall.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/02/firewall.html" class="leancloud_visitors" data-flag-title="firewall">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h3 id="受到管制的中国互联网">受到管制的中国互联网</h3><p>中国对其互联网内容有着严格的管制，设置了名为”防火长城”的屏蔽系统来阻止用户与外面的世界自由地互动。想要从中国访问自由的、不受管制的互联网，你需要绕开长城防火墙，在中国，上网就是如此之难。</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fire1.png" alt=""><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/fire2.JPG" alt=""></p>
<h3 id="测试网站是否被墙">测试网站是否被墙</h3><p><li><span class="exturl" data-url="aHR0cDovL3d3dy53ZWJzaXRlcHVsc2UuY29tL2hlbHAvdGVzdHRvb2xzLmNoaW5hLXRlc3QuaHRtbA==" title="http://www.websitepulse.com/help/testtools.china-test.html">websitepulse.com<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly96aC5ncmVhdGZpcmUub3JnL3Rlc3Q/dXJsPQ==" title="https://zh.greatfire.org/test?url=">greatfire.org<i class="fa fa-external-link"></i></span></li></p>
<h3 id="翻墙必备">翻墙必备</h3><p><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29sZGVuZnJvZy5jb20vdnlwcnZwbg==" title="https://www.goldenfrog.com/vyprvpn">VyprVPN<i class="fa fa-external-link"></i></span> ，有500M的免费流量，抗墙能力强，特别是安卓等移动设备。<strong><span style="color:#ff0000;">Vyprvpn为中国用户提供多一倍的免费数据流量</span></strong>，可<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29sZGVuZnJvZy5jaC9DTi92eXBydnBuL2dyZWF0LWZpcmV3YWxsLWZyZWUtdnBuLXNlcnZpY2U/b2ZmZXJfaWQ9OTAmYW1wO2FmZl9pZD0yMTQ3JmFtcDt1cmxfaWQ9NDcmYW1wO3Byb2Nlc3NlZD0xIw==" title="https://www.goldenfrog.ch/CN/vyprvpn/great-firewall-free-vpn-service?offer_id=90&amp;aff_id=2147&amp;url_id=47&amp;processed=1#">在此下载<i class="fa fa-external-link"></i></span>（中文页面），在推荐的这个入口注册账号才有多一倍的免费流量，下载手机客户端，用注册的账号登录即可。安卓下的vyprvpn可启用专用协议对抗中国的网络封锁，不可错过。 <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xQjlpckZjZy13ZGhjNzBsaGNCQldYNUpaZkN6cVU0ZDcza25RLXoyR2kxZy9wdWI=" title="https://docs.google.com/document/d/1B9irFcg-wdhc70lhcBBWX5JZfCzqU4d73knQ-z2Gi1g/pub">专供中国用户：安装及使用疑难问题解答。<i class="fa fa-external-link"></i></span></li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lpbmdodW9jaG8vZmlyZWZseS1wcm94eQ==" title="https://github.com/yinghuocho/firefly-proxy">萤火虫代理<i class="fa fa-external-link"></i></span> 开源翻墙工具，支持多平台。</li></p>
<p><li> <span class="exturl" data-url="aHR0cHM6Ly93d3cuZ2V0bGFudGVybi5vcmcv" title="https://www.getlantern.org/">Lantern<i class="fa fa-external-link"></i></span> 用私有网络分享节点，可以一试。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3dvd2xlZ2FjeS5tbC8=" title="http://wowlegacy.ml/">WoW Legacy<i class="fa fa-external-link"></i></span> 翻牆瀏覽器WowLegacy，基於Goagent重新開發，可一鍵翻牆。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy52cG5nYXRlLm5ldC9jbi8=" title="http://www.vpngate.net/cn/">VPN Gate<i class="fa fa-external-link"></i></span>  由全世界志愿者提供的公共 VPN 服务器获得自由访问互联网。VPNgate的开发者引入了一项新技术：P2P中继。简单来说，如果墙内有人连上了墙外志愿者提供的VPNgate服务器，那么他就自动成为了服务器，其他墙内的人就可以通过连上他来翻墙。（<span class="exturl" data-url="aHR0cDovL3d3dy5jaGluYWdmdy5vcmcvMjAxNS8wMi92cG5nYXRlcDJwLmh0bWw=" title="http://www.chinagfw.org/2015/02/vpngatep2p.html">安装<i class="fa fa-external-link"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy52cG5nYXRlLm5ldC9jbi9kb3dubG9hZC5hc3B4" title="http://www.vpngate.net/cn/download.aspx">下载<i class="fa fa-external-link"></i></span> <span class="exturl" data-url="aHR0cDovL3d3dy5jaGluYWdmdy5vcmcvMjAxNC8wNS8yMDE0NS5odG1s" title="http://www.chinagfw.org/2014/05/20145.html">使用经验<i class="fa fa-external-link"></i></span>）</li></p>
<p><li><span class="exturl" data-url="aHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tLzVua3Qtc2o3eC1jYzJoL3poLmh0bWw=" title="https://s3.amazonaws.com/5nkt-sj7x-cc2h/zh.html">赛风<i class="fa fa-external-link"></i></span> （<span class="exturl" data-url="aHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tLzVua3Qtc2o3eC1jYzJoL3poLmh0bWw=" title="https://s3.amazonaws.com/5nkt-sj7x-cc2h/zh.html">下载<i class="fa fa-external-link"></i></span>）由开放网络基金资助、多伦多大学的公民实验室（Citizen Lab）开发。</li></p>
<p><li><span class="exturl" data-url="aHR0cDovL3d3dy5pc2hhZG93c29ja3MuY29tLw==" title="http://www.ishadowsocks.com/">Shadowsocks<i class="fa fa-external-link"></i></span> 免费账号</li></p>
<h3 id="建议关注">建议关注</h3><p>P2P翻墙项目<span class="exturl" data-url="aHR0cHM6Ly91cHJveHkub3JnLw==" title="https://uproxy.org/">Uproxy<i class="fa fa-external-link"></i></span>的进展，谷歌翻墙利器。</p>
<h3 id="付费方案">付费方案</h3><p><li><span class="exturl" data-url="aHR0cDovL3d3dy5ob25neGluZ2NoYWppYW4uY29tLw==" title="http://www.hongxingchajian.com/">红杏<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/hongxing.png" alt=""></li></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/01/linux-command.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/01/linux-command.html" class="post-title-link" itemprop="url">linux命令行精选</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-01 21:27:15" itemprop="dateCreated datePublished" datetime="2015-08-01T21:27:15+08:00">2015-08-01</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/01/linux-command.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/01/linux-command.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/01/linux-command.html" class="leancloud_visitors" data-flag-title="linux命令行精选">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>致力于收集那些短小精悍的linux命令，欢迎补充！<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/linux_command.png" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">grep -vf file1 file2 查看两个文件的不同</span><br><span class="line">rename -n <span class="string">"s/-.*//"</span> * 批量前缀重命名</span><br><span class="line">diff &lt;(sort file1.txt) &lt;(sort file2.txt) 比较两个已排序的文件</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `find -name <span class="string">'*_test.rb'</span>` ; <span class="keyword">do</span> mv <span class="variable">$i</span> <span class="variable">$&#123;i%%_test.rb&#125;</span>_spec.rb ; <span class="keyword">done</span> 批量重命名</span><br><span class="line">shred -u -z -n 17 rubricasegreta.txt 安全删除文件</span><br><span class="line">sed -re <span class="string">'/^#/d ; s/#.*$//'</span> 清理注释</span><br><span class="line">ps aux | sort -nk 6 排序按 第6列</span><br><span class="line">convert -density 300x300 input.pdf output.png 把pdf转化成png</span><br><span class="line">:%s/&lt;control-VM&gt;//g 如何在vim清理^M</span><br><span class="line"><span class="built_in">export</span> HISTTIMEFORMAT=<span class="string">'%Y.%m.%d-%T :: '</span> HISTFILESIZE=50000 HISTSIZE=50000 更好地设置bash <span class="built_in">history</span></span><br><span class="line">/^\([2-9]\d*\|1\d+\) vim 中查找比 1 大的数</span><br><span class="line">tar cvfz dir_name.tgz dir/ 如何tar gz 一个目录</span><br><span class="line">pv file1 &gt; file2 带进度条的复制文件</span><br><span class="line">gs -dNOPAUSE -sDEVICE=jpeg -r144 -sOutputFile=p%03d.jpg file.pdf 使用Ghostscript转换PDF为JPEG</span><br><span class="line">find . -iname <span class="string">"*.jpg"</span> -<span class="built_in">printf</span> <span class="string">'&lt;img src="%f" title="%f"&gt;\n'</span> &gt; gallery.html 创建一个html相册</span><br><span class="line">sed -i &lt;start&gt;,&lt;end&gt;d &lt;filename&gt; 从一个文件删除一个范围内的行</span><br><span class="line">sed <span class="string">'/^$/d'</span> file &gt;newfile 清除文件中的空行</span><br><span class="line">awk <span class="string">'&#123;print NR": "$0; for(i=1;i&lt;=NF;++i)print "\t"i": "$i&#125;'</span> 分析列</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'wget url'</span> | at 01:00 定时启动wget下载</span><br><span class="line">awk -F<span class="string">'^"|", "|"$'</span> <span class="string">'&#123; print $2,$3,$4 &#125;'</span> file.csv 用 awk 解析.csv</span><br><span class="line">find -<span class="built_in">type</span> f -<span class="built_in">exec</span> mv &#123;&#125; . \; 将子目录的所有内容都移动到当前目录</span><br><span class="line">sed -i <span class="string">'s/\s\+$//'</span> &lt;file&gt; 删除文件中每行末尾的空格</span><br><span class="line">ls -al | sort +4n 按大小排序</span><br><span class="line">sort file1 file2 | uniq -d 求交集</span><br><span class="line">wget -r -nd -q -A <span class="string">"*.ext"</span> http://www.example.org/   抓去一个网页的所有特定扩展名的文件</span><br><span class="line">awk <span class="string">'&#123;s+=$1&#125;END&#123;print s&#125;'</span>   列求和</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/08/01/rss.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/08/01/rss.html" class="post-title-link" itemprop="url">rss制作</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-08-01 10:34:40" itemprop="dateCreated datePublished" datetime="2015-08-01T10:34:40+08:00">2015-08-01</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Hexo/" itemprop="url" rel="index"><span itemprop="name">Hexo</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/08/01/rss.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/08/01/rss.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/08/01/rss.html" class="leancloud_visitors" data-flag-title="rss制作">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>它非常小巧，仅仅加了一种能自动生成种子的功能。用户只需提供需要处理的URL地址，<span class="exturl" data-url="aHR0cHM6Ly9mZWVkaXR5LmNvbS8=" title="https://feedity.com/">Feedityl<i class="fa fa-external-link"></i></span>会提供起始终止的选项模块，这样它就能输出选定的内容。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/rss.png" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/07/31/color.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/07/31/color.html" class="post-title-link" itemprop="url">杂志图表的经典用色</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-07-31 23:07:34" itemprop="dateCreated datePublished" datetime="2015-07-31T23:07:34+08:00">2015-07-31</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/07/31/color.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/07/31/color.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/07/31/color.html" class="leancloud_visitors" data-flag-title="杂志图表的经典用色">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h3 id="《经济学人》常用的藏青色">《经济学人》常用的藏青色</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c77d81fg214.jpg" alt=""></p>
<p>经济学人上的图表，基本只用这一个颜色，或加上一些深浅明暗变化，再就是左上角的小红块，成为经济学人图表的招牌样式。罗兰贝格也非常爱用这个色，有时也配合橙色使用。各类提供专业服务的网站也多爱用此色。</p>
<p>风格就是这样，即使很单调，只要你坚持，也会成为自己的风格，别人也会认同。所谓以不变应万变，变得太多反而难以把握。</p>
<h3 id="《商业周刊》常用的蓝红组合">《商业周刊》常用的蓝红组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c74bcadg215.jpg" alt=""></p>
<p>早年的商业周刊上的图表，几乎都使用这个颜色组合，基本成为商业周刊图表的招牌标志了，应该是来源于其VI系统。不过今年来好像很有些变化，更加轻快明亮。</p>
<h3 id="《华尔街日报》常用的黑白灰">《华尔街日报》常用的黑白灰</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7989a1g214.jpg" alt=""><br>HSJ是一份报纸，所以图表多是黑白的，但就是这种黑白灰的组合，做出的图表仍然可以非常专业，配色也非常容易。</p>
<h3 id="使用同一颜色的不同深浅">使用同一颜色的不同深浅</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c75dafag215.jpg" alt=""></p>
<p>如果既想使用彩色，又不知道配色理论，可在一个图表内使用同一颜色的不同深浅/明暗。这种方法可以让我们使用丰富的颜色，配色难度也不高，是一种很保险的方法，不会出大问题。当然，最深/最亮的要用于最需要突出的序列。</p>
<h3 id="《FOCUS》常用的一组色">《FOCUS》常用的一组色</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7b0916g213.jpg" alt=""></p>
<p>这组颜色似乎是从组织的LOGO而来，比较亮丽明快，也不错。</p>
<h3 id="设计师珍藏自用颜色：橙＋灰">设计师珍藏自用颜色：橙＋灰</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7ace92g214.jpg" alt=""></p>
<p>我发现，设计师们总喜好把这个颜色组合用于自己的宣传，似乎这样能体现设计师的专业性。如Inmagine、Nordrio的LOGO就是这样。</p>
<h3 id="暗红＋灰组合">暗红＋灰组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7728eeg215.jpg" alt=""></p>
<p>这种红＋灰的组合给人很专业的印象，也经常出现在财经杂志上。</p>
<h3 id="橙＋绿组合">橙＋绿组合</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7c4e31g213.jpg" alt=""></p>
<p>这种橙＋绿的组合比较亮丽明快，充满活力，也经常出现在财经杂志上。</p>
<h3 id="黑底图表">黑底图表</h3><p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11d8c7cb5f3g213.jpg" alt=""></p>
<p>最为强烈的黑白对比，总是显得比较专业、高贵，黑底的图表其特点非常明显，但不要学麦肯锡的那一套，有些刺眼，也被它用滥了。</p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tiramisutes.github.io/2015/07/31/mytheme.html"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tiramisutes"/>
      <meta itemprop="description" content="hope bioinformatics blog"/>
      <meta itemprop="image" content="/images/author.jpg"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hope"/>
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2015/07/31/mytheme.html" class="post-title-link" itemprop="url">ggplot2 fine drawing using mytheme</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2015-07-31 22:45:06" itemprop="dateCreated datePublished" datetime="2015-07-31T22:45:06+08:00">2015-07-31</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/2015/07/31/mytheme.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2015/07/31/mytheme.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
            <span id="/2015/07/31/mytheme.html" class="leancloud_visitors" data-flag-title="ggplot2 fine drawing using mytheme">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              
                <span class="post-meta-item-text">Views: </span>
              
                <span class="leancloud-visitors-count"></span>
                <span>℃</span>
            </span>
          

          

          
            <div class="post-symbolscount">
              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article: </span>
                
                <span title="Words count in article"></span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time"></span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>ggplot2本身自带了很漂亮的主题格式，如theme_gray和theme_bw。但是在工作用图上，很多时候对图表格式配色字体等均有明文的规定。ggplot2允许我们事先定制好图表样式，我们可以生成如mytheme或者myline这样的有明确配色主题的对象，到时候就可以定制保存图表模板或者格式刷，直接在生成的图表里引用格式刷型的主题配色，就可以快捷方便的更改图表内容，保持风格的统一了。</p>
<h2 id="画图前的准备：自定义ggplot2格式刷">画图前的准备：自定义ggplot2格式刷</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(dplyr)</span><br><span class="line">library(RColorBrewer)</span><br><span class="line">library(tidyr)</span><br><span class="line">library(grid)</span><br><span class="line"><span class="comment">#定义好字体</span></span><br><span class="line">windowsFonts(CA=windowsFont(<span class="string">"Calibri"</span>))</span><br><span class="line"><span class="comment">#事先定制好要加图形的形状、颜色、主题等</span></span><br><span class="line"><span class="comment">#定制主题，要求背景全白，没有边框。然后所有的字体都是某某颜色</span></span><br><span class="line">mytheme&lt;-theme_bw()+theme(legend.position=<span class="string">"right"</span>,</span><br><span class="line">                          panel.border=element_blank(),</span><br><span class="line">                          panel.grid.major=element_line(linetype=<span class="string">"dashed"</span>),</span><br><span class="line">                          panel.grid.minor=element_blank(),</span><br><span class="line">                          plot.title=element_text(size=15,</span><br><span class="line">                                                  colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                  family=<span class="string">"CA"</span>),</span><br><span class="line">                          legend.text=element_text(size=9,colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                   family=<span class="string">"CA"</span>),</span><br><span class="line">                          legend.key=element_blank(),</span><br><span class="line">                          axis.text=element_text(size=10,colour=<span class="string">"#003087"</span>,</span><br><span class="line">                                                 family=<span class="string">"CA"</span>),</span><br><span class="line">                          strip.text=element_text(size=12,colour=<span class="string">"#EF0808"</span>,</span><br><span class="line">                                                  family=<span class="string">"CA"</span>),</span><br><span class="line">                          strip.background=element_blank()</span><br><span class="line"></span><br><span class="line">                        )</span><br><span class="line"><span class="comment">#饼图主题</span></span><br><span class="line">pie_theme=mytheme+theme(axis.text=element_blank(),</span><br><span class="line">                        axis.ticks=element_blank(),</span><br><span class="line">                        axis.title=element_blank(),</span><br><span class="line">                        panel.grid.major=element_blank())</span><br><span class="line"><span class="comment">#定制线的大小</span></span><br><span class="line">myline_blue&lt;-geom_line(colour=<span class="string">"#085A9C"</span>,size=2)</span><br><span class="line">myline_red&lt;-geom_line(colour=<span class="string">"#EF0808"</span>,size=2)</span><br><span class="line">myarea=geom_area(colour=NA,fill=<span class="string">"#003087"</span>,alpha=.2)</span><br><span class="line">mypoint=geom_point(size=3,shape=21,colour=<span class="string">"#003087"</span>,fill=<span class="string">"white"</span>)</span><br><span class="line">mybar=geom_bar(fill=<span class="string">"#0C8DC4"</span>,<span class="built_in">stat</span>=<span class="string">"identity"</span>)</span><br><span class="line"><span class="comment">#然后是配色（主要是图形配色），考虑到样本的多样性，可以事先设定颜色，如3种颜色或7种颜色的组合，如果想要用原来默认主题颜色则这部分注释掉即可</span></span><br><span class="line">mycolour_3&lt;-scale_fill_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>))</span><br><span class="line">mycolour_7&lt;-scale_fill_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>,</span><br><span class="line"><span class="string">"#FFFFE7"</span>,<span class="string">"#FF9418"</span>,<span class="string">"#219431"</span>,<span class="string">"#9C52AD"</span>))</span><br><span class="line">mycolour_line_7&lt;-scale_color_manual(values=c(<span class="string">"#085A9C"</span>,<span class="string">"#EF0808"</span>,<span class="string">"#526373"</span>,</span><br><span class="line">                                             <span class="string">"#0C8DC4"</span>,<span class="string">"#FF9418"</span>,<span class="string">"#219431"</span>,<span class="string">"#9C52AD"</span>))</span><br><span class="line"><span class="comment">#定制标题</span></span><br><span class="line">mytitle&lt;-labs(title = <span class="string">"hope 实例"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="载入例子数据">载入例子数据</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">require(ggplot2)</span><br><span class="line">data(diamonds)</span><br><span class="line">set.seed(42)</span><br><span class="line">small &lt;- diamonds[sample(nrow(diamonds), 1000), ]</span><br><span class="line">head(small)</span><br></pre></td></tr></table></figure>
<h3 id="不用自定义格式画图">不用自定义格式画图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot(small)+geom_bar(aes(x=clarity, fill=cut))+coord_polar()</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot01.jpeg" alt=""></p>
<h3 id="利用自定义格式画图">利用自定义格式画图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ggplot(small)+geom_bar(aes(x=clarity, fill=cut))+coord_polar()+ mytheme + mytitle</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/Rplot.jpeg" alt=""></p>
<h2 id="画图前的准备：数据塑形利器dplyr/tidyr">画图前的准备：数据塑形利器dplyr/tidyr</h2><p>在R里，则是用一些常用的包，如dplyr及tidyr，基本用的都是reshape2+plyr的组合对数据进行重塑再造.</p>
<h3 id="载入数据，数据来源:_股票的成交明细-">载入数据，数据来源: <span class="exturl" data-url="aHR0cDovL3d3dy55dWNlemhlLmNvbS9wcm9kdWN0P25hbWU9dGljay1kYXRhLXB1c2g=" title="http://www.yucezhe.com/product?name=tick-data-push">股票的成交明细.<i class="fa fa-external-link"></i></span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; data&lt;-read.table(<span class="string">"gupiao.txt"</span>,header=TRUE)</span><br><span class="line">&gt; head(data)</span><br><span class="line">     Time Price BuySell Volume     Money</span><br><span class="line">1 9:25:08 18.03    0.00  73520 132557642</span><br><span class="line">2 9:29:59 17.99   -0.04  11034  19857700</span><br><span class="line">3 9:30:09 17.99    0.00  28920  52089378</span><br><span class="line">4 9:30:09 17.99    0.00   9272  16681906</span><br><span class="line">5 9:30:14 17.96   -0.03    556    998913</span><br><span class="line">6 9:30:19 17.96    0.00    873   1567490</span><br><span class="line">&gt; dim(data)</span><br><span class="line">[1] 2345    5</span><br></pre></td></tr></table></figure>
<h3 id="将数据汇总(group_by_&amp;_summarize)_甚至再拆分_(spread)">将数据汇总(group_by &amp; summarize) 甚至再拆分 (spread)</h3><p>示例里面就是把成交记录按照成交Price和BuySell拆分<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; data %&gt;% group_by(Price,BuySell) %&gt;% summarize(Money=sum(Money,na.rm=TRUE)) %&gt;% spread(BuySell,Money)</span><br><span class="line">Source: <span class="built_in">local</span> data frame [46 x 16]</span><br><span class="line"></span><br><span class="line">   Price -0.07 -0.06 -0.05    -0.04   -0.03    -0.02    -0.01        0     0.01</span><br><span class="line">1  17.58    NA    NA    NA       NA      NA       NA 41631769 29645465       NA</span><br><span class="line">2  17.59    NA    NA    NA       NA      NA 17173618 37029276       NA 24179724</span><br><span class="line">3  17.60    NA    NA    NA       NA      NA   318581 42756941 15987562 11197676</span><br><span class="line">4  17.61    NA    NA    NA       NA      NA       NA 58098336 36701330 14999088</span><br><span class="line">5  17.62    NA    NA    NA       NA      NA       NA 32385632 51156365 24341609</span><br><span class="line">6  17.63    NA    NA    NA       NA      NA  5191027 16112558 32054647 23599759</span><br><span class="line">7  17.64    NA    NA    NA 24642084 3725529 14682967  4791698 18864232  4731619</span><br><span class="line">8  17.65    NA    NA    NA       NA 3918096  6003983 16293279 19115145 13177514</span><br><span class="line">9  17.66    NA    NA    NA       NA 5175002       NA 54169855 16671362  7801764</span><br><span class="line">10 17.67    NA    NA    NA       NA      NA 10951987 38090607  8704892  7911066</span><br><span class="line">..   ...   ...   ...   ...      ...     ...      ...      ...      ...      ...</span><br><span class="line">Variables not shown: 0.02 (int), 0.03 (int), 0.04 (int), 0.05 (int), 0.06 (int),</span><br><span class="line">  0.07 (int)</span><br></pre></td></tr></table></figure></p>
<p>然后便可用ggplot等包绘图。</p>
<h2 id="常用图形">常用图形</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">简单柱形图+文本（单一变量） </span><br><span class="line">分面柱形图（facet_wrap/facet_grid) </span><br><span class="line">簇型柱形图(position=<span class="string">"dodge"</span>) </span><br><span class="line">堆积柱形图(需要先添加百分比，再对百分比的变量做柱形图) </span><br><span class="line">饼图、极坐标图 </span><br><span class="line">多重线性图</span><br></pre></td></tr></table></figure>
<p>1)简单柱形图 </p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/11.jpeg" alt=""><br>代码组成如下，这里使用格式刷mybar和mytheme，然后用geom_text添加柱形图标签(vjust=1表示在柱形图里面显示)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data1&lt;-diamonds %&gt;% group_by(cut) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line">bar_chart&lt;-ggplot(data1,aes(x=cut,y=avg_price,fill=as.factor(cut)))+</span><br><span class="line">        mybar+mytheme+mytitle+</span><br><span class="line">        geom_text(aes(label=round(avg_price)),vjust=1,colour=<span class="string">"white"</span>)</span><br><span class="line">bar_chart</span><br></pre></td></tr></table></figure></p>
<p>2）带分类的柱形图<br>使用facet_wrap或者facet_grid可以快速绘制相应图形。这也是ggplot2不太支持双坐标的原因：可以快速绘图，就不需要做那么多无用功了。<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/22.jpeg" alt=""><br>代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dplyr处理数据</span></span><br><span class="line">data2&lt;-diamonds %&gt;% group_by(cut,color) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line"><span class="comment">#画图，套用设定好的绘图元素</span></span><br><span class="line">ggplot(data2,aes(x=color,y=avg_price))+facet_wrap(~cut,ncol = 2)+</span><br><span class="line">        mybar+mytheme+mytitle</span><br><span class="line"><span class="comment">#在facet_wrap里面，如果加上scales="free"的话，坐标就不一样了。</span></span><br></pre></td></tr></table></figure></p>
<p>3）簇型图<br>制图要点是，对数据作图后，添加geom_bar时，position=”dodge”（分开的）如果去掉这部分，默认是生成堆积图.</p>
<p><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/33.jpeg" alt=""><br>代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data3&lt;-diamonds %&gt;% filter(cut %<span class="keyword">in</span>% c(<span class="string">"Fair"</span>,<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>)) %&gt;%</span><br><span class="line">        group_by(cut,color) %&gt;% summarize(avg_price=mean(price))</span><br><span class="line"><span class="comment">#簇状图</span></span><br><span class="line">簇状柱形图&lt;-ggplot(data3,aes(x=color,y=avg_price,fill=cut))+</span><br><span class="line">        geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,position=<span class="string">"dodge"</span>)+</span><br><span class="line">        mytheme+mytitle+mycolour_3</span><br></pre></td></tr></table></figure>
<p>这里如果想要定义颜色的相应顺序的话，可以使用factor </p>
<p>譬如以下,只是用这行代码对颜色重新定义一下，用levels改变factor顺序，再画图的时候，颜色以及柱子顺序就会跟着改变了。非常方便。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data3<span class="variable">$cut</span>&lt;-factor(data3<span class="variable">$cut</span>,levels=c(<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>,<span class="string">"Fair"</span>))</span><br></pre></td></tr></table></figure></p>
<p>4）百分比堆积图<br>制图前要事先添加一个百分比的数据之后才好作图，这里我们用mutate(percent=n/sum(n))添加该百分比数据。同时去掉position=”dodge”<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/66.jpeg" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data4&lt;-diamonds %&gt;% filter(cut %<span class="keyword">in</span>% c(<span class="string">"Fair"</span>,<span class="string">"Very Good"</span>,<span class="string">"Ideal"</span>)) %&gt;%</span><br><span class="line">         count(color,cut) %&gt;% </span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">堆积图&lt;-ggplot(data4,aes(x=color,y=percent,fill=cut))+mytitle+</span><br><span class="line">        geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>)+mytheme+mycolour_3</span><br></pre></td></tr></table></figure></p>
<p>当然，也可以做面积图。不过如果数据有缺失，面积图出错几率蛮大的</p>
<p>5）饼图以及极坐标图</p>
<p>在ggplot2里并没有直接画饼图的方法，基本上都是先画出柱形图，再用coord_polar转化为饼图.<br>不指定x轴，直接用geom_bar生成y轴，然后fill=分类颜色，coord_polar直接投影y轴，该方法的好处代码是比较简单：coord_polar(“y”) 。<br>加标签方法请见： <span class="exturl" data-url="aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84OTUyMDc3L3BpZS1wbG90LWdldHRpbmctaXRzLXRleHQtb24tdG9wLW9mLWVhY2gtb3RoZXI=" title="http://stackoverflow.com/questions/8952077/pie-plot-getting-its-text-on-top-of-each-other">http://stackoverflow.com/questions/8952077/pie-plot-getting-its-text-on-top-of-each-other<i class="fa fa-external-link"></i></span><br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/77.jpeg" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data5&lt;-diamonds %&gt;% count(cut) %&gt;% </span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">ggplot(data5,aes(x=factor(1),y=percent,fill=cut))+geom_bar(<span class="built_in">stat</span>=<span class="string">"identity"</span>,width=3)+mycolour_7+</span><br><span class="line">        coord_polar(<span class="string">"y"</span>)+pie_theme+mytitle</span><br></pre></td></tr></table></figure></p>
<p>6、折线图<br><img src="https://raw.githubusercontent.com/wiki/tiramisutes/blog_image/88.jpeg" alt=""><br>要点是，先做成如A-B-变量这样的二联表，然后，x轴为A，group为b,colour为b<br>下面代码展示了这个处理<br>如果去掉group的话，折线图会不知道怎么去处理数字。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data6&lt;-diamonds %&gt;% count(color,cut) %&gt;% filter(color %<span class="keyword">in</span>% c(<span class="string">"D"</span>,<span class="string">"E"</span>,<span class="string">"F"</span>))%&gt;%</span><br><span class="line">        mutate(percent=n/sum(n))</span><br><span class="line">ggplot(data6,aes(x=cut,y=n,group=color,colour=color))+geom_line(size=1.5)+mypoint+</span><br><span class="line">        mycolour_line_7+mytheme+mytitle</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/" class="site-author-image" rel="start" style="border:none">
              <img class="site-author-image" itemprop="image"
                src="/images/author.jpg"
                alt="tiramisutes"/>
              </a>
            
              <p class="site-author-name" itemprop="name">tiramisutes</p>
              <div class="site-description motion-element" itemprop="description">hope bioinformatics blog</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">148</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">112</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpcmFtaXN1dGVz" title="GitHub &rarr; https://github.com/tiramisutes"><i class="fa fa-fw fa-github"></i>GitHub</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="bWFpbHRvOnRpcmFtaXN1dGVze2F0fTEyNi5jb20=" title="E-Mail &rarr; mailto:tiramisutes{at}126.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cDovL3dlaWJvLmNvbS90aXJhbWlzdXRlc1Rlcw==" title="Weibo &rarr; http://weibo.com/tiramisutesTes"><i class="fa fa-fw fa-globe"></i>Weibo</span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9ob3BldG9neQ==" title="Twitter &rarr; https://twitter.com/hopetogy"><i class="fa fa-fw fa-twitter"></i>Twitter</span>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
              
                
              
              
              
              <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"/></span>
             </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9paG9wZS5zaGlueWFwcHMuaW8vcVJULVBDUi1QaXBlbGluZS8=" title="https://ihope.shinyapps.io/qRT-PCR-Pipeline/">qRT-PCR-Pipeline</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly90aXJhbWlzdXRlcy5naXRib29rcy5pby9hd2svY29udGVudC8=" title="https://tiramisutes.gitbooks.io/awk/content/">GitBook《awk学习总结》</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2NvdHRvbi5oemF1LmVkdS5jbi8=" title="http://cotton.hzau.edu.cn/">棉花遗传改良团队</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5iaW8taW5mby10cmFpbmVlLmNvbS8=" title="http://www.bio-info-trainee.com/">生信菜鸟团-深圳大学城</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5iaW90cmFpbmVlLmNvbS9mb3J1bS5waHA=" title="http://www.biotrainee.com/forum.php">生信技能树</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5pd2hnYW8uY29tLw==" title="http://www.iwhgao.com/">rabbit gao's blog</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9odWFucy5naXRodWIuaW8v" title="https://huans.github.io/">Huans(代谢+GWAS)</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5zZXF1ZW5jaW5nLnVpby5uby8=" title="http://www.sequencing.uio.no/">NSC-sequenceing</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2Jsb2cuam9iYm9sZS5jb20v" title="http://blog.jobbole.com/">伯乐在线</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9saW51eC5jbi8=" title="https://linux.cn/">Linux开源中文社区</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3d3dy5yLWJsb2dnZXJzLmNvbS8=" title="http://www.r-bloggers.com/">R-bloggers</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvb3RoZXItZG9jcy5odG1s" title="https://cran.r-project.org/other-docs.html">R-resource</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL3R1dG9yaWFscy5pcS5oYXJ2YXJkLmVkdS9SL1JncmFwaGljcy9SZ3JhcGhpY3MuaHRtbA==" title="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html">ggplot2</span>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <span class="exturl" data-url="aHR0cDovL2xpbGliZWkubmV0Lw==" title="http://lilibei.net/">pele' blog</span>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <a class="theme-link" target="_blank" href="http://tiramisutes.github.io/about/"><span class="author" itemprop="copyrightHolder">tiramisutes</span></a>

  
    <span class="post-meta-item-icon">
    </span>
    <span title="Symbols count total"></span>
  

  
    <span class="post-meta-item-icon">
    </span>
    <span title="Reading time total"></span>
  
</div>


  <div class="powered-by">Powered: <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">▽ – <span class="exturl theme-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL25leHQtdGhlbWUvaGV4by10aGVtZS1uZXh0">NexT.Muse</span></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-line-chart"></i>
    </span>
    <span class="site-pv" title="Total Views">
    <a style="line-height: 1.5;" href="https://tongji.baidu.com/web/welcome/login" target="_blank">The total visits
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>&nbsp;times</a>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  



  
    
    
      
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='20' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest-nomobile.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.6/jquery.fancybox.min.js"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  
  <script src="/js/src/exturl.js?v=7.0.1"></script>


  
  
  
    
  

  
    
      
    
  

  
  
  
    <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
    <script>
      
        window.addEventListener('load', () => {
      
        quicklink({
          timeout: 3000,
          priority: true,
          ignores: [uri => uri.includes('#'),uri => uri == 'http://tiramisutes.github.io/page/13/',]
        });
      
        });
      
    </script>
  


  
  

  

<script src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: true,
    appId: 'c7x0fPmO8Ci9avDBRuGWHqpG-gzGzoHsz',
    appKey: 'iVJ6ST0e1O5xaiIhVwOyhbf3',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true
  });
</script>





  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  
<style>
.pdfobject-container {
  position: relative;
  overflow: auto;
  width: 100%;
}
</style>
<script>
if ($('body').find('div.pdf').length) {
  $.ajax({
    type: 'GET',
    url: '//cdn.jsdelivr.net/npm/pdfobject@2.1.1/pdfobject.min.js',
    dataType: 'script',
    cache: true,
    success: function() {
      $('body').find('div.pdf').each(function(i, o) {
        PDFObject.embed($(o).attr('target'), $(o), {
          pdfOpenParams: {
            navpanes: 0,
            toolbar: 0,
            statusbar: 0,
            pagemode: 'thumbs',
            view: 'FitH'
          },
          PDFJS_URL: '/lib/pdf/web/viewer.html',
          height: $(o).attr('height') || '500px'
        });
      });
    },
  });
}
</script>


  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  
  
  
    
  
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
    
      pbOptions = {};
      
        pbOptions.iconStyle = "box";
      
        pbOptions.boxForm = "horizontal";
      
        pbOptions.position = "bottomCenter";
      
        pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Evernote,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>


  

  

  

  

</body>
</html>
